function e(e){return e&&e.__esModule?e.default:e}function t(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}var i=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire26fc,n=i.register;n("4XALk",function(n,r){let o,s,l,a,d,c,u,h,m,g,p,v,S,f,C,I,b,_,R,y,T,E,w,P;t(n.exports,"SheetsUIPart",function(){return ed}),t(n.exports,"getEditorObject",function(){return ec}),t(n.exports,"SheetSkeletonManagerService",function(){return ev}),t(n.exports,"attachRangeWithCoord",function(){return eS}),t(n.exports,"RANGE_SELECTOR_COMPONENT_KEY",function(){return eM}),t(n.exports,"SHEET_VIEW_KEY",function(){return eO}),t(n.exports,"VIEWPORT_KEY",function(){return ex}),t(n.exports,"SELECTION_SHAPE_DEPTH",function(){return eN}),t(n.exports,"SelectionShape",function(){return eH}),t(n.exports,"ISheetSelectionRenderService",function(){return ez}),t(n.exports,"attachSelectionWithCoord",function(){return eF}),t(n.exports,"BaseSelectionRenderService",function(){return eY}),t(n.exports,"getAllSelection",function(){return eG}),t(n.exports,"JumpOver",function(){return ta}),t(n.exports,"MoveSelectionCommand",function(){return td}),t(n.exports,"ExpandSelectionCommand",function(){return tu}),t(n.exports,"getSheetObject",function(){return tg}),t(n.exports,"getCoordByCell",function(){return tp}),t(n.exports,"getCoordByOffset",function(){return tv}),t(n.exports,"IEditorBridgeService",function(){return tA}),t(n.exports,"deriveStateFromActiveSheet$",function(){return tN}),t(n.exports,"getObservableWithExclusiveRange$",function(){return tV}),t(n.exports,"getCurrentRangeDisable$",function(){return tW}),t(n.exports,"SheetsRenderService",function(){return tK}),t(n.exports,"getCustomRangePosition",function(){return t2}),t(n.exports,"getEditingCustomRangePosition",function(){return t5}),t(n.exports,"rangeToDiscreteRange",function(){return ie}),t(n.exports,"virtualizeDiscreteRanges",function(){return ii}),t(n.exports,"getAutoFillRepeatRange",function(){return iN}),t(n.exports,"DATA_TYPE",function(){return iW}),t(n.exports,"APPLY_TYPE",function(){return iH}),t(n.exports,"IAutoFillService",function(){return i9}),t(n.exports,"SetCellEditVisibleOperation",function(){return i7}),t(n.exports,"SetZoomRatioOperation",function(){return na}),t(n.exports,"IMarkSelectionService",function(){return od}),t(n.exports,"CancelFrozenCommand",function(){return oE}),t(n.exports,"ScrollToRangeOperation",function(){return oU}),t(n.exports,"useActiveWorkbook",function(){return sC}),t(n.exports,"whenSheetEditorFocused",function(){return lr}),t(n.exports,"whenFormulaEditorActivated",function(){return ld}),t(n.exports,"COPY_TYPE",function(){return lO}),t(n.exports,"getRepeatRange",function(){return lW}),t(n.exports,"PREDEFINED_HOOK_NAME",function(){return lK}),t(n.exports,"ISheetClipboardService",function(){return lq}),t(n.exports,"SheetPasteCommand",function(){return l3}),t(n.exports,"PASTE_SPECIAL_MENU_ID",function(){return aq}),t(n.exports,"checkInHeaderRanges",function(){return dm}),t(n.exports,"RANGE_SELECTOR_SYMBOLS",function(){return c$}),t(n.exports,"isRangeSelector",function(){return c0}),t(n.exports,"SheetCanvasPopManagerService",function(){return uI}),t(n.exports,"CellAlertType",function(){return uw}),t(n.exports,"CellAlertManagerService",function(){return uP}),t(n.exports,"HoverManagerService",function(){return uj}),t(n.exports,"DragManagerService",function(){return hu}),t(n.exports,"HoverRenderController",function(){return h0}),t(n.exports,"SheetPermissionInterceptorBaseController",function(){return mv}),t(n.exports,"SheetPrintInterceptorService",function(){return pM}),t(n.exports,"UniverSheetsUIPlugin",function(){return pL});var M=i("g6Cit"),O=i("7yNYd"),x=i("3e0Iz"),A=i("ejawP"),k=i("5LPkb"),N=i("5K4WI"),D=i("dLBA8"),V=i("bXJOC"),W=i("arCqp"),H=i("gL4uk"),U=i("lMvMU"),L=i("hciHF"),B=i("i54iF"),F=i("1O3Nt"),j=i("3yupB"),z=i("9GqS8"),X=i("ezO1S"),Y=i("1mjSk"),G=i("e1VZ5"),Z=i("23cfA"),K=i("2jrJe"),q=i("gv2K9"),Q=i("4T0Xd"),J=i("fL2Ug"),$=i("7AR1b"),ee=i("5gqvu"),et=i("1UDbf"),ei=i("86b1c"),en=i("2BOVU"),U=i("lMvMU"),er=i("5zTXZ"),eo=Object.defineProperty,es=(e,t,i)=>t in e?eo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,el=(e,t)=>eo(e,"name",{value:t,configurable:!0}),ea=(e,t,i)=>es(e,"symbol"!=typeof t?t+"":t,i),ed=((o=ed||{}).FILTER_PANEL_EMBED_POINT="filter-panel-embed-point",o.SHEETS_FOOTER="sheets-footer",o.FORMULA_AUX="formula-aux",o);function ec(e,t){if(null==e)return;let i=t.getRenderById(e);if(null==i)return;let{mainComponent:n,scene:r,engine:o,components:s}=i;return{document:n,docBackground:s.get(M.DOCS_VIEW_KEY.BACKGROUND),scene:r,engine:o}}el(ec,"getEditorObject");var eu,eh=Object.defineProperty,em=Object.getOwnPropertyDescriptor,eg=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?em(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&eh(t,i,o),o},"__decorateClass$X"),ep=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$X");let ev=(el(eu=class extends O.Disposable{constructor(e,t){super(),ea(this,"_currentSkeletonSearchParam",{sheetId:""}),ea(this,"_sheetSkeletonParam",[]),ea(this,"_currentSkeleton$",new k.BehaviorSubject(null)),ea(this,"currentSkeleton$",this._currentSkeleton$.asObservable()),ea(this,"_currentSkeletonBefore$",new k.BehaviorSubject(null)),ea(this,"currentSkeletonBefore$",this._currentSkeletonBefore$.asObservable()),this._context=e,this._injector=t,this.disposeWithMe(()=>{this._currentSkeletonBefore$.complete(),this._currentSkeleton$.complete(),this._sheetSkeletonParam=[]}),this._initRemoveSheet()}_initRemoveSheet(){this.disposeWithMe(this._context.unit.sheetDisposed$.subscribe(e=>{this.disposeSkeleton({sheetId:e.getSheetId()})}))}getCurrentSkeleton(){var e;return null==(e=this.getCurrent())?void 0:e.skeleton}getCurrent(){return this._getSkeleton(this._currentSkeletonSearchParam)}getWorksheetSkeleton(e){return this._getSkeleton({sheetId:e})}getUnitSkeleton(e,t){let i=this._getSkeleton({sheetId:t});return null!=i&&(i.unitId=e),i}setCurrent(e){this._setCurrent(e)}_setCurrent(e){let t=this._getSkeleton(e),i=this._context.unitId;if(null!=t)this._reCalculate(t);else{let{sheetId:t}=e,n=this._context.unit.getSheetBySheetId(e.sheetId);if(null==n)return;let r=this._buildSkeleton(n);this._sheetSkeletonParam.push({unitId:i,sheetId:t,skeleton:r,dirty:!1})}this._currentSkeletonSearchParam=e;let n=this._currentSkeletonSearchParam.sheetId,r=this.getUnitSkeleton(i,n);this._currentSkeletonBefore$.next(r),this._currentSkeleton$.next(r)}reCalculate(){let e=this.getCurrent();null!=e&&this._reCalculate(e)}_reCalculate(e){e.dirty&&(e.skeleton.makeDirty(!0),e.dirty=!1),e.skeleton.calculate()}makeDirty(e,t=!0){let i=this._getSkeleton(e);null!=i&&(i.dirty=t)}getOrCreateSkeleton(e){let t=this._getSkeleton(e);if(t)return t.skeleton;let i=this._context.unit.getSheetBySheetId(e.sheetId);if(!i)return;let n=this._buildSkeleton(i);return this._sheetSkeletonParam.push({unitId:this._context.unitId,sheetId:e.sheetId,skeleton:n,dirty:!1}),n}disposeSkeleton(e){let t=this._sheetSkeletonParam.findIndex(t=>t.sheetId===e.sheetId);t>-1&&(this._sheetSkeletonParam[t].skeleton.dispose(),this._sheetSkeletonParam.splice(t,1))}attachRangeWithCoord(e){let t=this.getCurrentSkeleton();return t?eS(t,e):null}_getSkeleton(e){let t=this._sheetSkeletonParam.find(t=>t.sheetId===e.sheetId);return null!=t&&(t.commandId=e.commandId),t}_buildSkeleton(e){let t=e.getConfig();return this._injector.createInstance(x.SpreadsheetSkeleton,e,t,e.getCellMatrix(),this._context.unit.getStyles())}},"SheetSkeletonManagerService"),eu);function eS(e,t){let{startRow:i,startColumn:n,endRow:r,endColumn:o,rangeType:s}=t,l=e.getNoMergeCellPositionByIndex(r<i?r:i,o<n?o:n),a=e.getNoMergeCellPositionByIndex(r<i?i:r,o<n?n:o);return{startRow:i,startColumn:n,endRow:r,endColumn:o,rangeType:s,startY:(null==l?void 0:l.startY)||0,endY:(null==a?void 0:a.endY)||0,startX:(null==l?void 0:l.startX)||0,endX:(null==a?void 0:a.endX)||0}}ev=eg([ep(1,(0,O.Inject)(O.Injector))],ev),el(eS,"attachRangeWithCoord");var ef,eC=Object.defineProperty,eI=Object.getOwnPropertyDescriptor,eb=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?eI(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&eC(t,i,o),o},"__decorateClass$W"),e_=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$W");let eR=(el(ef=class{constructor(e,t){ea(this,"_scrollStateMap",/* @__PURE__ */new Map),ea(this,"_rawscrollInfo$",new k.BehaviorSubject(null)),ea(this,"rawScrollInfo$",this._rawscrollInfo$.asObservable()),ea(this,"validViewportScrollInfo$",new k.BehaviorSubject(null)),ea(this,"_searchParamForScroll",null),this._context=e,this._sheetSkeletonManagerService=t}dispose(){this._rawscrollInfo$.complete()}setSearchParam(e){this._searchParamForScroll=e}setSearchParamAndRefresh(e){this._searchParamForScroll=e,this._scrollStateNext(e)}getScrollStateByParam(e){return this._getCurrentScroll(e)}getCurrentScrollState(){return this._getCurrentScroll(this._searchParamForScroll)}setScrollInfoAndEmitEvent(e){this._setScrollState(e),this._scrollStateNext(e)}setScrollStateToCurrSheetAndEmitEvent(e){null!=this._searchParamForScroll&&(this._setScrollState({...this._searchParamForScroll,...e}),this._scrollStateNext(this._searchParamForScroll))}setScrollStateToCurrSheet(e){null!=this._searchParamForScroll&&this._setScrollState({...this._searchParamForScroll,...e})}clear(){null!=this._searchParamForScroll&&this._clearByParamAndNotify(this._searchParamForScroll)}calcViewportScrollFromRowColOffset(e){if(!e)return{viewportScrollX:0,viewportScrollY:0};let{sheetViewStartColumn:t,sheetViewStartRow:i,offsetX:n,offsetY:r}=e;i=i||0,r=r||0;let o=this._sheetSkeletonManagerService.getCurrentSkeleton(),s=(null==o?void 0:o.rowHeightAccumulation[i-1])||0;return{viewportScrollX:((null==o?void 0:o.columnWidthAccumulation[t-1])||0)+n,viewportScrollY:s+r}}_setScrollState(e){let{unitId:t,sheetId:i,sheetViewStartColumn:n,sheetViewStartRow:r,offsetX:o,offsetY:s}=e;this._scrollStateMap.has(t)||this._scrollStateMap.set(t,/* @__PURE__ */new Map),this._scrollStateMap.get(t).set(i,{sheetViewStartRow:r,sheetViewStartColumn:n,offsetX:o,offsetY:s})}_clearByParamAndNotify(e){this._setScrollState({...e,sheetViewStartRow:0,sheetViewStartColumn:0,offsetX:0,offsetY:0}),this._scrollStateNext(e)}_getCurrentScroll(e){var t;if(null==e)return;let{unitId:i,sheetId:n}=e;return null==(t=this._scrollStateMap.get(i))?void 0:t.get(n)}_scrollStateNext(e){let t=this._getCurrentScroll(e);this._rawscrollInfo$.next(t)}},"SheetScrollManagerService"),ef);eR=eb([e_(1,(0,O.Inject)(ev))],eR);let ey={id:"sheet.operation.set-scroll",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>{if(!t)return!1;let{unitId:i,sheetId:n,offsetX:r,offsetY:o,sheetViewStartColumn:s,sheetViewStartRow:l}=t,a=e.get(O.IUniverInstanceService),d=e.get(x.IRenderManagerService),c=a.getUniverSheetInstance(i).getSheetBySheetId(n),u=d.getRenderById(i).with(eR),{xSplit:h,ySplit:m}=c.getConfig().freeze;return u.setScrollInfoAndEmitEvent({unitId:i,sheetId:n,offsetX:r,offsetY:o,sheetViewStartRow:l-m,sheetViewStartColumn:s-h}),!0},"handler")},eT={id:"sheet.command.set-scroll-relative",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.ICommandService),n=e.get(O.IUniverInstanceService),r=e.get(x.IRenderManagerService),o=(0,A.getSheetCommandTarget)(n);if(!o)return!1;let{unitId:s,subUnitId:l,worksheet:a}=o,{xSplit:d,ySplit:c}=a.getConfig().freeze,u=r.getRenderById(s).with(eR).getCurrentScrollState(),{offsetX:h=0,offsetY:m=0}=t||{},{sheetViewStartRow:g=0,sheetViewStartColumn:p=0,offsetX:v=0,offsetY:S=0}=u||{};return i.executeCommand(ey.id,{unitId:s,sheetId:l,sheetViewStartRow:g+c,sheetViewStartColumn:p+d,offsetX:v+h,offsetY:S+m})},"handler")},eE={id:"sheet.command.scroll-view",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el((e,t)=>{if(!t)return!1;let i=e.get(O.IUniverInstanceService),n=e.get(x.IRenderManagerService),r=(0,A.getSheetCommandTarget)(i);if(!r)return!1;let{workbook:o,worksheet:s,unitId:l}=r,a=n.getRenderById(l).with(eR).getCurrentScrollState();if(!s)return!1;let{sheetViewStartRow:d,sheetViewStartColumn:c,offsetX:u,offsetY:h}=t,{sheetViewStartColumn:m,sheetViewStartRow:g,offsetX:p,offsetY:v}=a||{},{xSplit:S,ySplit:f}=s.getConfig().freeze;return e.get(O.ICommandService).syncExecuteCommand(ey.id,{unitId:o.getUnitId(),sheetId:s.getSheetId(),sheetViewStartRow:null!=d?d:(null!=g?g:0)+f,sheetViewStartColumn:null!=c?c:(null!=m?m:0)+S,offsetX:null!=u?u:p,offsetY:null!=h?h:v})},"handler")},ew={id:"sheet.command.scroll-to-cell",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el((e,t)=>{let i=e.get(O.IUniverInstanceService);return e.get(x.IRenderManagerService).getRenderById(i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId()).with(tR).scrollToRange(t.range)},"handler")},eP=(O.CommandType.COMMAND,class extends O.Disposable{constructor(){super(...arguments),ea(this,"rangesStack",[]),ea(this,"selectedRangeWorksheet","")}});el(eP,"SelectAllService");let eM="RANGE_SELECTOR_COMPONENT_KEY";var eO=((s=eO||{}).MAIN="__SpreadsheetRender__",s.ROW="__SpreadsheetRowHeader__",s.COLUMN="__SpreadsheetColumnHeader__",s.LEFT_TOP="__SpreadsheetLeftTopPlaceholder__",s),ex=((l=ex||{}).VIEW_MAIN="viewMain",l.VIEW_MAIN_LEFT_TOP="viewMainLeftTop",l.VIEW_MAIN_TOP="viewMainTop",l.VIEW_MAIN_LEFT="viewMainLeft",l.VIEW_ROW_TOP="viewRowTop",l.VIEW_ROW_BOTTOM="viewRowBottom",l.VIEW_COLUMN_LEFT="viewColumnLeft",l.VIEW_COLUMN_RIGHT="viewColumnRight",l.VIEW_LEFT_TOP="viewLeftTop",l);let eA=(0,O.createInterceptorKey)("rangeMovePermissionCheck"),ek=(0,O.createInterceptorKey)("rangeFillPermissionCheck");var eN=((a=eN||{})[a.FORMULA_EDITOR_SHOW=100]="FORMULA_EDITOR_SHOW",a[a.MARK_SELECTION=1e4]="MARK_SELECTION",a);let eD=class{constructor(){ea(this,"_startColumn",-1),ea(this,"_startRow",-1),ea(this,"_endColumn",-1),ea(this,"_endRow",-1),ea(this,"_startX",0),ea(this,"_startY",0),ea(this,"_endX",0),ea(this,"_endY",0),ea(this,"_primary"),ea(this,"_rangeType",O.RANGE_TYPE.NORMAL)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get currentCell(){return this._primary}get rangeType(){return this._rangeType}isEqual(e){let{startColumn:t,startRow:i,endColumn:n,endRow:r}=this,{startColumn:o,startRow:s,endColumn:l,endRow:a}=e;return t===o&&i===s&&n===l&&r===a}isInclude(e){let{startColumn:t,startRow:i,endColumn:n,endRow:r}=this,{startColumn:o,startRow:s,endColumn:l,endRow:a}=e;return!(l<t||o>n||s>r||a<i)}highlightToSelection(){if(this._primary)return(0,O.makeCellToSelection)(this._primary)}getRange(){return{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY,rangeType:this.rangeType}}getCell(){return this._primary}getRangeType(){return this._rangeType}setRangeType(e){this._rangeType=e}getValue(){return{rangeWithCoord:this.getRange(),primaryWithCoord:this._primary}}setValue(e,t){let{startColumn:i,startRow:n,endColumn:r,endRow:o,startX:s,startY:l,endX:a,endY:d,rangeType:c}=e;this._startColumn=i,this._startRow=n,this._endColumn=r,this._endRow=o,this._startX=s,this._startY=l,this._endX=a,this._endY=d,void 0!==c&&(this._rangeType=c),this.setCurrentCell(t)}setCurrentCell(e){e&&(this._primary=e)}clearCurrentCell(){this._primary=null}};el(eD,"SelectionRenderModel");var eV=((d=eV||{}).Selection="__SpreadsheetSelectionShape__",d.top="__SpreadsheetSelectionTopControl__",d.bottom="__SpreadsheetSelectionBottomControl__",d.left="__SpreadsheetSelectionShapeLeftControl__",d.right="__SpreadsheetSelectionShapeRightControl__",d.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",d.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",d.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",d.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",d.fill="__SpreadsheetSelectionFillControl__",d.fillTopLeft="__SpreadsheetSelectionFillControlTopLeft__",d.fillBottomRight="__SpreadsheetSelectionFillControlBottomRight__",d.fillTopLeftInner="__SpreadsheetSelectionFillControlTopLeftInner__",d.fillBottomRightInner="__SpreadsheetSelectionFillControlBottomRightInner__",d.lineMain="__SpreadsheetDragLineMainControl__",d.lineContent="__SpreadsheetDragLineContentControl__",d.line="__SpreadsheetDragLineControl__",d.dash="__SpreadsheetDragDashControl__",d.rowHeaderBackground="__SpreadSheetSelectionRowHeaderBackground__",d.rowHeaderBorder="__SpreadSheetSelectionRowHeaderBorder__",d.rowHeaderGroup="__SpreadSheetSelectionRowHeaderGroup__",d.columnHeaderBackground="__SpreadSheetSelectionColumnHeaderBackground__",d.columnHeaderBorder="__SpreadSheetSelectionColumnHeaderBorder__",d.columnHeaderGroup="__SpreadSheetSelectionColumnHeaderGroup__",d.topLeftWidget="__SpreadSheetSelectionTopLeftWidget__",d.topCenterWidget="__SpreadSheetSelectionTopCenterWidget__",d.topRightWidget="__SpreadSheetSelectionTopRightWidget__",d.middleLeftWidget="__SpreadSheetSelectionMiddleLeftWidget__",d.middleRightWidget="__SpreadSheetSelectionMiddleRightWidget__",d.bottomLeftWidget="__SpreadSheetSelectionBottomLeftWidget__",d.bottomCenterWidget="__SpreadSheetSelectionBottomCenterWidget__",d.bottomRightWidget="__SpreadSheetSelectionBottomRightWidget__",d);let eW=class extends O.Disposable{constructor(e,t,i,n=!0,r){super(),ea(this,"_leftBorder"),ea(this,"_rightBorder"),ea(this,"_topBorder"),ea(this,"_bottomBorder"),ea(this,"_backgroundControlTop"),ea(this,"_backgroundControlBottom"),ea(this,"_backgroundControlMiddleLeft"),ea(this,"_backgroundControlMiddleRight"),ea(this,"_fillControl"),ea(this,"_selectionShapeGroup"),ea(this,"_rowHeaderBackground"),ea(this,"_rowHeaderBorder"),ea(this,"_rowHeaderGroup"),ea(this,"_columnHeaderBackground"),ea(this,"_columnHeaderBorder"),ea(this,"_columnHeaderGroup"),ea(this,"_topLeftWidget"),ea(this,"_topCenterWidget"),ea(this,"_topRightWidget"),ea(this,"_middleLeftWidget"),ea(this,"_middleRightWidget"),ea(this,"_bottomLeftWidget"),ea(this,"_bottomCenterWidget"),ea(this,"_bottomRightWidget"),ea(this,"_dashedRect"),ea(this,"_selectionModel"),ea(this,"_defaultStyle"),ea(this,"_currentStyle"),ea(this,"_rowHeaderWidth",0),ea(this,"_columnHeaderHeight",0),ea(this,"_widgetRects",[]),ea(this,"_dispose$",new k.BehaviorSubject(this)),ea(this,"dispose$",this._dispose$.asObservable()),ea(this,"selectionMoving$",new Y.Subject),ea(this,"selectionMoved$",new Y.Subject),ea(this,"selectionScaling$",new Y.Subject),ea(this,"selectionScaled$",new Y.Subject),ea(this,"selectionFilling$",new Y.Subject),ea(this,"_selectionFilled$",new Y.Subject),ea(this,"selectionFilled$",this._selectionFilled$.asObservable()),ea(this,"_isHelperSelection",!0),ea(this,"_antLineOffset",0),ea(this,"_antRequestNewFrame",-1),this._scene=e,this._zIndex=t,this._themeService=i,this._highlightHeader=n,this._rowHeaderWidth=(null==r?void 0:r.rowHeaderWidth)||0,this._columnHeaderHeight=(null==r?void 0:r.columnHeaderHeight)||0,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftBorder}get rightControl(){return this._rightBorder}get topControl(){return this._topBorder}get bottomControl(){return this._bottomBorder}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShapeGroup}get columnHeaderGroup(){return this._columnHeaderGroup}get rowHeaderGroup(){return this._rowHeaderGroup}get selectionShapeGroup(){return this._selectionShapeGroup}get model(){return this._selectionModel}get topLeftWidget(){return this._topLeftWidget}get topCenterWidget(){return this._topCenterWidget}get topRightWidget(){return this._topRightWidget}get middleLeftWidget(){return this._middleLeftWidget}get middleRightWidget(){return this._middleRightWidget}get bottomLeftWidget(){return this._bottomLeftWidget}get bottomCenterWidget(){return this._bottomCenterWidget}get bottomRightWidget(){return this._bottomRightWidget}get themeService(){return this._themeService}get selectionModel(){return this._selectionModel}set selectionModel(e){this._selectionModel=e}get defaultStyle(){return this._defaultStyle}set defaultStyle(e){this._defaultStyle=e}get dashedRect(){return this._dashedRect}get currentStyle(){return this._currentStyle}set currentStyle(e){e&&(this._currentStyle=e)}get isHelperSelection(){return this._isHelperSelection}get rowHeaderWidth(){return this._rowHeaderWidth}set rowHeaderWidth(e){this._rowHeaderWidth=e}get columnHeaderHeight(){return this._columnHeaderHeight}set columnHeaderHeight(e){this._columnHeaderHeight=e}setEvent(e){this.leftControl.evented=e,this.rightControl.evented=e,this.topControl.evented=e,this.bottomControl.evented=e}refreshSelectionFilled(e){this._selectionFilled$.next(e)}_setSizeAndStyleForSelectionControl(e){this.currentStyle=e;let t=this._defaultStyle,i=this.currentStyle,{stroke:n=t.stroke,widgets:r=t.widgets,hasAutoFill:o=t.hasAutoFill,AutofillStroke:s=t.AutofillStroke,strokeDash:l,isAnimationDash:a}=i,{strokeWidth:d=t.strokeWidth,AutofillSize:c=t.AutofillSize,AutofillStrokeWidth:u=t.AutofillStrokeWidth}=i,h=this._getScale(),m=(d+A.SELECTION_CONTROL_BORDER_BUFFER_WIDTH)/2/h;d/=h,c/=h,u/=h<1?1:h;let g=A.SELECTION_CONTROL_BORDER_BUFFER_WIDTH/h,p=x.FIX_ONE_PIXEL_BLUR_OFFSET/h,{startX:v,startY:S,endX:f,endY:C}=this._selectionModel;if(this.leftControl.transformByState({height:C-S,left:-m+p,width:d,strokeWidth:g,top:-g/2+p}),this.leftControl.setProps({fill:n,stroke:A.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),this.rightControl.transformByState({height:C-S,left:f-v-m+p,width:d,strokeWidth:g,top:-g/2+p}),this.rightControl.setProps({fill:n,stroke:A.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),this.topControl.transformByState({width:f-v+d,top:-m+p,left:-m+p,height:d,strokeWidth:g}),this.topControl.setProps({fill:n,stroke:A.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),this.bottomControl.transformByState({width:f-v+d,top:C-S-m+p,height:d,left:-m+p,strokeWidth:g}),this.bottomControl.setProps({fill:n,stroke:A.SELECTION_CONTROL_BORDER_BUFFER_COLOR}),null==l)this.dashedRect.hide(),this._stopAntLineAnimation();else{let e=2*i.strokeWidth/h;this.dashedRect.transformByState({height:C-S,width:f-v,strokeWidth:e,left:-e/2+p,top:-e/2+p}),this.dashedRect.setProps({strokeDashArray:[0,l/h]}),this._stopAntLineAnimation(),!1!==a&&this._startAntLineAnimation(),this.dashedRect.show()}if(!0!==o||this._hasWidgets(r))this.fillControl.hide();else{let e={width:c-u,height:c-u,left:f-v-c/2+u/2-p,top:C-S-c/2+u/2-p,strokeWidth:u};this.fillControl.setProps({fill:n,stroke:s,strokeScaleEnabled:!1}),this.fillControl.transformByState(e),this.fillControl.show()}this._updateBackgroundControl(e),this._updateHeaderBackground(e),this._updateWidgets(e)}_refreshControlPosition(){let{startX:e,startY:t}=this._selectionModel;this.selectionShapeGroup.show(),this.selectionShapeGroup.translate(e,t),this.selectionShapeGroup.makeDirtyNoDebounce(!0)}updateStyle(e){this._setSizeAndStyleForSelectionControl(e),this._refreshControlPosition()}updateRange(e,t){this._selectionModel.setValue(e,t),this._setSizeAndStyleForSelectionControl(this._currentStyle),this._refreshControlPosition()}update(e,t=0,i=0,n,r){this._selectionModel.setValue(e,r),this._rowHeaderWidth=t,this._columnHeaderHeight=i,this._setSizeAndStyleForSelectionControl(n||this._currentStyle),this._refreshControlPosition()}updateCurrCell(e){this._selectionModel.setCurrentCell(e)}clearHighlight(){this._selectionModel.clearCurrentCell(),this._setSizeAndStyleForSelectionControl(this._currentStyle)}getScene(){return this._scene}dispose(){var e,t,i,n,r,o,s,l,a,d,c,u,h,m,g,p,v,S,f,C,I,b,_,R;null==(e=this._leftBorder)||e.dispose(),null==(t=this._rightBorder)||t.dispose(),null==(i=this._topBorder)||i.dispose(),null==(n=this._bottomBorder)||n.dispose(),null==(r=this._backgroundControlTop)||r.dispose(),null==(o=this._backgroundControlMiddleLeft)||o.dispose(),null==(s=this._backgroundControlMiddleRight)||s.dispose(),null==(l=this._backgroundControlBottom)||l.dispose(),this._fillControl.dispose(),null==(a=this._selectionShapeGroup)||a.dispose(),null==(d=this._rowHeaderBackground)||d.dispose(),null==(c=this._rowHeaderBorder)||c.dispose(),null==(u=this._rowHeaderGroup)||u.dispose(),null==(h=this._rowHeaderBackground)||h.dispose(),null==(m=this._columnHeaderBackground)||m.dispose(),null==(g=this._columnHeaderBorder)||g.dispose(),null==(p=this._columnHeaderGroup)||p.dispose(),null==(v=this._topLeftWidget)||v.dispose(),null==(S=this._topCenterWidget)||S.dispose(),null==(f=this._topRightWidget)||f.dispose(),null==(C=this._middleLeftWidget)||C.dispose(),null==(I=this._middleRightWidget)||I.dispose(),null==(b=this._bottomLeftWidget)||b.dispose(),null==(_=this._bottomCenterWidget)||_.dispose(),null==(R=this._bottomRightWidget)||R.dispose(),super.dispose(),this._dispose$.next(this),this._dispose$.complete()}getCurrentCellInfo(){let e=this.model.currentCell;if(e){let t;if(e.isMerged){let i=e.mergeInfo;t={startRow:i.startRow,endRow:i.endRow,startColumn:i.startColumn,endColumn:i.endColumn,startX:i.startX,endX:i.endX,startY:i.startY,endY:i.endY}}else{let{actualRow:i,actualColumn:n,startX:r,endX:o,startY:s,endY:l}=e;t={startRow:i,endRow:i,startColumn:n,endColumn:n,startX:r,endX:o,startY:s,endY:l}}return t}}getValue(){return{...this._selectionModel.getValue(),style:this._currentStyle}}getRange(){return this._selectionModel.getValue().rangeWithCoord}enableHelperSelection(){this._isHelperSelection=!0}disableHelperSelection(){this._isHelperSelection=!1}_initialize(){this._defaultStyle=(0,A.getNormalSelectionStyle)(this._themeService),this._currentStyle=(0,A.getNormalSelectionStyle)(this._themeService),this._selectionModel=new eD;let e=this._zIndex;this._leftBorder=new x.Rect("__SpreadsheetSelectionShapeLeftControl__"+e,{zIndex:e}),this._rightBorder=new x.Rect("__SpreadsheetSelectionShapeRightControl__"+e,{zIndex:e}),this._topBorder=new x.Rect("__SpreadsheetSelectionTopControl__"+e,{zIndex:e}),this._bottomBorder=new x.Rect("__SpreadsheetSelectionBottomControl__"+e,{zIndex:e}),this._backgroundControlTop=new x.Rect("__SpreadsheetSelectionBackgroundControlTop__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlBottom=new x.Rect("__SpreadsheetSelectionBackgroundControlBottom__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new x.Rect("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new x.Rect("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{zIndex:e-1,evented:!1}),this._fillControl=new x.Rect("__SpreadsheetSelectionFillControl__"+e,{zIndex:e+1}),this._dashedRect=new x.DashedRect("__SpreadsheetDragDashControl__"+e,{zIndex:e+2,evented:!1,stroke:"#fff"});let t=[this._fillControl,this._leftBorder,this._rightBorder,this._topBorder,this._bottomBorder,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom,this._dashedRect];this._widgetRects=this._initialWidget(),this._selectionShapeGroup=new x.Group("__SpreadsheetSelectionShape__"+e,...t,...this._widgetRects),this._selectionShapeGroup.hide(),this._selectionShapeGroup.evented=!1,this._selectionShapeGroup.zIndex=e;let i=this.getScene();i.addObject(this._selectionShapeGroup,1),this.disposeWithMe((0,O.toDisposable)(i.onTransformChange$.subscribeEvent(e=>{e.type===x.TRANSFORM_CHANGE_OBSERVABLE_TYPE.scale&&(this._setSizeAndStyleForSelectionControl(this._currentStyle),this._refreshControlPosition())}))),this._initialHeader()}_initialHeader(){let e=this._zIndex;this._rowHeaderBackground=new x.Rect("__SpreadSheetSelectionRowHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderBorder=new x.Rect("__SpreadSheetSelectionRowHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._rowHeaderGroup=new x.Group("__SpreadSheetSelectionRowHeaderGroup__"+e,this._rowHeaderBackground,this._rowHeaderBorder),this._rowHeaderGroup.hide(),this._rowHeaderGroup.evented=!1,this._rowHeaderGroup.zIndex=e,this._columnHeaderBackground=new x.Rect("__SpreadSheetSelectionColumnHeaderBackground__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderBorder=new x.Rect("__SpreadSheetSelectionColumnHeaderBorder__"+e,{zIndex:e-1,evented:!1}),this._columnHeaderGroup=new x.Group("__SpreadSheetSelectionColumnHeaderGroup__"+e,this._columnHeaderBackground,this._columnHeaderBorder),this._columnHeaderGroup.hide(),this._columnHeaderGroup.evented=!1,this._columnHeaderGroup.zIndex=e,this.getScene().addObjects([this._rowHeaderGroup,this._columnHeaderGroup],11)}_initialWidget(){let e=this._zIndex;return this._topLeftWidget=new x.Rect("__SpreadSheetSelectionTopLeftWidget__"+e,{zIndex:e+1}),this._topCenterWidget=new x.Rect("__SpreadSheetSelectionTopCenterWidget__"+e,{zIndex:e+1}),this._topRightWidget=new x.Rect("__SpreadSheetSelectionTopRightWidget__"+e,{zIndex:e+1}),this._middleLeftWidget=new x.Rect("__SpreadSheetSelectionMiddleLeftWidget__"+e,{zIndex:e+1}),this._middleRightWidget=new x.Rect("__SpreadSheetSelectionMiddleRightWidget__"+e,{zIndex:e+1}),this._bottomLeftWidget=new x.Rect("__SpreadSheetSelectionBottomLeftWidget__"+e,{zIndex:e+1}),this._bottomCenterWidget=new x.Rect("__SpreadSheetSelectionBottomCenterWidget__"+e,{zIndex:e+1}),this._bottomRightWidget=new x.Rect("__SpreadSheetSelectionBottomRightWidget__"+e,{zIndex:e+1}),[this._topLeftWidget,this._topCenterWidget,this._topRightWidget,this._middleLeftWidget,this._middleRightWidget,this._bottomLeftWidget,this._bottomCenterWidget,this._bottomRightWidget]}_updateHeaderBackground(e){let{startX:t,startY:i,endX:n,endY:r,rangeType:o}=this._selectionModel,s=this._defaultStyle;null==e&&(e=s);let l=this._getScale(),{stroke:a,hasRowHeader:d,rowHeaderFill:c=s.rowHeaderFill,rowHeaderStroke:u=s.rowHeaderStroke,hasColumnHeader:h,columnHeaderFill:m=s.columnHeaderFill,columnHeaderStroke:g=s.columnHeaderStroke}=e,{rowHeaderStrokeWidth:p=s.rowHeaderStrokeWidth,columnHeaderStrokeWidth:v=s.columnHeaderStrokeWidth}=e;p/=l,v/=l;let S=this._rowHeaderWidth,f=this._columnHeaderHeight;if(!0===h){let e=m;this._highlightHeader&&o===O.RANGE_TYPE.COLUMN&&(e=new(0,O.ColorKit)(a).setAlpha(.3).toString()),this._columnHeaderBackground.setProps({fill:e}),this._columnHeaderBackground.resize(n-t,f),this._columnHeaderBorder.setProps({fill:g}),this._columnHeaderBorder.transformByState({width:n-t,height:v,top:f-v+1/l}),this._columnHeaderGroup.show(),this._columnHeaderGroup.translate(t,0)}else this._columnHeaderGroup.hide();if(this._columnHeaderGroup.makeDirty(!0),!0===d){let e=c;this._highlightHeader&&o===O.RANGE_TYPE.ROW&&(e=new(0,O.ColorKit)(a).setAlpha(.3).toString()),this._rowHeaderBackground.setProps({fill:e}),this._rowHeaderBackground.resize(S,r-i),this._rowHeaderBorder.setProps({fill:u}),this._rowHeaderBorder.transformByState({width:p,height:r-i,left:S-p+1/l}),this._rowHeaderGroup.show(),this._rowHeaderGroup.translate(0,i)}else this._rowHeaderGroup.hide();this._rowHeaderGroup.makeDirty(!0)}_updateBackgroundControl(e){let{startX:t,startY:i,endX:n,endY:r}=this._selectionModel,o=this._defaultStyle;null==e&&(e=o);let s=this._getScale(),{fill:l=o.fill}=e,{strokeWidth:a=o.strokeWidth}=e;a/=s;let d=this._selectionModel.highlightToSelection();if(!d){this._backgroundControlTop.resize(n-t,r-i),this._backgroundControlTop.setProps({fill:l}),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}let{startX:c,startY:u,endX:h,endY:m}=d,g=a/2,p={left:-g,top:-g,width:n-t+2*g,height:u-i+g};p.height<0&&(p.width=0,p.height=0),this._backgroundControlTop.transformByState(p);let v={left:-g,top:u-i,width:c-t+g,height:m-u};v.width<0&&(v.width=0,v.height=0),this._backgroundControlMiddleLeft.transformByState(v);let S={left:h-t-g,top:u-i,width:n-h+2*g,height:m-u};S.width<0&&(S.width=0,S.height=0),this._backgroundControlMiddleRight.transformByState(S);let f={left:-g,top:m-i,width:n-t+2*g,height:r-m+g};f.height<0&&(f.width=0,f.height=0),this._backgroundControlBottom.transformByState(f),this._backgroundControlTop.setProps({fill:l}),this._backgroundControlMiddleLeft.setProps({fill:l}),this._backgroundControlMiddleRight.setProps({fill:l}),this._backgroundControlBottom.setProps({fill:l})}_updateWidgets(e){let{startX:t,startY:i,endX:n,endY:r}=this._selectionModel,o=this._defaultStyle;null==e&&(e=o);let{stroke:s=o.stroke,widgets:l=o.widgets,widgetStroke:a=o.widgetStroke}=e,d=this._getScale(),{widgetSize:c=o.widgetSize,widgetStrokeWidth:u=o.widgetStrokeWidth}=e,h={left:-(c/=d)/2+(u/=d)/2,center:(n-t)/2-c/2+u/2,right:n-t-c/2+u/2,top:-c/2,middle:(r-i)/2-c/2,bottom:r-i-c/2+u/2},m=c-u;this._widgetRects.forEach(e=>{e.setProps({fill:s,stroke:a})}),!0===l.tl?(this._topLeftWidget.transformByState({height:m,width:m,left:h.left,top:h.top,strokeWidth:u}),this._topLeftWidget.show()):this._topLeftWidget.hide(),!0===l.tc?(this._topCenterWidget.transformByState({height:m,width:m,left:h.center,top:h.top,strokeWidth:u}),this._topCenterWidget.show()):this._topCenterWidget.hide(),!0===l.tr?(this._topRightWidget.transformByState({height:m,width:m,left:h.right,top:h.top,strokeWidth:u}),this._topRightWidget.show()):this._topRightWidget.hide(),!0===l.ml?(this._middleLeftWidget.transformByState({height:m,width:m,left:h.left,top:h.middle,strokeWidth:u}),this._middleLeftWidget.show()):this._middleLeftWidget.hide(),!0===l.mr?(this._middleRightWidget.transformByState({height:m,width:m,left:h.right,top:h.middle,strokeWidth:u}),this._middleRightWidget.show()):this._middleRightWidget.hide(),!0===l.bl?(this._bottomLeftWidget.transformByState({height:m,width:m,left:h.left,top:h.bottom,strokeWidth:u}),this._bottomLeftWidget.show()):this._bottomLeftWidget.hide(),!0===l.bc?(this._bottomCenterWidget.transformByState({height:m,width:m,left:h.center,top:h.bottom,strokeWidth:u}),this._bottomCenterWidget.show()):this._bottomCenterWidget.hide(),!0===l.br?(this._bottomRightWidget.transformByState({height:m,width:m,left:h.right,top:h.bottom,strokeWidth:u}),this._bottomRightWidget.show()):this._bottomRightWidget.hide()}_hasWidgets(e){if(null==e)return!1;let t=Object.keys(e);if(0===t.length)return!1;for(let i of t)if(!0===e[i])break;return!0}_getScale(){let{scaleX:e,scaleY:t}=this._scene.getAncestorScale();return Math.max(e,t)}_stopAntLineAnimation(){this._antLineOffset=0,(0,x.cancelRequestFrame)(this._antRequestNewFrame)}_startAntLineAnimation(){let e=this._getScale();this._antLineOffset+=.6/e,this._antLineOffset>160/e&&(this._antLineOffset=0),this.dashedRect.setProps({strokeDashOffset:-this._antLineOffset}),this._antRequestNewFrame=(0,x.requestNewFrame)(()=>{this._startAntLineAnimation()})}};el(eW,"SelectionControl");let eH=eW,eU=class extends x.Layer{render(e,t=!1){let i=(0,O.Tools).now();return super.render(e,t),this._afterRender(i),this}_afterRender(e){this.scene.getEngine().renderFrameTimeMetric$.next(["selectionLayer",(0,O.Tools).now()-e])}};el(eU,"SelectionLayer");let eL="__SpreadsheetHelperSelectionTempRect",eB=class{constructor(e,t,i,n,r,o){ea(this,"_startOffsetX",0),ea(this,"_startOffsetY",0),ea(this,"_relativeSelectionPositionRow",0),ea(this,"_relativeSelectionPositionColumn",0),ea(this,"_relativeSelectionRowLength",0),ea(this,"_relativeSelectionColumnLength",0),ea(this,"_scenePointerMoveSub"),ea(this,"_scenePointerUpSub"),ea(this,"_helperSelection"),ea(this,"_scrollTimer"),ea(this,"_activeViewport"),ea(this,"_targetSelection",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),ea(this,"_isInMergeState",!1),ea(this,"_fillControlColors",[]),this._control=e,this._skeleton=t,this._scene=i,this._themeService=n,this._injector=r,this._selectionHooks=o,this._initialControl(),this._initialWidget(),this._initialFill(),this._control.dispose$.subscribe(()=>{this.dispose()})}get isHelperSelection(){return this._control.isHelperSelection}dispose(){var e,t;null==(e=this._scrollTimer)||e.dispose(),this._fillControlColors=[],this._clearObserverEvent(),null==(t=this._helperSelection)||t.dispose()}_getFreeze(){var e,t;return null==(t=null==(e=this._injector.get(x.IRenderManagerService).withCurrentTypeOfUnit(O.UniverInstanceType.UNIVER_SHEET,ev))?void 0:e.getCurrent())?void 0:t.skeleton.getWorksheetConfig().freeze}_isSelectionInViewport(e,t){let i=this._getFreeze()||{startRow:-1,startColumn:-1,xSplit:0,ySplit:0};switch(t.viewportKey){case x.SHEET_VIEWPORT_KEY.VIEW_MAIN:return e.endRow>=i.startRow&&e.endColumn>=i.startColumn;case x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP:case x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT:return e.endColumn>=i.startColumn&&e.startRow<i.startRow;case x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT:case x.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM:return e.endRow>=i.startRow&&e.startColumn<i.startColumn;case x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP:case x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT:case x.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP:case x.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP:return e.startRow<i.startRow&&e.startColumn<i.startColumn}}_clearObserverEvent(){var e,t;null==(e=this._scenePointerMoveSub)||e.unsubscribe(),null==(t=this._scenePointerUpSub)||t.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null}_initialControl(){let{leftControl:e,rightControl:t,topControl:i,bottomControl:n}=this._control;[e,t,i,n].forEach(e=>{e.onPointerEnter$.subscribeEvent(()=>{var t;(null==(t=this._injector.get(ez,O.Quantity.OPTIONAL))?void 0:t.interceptor.fetchThroughInterceptors(eA)(!1,null))!==!1&&e.setCursor(x.CURSOR_TYPE.MOVE)}),e.onPointerLeave$.subscribeEvent(()=>{e.resetCursor()}),e.onPointerDown$.subscribeEvent(this._controlEvent.bind(this))})}_controlMoving(e,t){var i;let n=this._scene,r=n.getVpScrollXYInfoByPosToVp((0,x.Vector2).FromArray([e,t])),{scaleX:o,scaleY:s}=n.getAncestorScale(),{row:l,column:a}=this._skeleton.getCellPositionByOffset(e,t,o,s,r),d=this._skeleton.getRowCount()-1,c=this._skeleton.getColumnCount()-1,u=l+this._relativeSelectionPositionRow;u<0&&(u=0);let h=u+this._relativeSelectionRowLength;h>d&&(h=d)-u<this._relativeSelectionRowLength&&(u=h-this._relativeSelectionRowLength);let m=a+this._relativeSelectionPositionColumn;m<0&&(m=0);let g=m+this._relativeSelectionColumnLength;g>c&&(g=c)-m<this._relativeSelectionColumnLength&&(m=g-this._relativeSelectionColumnLength);let p=this._skeleton.getNoMergeCellPositionByIndex(u,m),v=this._skeleton.getNoMergeCellPositionByIndex(h,g),S=(null==p?void 0:p.startY)||0,f=(null==v?void 0:v.endY)||0,C=(null==p?void 0:p.startX)||0,I=(null==v?void 0:v.endX)||0;null==(i=this._helperSelection)||i.transformByState({left:C,top:S,width:I-C,height:f-S}),this._targetSelection={startY:S,endY:f,startX:C,endX:I,startRow:u,endRow:h,startColumn:m,endColumn:g},this._control.selectionMoving$.next(this._targetSelection)}_controlEvent(e){let{offsetX:t,offsetY:i}=e,n=this._scene,r=n.getRelativeToViewportCoord((0,x.Vector2).FromArray([t,i])),{x:o,y:s}=r,l=n.getVpScrollXYInfoByPosToVp(r),{scaleX:a,scaleY:d}=n.getAncestorScale(),c=this._skeleton.getCellPositionByOffset(o,s,a,d,l);this._startOffsetX=o,this._startOffsetY=s;let{row:u,column:h}=c,{startRow:m,startColumn:g,endRow:p,endColumn:v}=this._control.model,S=0,f=0;u<m?S-=1:u>p&&(S+=1),h<g?f-=1:h>v&&(f+=1),this._relativeSelectionPositionRow=m-u+S,this._relativeSelectionPositionColumn=g-h+f,this._relativeSelectionRowLength=p-m,this._relativeSelectionColumnLength=v-g;let C=this._control.currentStyle,I=this._getScale();this.isHelperSelection&&(this._helperSelection=new x.Rect(eL,{stroke:C.stroke,strokeWidth:C.strokeWidth/I}),n.addObject(this._helperSelection));let b=n.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),_=(0,x.ScrollTimer).create(n);this._scrollTimer=_,_.startScroll(o,s,b),n.disableObjectsEvent(),this._scenePointerMoveSub=n.onPointerMove$.subscribeEvent(e=>{var t;let{offsetX:i,offsetY:r}=e;if((null==(t=this._injector.get(ez,O.Quantity.OPTIONAL))?void 0:t.interceptor.fetchThroughInterceptors(eA)(!1,null))===!1)return;let{x:o,y:s}=n.getRelativeToViewportCoord((0,x.Vector2).FromArray([i,r]));this._controlMoving(o,s),n.setCursor(x.CURSOR_TYPE.MOVE),_.scrolling(o,s,()=>{this._controlMoving(o,s)})}),this._scenePointerUpSub=n.onPointerUp$.subscribeEvent(()=>{var e,t,i,n;null==(e=this._helperSelection)||e.dispose();let r=this._scene;r.resetCursor(),this._clearObserverEvent(),r.enableObjectsEvent(),null==(t=this._scrollTimer)||t.dispose(),this._control.selectionMoved$.next(this._targetSelection),null==(n=(i=this._selectionHooks).selectionMoveEnd)||n.call(i)})}_initialWidget(){let{topLeftWidget:e,topCenterWidget:t,topRightWidget:i,middleLeftWidget:n,middleRightWidget:r,bottomLeftWidget:o,bottomCenterWidget:s,bottomRightWidget:l}=this._control,a=[x.CURSOR_TYPE.NORTH_WEST_RESIZE,x.CURSOR_TYPE.NORTH_RESIZE,x.CURSOR_TYPE.NORTH_EAST_RESIZE,x.CURSOR_TYPE.WEST_RESIZE,x.CURSOR_TYPE.EAST_RESIZE,x.CURSOR_TYPE.SOUTH_WEST_RESIZE,x.CURSOR_TYPE.SOUTH_RESIZE,x.CURSOR_TYPE.SOUTH_EAST_RESIZE];[e,t,i,n,r,o,s,l].forEach((e,t)=>{e.onPointerEnter$.subscribeEvent(()=>{e.setCursor(a[t])}),e.onPointerLeave$.subscribeEvent(()=>{e.resetCursor()}),e.onPointerDown$.subscribeEvent(e=>{this._widgetPointerDownEvent(e,a[t])})})}_widgetPointerDownEvent(e,t){let i=this._scene,{offsetX:n,offsetY:r}=e,{x:o,y:s}=i.getRelativeToViewportCoord((0,x.Vector2).FromArray([n,r]));this._startOffsetX=n,this._startOffsetY=r;let{startRow:l,startColumn:a,endRow:d,endColumn:c}=this._control.model,u=Math.min(l,d),h=Math.min(a,c),m=Math.max(l,d),g=Math.max(a,c);this._relativeSelectionPositionRow=u,this._relativeSelectionPositionColumn=h,this._relativeSelectionRowLength=m-u,this._relativeSelectionColumnLength=g-h,t===x.CURSOR_TYPE.NORTH_WEST_RESIZE?(this._relativeSelectionPositionRow=m,this._relativeSelectionPositionColumn=g):t===x.CURSOR_TYPE.NORTH_RESIZE?this._relativeSelectionPositionRow=m:t===x.CURSOR_TYPE.NORTH_EAST_RESIZE?this._relativeSelectionPositionRow=m:t===x.CURSOR_TYPE.WEST_RESIZE?this._relativeSelectionPositionColumn=g:t===x.CURSOR_TYPE.SOUTH_WEST_RESIZE?this._relativeSelectionPositionColumn=g:t===x.CURSOR_TYPE.SOUTH_RESIZE&&(this._relativeSelectionPositionRow=u);let p=(0,x.ScrollTimer).create(i);p.startScroll(o,s),this._scrollTimer=p,i.disableObjectsEvent(),this._scenePointerMoveSub=i.onPointerMove$.subscribeEvent(e=>{let{offsetX:n,offsetY:r}=e,{x:o,y:s}=i.getRelativeToViewportCoord((0,x.Vector2).FromArray([n,r]));this._widgetMoving(o,s,t),i.setCursor(t),p.scrolling(o,s,()=>{this._widgetMoving(o,s,t)})}),this._scenePointerUpSub=i.onPointerUp$.subscribeEvent(()=>{var e,t,i;let n=this._scene;n.resetCursor(),this._clearObserverEvent(),n.enableObjectsEvent(),null==(e=this._scrollTimer)||e.dispose(),this._control.selectionScaled$.next(this._targetSelection),null==(i=(t=this._selectionHooks).selectionMoveEnd)||i.call(t)})}_widgetMoving(e,t,i){let n=this._scene,r=n.getVpScrollXYInfoByPosToVp((0,x.Vector2).FromArray([this._startOffsetX,this._startOffsetY])),{scaleX:o,scaleY:s}=n.getAncestorScale(),{row:l,column:a}=this._skeleton.getCellPositionByOffset(e,t,o,s,r),{rowHeaderWidth:d,columnHeaderHeight:c}=this._skeleton,u=this._relativeSelectionPositionRow,h=this._relativeSelectionPositionColumn,m=l,g=a;i===x.CURSOR_TYPE.NORTH_WEST_RESIZE?(u=l,h=a,m=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn):i===x.CURSOR_TYPE.NORTH_RESIZE?(u=l,h=this._relativeSelectionPositionColumn,m=this._relativeSelectionPositionRow,g=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength):i===x.CURSOR_TYPE.NORTH_EAST_RESIZE?(u=l,h=this._relativeSelectionPositionColumn,m=this._relativeSelectionPositionRow,g=a):i===x.CURSOR_TYPE.WEST_RESIZE?(u=this._relativeSelectionPositionRow,h=a,m=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,g=this._relativeSelectionPositionColumn):i===x.CURSOR_TYPE.EAST_RESIZE?m=this._relativeSelectionPositionRow+this._relativeSelectionRowLength:i===x.CURSOR_TYPE.SOUTH_WEST_RESIZE?(u=this._relativeSelectionPositionRow,h=a,m=l,g=this._relativeSelectionPositionColumn):i===x.CURSOR_TYPE.SOUTH_RESIZE&&(u=this._relativeSelectionPositionRow,h=this._relativeSelectionPositionColumn,m=l,g=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength);let{startRow:p,startColumn:v,endRow:S,endColumn:f}=this._swapPositions(u,h,m,g),C=this._skeleton.getNoMergeCellPositionByIndex(p,v),I=this._skeleton.getNoMergeCellPositionByIndex(S,f),b=(null==C?void 0:C.startY)||0,_=(null==I?void 0:I.endY)||0,R=(null==C?void 0:C.startX)||0,y=(null==I?void 0:I.endX)||0;this._targetSelection={startY:b,endY:_,startX:R,endX:y,startRow:u,endRow:m,startColumn:h,endColumn:g},this._control.update(this._targetSelection,d,c,this._control.currentStyle),this._control.clearHighlight(),this._control.selectionScaling$.next(this._targetSelection)}_initialFill(){let{fillControl:e}=this._control;e.onPointerEnter$.subscribeEvent(t=>{this._injector.get(ez).interceptor.fetchThroughInterceptors(ek)(!1,{x:t.offsetX,y:t.offsetY,skeleton:this._skeleton,scene:this._scene})&&e.setCursor(x.CURSOR_TYPE.CROSSHAIR)}),e.onPointerLeave$.subscribeEvent(()=>{e.resetCursor()}),e.onPointerDown$.subscribeEvent(this._fillEvent.bind(this))}_fillMoving(e,t){var i,n,r;let o=this._scene,s=o.getViewportScrollXY(this._activeViewport),{scaleX:l,scaleY:a}=o.getAncestorScale(),{row:d,column:c}=this._skeleton.getCellPositionByOffset(e,t,l,a,s),u=o.getRelativeToViewportCoord((0,x.Vector2).FromArray([e,t])),h=this._skeleton.getRowCount()-1,m=this._skeleton.getColumnCount()-1,g=this._relativeSelectionPositionRow,p=this._relativeSelectionPositionColumn,v=this._relativeSelectionPositionRow+this._relativeSelectionRowLength,S=this._relativeSelectionPositionColumn+this._relativeSelectionColumnLength,f=!1,C=!0;if((c<p||c>S)&&d>=g&&d<=v){let e=this._fillRuler(c,p,S,this._relativeSelectionColumnLength,m);p=e.startRowOrColumn,S=e.endRowOrColumn,f=e.isLighten,C=!1}else if((d<g||d>v)&&c>=p&&c<=S){let e=this._fillRuler(d,g,v,this._relativeSelectionRowLength,h);g=e.startRowOrColumn,v=e.endRowOrColumn,f=e.isLighten}else if(Math.abs(this._startOffsetX-u.x-s.x)/2>Math.abs(this._startOffsetY-u.y-s.y)){let e=this._fillRuler(c,p,S,this._relativeSelectionColumnLength,m);p=e.startRowOrColumn,S=e.endRowOrColumn,f=e.isLighten,C=!1}else{let e=this._fillRuler(d,g,v,this._relativeSelectionRowLength,h);g=e.startRowOrColumn,v=e.endRowOrColumn,f=e.isLighten}let I=this._skeleton.getNoMergeCellPositionByIndex(g,p),b=this._skeleton.getNoMergeCellPositionByIndex(v,S),_=(null==I?void 0:I.startY)||0,R=(null==b?void 0:b.endY)||0,y=(null==I?void 0:I.startX)||0,T=(null==b?void 0:b.endX)||0;f?this._controlHandler((e,t)=>{let i=new(0,O.ColorKit)(this._fillControlColors[t]).lighten(35).toRgbString();e.setProps({fill:i})}):this._controlHandler((e,t)=>{e.setProps({fill:this._fillControlColors[t]})});let E=A.SELECTION_CONTROL_BORDER_BUFFER_WIDTH/this._getScale();g===v&&!0===C||p===S&&!1===C?null==(i=this._helperSelection)||i.hide():(null==(n=this._helperSelection)||n.transformByState({left:y-E/2,top:_-E/2,width:T-y,height:R-_}),null==(r=this._helperSelection)||r.show()),this._targetSelection={startY:_,endY:R,startX:y,endX:T,startRow:g,endRow:v,startColumn:p,endColumn:S},this._control.selectionFilling$.next(this._targetSelection)}_fillEvent(e){let{offsetX:t,offsetY:i}=e,n=this._scene,{x:r,y:o}=n.getRelativeToViewportCoord((0,x.Vector2).FromArray([t,i]));this._startOffsetX=r,this._startOffsetY=o;let{startRow:s,startColumn:l,endRow:a,endColumn:d}=this._control.model;this._isInMergeState=this._hasMergeInRange(s,l,a,d),this._relativeSelectionPositionRow=s,this._relativeSelectionPositionColumn=l,this._relativeSelectionRowLength=a-s,this._relativeSelectionColumnLength=d-l;let c=this._control.currentStyle,u=null==c?void 0:c.stroke,h=null==c?void 0:c.strokeWidth,m=(0,A.getNormalSelectionStyle)(this._themeService);null==u&&(u=m.stroke),null==h&&(h=m.strokeWidth);let g=this._getScale();h/=g;let p=A.SELECTION_CONTROL_BORDER_BUFFER_WIDTH/g,v=new(0,O.ColorKit)(u).darken(2).toRgbString();this.isHelperSelection&&(this._helperSelection=new x.Rect(eL,{stroke:v,strokeWidth:h+p/2}),n.addObject(this._helperSelection)),this._activeViewport=n.getActiveViewportByCoord((0,x.Vector2).FromArray([t,i]));let S=n.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),f=(0,x.ScrollTimer).create(n,this._activeViewport.viewportKey===x.SHEET_VIEWPORT_KEY.VIEW_MAIN?x.ScrollTimerType.ALL:x.ScrollTimerType.NONE);f.startScroll(r,o,S),this._scrollTimer=f,n.disableObjectsEvent(),this._controlHandler(e=>{this._fillControlColors.push(e.fill)}),this._scenePointerMoveSub=n.onPointerMove$.subscribeEvent(t=>{var i;let{offsetX:r,offsetY:o}=t,d=n.getActiveViewportByCoord((0,x.Vector2).FromArray([r,o]));if(!this._injector.get(ez).interceptor.fetchThroughInterceptors(ek)(!1,{x:e.offsetX,y:e.offsetY,skeleton:this._skeleton,scene:this._scene}))return;let{x:c,y:u}=n.getRelativeToViewportCoord((0,x.Vector2).FromArray([r,o]));this._fillMoving(c,u),n.setCursor(x.CURSOR_TYPE.CROSSHAIR);let h=this._targetSelection;if(S&&d&&(null==(i=this._activeViewport)?void 0:i.viewportKey)!==(null==d?void 0:d.viewportKey)){let e;h.startRow!==s?(f.scrollTimerType=x.ScrollTimerType.Y,e={...h,endRow:h.startRow}):h.endRow!==a?(f.scrollTimerType=x.ScrollTimerType.Y,e={...h,startRow:h.endRow}):h.startColumn!==l?(f.scrollTimerType=x.ScrollTimerType.X,e={...h,endColumn:h.startColumn}):(f.scrollTimerType=x.ScrollTimerType.X,e={...h,startColumn:h.endColumn}),this._isSelectionInViewport(e,d)&&(S.scrollToBarPos({x:f.scrollTimerType===x.ScrollTimerType.X?0:void 0,y:f.scrollTimerType===x.ScrollTimerType.Y?0:void 0}),this._activeViewport=d)}f.scrolling(c,u,()=>{this._fillMoving(c,u)})}),this._scenePointerUpSub=n.onPointerUp$.subscribeEvent(()=>{var e,t;null==(e=this._helperSelection)||e.dispose();let i=this._scene;i.resetCursor(),this._clearObserverEvent(),i.enableObjectsEvent(),null==(t=this._scrollTimer)||t.dispose(),this._control.refreshSelectionFilled(this._targetSelection),this._isInMergeState=!1,this._controlHandler((e,t)=>{e.setProps({fill:this._fillControlColors[t]})}),this._fillControlColors=[]})}_hasMergeInRange(e,t,i,n){return this._skeleton.worksheet.getMergedCellRange(e,t,i,n).length>0}_swapPositions(e,t,i,n){return{startRow:Math.min(e,i),startColumn:Math.min(t,n),endRow:Math.max(e,i),endColumn:Math.max(t,n)}}_controlHandler(e){let{leftControl:t,rightControl:i,topControl:n,bottomControl:r,backgroundControlTop:o,backgroundControlMiddleLeft:s,backgroundControlMiddleRight:l,backgroundControlBottom:a,fillControl:d}=this._control,c=[t,i,n,r,o,s,l,a,d];for(let t=0,i=c.length;t<i;t++)e(c[t],t)}_fillRuler(e,t,i,n,r){let o=!1;if(e<t){if(this._isInMergeState&&e<t){let i=n+1,r=Math.ceil((t-e)/i),o=t-r*i;o<0&&(o=t-(r-1)*i),t=o}else t=e}else if(e>=t&&e<=i)o=!0,this._isInMergeState||(i=e);else if(this._isInMergeState&&e>i){let t=n+1,o=Math.ceil((e-i)/t),s=i+o*t;s>r&&(s=i+(o-1)*t),i=s}else i=e;return{rowOrColumn:e,startRowOrColumn:t,endRowOrColumn:i,isLighten:o}}_getScale(){let{scaleX:e,scaleY:t}=this._scene.getAncestorScale();return Math.max(e,t)}};function eF(e,t){let{range:i,primary:n,style:r}=e;return{rangeWithCoord:eS(t,i),primaryWithCoord:n?ej(n,t):null,style:r}}function ej(e,t){let{actualRow:i,actualColumn:n,isMerged:r,isMergedMainCell:o,startRow:s,startColumn:l,endRow:a,endColumn:d}=e,c=t.getNoMergeCellPositionByIndex(i,n),u=t.getNoMergeCellPositionByIndex(s,l),h=t.getNoMergeCellPositionByIndex(a,d);return{actualRow:i,actualColumn:n,isMerged:r,isMergedMainCell:o,startX:c.startX,startY:c.startY,endX:c.endX,endY:c.endY,mergeInfo:{startRow:s,startColumn:l,endRow:a,endColumn:d,startY:(null==u?void 0:u.startY)||0,endY:(null==h?void 0:h.endY)||0,startX:(null==u?void 0:u.startX)||0,endX:(null==h?void 0:h.endX)||0}}}el(eB,"SelectionShapeExtension"),el(eF,"attachSelectionWithCoord"),el(ej,"attachPrimaryWithCoord");let ez=(0,O.createIdentifier)("univer.sheet.selection-render-service"),eX=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_downObserver"),ea(this,"_scenePointerMoveSub"),ea(this,"_scenePointerUpSub"),ea(this,"_controlFillConfig$",new k.BehaviorSubject(null)),ea(this,"controlFillConfig$",this._controlFillConfig$.asObservable()),ea(this,"_selectionControls",[]),ea(this,"_startRangeWhenPointerDown",{startY:0,endY:0,startX:0,endX:0,startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}),ea(this,"_startViewportPosX",0),ea(this,"_startViewportPosY",0),ea(this,"_scrollTimer"),ea(this,"_cancelDownSubscription"),ea(this,"_cancelUpSubscription"),ea(this,"_skeleton"),ea(this,"_scene"),ea(this,"_isHeaderHighlight",!0),ea(this,"_shouldDetectMergedCells",!0),ea(this,"_selectionStyle"),ea(this,"_remainLastEnabled",!1),ea(this,"_skipLastEnabled",!1),ea(this,"_singleSelectionEnabled",!1),ea(this,"_selectionMoveEnd$",new k.BehaviorSubject([])),ea(this,"selectionMoveEnd$",this._selectionMoveEnd$.asObservable()),ea(this,"_selectionMoving$",new Y.Subject),ea(this,"selectionMoving$",this._selectionMoving$.asObservable()),ea(this,"_selectionMoveStart$",new Y.Subject),ea(this,"selectionMoveStart$",this._selectionMoveStart$.asObservable()),ea(this,"_selectionMoving",!1),ea(this,"_activeViewport"),ea(this,"interceptor",new O.InterceptorManager({RANGE_MOVE_PERMISSION_CHECK:eA,RANGE_FILL_PERMISSION_CHECK:ek})),ea(this,"_escapeShortcutDisposable",null),this._injector=e,this._themeService=t,this._shortcutService=i,this._sheetSkeletonManagerService=n,this._resetSelectionStyle(),this._initMoving()}get selectionMoving(){return this._selectionMoving}_initMoving(){this.disposeWithMe(this._selectionMoving$.subscribe(()=>{this._selectionMoving=!0})),this.disposeWithMe(this._selectionMoveEnd$.subscribe(()=>{this._selectionMoving=!1}))}_setSelectionStyle(e){this._selectionStyle=e}_resetSelectionStyle(){this._setSelectionStyle((0,A.getNormalSelectionStyle)(this._themeService))}getViewPort(){return this._activeViewport}setSingleSelectionEnabled(e=!1){this._singleSelectionEnabled=e}_addSelectionControlBySelectionData(e){var t;let i=this._skeleton,n=null!=(t=e.style)?t:(0,A.getNormalSelectionStyle)(this._themeService),r=this._scene;if(!r||!i)return;let{rangeWithCoord:o,primaryWithCoord:s}=e,{rangeType:l}=o,a=this.newSelectionControl(r,l||O.RANGE_TYPE.NORMAL,i);new eB(a,i,r,this._themeService,this._injector,{selectionMoveEnd:/* @__PURE__ */el(()=>{this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())},"selectionMoveEnd")});let{rowHeaderWidth:d,columnHeaderHeight:c}=i;a.update(o,d,c,n,s)}newSelectionControl(e,t,i){let n=this.getSelectionControls().length,{rowHeaderWidth:r,columnHeaderHeight:o}=i,s=new eH(e,n,this._themeService,this._isHeaderHighlight,{rowHeaderWidth:r,columnHeaderHeight:o});return this._selectionControls.push(s),s}updateControlForCurrentByRangeData(e){let t=this.getSelectionControls();if(!(!t||null==this._skeleton))for(let i=0,n=e.length;i<n;i++){let{rangeWithCoord:n,primaryWithCoord:r}=e[i],o=t[i];o&&o.updateRange(n,r)}}refreshSelectionMoveStart(){this._selectionMoveStart$.next(this.getSelectionDataWithStyle())}refreshSelectionMoveEnd(){this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}_changeRuntime(e,t,i){this._skeleton=e,this._scene=t,this._activeViewport=i||(null==t?void 0:t.getViewports()[0]),t.findLayerByZIndex(1)||t.addLayer(new eU(t,[],1))}getSkeleton(){return this._skeleton}getSelectionDataWithStyle(){let e=this._selectionControls,[t,i]=this._skeleton.getLocation();return e.map(e=>{let n=e.getValue();return n.rangeWithCoord.sheetId=i,n.rangeWithCoord.unitId=t,n})}getSelectionControls(){return this._selectionControls}_clearSelectionControls(){for(let e of this._selectionControls)e.dispose();this._selectionControls.length=0}_getFreeze(){var e;return null==(e=this._sheetSkeletonManagerService.getCurrent())?void 0:e.skeleton.getWorksheetConfig().freeze}_getViewportByCell(e,t){if(void 0===e||void 0===t)return null;let i=this._getFreeze();return!i||i.startRow<=0&&i.startColumn<=0||e>i.startRow&&t>i.startColumn?this._scene.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN):e<=i.startRow&&t<=i.startColumn?this._scene.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP):e<=i.startRow&&t>i.startColumn?this._scene.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP):e>i.startRow&&t<=i.startColumn?this._scene.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT):void 0}getActiveRange(){let e=this.getSelectionControls(),t=e&&e[e.length-1].model;return t&&{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}getActiveSelectionControl(){let e=this.getSelectionControls();if(e)return e[e.length-1]}endSelection(){var e;this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),null==(e=this._escapeShortcutDisposable)||e.dispose(),this._escapeShortcutDisposable=null}_reset(){var e;this._clearSelectionControls(),null==(e=this._downObserver)||e.unsubscribe(),this._downObserver=null}resetAndEndSelection(){this.endSelection(),this._reset()}_onPointerDown(e,t=0,i=O.RANGE_TYPE.NORMAL,n,r=x.ScrollTimerType.ALL){var o;this._shouldDetectMergedCells=i===O.RANGE_TYPE.NORMAL;let s=this._skeleton,l=this._scene;if(!l||!s)return;n&&(this._activeViewport=n);let{offsetX:a,offsetY:d}=e,c=l.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(!c)return;let u=l.getRelativeToViewportCoord((0,x.Vector2).FromArray([a,d])),{x:h,y:m}=u;this._startViewportPosX=h,this._startViewportPosY=m;let g=l.getVpScrollXYInfoByPosToVp(u),{scaleX:p,scaleY:v}=l.getAncestorScale(),S=this._getCellRangeByCursorPosition(h,m,p,v,g);if(!S)return;let{rangeWithCoord:f,primaryWithCoord:C}=S,I={...f,rangeType:i};this._startRangeWhenPointerDown={...f,rangeType:i};let b=this.getActiveSelectionControl();for(let t of this.getSelectionControls()){if(2===e.button&&t.model.isInclude(I)){b=t;return}if(t.model.isEqual(I)){b=t;break}e.shiftKey||t.clearHighlight()}this._checkClearPreviousControls(e);let _=null==b?void 0:b.model.currentCell,R=e.shiftKey&&_,y=this._remainLastEnabled&&!e.ctrlKey&&!e.shiftKey&&!this._skipLastEnabled&&!this._singleSelectionEnabled;R&&_?this._performSelectionByTwoCells(_,I,s,i,b):(y&&b||(b=this.newSelectionControl(l,i,s)),this._updateSelectionControlByRange(b,I,C)),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),l.disableObjectsEvent(),this._clearUpdatingListeners(),this._addEndingListeners(),null==(o=l.getTransformer())||o.clearSelectedObjects(),(i===O.RANGE_TYPE.ROW||i===O.RANGE_TYPE.COLUMN)&&(i===O.RANGE_TYPE.ROW?h=0:i===O.RANGE_TYPE.COLUMN&&(m=0),this._movingHandler(h,m,b,i)),this._setupPointerMoveListener(c,b,i,r,h,m),this._escapeShortcutDisposable=this._shortcutService.forceEscape(),this._scenePointerUpSub=l.onPointerUp$.subscribeEvent(()=>{var e;this._clearUpdatingListeners(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),null==(e=this._escapeShortcutDisposable)||e.dispose(),this._escapeShortcutDisposable=null})}_setupPointerMoveListener(e,t,i,n=x.ScrollTimerType.ALL,r,o){var s,l;let a=0,d=0,c=r,u=o;this._scrollTimer=(0,x.ScrollTimer).create(this._scene,n),this._scrollTimer.startScroll(null!=(s=null==e?void 0:e.left)?s:0,null!=(l=null==e?void 0:e.top)?l:0,e);let h=this._scene,m=h.getActiveViewportByCoord((0,x.Vector2).FromArray([r,o]));this._scenePointerMoveSub=h.onPointerMove$.subscribeEvent(n=>{var r,o,s,l,g,p,v,S,f;let{offsetX:C,offsetY:I}=n,{x:b,y:_}=h.getRelativeToViewportCoord((0,x.Vector2).FromArray([C,I]));this._movingHandler(b,_,t,i);let R=b,y=_,T=this.getActiveSelectionControl(),E=this._getFreeze(),w=null==T?void 0:T.model,P=null!=(r=h.getActiveViewportByCoord((0,x.Vector2).FromArray([C,I])))?r:this._getViewportByCell(null==w?void 0:w.endRow,null==w?void 0:w.endColumn);if(/* @__PURE__ */el(()=>{if(!m||!P||!e)return!1;let t=[x.SHEET_VIEWPORT_KEY.VIEW_MAIN,x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP,x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP,x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT];return t.includes(m.viewportKey)&&t.includes(P.viewportKey)},"isCrossableViewports")()){if(!m||!P||!e)return!1;let t=c<e.left&&b>e.left||c>e.left&&b<e.left,i=u<e.top&&_>e.top||u>e.top&&_<e.top;t&&(a+=1),i&&(d+=1);let n=m.viewportKey,r=P.viewportKey;if(n===x.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP)I<e.top&&(null!=(o=null==w?void 0:w.endRow)?o:0)<(null!=(s=null==E?void 0:E.startRow)?s:0)?y=e.top:i&&d%2==1&&e.scrollToViewportPos({viewportScrollY:0});else if(n===x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT)C<e.left&&(null!=(l=null==w?void 0:w.endColumn)?l:0)<(null!=(g=null==E?void 0:E.startColumn)?g:0)?R=e.left:t&&a%2==1&&e.scrollToViewportPos({viewportScrollX:0});else if(n===r){let t=!1,i=!1;n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP?(t=!0,i=!0):n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP?i=!0:n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT&&(t=!0),(null!=(p=null==w?void 0:w.endRow)?p:0)>(null!=(v=null==E?void 0:E.startRow)?v:0)&&(i=!1),(null!=(S=null==w?void 0:w.endColumn)?S:0)>(null!=(f=null==E?void 0:E.startColumn)?f:0)&&(t=!1),t&&(R=e.left),i&&(y=e.top)}else{let o={x:m.scrollX,y:m.scrollY},s={x:P.scrollX,y:P.scrollY},l=o.x!==s.x&&t&&a%2==1,c=o.y!==s.y&&i&&d%2==1;(l||c)&&(e.scrollToBarPos({x:l?o.x:void 0,y:c?o.y:void 0}),l||(R=e.left),c||(y=e.top)),(n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&r===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT||r===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT)&&(R=e.left),(n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&r===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP||r===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&n===x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP)&&(y=e.top)}c=b,u=_}this._scrollTimer.scrolling(R,y,()=>{this._movingHandler(b,_,t,i)})})}attachSelectionWithCoord(e){return eF(e,this._skeleton)}attachPrimaryWithCoord(e){return ej(e,this._skeleton)}getSelectionCellByPosition(e,t){let i=this._scene,n=this._skeleton,r=i.getViewportScrollXY(i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN)),{scaleX:o,scaleY:s}=i.getAncestorScale();return n.calculateCellIndexByPosition(e,t,o,s,r)}_movingHandler(e,t,i,n){var r,o,s,l,a;let d=this._skeleton,c=this._scene,[u,h]=d.getLocation(),m={startRow:null!=(r=null==i?void 0:i.model.startRow)?r:-1,endRow:null!=(o=null==i?void 0:i.model.endRow)?o:-1,startColumn:null!=(s=null==i?void 0:i.model.startColumn)?s:-1,endColumn:null!=(l=null==i?void 0:i.model.endColumn)?l:-1,unitId:u,sheetId:h},g=c.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),p=null!=(a=this._getViewportByCell(m.endRow,m.endColumn))?a:g,v=c.getVpScrollXYInfoByPosToVp((0,x.Vector2).FromArray([this._startViewportPosX,this._startViewportPosY]),p),{scaleX:S,scaleY:f}=c.getAncestorScale();n===O.RANGE_TYPE.ROW?e=Number.POSITIVE_INFINITY:n===O.RANGE_TYPE.COLUMN&&(t=Number.POSITIVE_INFINITY);let C=this._getCellRangeByCursorPosition(e,t,S,f,v);if(!C)return;let{rangeWithCoord:I}=C,b=this._startRangeWhenPointerDown,_={startRow:Math.min(I.startRow,b.startRow),startColumn:Math.min(I.startColumn,b.startColumn),endRow:Math.max(I.endRow,b.endRow),endColumn:Math.max(I.endColumn,b.endColumn)};if(this._shouldDetectMergedCells&&(_=d.getSelectionMergeBounding(_.startRow,_.startColumn,_.endRow,_.endColumn)),!_)return;let R=d.getNoMergeCellPositionByIndex(_.startRow,_.startColumn),y=d.getNoMergeCellPositionByIndex(_.endRow,_.endColumn),T={startRow:_.startRow,startColumn:_.startColumn,endRow:_.endRow,endColumn:_.endColumn,unitId:u,sheetId:h,startY:(null==R?void 0:R.startY)||0,endY:(null==y?void 0:y.endY)||0,startX:(null==R?void 0:R.startX)||0,endX:(null==y?void 0:y.endX)||0},E=m.startRow!==_.startRow||m.startColumn!==_.startColumn||m.endRow!==_.endRow||m.endColumn!==_.endColumn;null!=i&&E&&(this._updateSelectionControlByRange(i,T),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_updateSelectionControlByRange(e,t,i){e.updateRange(t,i)}_clearUpdatingListeners(){var e,t,i,n,r;this._scene.enableObjectsEvent(),null==(e=this._scenePointerMoveSub)||e.unsubscribe(),this._scenePointerMoveSub=null,null==(t=this._scenePointerUpSub)||t.unsubscribe(),this._scenePointerUpSub=null,null==(i=this._cancelDownSubscription)||i.unsubscribe(),this._cancelDownSubscription=null,null==(n=this._cancelUpSubscription)||n.unsubscribe(),this._cancelUpSubscription=null,null==(r=this._scrollTimer)||r.dispose()}_addEndingListeners(){var e,t,i;let n=this._scene,r=null==(e=n.getEngine())?void 0:e.activeScene;r&&r!==n&&(null==(t=this._cancelDownSubscription)||t.unsubscribe(),this._cancelDownSubscription=null,null==(i=this._cancelUpSubscription)||i.unsubscribe(),this._cancelUpSubscription=null,this._cancelDownSubscription=r.onPointerDown$.subscribeEvent(()=>this._clearUpdatingListeners()),this._cancelUpSubscription=r.onPointerUp$.subscribeEvent(()=>this._clearUpdatingListeners()))}_getCellRangeByCursorPosition(e,t,i,n,r){var o;if(this._shouldDetectMergedCells){let s=null==(o=this._skeleton)?void 0:o.calculateCellIndexByPosition(e,t,i,n,r);if(!s)return;let l=(0,O.makeCellToSelection)(s);return{primaryWithCoord:s,rangeWithCoord:l}}let s=this._skeleton;if(null==s)return;let{row:l,column:a}=s.getCellPositionByOffset(e,t,i,n,r),{startX:d,startY:c,endX:u,endY:h}=s.getNoMergeCellPositionByIndex(l,a),m={startY:c,endY:h,startX:d,endX:u,startRow:l,endRow:l,startColumn:a,endColumn:a};return{primaryWithCoord:{actualRow:l,actualColumn:a,isMerged:!1,isMergedMainCell:!1,startY:c,endY:h,startX:d,endX:u,mergeInfo:m},rangeWithCoord:m}}_checkClearPreviousControls(e){0===this.getSelectionControls().length||(e.ctrlKey||e.shiftKey||this._remainLastEnabled)&&(!this._singleSelectionEnabled||e.shiftKey)||this._clearSelectionControls()}_performSelectionByTwoCells(e,t,i,n,r){let{actualRow:o,actualColumn:s,mergeInfo:l}=e,a=Math.min(o,t.startRow,l.startRow),d=Math.max(o,t.endRow,l.endRow),c=Math.min(s,t.startColumn,l.startColumn),u=Math.max(s,t.endColumn,l.endColumn),h=i.getMergeBounding(a,c,d,u),m=i.getNoMergeCellPositionByIndex(h.startRow,h.startColumn),g=i.getNoMergeCellPositionByIndex(h.endRow,h.endColumn),p={startColumn:h.startColumn,startRow:h.startRow,endColumn:h.endColumn,endRow:h.endRow,startY:m.startY,endY:g.endY,startX:m.startX,endX:g.endX,rangeType:n},v=i.getCellByIndex(o,s);this._startRangeWhenPointerDown={startColumn:v.mergeInfo.startColumn,startRow:v.mergeInfo.startRow,endColumn:v.mergeInfo.endColumn,endRow:v.mergeInfo.endRow,startY:v.mergeInfo.startY||0,endY:v.mergeInfo.endY||0,startX:v.mergeInfo.startX||0,endX:v.mergeInfo.endX||0,rangeType:n},this._updateSelectionControlByRange(r,p,e)}_refreshSelectionControl(e){let t=e.map(e=>{let t=eF(e,this._skeleton);return t.style=(0,A.getNormalSelectionStyle)(this._themeService),t});this.updateControlForCurrentByRangeData(t)}};el(eX,"BaseSelectionRenderService");let eY=eX;function eG(e){return{range:{startRow:0,startColumn:0,endRow:e.getRowCount()-1,endColumn:e.getColumnCount()-1,rangeType:O.RANGE_TYPE.ALL},primary:eZ(e).primary,style:null}}function eZ(e){let t=e.mergeData;return(0,A.transformCellDataToSelectionData)(0,0,t)||{range:{startRow:0,startColumn:0,endRow:0,endColumn:0},primary:{actualRow:0,actualColumn:0,startRow:0,startColumn:0,endRow:0,endColumn:0,isMerged:!1,isMergedMainCell:!1},style:null}}el(eG,"getAllSelection"),el(eZ,"getTopLeftSelection");var eK,eq=Object.defineProperty,eQ=Object.getOwnPropertyDescriptor,eJ=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?eQ(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&eq(t,i,o),o},"__decorateClass$V"),e$=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$V");let e0=(el(eK=class{constructor(e,t){ea(this,"_current",null),ea(this,"_shortcutParam",[]),this._univerInstanceService=e,this._localeService=t}dispose(){this._shortcutParam=[]}getCurrentBySearch(e){return this._getCurrentBySearch(e)}getCurrent(){return this._getCurrentBySearch(this._current)}addOrUpdate(e){let t=this._getCurrentBySearch({unitId:e.unitId,sheetId:e.sheetId,keycode:e.keycode});if(null!=t){let e=this._shortcutParam.indexOf(t);this._shortcutParam.splice(e,1)}return this._shortcutParam.push(e),t}remove(e){if(null==e)return;let t=this._getCurrentBySearch(e);if(null==t)return;let i=this._shortcutParam.indexOf(t);return this._shortcutParam.splice(i,1)[0]}_getCurrentBySearch(e){return null==e?void 0:this._shortcutParam.find(t=>t.unitId===e.unitId&&t.sheetId===e.sheetId&&t.keycode===e.keycode)}},"ShortcutExperienceService"),eK);e0=eJ([e$(0,O.IUniverInstanceService),e$(1,(0,O.Inject)(O.LocaleService))],e0);var e1=((c=e1||{}).MergeAll="mergeAll",c.MergeVertical="mergeVertical",c.MergeHorizontal="mergeHorizontal",c);function e2(e,t,i,n,r=!0,o=1,s=!0){let l,a={...e};switch(null==n&&(n={startRow:0,endRow:i.getRowCount()-1,startColumn:0,endColumn:i.getColumnCount()-1}),t){case O.Direction.UP:for(l=e.startRow-o;l>-1&&!i.getRowVisible(l);)l-=1;l>=n.startRow?(a.startRow=l,a.endRow=l):s&&(a.startRow=n.endRow,a.endRow=n.endRow,r&&(a=e2(a,O.Direction.LEFT,i,n,!1)));break;case O.Direction.DOWN:for(l=e.endRow+o;l<i.getRowCount()&&!i.getRowVisible(l);)l+=1;l<=n.endRow?(a.startRow=l,a.endRow=l):s&&(a.startRow=n.startRow,a.endRow=n.startRow,r&&(a=e2(a,O.Direction.RIGHT,i,n,!1)));break;case O.Direction.LEFT:for(l=e.startColumn-o;l>-1&&!i.getColVisible(l);)l-=1;l>=n.startColumn?(a.startColumn=l,a.endColumn=l):s&&(a.startColumn=n.endColumn,a.endColumn=n.endColumn,r&&(a=e2(a,O.Direction.UP,i,n,!1)));break;case O.Direction.RIGHT:for(l=e.endColumn+o;l<i.getColumnCount()&&!i.getColVisible(l);)l+=1;l<=n.endColumn?(a.startColumn=l,a.endColumn=l):s&&(a.startColumn=n.startColumn,a.endColumn=n.startColumn,r&&(a=e2(a,O.Direction.DOWN,i,n,!1)))}return a}function e5(e,t,i){let n={...e},{startRow:r,startColumn:o,endRow:s,endColumn:l}=te(e,t,i),a=tt(i,r,o,s,l).hasValue,d=!0,c=!0;for(;c;){if(O.Direction.UP===t){let e=n.startRow-1;for(;e>-1&&!i.getRowVisible(e);)e-=1;if(-1===e){c=!1;break}let{hasValue:t,matrix:r}=tt(i,e,n.startColumn,e,n.endColumn);if(!a||t||d){if(0!==r.getLength()){let t=e;r.forValue(e=>{t=Math.min(e,t)}),n.startRow=t}else n.startRow=e;if(n.endRow=n.startRow,!a&&t){c=!1;break}a=t,d=!1}else{c=!1;break}}if(O.Direction.DOWN===t){let e=n.endRow+1;for(;e<i.getRowCount()&&!i.getRowVisible(e);)e+=1;if(e===i.getRowCount()){c=!1;break}let{hasValue:t,matrix:r}=tt(i,e,n.startColumn,e,n.endColumn);if(!a||t||d){if(0!==r.getLength()){let t=e;r.forValue((e,i,n)=>{t=Math.max(e+(n.rowSpan||1)-1,t)}),n.endRow=t}else n.endRow=e;if(n.startRow=n.endRow,!a&&t){c=!1;break}a=t,d=!1}else{c=!1;break}}if(O.Direction.LEFT===t){let e=n.startColumn-1;for(;e>-1&&!i.getColVisible(e);)e-=1;if(-1===e){c=!1;break}let{hasValue:t,matrix:r}=tt(i,n.startRow,e,n.endRow,e);if(!a||t||d){if(0!==r.getLength()){let t=e;r.forValue((e,i)=>{t=Math.min(i,t)}),n.startColumn=t}else n.startColumn=e;if(n.endColumn=n.startColumn,!a&&t){c=!1;break}a=t,d=!1}else{c=!1;break}}if(O.Direction.RIGHT===t){let e=n.endColumn+1;for(;e<i.getColumnCount()&&!i.getColVisible(e);)e+=1;if(e===i.getColumnCount()){c=!1;break}let{hasValue:t,matrix:r}=tt(i,n.startRow,e,n.endRow,e);if(!a||t||d){if(0!==r.getLength()){let t=e;r.forValue((e,i,n)=>{t=Math.max(i+(n.colSpan||1)-1,t)}),n.endColumn=t}else n.endColumn=e;if(n.startColumn=n.endColumn,!a&&t){c=!1;break}a=t,d=!1}else{c=!1;break}}}return(0,A.alignToMergedCellsBorders)(n,i,!0)}function e9(e,t,i){return e2(e,t,i,void 0,!1,1,!1)}function e6(e,t,i){let n=e5(e,t,i);return(0,A.alignToMergedCellsBorders)((0,O.Rectangle).union(n,e),i,!0)}function e3(e,t,i){let n=e9(e,t,i),r={startRow:Math.min(e.startRow,n.startRow),startColumn:Math.min(e.startColumn,n.startColumn),endRow:Math.max(e.endRow,n.endRow),endColumn:Math.max(e.endColumn,n.endColumn)};return(0,A.alignToMergedCellsBorders)((0,O.Rectangle).union(e,r),i)}function e7(e,t,i,n){let r=e5(te(e,(0,O.getReverseDirection)(i),n),i,n);return i===O.Direction.UP&&r.startRow<=e.startRow?(0,A.alignToMergedCellsBorders)({...t,startColumn:e.startColumn,endColumn:e.endColumn},n,!0):i===O.Direction.DOWN&&r.endRow>=e.endRow?(0,A.alignToMergedCellsBorders)({...t,startColumn:e.startColumn,endColumn:e.endColumn},n,!0):i===O.Direction.LEFT&&r.startColumn<=e.startColumn?(0,A.alignToMergedCellsBorders)({...t,startRow:e.startRow,endRow:e.endRow},n,!0):i===O.Direction.RIGHT&&r.endColumn>=e.endColumn?(0,A.alignToMergedCellsBorders)({...t,startRow:e.startRow,endRow:e.endRow},n,!0):(0,O.Rectangle).union((0,O.Rectangle).clone(t),r)}function e4(e,t,i){let n=te(e,(0,O.getReverseDirection)(t),i),r=te(e,t,i),o=e9(n,t,i);return(0,A.alignToMergedCellsBorders)((0,O.Rectangle).union(r,o),i,!1)}function e8(e){return{startRow:0,startColumn:0,endRow:e.getRowCount()-1,endColumn:e.getColumnCount()-1,rangeType:O.RANGE_TYPE.ALL}}function te(e,t,i){let n;switch(t){case O.Direction.UP:n={startRow:e.startRow,startColumn:e.startColumn,endRow:e.startRow,endColumn:e.endColumn,rangeType:O.RANGE_TYPE.NORMAL};break;case O.Direction.DOWN:n={startRow:e.endRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:O.RANGE_TYPE.NORMAL};break;case O.Direction.LEFT:n={startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.startColumn,rangeType:O.RANGE_TYPE.NORMAL};break;case O.Direction.RIGHT:n={startRow:e.startRow,startColumn:e.endColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:O.RANGE_TYPE.NORMAL};break;default:throw Error("Invalid direction")}return(0,A.alignToMergedCellsBorders)(n,i,!1)}function tt(e,t,i,n,r){let o=!1,s=e.getMatrixWithMergedCells(t,i,n,r).forValue((e,t,i)=>{if(tl(i))return o=!0,!1});return{hasValue:o,matrix:s}}function ti(e,t,i){let n=(0,O.Rectangle).clone(e);if(null==t)return n;switch(i){case O.Direction.UP:case O.Direction.DOWN:n.startColumn=n.endColumn=t.actualColumn;break;case O.Direction.LEFT:case O.Direction.RIGHT:n.startRow=n.endRow=t.actualRow}return n}function tn(e,t,i){let{primary:n,range:r}=e,o=(0,O.Rectangle).clone(r);switch(t){case O.Direction.UP:case O.Direction.DOWN:o.startRow=n.startRow,o.endRow=n.endRow;break;case O.Direction.LEFT:case O.Direction.RIGHT:o.startColumn=n.startColumn,o.endColumn=n.endColumn}let s=te(o,t,i);switch(t){case O.Direction.DOWN:return r.startRow<s.startRow;case O.Direction.UP:return r.endRow>s.endRow;case O.Direction.LEFT:return s.endColumn<r.endColumn;case O.Direction.RIGHT:return s.startColumn>r.startColumn}}function tr(e,t){let i=e[0].startRow,n=e[0].endRow;e.forEach(e=>{let{startRow:t,endRow:r}=e;i=Math.min(i,t),n=Math.max(n,r)});let r=Array(n-i+1).fill(!1);return t.forEach(e=>{let{startRow:t,endRow:o}=e;for(let e=Math.max(t,i);e<=Math.min(o,n);e++)r[e-i]=!0}),e.every(e=>{let{startRow:t,endRow:n}=e;for(let e=t;e<=n;e++)if(!r[e-i])return!1;return!0})}function to(e,t){let i=e[0].startColumn,n=e[0].endColumn;e.forEach(e=>{let{startColumn:t,endColumn:r}=e;i=Math.min(i,t),n=Math.max(n,r)});let r=Array(n-i+1).fill(!1);return t.forEach(e=>{let{startColumn:t,endColumn:o}=e;for(let e=Math.max(t,i);e<=Math.min(o,n);e++)r[e-i]=!0}),e.every(e=>{let{startColumn:t,endColumn:n}=e;for(let e=t;e<=n;e++)if(!r[e-i])return!1;return!0})}function ts(e,t){return t?"mergeAll"===e?t.filter(e=>!(e.startRow===e.endRow&&e.startColumn===e.endColumn)):"mergeVertical"===e?t.filter(e=>e.startRow!==e.endRow):"mergeHorizontal"===e?t.filter(e=>e.startColumn!==e.endColumn):t:null}function tl(e){return void 0!==e.v&&null!==e.v&&""!==e.v||void 0!==e.p}el(e2,"findNextRange"),el(e5,"findNextGapRange"),el(e9,"findNextRangeExpand"),el(e6,"expandToNextGapRange"),el(e3,"expandToNextCell"),el(e7,"shrinkToNextGapRange"),el(e4,"shrinkToNextCell"),el(e8,"expandToWholeSheet"),el(te,"getEdgeOfRange"),el(tt,"rangeHasValue"),el(ti,"getStartRange"),el(tn,"checkIfShrink"),el(tr,"isAllRowsCovered"),el(to,"isAllColumnsCovered"),el(ts,"getMergeableSelectionsByType"),el(tl,"cellHasValue");var ta=((u=ta||{})[u.moveStopeOne=0]="moveStopeOne",u[u.moveGap=1]="moveGap",u[u.moveStepPage=2]="moveStepPage",u[u.moveStepEnd=3]="moveStepEnd",u);let td={id:"sheet.command.move-selection",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{var i;if(!t)return!1;let n=(0,A.getSheetCommandTarget)(e.get(O.IUniverInstanceService));if(!n)return!1;let{workbook:r,worksheet:o}=n,s=(0,A.getSelectionsService)(e).getCurrentLastSelection();if(!s)return!1;let{direction:l,jumpOver:a}=t,{range:d,primary:c}=s,u=ti(d,c,l),h=1===a?e5(u,l,o):e2(u,l,o),m=(0,A.getCellAtRowCol)(h.startRow,h.startColumn,o);if((0,O.Rectangle).equals(m,u))return!1;let g=r.getUnitId();e.get(e0).remove({unitId:g,sheetId:o.getSheetId(),keycode:J.KeyCode.TAB});let p=[{range:(0,O.Rectangle).clone(m),primary:{startRow:m.startRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.endColumn,actualRow:h.startRow,actualColumn:h.startColumn,isMerged:m.isMerged,isMergedMainCell:m.startRow===h.startRow&&m.startColumn===h.startColumn}}],v=e.get(O.ICommandService).executeCommand(A.SetSelectionsOperation.id,{unitId:r.getUnitId(),subUnitId:o.getSheetId(),selections:p}),S=null==(i=e.get(x.IRenderManagerService).getRenderById(g))?void 0:i.with(ez);return null==S||S.refreshSelectionMoveEnd(),v},"handler")},tc={id:"sheet.command.move-selection-enter-tab",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{var i;let n;if(!t)return!1;let r=(0,A.getSheetCommandTarget)(e.get(O.IUniverInstanceService));if(!r)return!1;let{workbook:o,worksheet:s}=r,l=(0,A.getSelectionsService)(e).getCurrentLastSelection();if(!l)return!1;let a=o.getUnitId(),d=s.getSheetId();if(!l)return!1;let{direction:c,keycode:u}=t,{range:h,primary:m}=l,g=ti(h,m,c),p=e.get(e0),v=p.getCurrentBySearch({unitId:a,sheetId:d,keycode:J.KeyCode.TAB}),{startRow:S,endRow:f,startColumn:C,endColumn:I}=h;if((0,O.Rectangle).equals(h,m)){if(u===J.KeyCode.TAB)null==v&&p.addOrUpdate({unitId:a,sheetId:d,keycode:J.KeyCode.TAB,selection:l});else{let e=null==v?void 0:v.selection;if(null!=e){let{range:t,primary:i}=e;g=ti(t,i,c)}p.remove({unitId:a,sheetId:d,keycode:J.KeyCode.TAB})}let e=e2(g,c,s),t=(0,A.getCellAtRowCol)(e.startRow,e.startColumn,s);if((0,O.Rectangle).equals(t,g))return!1;n={range:(0,O.Rectangle).clone(t),primary:{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn,actualRow:e.startRow,actualColumn:e.startColumn,isMerged:t.isMerged,isMergedMainCell:t.startRow===e.startRow&&t.startColumn===e.startColumn}}}else{p.remove({unitId:a,sheetId:d,keycode:J.KeyCode.TAB});let e=(0,O.Tools).deepClone(m),t=e2({startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn},c,s,{startRow:S,endRow:f,startColumn:C,endColumn:I}),i=(0,A.getCellAtRowCol)(t.startRow,t.startColumn,s);n={range:(0,O.Rectangle).clone(h),primary:{startRow:i.startRow,startColumn:i.startColumn,endRow:i.endRow,endColumn:i.endColumn,actualRow:t.startRow,actualColumn:t.startColumn,isMerged:i.isMerged,isMergedMainCell:i.startRow===t.startRow&&i.startColumn===t.startColumn}}}let b=e.get(O.ICommandService).executeCommand(A.SetSelectionsOperation.id,{unitId:a,subUnitId:d,selections:[n]}),_=null==(i=e.get(x.IRenderManagerService).getRenderById(a))?void 0:i.with(ez);return null==_||_.refreshSelectionMoveEnd(),b},"handler")},tu={id:"sheet.command.expand-selection",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{if(!t)return!1;let i=(0,A.getSheetCommandTarget)(e.get(O.IUniverInstanceService));if(!i)return!1;let{worksheet:n,unitId:r,subUnitId:o}=i,s=(0,A.getSelectionsService)(e).getCurrentLastSelection();if(!s)return!1;let{range:l,primary:a}=s,{jumpOver:d,direction:c}=t,u=tn(s,c,n)?1===d?e7(l,{...(0,O.Rectangle).clone(a),rangeType:O.RANGE_TYPE.NORMAL},c,n):e4(l,c,n):1===d?e6(l,c,n):e3(l,c,n);return!(0,O.Rectangle).equals(u,l)&&e.get(O.ICommandService).executeCommand(A.SetSelectionsOperation.id,{unitId:r,subUnitId:o,selections:[{range:u,primary:a}]})},"handler")},th={id:"sheet.command.select-all",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t={expandToGapFirst:!0,loop:!1})=>{let i;let n=(0,A.getSheetCommandTarget)(e.get(O.IUniverInstanceService));if(!n)return!1;let r=(0,A.getSelectionsService)(e).getCurrentLastSelection();if(!r)return!1;let o=e.get(eP),{worksheet:s,unitId:l,subUnitId:a}=n,d=`${l}|${a}`;d!==o.selectedRangeWorksheet&&(o.rangesStack=[],o.selectedRangeWorksheet=d);let c=s.getMaxRows(),u=s.getMaxColumns(),{expandToGapFirst:h,loop:m}=t,{range:g,primary:p}=r,v=g.endColumn===u-1&&g.endRow===c-1&&0===g.startRow&&0===g.startColumn;if(o.rangesStack.some(e=>(0,O.Rectangle).equals(e,g))||(o.rangesStack=[],o.rangesStack.push(g)),v){if(!m||o.rangesStack.findIndex(e=>(0,O.Rectangle).equals(e,g))!==o.rangesStack.length-1)return!1;i=o.rangesStack[0]}else h?(i=(0,A.expandToContinuousRange)(g,{left:!0,right:!0,up:!0,down:!0},s),(0,O.Rectangle).equals(i,g)&&(i=e8(s))):i=e8(s);return o.rangesStack.some(e=>(0,O.Rectangle).equals(e,i))||o.rangesStack.push(i),e.get(O.ICommandService).executeCommand(A.SetSelectionsOperation.id,{unitId:l,subUnitId:a,selections:[{range:i,primary:p}]})},"handler")};function tm(e){return typeof e.isMainScene>"u"}function tg(e,t){let i,n,r,o;let s=e instanceof O.Workbook?e:e.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!s)return null;let l=s.getUnitId();if(tm(t)){let e=t.getRenderById(l);if(null==e)return null;i=e.components,i=e.components,n=e.mainComponent,r=e.scene,o=e.engine}else i=t.components,n=t.mainComponent,r=t.scene,o=t.engine;return i&&n?{spreadsheet:n,spreadsheetRowHeader:i.get(eO.ROW),spreadsheetColumnHeader:i.get(eO.COLUMN),spreadsheetLeftTopPlaceholder:i.get(eO.LEFT_TOP),scene:r,engine:o}:null}function tp(e,t,i,n){let{startX:r,startY:o,endX:s,endY:l}=n.getCellByIndex(e,t);return{startX:r,startY:o,endX:s,endY:l}}function tv(e,t,i,n,r,o){let s=i.getRelativeToViewportCoord((0,x.Vector2).FromArray([e,t])),{x:l,y:a}=s,d=i.getVpScrollXYInfoByPosToVp(s,r),{scaleX:c,scaleY:u}=i.getAncestorScale(),{row:h,column:m}=n.getCellPositionByOffset(l,a,c,u,d,o),{startX:g,startY:p,endX:v,endY:S}=n.getNoMergeCellPositionByIndex(h,m);return{startX:g,startY:p,endX:v,endY:S,row:h,column:m}}function tS(e,t,i,n){let r=i.getRelativeToViewportCoord((0,x.Vector2).FromArray([e,t])),o=i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),s=i.getVpScrollXYInfoByPosToVp(r,o),{scaleX:l,scaleY:a}=i.getAncestorScale(),{x:d,y:c}=s;return{x:e/l+d,y:t/a+c}}el(tm,"isRenderManagerService"),el(tg,"getSheetObject"),el(tp,"getCoordByCell"),el(tv,"getCoordByOffset"),el(tS,"getTransformCoord");var tf=Object.defineProperty,tC=Object.getOwnPropertyDescriptor,tI=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?tC(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&tf(t,i,o),o},"__decorateClass$U"),tb=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$U");let t_=[td.id,tc.id],tR=(el(iZ=class extends O.Disposable{constructor(e,t,i,n,r,o,s){super(),this._context=e,this._injector=t,this._sheetSkeletonManagerService=i,this._contextService=n,this._commandService=r,this._renderManagerService=o,this._scrollManagerService=s,this._initCommandListener(),this._wheelEventListener(),this._scrollBarEventListener(),this._initSkeletonListener()}scrollToRange(e){let{endRow:t,endColumn:i,startColumn:n,startRow:r}=e,o=this._getViewportBounding();if(e.rangeType===O.RANGE_TYPE.ROW?(n=0,i=0):e.rangeType===O.RANGE_TYPE.COLUMN&&(r=0,t=0),!o)return this._scrollToCell(r,n);{let e=o.startRow>t?r:t,s=o.startColumn>i?n:i;return this._scrollToCell(e,s)}}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t_.includes(e.id))this._scrollToSelection();else if(e.id===A.ScrollToCellOperation.id){let t=e.params;this.scrollToRange(t)}else if(e.id===tu.id){let t=e.params;this._scrollToSelectionForExpand(t)}else e.id===A.SetSelectionsOperation.id&&e.params.reveal&&this._scrollToSelection()}))}_scrollToSelectionForExpand(e){setTimeout(()=>{let t=this._getSelectionsService().getCurrentLastSelection();if(null==t)return;let{startRow:i,startColumn:n,endRow:r,endColumn:o}=t.range,s=this._getViewportBounding();if(null==s)return;let{startRow:l,startColumn:a,endRow:d,endColumn:c}=s,u=0,h=0;u=i>l?r:r<d?i:l,h=n>a?o:o<c?n:a,e.direction===O.Direction.DOWN?u=r:e.direction===O.Direction.UP?u=i:e.direction===O.Direction.RIGHT?h=o:e.direction===O.Direction.LEFT&&(h=n),this._scrollToCell(u,h)},0)}_getFreeze(){var e;let t=null==(e=this._sheetSkeletonManagerService.getCurrent())?void 0:e.skeleton.getWorksheetConfig();if(null!=t)return t.freeze}_wheelEventListener(){let{scene:e}=this._context;if(!e)return;let t=e.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);t&&this.disposeWithMe(e.onMouseWheel$.subscribeEvent((i,n)=>{if(i.ctrlKey||!this._contextService.getContextValue(O.FOCUSING_SHEET))return;let r=0,o=0,s=t.limitedScroll();if(i.inputIndex===x.PointerInput.MouseWheelX){let o=Math.abs(i.deltaX);r=i.deltaX>0?o:-o,this._commandService.executeCommand(eT.id,{offsetX:r}),e.getParent().classType===x.RENDER_CLASS_TYPE.SCENE_VIEWER?null!=s&&s.isLimitedX||n.stopPropagation():t.isWheelPreventDefaultX?i.preventDefault():null!=s&&s.isLimitedX||i.preventDefault()}if(i.inputIndex===x.PointerInput.MouseWheelY){let l=Math.abs(i.deltaY);i.shiftKey?(l*=3,r=i.deltaY>0?l:-l,this._commandService.executeCommand(eT.id,{offsetX:r}),e.getParent().classType===x.RENDER_CLASS_TYPE.SCENE_VIEWER?null!=s&&s.isLimitedX||n.stopPropagation():t.isWheelPreventDefaultX?i.preventDefault():null!=s&&s.isLimitedX||i.preventDefault()):(o=i.deltaY>0?l:-l,this._commandService.executeCommand(eT.id,{offsetY:o}),e.getParent().classType===x.RENDER_CLASS_TYPE.SCENE_VIEWER?null!=s&&s.isLimitedY||n.stopPropagation():t.isWheelPreventDefaultY?i.preventDefault():null!=s&&s.isLimitedY||i.preventDefault())}this._context.scene.makeDirty(!0)}))}_scrollBarEventListener(){let{scene:e}=this._context;if(null==e)return;let t=e.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);t&&(this.disposeWithMe((0,O.toDisposable)(this._scrollManagerService.rawScrollInfo$.subscribe(e=>{var i;let n=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton;if(!n)return;if(null==e){t.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});return}let{sheetViewStartRow:r,sheetViewStartColumn:o,offsetX:s,offsetY:l}=e,{startX:a,startY:d}=n.getCellByIndexWithNoHeader(r,o);t.scrollToViewportPos({viewportScrollX:a+s,viewportScrollY:d+l})}))),this.disposeWithMe(t.onScrollAfter$.subscribeEvent(e=>{var t;let i=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(null==i||!1===e.isTrigger)return;let n=this._getSheetObject();if(null==i||null==n)return;let{viewportScrollX:r,viewportScrollY:o,scrollX:s,scrollY:l}=e,{row:a,column:d,rowOffset:c,columnOffset:u}=i.getDecomposedOffset(r,o),h={sheetViewStartRow:a,sheetViewStartColumn:d,offsetX:u,offsetY:c};this._scrollManagerService.setScrollStateToCurrSheet(h),this._scrollManagerService.validViewportScrollInfo$.next({...h,viewportScrollX:r,viewportScrollY:o,scrollX:s,scrollY:l})})),this.disposeWithMe(t.onScrollByBar$.subscribeEvent(e=>{var t;let i=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(null==i||!1===e.isTrigger)return;let n=this._getSheetObject();if(null==i||null==n)return;let{viewportScrollX:r=0,viewportScrollY:o=0}=e,s=this._getFreeze(),{row:l,column:a,rowOffset:d,columnOffset:c}=i.getDecomposedOffset(r,o);this._commandService.executeCommand(eE.id,{sheetViewStartRow:l+((null==s?void 0:s.ySplit)||0),sheetViewStartColumn:a+((null==s?void 0:s.xSplit)||0),offsetX:c,offsetY:d})})))}_initSkeletonListener(){this.disposeWithMe((0,O.toDisposable)(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(null==e)return;let t={unitId:e.unitId,sheetId:e.sheetId};this._scrollManagerService.setSearchParam(t);let i=this._getSheetObject();if(!i)return;let n=i.scene.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),r=this._scrollManagerService.getScrollStateByParam(t),{viewportScrollX:o,viewportScrollY:s}=this._scrollManagerService.calcViewportScrollFromRowColOffset(r);n&&(r?(n.viewportScrollX=o,n.viewportScrollY=s):(n.viewportScrollX=0,n.viewportScrollY=0),this._updateSceneSize(e))})))}_updateSceneSize(e){var t;if(null==e)return;let{unitId:i}=this._context,{skeleton:n}=e,r=null==(t=this._renderManagerService.getRenderById(i))?void 0:t.scene;if(null==n||null==r)return;let{rowTotalHeight:o,columnTotalWidth:s,rowHeaderWidthAndMarginLeft:l,columnHeaderHeightAndMarginTop:a}=n,d=this._context.unit.getActiveSheet();if(!d)return;let c=d.getZoomRatio()||1;null==r||r.setScaleValue(c,c),null==r||r.transformByState({width:l+s,height:a+o})}_getSheetObject(){return tg(this._context.unit,this._context)}_scrollToSelectionByDirection(e){let t=this._getViewportBounding();if(null==t)return!1;let{startRow:i,startColumn:n,endRow:r,endColumn:o}=t,s=0,l=0,{startRow:a,startColumn:d,endRow:c,endColumn:u}=e;a>=i&&(s=c),c<=r&&(s=a),d>=n&&(l=u),u<=o&&(l=d),this._scrollToCell(s,l)}_scrollToSelection(e=!0){let t=this._getSelectionsService().getCurrentLastSelection();if(!t)return;let{startRow:i,startColumn:n,actualRow:r,actualColumn:o}=t.primary;this._scrollToCell(e?r:i,e?o:n)}_getSelectionsService(){return(0,A.getSelectionsService)(this._injector)}_getViewportBounding(){var e,t;let i=null==(e=this._getSheetObject())?void 0:e.scene;if(null==i)return;let n=i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(null==n)return;let r=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(null==r)return;let o=n.getBounding();return r.getRowColumnSegmentByViewBound(o.viewBound)}_scrollToCell(e,t){var i,n,r,o;let s,l;let{rowHeightAccumulation:a,columnWidthAccumulation:d}=null!=(n=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton)?n:{};if(null==a||null==d)return!1;let c=null==(r=this._getSheetObject())?void 0:r.scene;if(null==c)return!1;let u=c.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(null==u||(null==(o=this._sheetSkeletonManagerService.getCurrent())?void 0:o.skeleton)==null)return!1;let h=this._context.unit.getActiveSheet();if(!h)return!1;let{startColumn:m,startRow:g,ySplit:p,xSplit:v}=h.getFreeze(),S=this._getViewportBounding();if(null==S)return!1;let{startRow:f,startColumn:C,endRow:I,endColumn:b}=S;if(e>=g&&t>=m-v&&(e<=f&&(s=e),e>=I)){let t=a[e]-u.height;for(let i=f;i<=e;i++)if(a[i]>=t){s=i+1;break}}if(t>=m&&e>=g-p&&(t<=C&&(l=t),t>=b)){let e=d[t]-u.width;for(let i=C;i<=t;i++)if(d[i]>=e){l=i+1;break}}if(void 0===s&&void 0===l)return!1;let{offsetX:_,offsetY:R}=this._scrollManagerService.getCurrentScrollState()||{};return s=s&&Math.min(s,e),l=l&&Math.min(l,t),this._commandService.syncExecuteCommand(eE.id,{sheetViewStartRow:s,sheetViewStartColumn:l,offsetX:void 0===l?_:0,offsetY:void 0===s?R:0})}},"SheetsScrollRenderController"),iZ);tR=tI([tb(1,(0,O.Inject)(O.Injector)),tb(2,(0,O.Inject)(ev)),tb(3,O.IContextService),tb(4,O.ICommandService),tb(5,x.IRenderManagerService),tb(6,(0,O.Inject)(eR))],tR);var ty=Object.defineProperty,tT=Object.getOwnPropertyDescriptor,tE=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?tT(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&ty(t,i,o),o},"__decorateClass$T"),tw=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$T");let tP=(0,O.createInterceptorKey)("BEFORE_CELL_EDIT"),tM=(0,O.createInterceptorKey)("AFTER_CELL_EDIT"),tO=(0,O.createInterceptorKey)("AFTER_CELL_EDIT_ASYNC"),tx=(iK=class extends O.Disposable{constructor(e,t,i,n,r,o){super(),ea(this,"_editorUnitId",O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),ea(this,"_isForceKeepVisible",!1),ea(this,"_editorIsDirty",!1),ea(this,"_isDisabled",!1),ea(this,"_visible",{visible:!1,eventType:x.DeviceInputEventType.Dblclick,unitId:""}),ea(this,"_currentEditCell",null),ea(this,"_currentEditCellState",null),ea(this,"_currentEditCellLayout",null),ea(this,"_currentEditCellState$",new k.BehaviorSubject(null)),ea(this,"currentEditCellState$",this._currentEditCellState$.asObservable()),ea(this,"_currentEditCellLayout$",new k.BehaviorSubject(null)),ea(this,"currentEditCellLayout$",this._currentEditCellLayout$.asObservable()),ea(this,"currentEditCell$",this._currentEditCellState$.pipe((0,Z.switchMap)(e=>this._currentEditCellLayout$.pipe((0,L.map)(t=>e&&t?{...e,...t}:null))))),ea(this,"_visible$",new k.BehaviorSubject(this._visible)),ea(this,"visible$",this._visible$.asObservable()),ea(this,"_afterVisible$",new k.BehaviorSubject(this._visible)),ea(this,"afterVisible$",this._afterVisible$.asObservable()),ea(this,"interceptor",new O.InterceptorManager({BEFORE_CELL_EDIT:tP,AFTER_CELL_EDIT:tM,AFTER_CELL_EDIT_ASYNC:tO})),this._renderManagerService=e,this._themeService=t,this._univerInstanceService=i,this._editorService=n,this._refSelectionsService=r,this._contextService=o,this.disposeWithMe((0,O.toDisposable)(()=>{this._currentEditCellState$.complete(),this._currentEditCell=null})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().AFTER_CELL_EDIT,{priority:-1,handler:/* @__PURE__ */el(e=>e,"handler")})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().BEFORE_CELL_EDIT,{priority:-1,handler:/* @__PURE__ */el(e=>e,"handler")})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().AFTER_CELL_EDIT_ASYNC,{priority:-1,handler:/* @__PURE__ */el(e=>e,"handler")})),this._univerInstanceService.getTypeOfUnitDisposed$(O.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{var t;e.getUnitId()===(null==(t=this._currentEditCellState)?void 0:t.unitId)&&this._clearCurrentEditCellState()})}refreshEditCellState(){let e=this.getLatestEditCellState();if(!e){this._currentEditCellState=null,this._currentEditCellLayout=null,this._currentEditCellState$.next(null),this._currentEditCellLayout$.next(null);return}let{position:t,scaleX:i,scaleY:n,canvasOffset:r,...o}=e;this._currentEditCellState=o,this._currentEditCellLayout={position:t,scaleX:i,scaleY:n,canvasOffset:r},this._currentEditCellState$.next(this._currentEditCellState),this._currentEditCellLayout$.next(this._currentEditCellLayout)}refreshEditCellPosition(e){var t;let i=this._currentEditCell;if(null==i)return;let n=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_SHEET);if(!n)return;let r=null==(t=n.with(ev).getWorksheetSkeleton(i.sheetId))?void 0:t.skeleton,o=n.with(ez);if(!r||!this._currentEditCellState)return;let{primary:s,unitId:l,sheetId:a,scene:d,engine:c}=i,u=ej(s,r);if(null==u)return;let h=(0,O.makeCellToSelection)(u),m=(0,M.getCanvasOffsetByEngine)(c),{startX:g,startY:p,endX:v,endY:S}=h,{scaleX:f,scaleY:C}=d.getAncestorScale(),I=d.getViewportScrollXY(o.getViewPort());g=r.convertTransformToOffsetX(g,f,I),p=r.convertTransformToOffsetY(p,C,I),v=r.convertTransformToOffsetX(v,f,I),S=r.convertTransformToOffsetY(S,C,I),e&&this._currentEditCellLayout&&(v=v-g+this._currentEditCellLayout.position.startX,S=S-p+this._currentEditCellLayout.position.startY,g=this._currentEditCellLayout.position.startX,p=this._currentEditCellLayout.position.startY),this._editorService.setOperationSheetUnitId(l),this._editorService.setOperationSheetSubUnitId(a),this._currentEditCellLayout={position:{startX:g,startY:p,endX:v,endY:S},canvasOffset:m,scaleX:f,scaleY:C},this._currentEditCellLayout$.next(this._currentEditCellLayout)}setEditCell(e){this._currentEditCell=e,this._editorService.getFocusEditor()||(this._editorService.focus(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),this._contextService.setContextValue(O.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(O.FOCUSING_EDITOR_STANDALONE,!1),this._contextService.setContextValue(O.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE,!1));let t=this.getLatestEditCellState();if(!t){this._currentEditCellState=t,this._currentEditCellLayout=t,this._currentEditCellState$.next(t),this._currentEditCellLayout$.next(t);return}let{position:i,canvasOffset:n,scaleX:r,scaleY:o,...s}=t;this._currentEditCellState=s,this._currentEditCellLayout={position:i,canvasOffset:n,scaleX:r,scaleY:o},this._currentEditCellState$.next(this._currentEditCellState),this._currentEditCellLayout$.next(this._currentEditCellLayout)}_clearCurrentEditCellState(){this._currentEditCellState=null,this._currentEditCellState$.next(null),this._currentEditCellLayout=null,this._currentEditCellLayout$.next(null)}getEditCellState(){return null==this._currentEditCellState||null==this._currentEditCellLayout?null:{...this._currentEditCellState,...this._currentEditCellLayout}}getEditCellLayout(){return this._currentEditCellLayout}getEditLocation(){return this._currentEditCellState}getLatestEditCellState(){var e,t,i;let n;let r=this._currentEditCell;if(null==r)return;let o=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_SHEET);if(!o)return;let s=o.with(ev).getCurrentSkeleton(),l=o.with(ez);if(!s)return;let{primary:a,unitId:d,sheetId:c,scene:u,engine:h}=r,{startRow:m,startColumn:g}=a,p=ej(a,s);if(null==p)return;let v=(0,O.makeCellToSelection)(p),S=(0,M.getCanvasOffsetByEngine)(h),{startX:f,startY:C,endX:I,endY:b}=v,{scaleX:_,scaleY:R}=u.getAncestorScale(),y=u.getViewportScrollXY(l.getViewPort());f=s.convertTransformToOffsetX(f,_,y),C=s.convertTransformToOffsetY(C,R,y),I=s.convertTransformToOffsetX(I,_,y),b=s.convertTransformToOffsetY(b,R,y);let T=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),E=T.getActiveSheet();if(!E)return;let w={workbook:T,worksheet:E,unitId:T.getUnitId(),subUnitId:E.getSheetId(),row:m,col:g,origin:E.getCellRaw(m,g)},P=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().BEFORE_CELL_EDIT)(E.getCell(m,g),w),A=null==(e=null==(n=P&&s.getCellDocumentModelWithFormula(P))?void 0:n.documentModel)?void 0:e.documentStyle.renderConfig;if(null!=A&&(A.cellValueType=O.CellValueType.STRING),!n||null==n.documentModel){let e=s.getBlankCellDocumentModel(P);if(null!=n){let{verticalAlign:t,horizontalAlign:i,wrapStrategy:r,textRotation:o,fill:s}=n,{centerAngle:l,vertexAngle:a}=(0,x.convertTextRotation)(o);e.documentModel.documentStyle.renderConfig={verticalAlign:t,horizontalAlign:i,wrapStrategy:r,background:{rgb:s},centerAngle:l,vertexAngle:a}}n=e}if(n.fill=n.fill||"#fff",null==(t=n.documentModel)||t.setZoomRatio(Math.max(_,R)),(null==P?void 0:P.isInArrayFormulaRange)===!0){let e=null==(i=n.documentModel)?void 0:i.getBody();e&&(e.textRuns=[{st:0,ed:e.dataStream.length-2,ts:{cl:{rgb:this._themeService.getCurrentTheme().textColorSecondary}}}])}return this._editorService.setOperationSheetUnitId(d),this._editorService.setOperationSheetSubUnitId(c),{position:{startX:f,startY:C,endX:I,endY:b},scaleX:_,scaleY:R,canvasOffset:S,row:m,column:g,unitId:d,sheetId:c,documentLayoutObject:n,editorUnitId:this._editorUnitId,isInArrayFormulaRange:null==P?void 0:P.isInArrayFormulaRange}}getCurrentEditorId(){return this._editorUnitId}changeVisible(e){let t=this._editorService.getFocusEditor();this._refSelectionsService.getCurrentSelections().length>0&&t&&!t.isSheetEditor()||(this._visible=e,e.visible&&(this._editorIsDirty=!1),this._visible$.next(this._visible),this._afterVisible$.next(this._visible))}isVisible(){return this._visible}enableForceKeepVisible(){this._isForceKeepVisible=!0}disableForceKeepVisible(){this._isForceKeepVisible=!1}isForceKeepVisible(){return this._isForceKeepVisible}changeEditorDirty(e){this._editorIsDirty=e}getEditorDirty(){return this._editorIsDirty}async beforeSetRangeValue(e,t,i,n,r){let o={subUnitId:t.getSheetId(),unitId:e.getUnitId(),workbook:e,worksheet:t,row:i,col:n,origin:(0,O.Tools).deepClone(r)},s=this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().AFTER_CELL_EDIT)(r,o);return await this.interceptor.fetchThroughInterceptors(this.interceptor.getInterceptPoints().AFTER_CELL_EDIT_ASYNC)(Promise.resolve(s),o)}},el(iK,"EditorBridgeService"),iK);tx=tE([tw(0,x.IRenderManagerService),tw(1,(0,O.Inject)(O.ThemeService)),tw(2,O.IUniverInstanceService),tw(3,M.IEditorService),tw(4,A.IRefSelectionsService),tw(5,O.IContextService)],tx);let tA=(0,O.createIdentifier)("univer.sheet-editor-bridge.service");function tk(e){return e.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).pipe((0,Z.switchMap)(e=>e?e.activeSheet$.pipe((0,L.map)(t=>t?{workbook:e,worksheet:t}:null)):(0,j.of)(null)))}function tN(e,t,i){return tk(e).pipe((0,Z.switchMap)(e=>e?i(e):(0,j.of)(t)))}function tD(e,t){let i=e.get(O.IUniverInstanceService),n=e.get(A.IExclusiveRangeService),r=e.get(A.SheetsSelectionsService);return i.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).pipe((0,Z.switchMap)(e=>e?(0,N.combineLatest)([r.selectionMoveEnd$,e.activeSheet$]).pipe((0,Z.switchMap)(([e,i])=>{if(!i||0===e.length)return(0,j.of)(!1);let r=n.getInterestGroupId(e);if(!t)return(0,j.of)(r.length>0);{let e=r.filter(e=>t.has(e));return(0,j.of)(e.length>0)}})):(0,j.of)(!1)))}function tV(e,t,i){return(0,N.combineLatest)([t,tD(e,i)]).pipe((0,L.map)(([e,t])=>e||t))}function tW(e,t={},i=!1){var n;let r=e.get(O.IUniverInstanceService).getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),o=e.get(O.UserManagerService),s=e.has(tA)?e.get(tA):null,l=e.get(O.IContextService).subscribeContextValue$(O.FOCUSING_FX_BAR_EDITOR),a=null!=(n=null==s?void 0:s.visible$)?n:(0,j.of)(null);return(0,N.combineLatest)([o.currentUser$,r,a,l]).pipe((0,Z.switchMap)(([n,r,o,s])=>r&&(null==o||!o.visible||o.unitId!==r.getUnitId()||i)&&(!s||i)?r.activeSheet$.pipe((0,Z.switchMap)(i=>{if(!i)return(0,j.of)(!0);let n=e.get(A.SheetsSelectionsService),o=e.get(A.RangeProtectionRuleModel),s=e.get(A.WorksheetProtectionRuleModel),l=e.get(O.IContextService).subscribeContextValue$(O.FOCUSING_COMMON_DRAWINGS).pipe((0,X.startWith)(!1));return(0,N.combineLatest)([n.selectionMoveEnd$,l]).pipe((0,Z.switchMap)(([n,l])=>{if(l)return(0,j.of)(!0);let a=r.getUnitId(),d=i.getSheetId(),c=e.get(O.IPermissionService),{workbookTypes:u=[A.WorkbookEditablePermission],worksheetTypes:h,rangeTypes:m}=t,g=[];if(null==u||u.forEach(e=>{g.push(new e(a).id)}),null==h||h.forEach(e=>{g.push(new e(a,d).id)}),s.getRule(a,d))return c.composePermission$(g).pipe((0,L.map)(e=>e.some(e=>!1===e.value)));let p=null==n?void 0:n.map(e=>e.range),v=o.getSubunitRuleList(a,d).filter(e=>null==p?void 0:p.some(t=>e.ranges.some(e=>(0,O.Rectangle).intersects(t,e))));return null==m||m.forEach(e=>{v.forEach(t=>{g.push(new e(a,d,t.permissionId).id)})}),c.composePermission$(g).pipe((0,L.map)(e=>e.some(e=>!1===e.value)))}))})):(0,j.of)(!0)))}function tH(e){let t=e.get(O.IUniverInstanceService),i=e.get(A.SheetsSelectionsService),n=e.get(A.RangeProtectionRuleModel),r=e.get(O.IPermissionService);return(0,B.merge)(i.selectionMoveEnd$,r.permissionPointUpdate$.pipe((0,V.debounceTime)(100))).pipe((0,L.map)(()=>{var e;let o=null==(e=i.getCurrentLastSelection())?void 0:e.range;if(!o)return!0;let s=t.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),l=null==s?void 0:s.getActiveSheet();if(!s||!l)return!0;let a=s.getUnitId(),d=l.getSheetId(),c=[new A.WorkbookEditablePermission(a).id,new A.WorksheetEditPermission(a,d).id];return n.getSubunitRuleList(a,d).filter(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(o,e))).forEach(e=>{c.push(new A.RangeProtectionPermissionEditPoint(a,d,e.permissionId).id)}),r.composePermission(c).some(e=>!1===e.value)}))}function tU(e,t){let i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(A.RangeProtectionRuleModel),o=e.get(O.IPermissionService);return(0,B.merge)(n.selectionMoveEnd$,o.permissionPointUpdate$.pipe((0,V.debounceTime)(100))).pipe((0,L.map)(()=>{var e;let s=null==(e=n.getCurrentLastSelection())?void 0:e.range;if(!s)return!0;let l=i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),a=null==l?void 0:l.getActiveSheet();if(!l||!a)return!0;let d=l.getUnitId(),c=a.getSheetId(),u=[new A.WorkbookEditablePermission(d).id,new A.WorksheetEditPermission(d,c).id];return r.getSubunitRuleList(d,c).filter(e=>"row"===t?e.ranges.some(e=>s.endRow>e.startRow&&s.endRow<=e.endRow):e.ranges.some(e=>s.endColumn>e.startColumn&&s.endColumn<=e.endColumn)).forEach(e=>{u.push(new A.RangeProtectionPermissionEditPoint(d,c,e.permissionId).id)}),o.composePermission(u).some(e=>!1===e.value)}))}function tL(e,t){let i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(A.RangeProtectionRuleModel),o=e.get(O.IPermissionService);return(0,B.merge)(n.selectionMoveEnd$,o.permissionPointUpdate$.pipe((0,V.debounceTime)(100))).pipe((0,L.map)(()=>{var e;let s=null==(e=n.getCurrentLastSelection())?void 0:e.range;if(!s)return!0;let l=i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),a=null==l?void 0:l.getActiveSheet();if(!l||!a)return!0;let d=l.getUnitId(),c=a.getSheetId(),u=[new A.WorkbookEditablePermission(d).id,new A.WorksheetEditPermission(d,c).id];return r.getSubunitRuleList(d,c).filter(e=>"row"===t?e.ranges.some(e=>s.startRow>e.startRow&&s.startRow<=e.endRow):e.ranges.some(e=>s.startColumn>e.startColumn&&s.startColumn<=e.endColumn)).forEach(e=>{u.push(new A.RangeProtectionPermissionEditPoint(d,c,e.permissionId).id)}),o.composePermission(u).some(e=>!1===e.value)}))}function tB(e,t){let i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(A.RangeProtectionRuleModel),o=e.get(O.IPermissionService);return(0,B.merge)(n.selectionMoveEnd$,o.permissionPointUpdate$.pipe((0,V.debounceTime)(100))).pipe((0,L.map)(()=>{var e;let s=null==(e=n.getCurrentLastSelection())?void 0:e.range;if(!s)return!0;let l=i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),a=null==l?void 0:l.getActiveSheet();if(!l||!a)return!0;let d=l.getUnitId(),c=a.getSheetId(),u=[new A.WorkbookEditablePermission(d).id,new A.WorksheetEditPermission(d,c).id],h=(0,O.Tools).deepClone(s);return"row"===t?(h.startColumn=0,h.endColumn=a.getColumnCount()-1):(h.startRow=0,h.endRow=a.getRowCount()-1),r.getSubunitRuleList(d,c).filter(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(h,e))).forEach(e=>{u.push(new A.RangeProtectionPermissionEditPoint(d,c,e.permissionId).id)}),o.composePermission(u).some(e=>!1===e.value)}))}function tF(e,t){let i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(A.RangeProtectionRuleModel),o=e.get(O.IPermissionService);return(0,B.merge)(n.selectionMoveEnd$,o.permissionPointUpdate$.pipe((0,V.debounceTime)(100))).pipe((0,L.map)(()=>{var e;let s=null==(e=n.getCurrentLastSelection())?void 0:e.range;if(!s)return!0;let l=i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),a=null==l?void 0:l.getActiveSheet();if(!l||!a)return!0;let d=l.getUnitId(),c=a.getSheetId(),u=[new A.WorkbookEditablePermission(d).id,new A.WorksheetEditPermission(d,c).id],h=(0,O.Tools).deepClone(s);return"row"===t?h.endRow=a.getRowCount()-1:h.endColumn=a.getColumnCount()-1,r.getSubunitRuleList(d,c).filter(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(h,e))).forEach(e=>{u.push(new A.RangeProtectionPermissionEditPoint(d,c,e.permissionId).id)}),o.composePermission(u).some(e=>!1===e.value)}))}function tj(e,t){let i=e.get(O.IUniverInstanceService).getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),n=e.get(A.WorksheetProtectionRuleModel),r=e.get(A.RangeProtectionRuleModel),o=e.get(O.IPermissionService),s=e.get(O.UserManagerService);return(0,N.combineLatest)([s.currentUser$,i]).pipe((0,Z.switchMap)(([e,i])=>i?i.activeSheet$.pipe((0,Z.switchMap)(e=>{if(!e)return(0,j.of)(!0);let s=i.getUnitId(),l=[];return t.forEach(e=>l.push(new e(s).id)),o.composePermission$(l).pipe((0,L.map)(e=>e.every(e=>!0===e.value))).pipe((0,L.map)(t=>{if(!t)return!0;let i=e.getSheetId(),o=n.getRule(s,i),l=r.getSubunitRuleList(s,i);return!!(o||l.length)}))})):(0,j.of)(!0)))}el(tk,"getActiveSheet$"),el(tN,"deriveStateFromActiveSheet$"),el(tD,"getCurrentExclusiveRangeInterest$"),el(tV,"getObservableWithExclusiveRange$"),el(tW,"getCurrentRangeDisable$"),el(tH,"getBaseRangeMenuHidden$"),el(tU,"getInsertAfterMenuHidden$"),el(tL,"getInsertBeforeMenuHidden$"),el(tB,"getDeleteMenuHidden$"),el(tF,"getCellMenuHidden$"),el(tj,"getWorkbookPermissionDisable$");var tz=Object.defineProperty,tX=Object.getOwnPropertyDescriptor,tY=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?tX(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&tz(t,i,o),o},"__decorateClass$S"),tG=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$S");let tZ="univer-sheet-main-canvas",tK=(el(iq=class extends O.RxDisposable{constructor(e,t,i){super(),ea(this,"_skeletonChangeMutations",/* @__PURE__ */new Set),this._contextService=e,this._instanceSrv=t,this._renderManagerService=i,Promise.resolve().then(()=>this._init())}registerSkeletonChangingMutations(e){return this._skeletonChangeMutations.has(e)?(0,O.toDisposable)(()=>{}):(this._skeletonChangeMutations.add(e),(0,O.toDisposable)(()=>this._skeletonChangeMutations.delete(e)))}checkMutationShouldTriggerRerender(e){return this._skeletonChangeMutations.has(e)}_init(){this._initWorkbookListener(),this._initContextListener()}_initWorkbookListener(){this._instanceSrv.getTypeOfUnitAdded$(O.UniverInstanceType.UNIVER_SHEET).pipe((0,K.takeUntil)(this.dispose$)).subscribe(e=>this._createRenderer(e)),this._instanceSrv.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET).forEach(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitDisposed$(O.UniverInstanceType.UNIVER_SHEET).pipe((0,K.takeUntil)(this.dispose$)).subscribe(e=>this._disposeRenderer(e))}_createRenderer(e){let t=e.getUnitId();this._renderManagerService.created$.subscribe(e=>{e.unitId===t&&(e.engine.getCanvas().setId(`${tZ}_${t}`),e.engine.getCanvas().getContext().setId(`${tZ}_${t}`))}),this._renderManagerService.createRender(t),this._renderManagerService.setCurrent(t)}_disposeRenderer(e){let t=e.getUnitId();this._renderManagerService.removeRender(t)}_initContextListener(){this.disposeWithMe(this._contextService.subscribeContextValue$(x.RENDER_RAW_FORMULA_KEY).pipe((0,W.distinctUntilChanged)()).subscribe(()=>{this._renderManagerService.getRenderAll().forEach(e=>{e.mainComponent instanceof x.Spreadsheet&&e.mainComponent.makeForceDirty(!0)})}))}},"SheetsRenderService"),iq);tK=tY([tG(0,O.IContextService),tG(1,O.IUniverInstanceService),tG(2,x.IRenderManagerService)],tK);let tq=/* @__PURE__ */el((e,t)=>{var i,n,r,o,s;let l=t.findNodePositionByCharIndex(e.startOffset,!1,e.segmentId,-1),a=t.getSkeletonData(),d=e.endOffset;if(e.segmentId){let t=null!=(s=Array.from(null!=(n=null==(i=null==a?void 0:a.skeFooters.get(e.segmentId))?void 0:i.values())?n:[])[0])?s:Array.from(null!=(o=null==(r=null==a?void 0:a.skeHeaders.get(e.segmentId))?void 0:r.values())?o:[])[0];t&&(d=Math.min(t.ed,d))}let c=t.findNodePositionByCharIndex(d,!1,e.segmentId,-1);if(!c||!l)return;let{borderBoxPointGroup:u}=new M.NodePositionConvertToCursor({docsLeft:0,docsTop:0,pageMarginLeft:0,pageMarginTop:0},t).getRangePointData(l,c);return(0,M.getLineBounding)(u).map(e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right}))},"calcDocRangePositions"),tQ=/* @__PURE__ */el((e,t,i=-1)=>{let n=t.findPositionByGlyph(e,i);if(!n)return;let r={...n,isBack:!0},{borderBoxPointGroup:o}=new M.NodePositionConvertToCursor({docsLeft:0,docsTop:0,pageMarginLeft:0,pageMarginTop:0},t).getRangePointData(r,r),s=(0,M.getLineBounding)(o)[0];return{top:s.top,bottom:s.bottom,left:s.left,right:s.right}},"calcDocGlyphPosition"),tJ=/* @__PURE__ */el((e,t,i=0,n=0)=>{let r=tq({startOffset:t.startIndex,endOffset:t.endIndex+1,collapsed:!1},e);if(r)return{rects:r.map(e=>({top:e.top+n,bottom:e.bottom+n,left:e.left+i,right:e.right+i})),range:t}},"calcLinkPosition"),t$=/* @__PURE__ */el((e,t,i=0,n=0)=>{var r,o,s;let l=e.findNodeByCharIndex(t.startIndex),a=null==l?void 0:l.parent,d=null==a?void 0:a.parent,c=null==d?void 0:d.parent,u=null==c?void 0:c.lines.find(e=>e.paragraphStart&&e.paragraphIndex===t.startIndex),h=null==(s=null==(o=null==(r=null==u?void 0:u.divides)?void 0:r[0])?void 0:o.glyphGroup)?void 0:s[0];if(!h||!h)return;let m=tQ(h,e);if(m)return{rect:{top:m.top+n,bottom:m.bottom+n,left:m.left+i,right:m.right+i},segmentId:void 0,segmentPageIndex:-1,paragraph:t}},"calcBulletPosition"),t0=/* @__PURE__ */el((e,t=0,i=0)=>{var n,r,o,s,l,a;let d=e.getViewModel().getDataModel(),c=null!=(o=null==(r=null==(n=d.getBody())?void 0:n.customRanges)?void 0:r.filter(e=>e.rangeType===O.CustomRangeType.HYPERLINK))?o:[],u=null!=(a=null==(l=null==(s=d.getBody())?void 0:s.paragraphs)?void 0:l.filter(e=>{var t;return(null==(t=e.bullet)?void 0:t.listType.indexOf(O.PresetListType.CHECK_LIST))===0}))?a:[];return{links:c.map(n=>tJ(e,n,t,i)).filter(Boolean),checkLists:u.map(n=>t$(e,n,t,i)).filter(Boolean)}},"calculateDocSkeletonRects");function t1(e,t){var i,n,r,o;let s=null!=(n=null==(i=t.documentSkeleton.getSkeletonData())?void 0:i.pages[0].height)?n:0,l=null!=(o=null==(r=t.documentSkeleton.getSkeletonData())?void 0:r.pages[0].width)?o:0,a=t.verticalAlign,d=t.horizontalAlign,c=0;switch(a){case O.VerticalAlign.UNSPECIFIED:case O.VerticalAlign.BOTTOM:c=e.mergeInfo.endY-e.mergeInfo.startY-s;break;case O.VerticalAlign.MIDDLE:c=(e.mergeInfo.endY-e.mergeInfo.startY-s)/2}let u=0;switch(d){case O.HorizontalAlign.RIGHT:u=e.mergeInfo.endX-e.mergeInfo.startX-l;break;case O.HorizontalAlign.CENTER:u=(e.mergeInfo.endX-e.mergeInfo.startX-l)/2}return{paddingLeft:u,paddingTop:c}}el(t1,"calcPadding");let t2=/* @__PURE__ */el((e,t,i,n,r,o)=>{var s,l,a;let d=e.get(O.IUniverInstanceService),c=e.get(x.IRenderManagerService),u=d.getUnit(t,O.UniverInstanceType.UNIVER_SHEET);if(!u)return null;let h=u.getSheetBySheetId(i);if(!h)return null;let m=c.getRenderById(u.getUnitId()),g=null==m?void 0:m.with(ev).getWorksheetSkeleton(h.getSheetId()),p=null==g?void 0:g.skeleton;if(!p||!m)return;let v=p.getFont(n,r),S=null==v?void 0:v.documentSkeleton;if(!S)return null;let f=null==(l=null==(s=S.getViewModel().getBody())?void 0:s.customRanges)?void 0:l.find(e=>e.rangeId===o);if(!f)return null;let C=M.DOC_VERTICAL_PADDING,{actualColumn:I,actualRow:b}=p.getCellByIndex(n,r);p.overflowCache.forValue((e,t,i)=>{i.startRow<=b&&i.endRow>=b&&i.startColumn<=I&&i.endColumn>=I&&(I=t,b=e)});let _=p.getCellByIndex(b,I),R=h.getCell(_.actualRow,_.actualColumn),{topOffset:y=0,leftOffset:T=0}=null!=(a=null==R?void 0:R.fontRenderExtension)?a:{},{paddingLeft:E,paddingTop:w}=t1(_,v),P=tq({startOffset:f.startIndex,endOffset:f.endIndex,collapsed:!1},S);return{rects:null==P?void 0:P.map(e=>({top:e.top+_.mergeInfo.startY+w+y+C,bottom:e.bottom+_.mergeInfo.startY+w+y+C,left:e.left+_.mergeInfo.startX+E+T,right:e.right+_.mergeInfo.startX+E+T})),customRange:f,label:S.getViewModel().getBody().dataStream.slice(f.startIndex+1,f.endIndex)}},"getCustomRangePosition"),t5=/* @__PURE__ */el((e,t,i,n,r,o)=>{var s,l,a;let d=e.get(tA),c=d.getEditCellState();if(!c||!d.isVisible().visible)return null;let{editorUnitId:u,unitId:h,sheetId:m,row:g,column:p}=c;if(t!==h||i!==m||g!==n||p!==r)return null;let v=e.get(x.IRenderManagerService),S=v.getRenderById(u),f=v.getRenderById(t);if(!S||!f)return null;let C=S.with($.DocSkeletonManagerService).getSkeleton(),I=null==(s=f.with(ev).getWorksheetSkeleton(m))?void 0:s.skeleton;if(!C||!I)return null;let b=null==(a=null==(l=C.getViewModel().getBody())?void 0:l.customRanges)?void 0:a.find(e=>e.rangeId===o);if(!b)return null;let _=tq({startOffset:b.startIndex,endOffset:b.endIndex,collapsed:!1},C),R=S.engine.getCanvasElement().getBoundingClientRect();return{rects:null==_?void 0:_.map(e=>({top:e.top+R.top-4,bottom:e.bottom+R.top+4,left:e.left+R.left,right:e.right+R.left})),customRange:b,label:C.getViewModel().getBody().dataStream.slice(b.startIndex+1,b.endIndex)}},"getEditingCustomRangePosition");var t9=Object.defineProperty,t6=Object.getOwnPropertyDescriptor,t3=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?t6(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&t9(t,i,o),o},"__decorateClass$R"),t7=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$R");let t4=["ff","fs","tr","tb"],t8=(iQ=class extends O.Disposable{constructor(e,t,i,n){super(),this._renderManagerService=e,this._sheetInterceptorService=t,this._selectionManagerService=i,this._univerInstanceService=n,this._initialize()}getUndoRedoParamsOfAutoHeight(e){let{_univerInstanceService:t}=this,i=t.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),n=i.getActiveSheet(),r=i.getUnitId(),o=n.getSheetId(),s=this._renderManagerService.getRenderById(r).with(ev);if(!o||!s.getCurrent())return{redos:[],undos:[]};let{skeleton:l}=s.getCurrent(),a={subUnitId:o,unitId:r,rowsAutoHeightInfo:l.calculateAutoHeightInRange(e)},d=(0,A.SetWorksheetRowAutoHeightMutationFactory)(a,n);return{undos:[{id:A.SetWorksheetRowAutoHeightMutation.id,params:d}],redos:[{id:A.SetWorksheetRowAutoHeightMutation.id,params:a}]}}_initialize(){let{_sheetInterceptorService:e,_selectionManagerService:t}=this;this.disposeWithMe(e.interceptCommand({getMutations:/* @__PURE__ */el(e=>e.id!==A.SetRangeValuesCommand.id?{redos:[],undos:[]}:this.getUndoRedoParamsOfAutoHeight(e.params.range),"getMutations")})),this.disposeWithMe(e.interceptCommand({getMutations:/* @__PURE__ */el(e=>e.id!==A.SetWorksheetRowIsAutoHeightCommand.id?{redos:[],undos:[]}:this.getUndoRedoParamsOfAutoHeight(e.params.ranges),"getMutations")})),this.disposeWithMe(e.interceptCommand({getMutations:/* @__PURE__ */el(e=>{var i,n;if(e.id!==A.SetStyleCommand.id||!t4.includes(null==(i=e.params)?void 0:i.style.type))return{redos:[],undos:[]};let r=null==(n=t.getCurrentSelections())?void 0:n.map(e=>e.range);return null!=r&&r.length?this.getUndoRedoParamsOfAutoHeight(r):{redos:[],undos:[]}},"getMutations")}))}},el(iQ,"AutoHeightController"),iQ);function ie(e,t,i,n){let r=t.get(O.IUniverInstanceService),o=i?r.getUnit(i,O.UniverInstanceType.UNIVER_SHEET):r.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),s=n?null==o?void 0:o.getSheetBySheetId(n):null==o?void 0:o.getActiveSheet();if(!s)return null;let{startRow:l,endRow:a,startColumn:d,endColumn:c}=e,u=[],h=[];for(let e=l;e<=a;e++)s.getRowFiltered(e)||u.push(e);for(let e=d;e<=c;e++)h.push(e);return{rows:u,cols:h}}function it(e){let{rows:t,cols:i}=e;return{startRow:t[0],endRow:t[t.length-1],startColumn:i[0],endColumn:i[i.length-1]}}function ii(e){let t=[],i=[],n=[];return e.forEach(e=>{t.push(...e.rows),i.push(...e.cols)}),t=Array.from(new Set(t)).sort((e,t)=>e-t),i=Array.from(new Set(i)).sort((e,t)=>e-t),e.forEach(e=>{n.push({startRow:t.findIndex(t=>t===e.rows[0]),endRow:t.findIndex(t=>t===e.rows[e.rows.length-1]),startColumn:i.findIndex(t=>t===e.cols[0]),endColumn:i.findIndex(t=>t===e.cols[e.cols.length-1])})}),{ranges:n,mapFunc:/* @__PURE__ */el((e,n)=>({row:t[e],col:i[n]}),"mapFunc")}}function ir(e){let t=new O.ObjectMatrix;return e.forEach(e=>{let{rows:i,cols:n}=e;i.forEach(e=>{n.forEach(i=>{t.setValue(e,i,{v:null,p:null,f:null,si:null,custom:null})})})}),t.getData()}t8=t3([t7(0,x.IRenderManagerService),t7(1,(0,O.Inject)(A.SheetInterceptorService)),t7(2,(0,O.Inject)(A.SheetsSelectionsService)),t7(3,(0,O.Inject)(O.IUniverInstanceService))],t8),el(ie,"rangeToDiscreteRange"),el(it,"discreteRangeToRange"),el(ii,"virtualizeDiscreteRanges"),el(ir,"generateNullCellValueRowCol");let io={:0,:1,:2,:3,:4,:5,:6,:7,:8,:9},is=["","","","","","","","","",""],il=["","","","",""],ia=["","","",""],id={:{value:10,secUnit:!1},:{value:100,secUnit:!1},:{value:1e3,secUnit:!1},:{value:1e4,secUnit:!0},:{value:1e8,secUnit:!0}};function ic(e){if(!e)return 0;let t=0,i=0,n=0,r=e.split("");for(let e=0;e<r.length;e++){let o=io[r[e]];if("u">typeof o)n=o,e===r.length-1&&(i+=n);else{let o=id[r[e]],s=o.value;o.secUnit?(t+=i=(i+n)*s,i=0):i+=n*s,n=0}}return t+i}function iu(e){let t="",i=0,n=!0;for(;e>0;){let r=e%10;0===r?n||(n=!0,t=is[r]+t):(n=!1,t=is[r]+ia[i]+t),i++,e=Math.floor(e/10)}return t}function ih(e){let t=0,i="",n=!1;if(0===e)return"";for(;e>0;){let r=e%1e4;n&&(i=""+i),i=iu(r)+(0!==r?il[t]:"")+i,n=r<1e3&&r>0,e=Math.floor(e/1e4),t++}return i}function im(e){if(!e)return!1;let t=!0;if(e){if(1===e.length)t=""===e||e in io;else{let i=e.split("");for(let e=0;e<i.length;e++)if(!(i[e]in io||i[e]in id)){t=!1;break}}}return t}function ig(e){if(!e)return{isExtendNumber:!1};let t=/0|([1-9]+[0-9]*)/g,i=t.test(e);if(i){let i=e.match(t);if(i&&i.length>0){let t=i[i.length-1],n=e.lastIndexOf(t),r=e.substr(0,n),o=e.substr(n+t.length);return{isExtendNumber:!0,matchTxt:Number(t),beforeTxt:r,afterTxt:o}}return{isExtendNumber:!1}}return{isExtendNumber:i}}function ip(e){return 2===e.length&&(""===e||""===e||""===e||""===e||""===e||""===e||""===e)}function iv(e){return 3===e.length&&(""===e||""===e||""===e||""===e||""===e||""===e||""===e)}function iS(e,t){let i=0;for(let n=0;n<e.length&&e[n]<t;n++)i++;return i}function iC(e){let t=!0,i=e[1]-e[0];for(let n=1;n<e.length;n++)if(e[n]-e[n-1]!==i){t=!1;break}return t}function iI(e,t,i){let n=[],r=Math.floor(t/e),o=t%e,s=0;if(r>0){for(let t=0;t<r;t++)for(let r=0;r<i.length;r++)n[i[r]+t*e]=s,s++;for(let t=0;t<i.length&&i[t]<o;t++)n[i[t]+e*r]=s,s++}else for(let e=0;e<i.length&&i[e]<o;e++)n[i[e]]=s,s++;return n}function ib(e,t){let i=[];for(let n=1;n<=t;n++){let t=(n-1)%e.length,r=(0,O.Tools).deepClone(e[t]);i.push({v:null,s:null,p:null,f:null,si:null,t:null,...r})}return i}function i_(e,t){var i;let n=[];for(let r=1;r<=t;r++){let t=(r-1)%e.length,o={s:null==(i=e[t])?void 0:i.s};n.push(o)}return n}function iR(e){let t=!0,i=e[1]/e[0];for(let n=1;n<e.length;n++)if(e[n]/e[n-1]!==i){t=!1;break}return t}function iy(e){let t=[];for(let i=1;i<=e;i++)t.push(i);return t}function iT(e,t,i){var n,r,o,s;let l=[],a=[];for(let t=0;t<e.length;t++)a.push(Number(null==(n=e[t])?void 0:n.v));if(e.length>2&&iR(a))for(let i=1;i<=t;i++){let t=(i-1)%e.length,n=(0,O.Tools).deepClone(e[t]),a=Number(null==(r=e[e.length-1])?void 0:r.v)*(Number(null==(o=e[1])?void 0:o.v)/Number(null==(s=e[0])?void 0:s.v))**i;n&&(iD(n)&&(n.v=a),l.push(n))}else{let n=iy(e.length);for(let r=1;r<=t;r++){let t=(r-1)%e.length,o=(0,O.Tools).deepClone(e[t]),s=i===O.Direction.DOWN||i===O.Direction.RIGHT,d=iE(e.length+r,a,n,s);o&&(iD(o)&&(o.v=d),l.push(o))}}return l}function iE(e,t,i,n=!0){let r;function o(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t/e.length}el(o,"getAverage");let s=o(i),l=o(t),a=0,d=0;for(let e=0;e<i.length;e++)a+=(i[e]-s)*(t[e]-l),d+=(i[e]-s)*(i[e]-s);return Math.round((l-(r=0===d?n?1:-1:a/d)*s+r*e)*1e5)/1e5}function iw(e,t,i){var n;let r=[],o=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=t;s++){let t=(s-1)%e.length,l=(0,O.Tools).deepClone(e[t]),a=`${null==(n=e[e.length-1])?void 0:n.v}`,d=null==a?void 0:a.match(o),c=null==d?void 0:d[d.length-1],u=Math.abs(Number(c)+i*s);if(!a||!c)continue;let h=a.lastIndexOf(c),m=a.substr(0,h)+u.toString()+a.substr(h+c.length);l&&(l.v=m,r.push(l))}return r}function iP(e,t,i,n=0){var r,o;let s=[["","","","","","",""],["","","","","","",""],["","","","","","",""]];if(n>=s.length)return[];let l=s[n],a=[];for(let n=1;n<=t;n++){let t=(n-1)%e.length,s=(0,O.Tools).deepClone(e[t]),d=0;if((null==(r=e[e.length-1])?void 0:r.v)===l[0])d=7+i*n;else{let t=`${null==(o=e[e.length-1])?void 0:o.v}`;t&&(d=ic(t.substr(t.length-1,1))+i*n)}d<0&&(d=7*Math.ceil(Math.abs(d)/7)+d);let c=d%7;s&&(s.v=l[c],a.push(s))}return a}function iM(e,t,i){var n;let r=[];for(let o=1;o<=t;o++){let t;let s=(o-1)%e.length,l=(0,O.Tools).deepClone(e[s]),a=ic(`${null==(n=e[e.length-1])?void 0:n.v}`)+i*o;t=a<=0?"":ih(a),l&&(l.v=t,r.push(l))}return r}el(ic,"chineseToNumber"),el(iu,"sectionToChinese"),el(ih,"numberToChinese"),el(im,"isChnNumber"),el(ig,"matchExtendNumber"),el(ip,"isChnWeek2"),el(iv,"isChnWeek3"),el(iS,"getLenS"),el(iC,"isEqualDiff"),el(iI,"getDataIndex"),el(ib,"fillCopy"),el(i_,"fillCopyStyles"),el(iR,"isEqualRatio"),el(iy,"getXArr"),el(iT,"fillSeries"),el(iE,"forecast"),el(iw,"fillExtendNumber"),el(iP,"fillChnWeek"),el(iM,"fillChnNumber");let iO={enWeek1:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],enWeek2:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],enMonth1:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],enMonth2:["January","February","March","April","May","June","July","August","September","October","November","December"],chnMonth1:["","","","","","","","","","","",""],chnMonth2:["","","","","","","","","","","",""],chHour1:["","","","","","","","","","","",""],chHour2:["","","","","","","","","","","",""],chYear1:["","","","","","","","","",""],chSeason1:["","","",""],chSeason2:["","","",""]};function ix(e){let t=!1;return Object.keys(iO).forEach(i=>{iO[i].includes(e)&&(t=!0)}),t}function iA(e){let t="",i=[];return Object.keys(iO).forEach(n=>{iO[n].includes(e)&&(t=n,i.push(...iO[n]))}),{name:t,series:i}}function ik(e,t,i,n){var r;let o=n.length,s=[];for(let l=1;l<=t;l++){let t=(l-1)%e.length,a=(0,O.Tools).deepClone(e[t]),d=`${null==(r=e[e.length-1])?void 0:r.v}`,c=n.indexOf(d)+i*l;c<0&&(c+=Math.abs(i)*o);let u=c%o;a&&(a.v=n[u],s.push(a))}return s}function iN(e,t){let i;let n=[];if(t.startRow<e.startRow)i=O.Direction.UP;else if(t.endRow>e.endRow)i=O.Direction.DOWN;else if(t.startColumn<e.startColumn)i=O.Direction.LEFT;else{if(!(t.endColumn>e.endColumn))return[];i=O.Direction.RIGHT}if(i===O.Direction.DOWN||i===O.Direction.UP){let r=e.endRow-e.startRow+1,o=t.endRow-t.startRow+1,s=Math.floor(o/r),l=o%r,a={startRow:0,startColumn:0,endRow:e.endRow-e.startRow,endColumn:e.endColumn-e.startColumn};if(i===O.Direction.DOWN){for(let t=0;t<s;t++)n.push({repeatStartCell:{row:e.startRow+(t+1)*r,col:e.startColumn},relativeRange:a});l>0&&n.push({repeatStartCell:{row:e.startRow+(s+1)*r,col:e.startColumn},relativeRange:{startRow:0,startColumn:0,endRow:l-1,endColumn:e.endColumn-e.startColumn}})}else{for(let t=0;t<s;t++)n.push({repeatStartCell:{row:e.startRow-(t+1)*r,col:e.startColumn},relativeRange:a});l>0&&n.push({repeatStartCell:{row:e.startRow-(s+1)*r,col:e.startColumn},relativeRange:{startRow:r-l,endRow:r-1,startColumn:0,endColumn:e.endColumn-e.startColumn}})}}if(i===O.Direction.RIGHT||i===O.Direction.LEFT){let r=e.endColumn-e.startColumn+1,o=t.endColumn-t.startColumn+1,s=Math.floor(o/r),l=o%r,a={startRow:0,startColumn:0,endRow:e.endRow-e.startRow,endColumn:e.endColumn-e.startColumn};if(i===O.Direction.RIGHT){for(let t=0;t<s;t++)n.push({repeatStartCell:{row:e.startRow,col:e.startColumn+(t+1)*r},relativeRange:a});l>0&&n.push({repeatStartCell:{row:e.startRow,col:e.startColumn+(s+1)*r},relativeRange:{startRow:0,startColumn:0,endRow:e.endRow-e.startRow,endColumn:l-1}})}else{for(let t=0;t<s;t++)n.push({repeatStartCell:{row:e.startRow,col:e.startColumn-(t+1)*r},relativeRange:a});l>0&&n.push({repeatStartCell:{row:e.startRow,col:e.startColumn-(s+1)*r},relativeRange:{startRow:0,startColumn:r-l,endRow:e.endRow-e.startRow,endColumn:r-1}})}}return n}function iD(e){return!((0,O.isFormulaString)(e.f)||(0,O.isFormulaId)(e.si)||e.t===O.CellValueType.BOOLEAN)}el(ix,"isLoopSeries"),el(iA,"getLoopSeriesInfo"),el(ik,"fillLoopSeries"),el(iN,"getAutoFillRepeatRange"),el(iD,"needsUpdateCellValue");var iV=((h=iV||{}).Append="APPEND",h.Default="DEFAULT",h.Only="ONLY",h),iW=((m=iW||{}).NUMBER="number",m.DATE="date",m.EXTEND_NUMBER="extendNumber",m.CHN_NUMBER="chnNumber",m.CHN_WEEK2="chnWeek2",m.CHN_WEEK3="chnWeek3",m.LOOP_SERIES="loopSeries",m.FORMULA="formula",m.OTHER="other",m),iH=((g=iH||{}).COPY="COPY",g.SERIES="SERIES",g.ONLY_FORMAT="ONLY_FORMAT",g.NO_FORMAT="NO_FORMAT",g);let iU={type:iW.DATE,priority:1100,match:/* @__PURE__ */el((e,t)=>{var i;if(null!=e&&e.f||null!=e&&e.si)return!1;if(("number"==typeof(null==e?void 0:e.v)||(null==e?void 0:e.t)===O.CellValueType.NUMBER)&&e.s){if("string"==typeof e.s){let n=t.get(O.IUniverInstanceService).getFocusedUnit().getStyles().get(e.s),r=null==(i=null==n?void 0:n.n)?void 0:i.pattern;if(r)return(0,O.numfmt).getInfo(r).isDate}else if(e.s.n&&(0,O.numfmt).getInfo(e.s.n.pattern).isDate)return!0}return!1},"match"),isContinue:/* @__PURE__ */el((e,t)=>e.type===iW.DATE,"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{let{data:n}=e;return i===O.Direction.LEFT||i===O.Direction.UP?(n.reverse(),iT(n,t,i).reverse()):iT(n,t,i)}}},iL={type:iW.NUMBER,priority:1e3,match:/* @__PURE__ */el(e=>"number"==typeof(null==e?void 0:e.v)||(null==e?void 0:e.t)===O.CellValueType.NUMBER,"match"),isContinue:/* @__PURE__ */el((e,t)=>e.type===iW.NUMBER,"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{let{data:n}=e;return i===O.Direction.LEFT||i===O.Direction.UP?(n.reverse(),iT(n,t,i).reverse()):iT(n,t,i)}}},iB={type:iW.OTHER,priority:0,match:/* @__PURE__ */el(()=>!0,"match"),isContinue:/* @__PURE__ */el((e,t)=>e.type===iW.OTHER,"isContinue")},iF={type:iW.EXTEND_NUMBER,priority:900,match:/* @__PURE__ */el(e=>ig(`${null==e?void 0:e.v}`||"").isExtendNumber,"match"),isContinue:/* @__PURE__ */el((e,t)=>{var i;if(e.type===iW.EXTEND_NUMBER){let{beforeTxt:n,afterTxt:r}=ig(`${null==(i=e.cellData)?void 0:i.v}`||""),{beforeTxt:o,afterTxt:s}=ig(`${null==t?void 0:t.v}`||"");if(n===o&&r===s)return!0}return!1},"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{var n;let{data:r}=e,o=i===O.Direction.UP||i===O.Direction.LEFT;if(1===r.length)return iG(iw(r,t,o?-1:1),o);let s=[];for(let e=0;e<r.length;e++){let t=`${null==(n=r[e])?void 0:n.v}`;t&&s.push(Number(ig(t).matchTxt))}return o&&(r.reverse(),s.reverse()),iC(s)?iG(iw(r,t,s[1]-s[0]),o):ib(r,t)}}},ij={type:iW.CHN_NUMBER,priority:830,match:/* @__PURE__ */el(e=>!!im(`${null==e?void 0:e.v}`||""),"match"),isContinue:/* @__PURE__ */el((e,t)=>e.type===iW.CHN_NUMBER,"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{var n,r,o;let{data:s}=e,l=i===O.Direction.LEFT||i===O.Direction.UP;if(1===s.length){let e;let i=`${null==(n=s[0])?void 0:n.v}`;return e=l?-1:1,i&&(""===i||7>ic(i))?iG(iP(s,t,e),l):iG(iM(s,t,e),l)}let a=!1;for(let e=0;e<s.length;e++)if((null==(r=s[e])?void 0:r.v)===""){a=!0;break}let d=[],c=0;for(let e=0;e<s.length;e++){let t=`${null==(o=s[e])?void 0:o.v}`;""===t?0===e?d.push(0):(c++,d.push(7*c)):a&&ic(t)>0&&7>ic(t)?d.push(ic(t)+7*c):d.push(ic(t))}return(l&&(s.reverse(),d.reverse()),iC(d))?a||d[d.length-1]<6&&d[0]>0||d[0]<6&&d[d.length-1]>0?iG(iP(s,t,d[1]-d[0]),l):iG(iM(s,t,d[1]-d[0]),l):ib(s,t)}}},iz={type:iW.CHN_WEEK2,priority:820,match:/* @__PURE__ */el(e=>!!ip(`${null==e?void 0:e.v}`||""),"match"),isContinue:/* @__PURE__ */el((e,t)=>e.type===iW.CHN_WEEK2,"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{var n;let{data:r}=e,o=i===O.Direction.LEFT||i===O.Direction.UP;if(1===r.length)return iG(iP(r,t,o?-1:1,1),o);let s=[],l=0;for(let e=0;e<r.length;e++){let t=`${null==(n=r[e])?void 0:n.v}`,i=null==t?void 0:t.substr(t.length-1,1);""===t?0===e?s.push(0):(l++,s.push(7*l)):s.push(ic(i)+7*l)}return(o&&(r.reverse(),s.reverse()),iC(s))?iG(iP(r,t,s[1]-s[0],1),o):ib(r,t)}}},iX={type:iW.CHN_WEEK3,priority:810,match:/* @__PURE__ */el(e=>iv(`${null==e?void 0:e.v}`||""),"match"),isContinue:/* @__PURE__ */el((e,t)=>e.type===iW.CHN_WEEK3,"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{var n;let{data:r}=e,o=i===O.Direction.LEFT||i===O.Direction.UP;if(1===r.length)return iG(iP(r,t,o?-1:1,2),o);let s=[],l=0;for(let e=0;e<r.length;e++){let t=`${null==(n=r[e])?void 0:n.v}`;if(t){let i=t.substr(t.length-1,1);""===t?0===e?s.push(0):(l++,s.push(7*l)):s.push(ic(i)+7*l)}}return(o&&(r.reverse(),s.reverse()),iC(s))?iG(iP(r,t,s[1]-s[0],2),o):ib(r,t)}}},iY={type:iW.LOOP_SERIES,priority:800,match:/* @__PURE__ */el(e=>ix(`${null==e?void 0:e.v}`||""),"match"),isContinue:/* @__PURE__ */el((e,t)=>{var i;return e.type===iW.LOOP_SERIES&&iA(`${null==(i=e.cellData)?void 0:i.v}`||"").name===iA(`${null==t?void 0:t.v}`||"").name},"isContinue"),applyFunctions:{[iH.SERIES]:(e,t,i)=>{var n,r;let{data:o}=e,s=i===O.Direction.LEFT||i===O.Direction.UP,{series:l}=iA(`${null==(n=o[0])?void 0:n.v}`||"");if(1===o.length)return iG(ik(o,t,s?-1:1,l),s);let a=[],d=0;for(let e=0;e<o.length;e++){let t=`${null==(r=o[e])?void 0:r.v}`;t&&(t===l[0]?0===e?a.push(0):(d++,a.push(d*l.length)):a.push(l.indexOf(t)+7*d))}return(s&&(o.reverse(),a.reverse()),iC(a))?iG(ik(o,t,a[1]-a[0],l),s):ib(o,t)}}};function iG(e,t){return t?e.reverse():e}el(iG,"reverseIfNeed");var iZ,iK,iq,iQ,iJ,i$=Object.defineProperty,i0=Object.getOwnPropertyDescriptor,i1=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?i0(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&i$(t,i,o),o},"__decorateClass$Q"),i2=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$Q");let i5=(el(iJ=class extends O.Disposable{constructor(e,t,i,n,r,o){super(),ea(this,"_rules",[]),ea(this,"_hooks",[]),ea(this,"_applyType$",new k.BehaviorSubject(iH.SERIES)),ea(this,"_isFillingStyle",!0),ea(this,"_prevUndos",[]),ea(this,"_autoFillLocation$",new k.BehaviorSubject(null)),ea(this,"autoFillLocation$",this._autoFillLocation$.asObservable()),ea(this,"_showMenu$",new k.BehaviorSubject(!1)),ea(this,"showMenu$",this._showMenu$.asObservable()),ea(this,"_direction",O.Direction.DOWN),ea(this,"applyType$",this._applyType$.asObservable()),ea(this,"_menu$",new k.BehaviorSubject([{label:"autoFill.copy",value:iH.COPY,disable:!1},{label:"autoFill.series",value:iH.SERIES,disable:!1},{label:"autoFill.formatOnly",value:iH.ONLY_FORMAT,disable:!1},{label:"autoFill.noFormat",value:iH.NO_FORMAT,disable:!1}])),ea(this,"menu$",this._menu$.asObservable()),this._commandService=e,this._undoRedoService=t,this._renderManagerService=i,this._univerInstanceService=n,this._selectionManagerService=r,this._injector=o,this._init()}_init(){this._rules=[iU,iL,iF,ij,iz,iX,iY,iB].sort((e,t)=>t.priority-e.priority),this._isFillingStyle=!0}_getOneByPriority(e){return e.length<=0?[]:[e.reduce((e,t)=>(t.priority||0)>(e.priority||0)?t:e,e[0])]}initPrevUndo(){this._prevUndos=[]}addHook(e){if(this._hooks.find(t=>t.id===e.id))throw Error(`Add hook failed, hook id '${e.id}' already exist!`);return void 0===e.priority&&(e.priority=0),void 0===e.type&&(e.type=iV.Append),this._hooks.push(e),(0,O.toDisposable)(()=>{let t=this._hooks.findIndex(t=>t===e);t>-1&&this._hooks.splice(t,1)})}registerRule(e){if(this._rules.find(t=>t.type===e.type))throw Error(`Registry rule failed, type '${e.type}' already exist!`);let t=this._rules.findIndex(t=>t.priority<e.priority);this._rules.splice(-1===t?this._rules.length:t,0,e)}getRules(){return this._rules}getAllHooks(){return this._hooks}getActiveHooks(){let{source:e,target:t,unitId:i,subUnitId:n}=this.autoFillLocation||{};if(!e||!t||!i||!n)return[];let r=this._hooks.filter(r=>{var o;return!(null!=(o=r.disable)&&o.call(r,{source:e,target:t,unitId:i,subUnitId:n},this._direction,this.applyType))}),o=r.filter(e=>e.type===iV.Only);return o.length>0?this._getOneByPriority(o):[...this._getOneByPriority(r.filter(e=>e.type===iV.Default)),...r.filter(e=>e.type===iV.Append)||[]]}get applyType(){return this._applyType$.getValue()}set applyType(e){this._applyType$.next(e)}get menu(){return this._menu$.getValue()}get direction(){return this._direction}set direction(e){this._direction=e}isFillingStyle(){return this._isFillingStyle}setFillingStyle(e){this._isFillingStyle=e}get autoFillLocation(){return this._autoFillLocation$.getValue()}set autoFillLocation(e){this._autoFillLocation$.next(e)}setDisableApplyType(e,t){this._menu$.next(this._menu$.getValue().map(i=>i.value===e?{...i,disable:t}:i))}setShowMenu(e){this._showMenu$.next(e)}fillData(e,t){var i,n,r;let{source:o,target:s,unitId:l=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId(),subUnitId:a=null==(i=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getActiveSheet())?void 0:i.getSheetId()}=this.autoFillLocation||{},d=this.direction;if(!o||!o.cols.length||!o.rows.length||!s||!s.cols.length||!s.rows.length||l!==e||a!==t)return!1;this._prevUndos.length>0&&this._prevUndos.forEach(e=>{this._commandService.syncExecuteCommand(e.id,e.params)}),this._prevUndos=[];let c=(0,O.Rectangle).union(it(o),it(s)),u=this.applyType,h=this.getActiveHooks();this._commandService.syncExecuteCommand(A.SetSelectionsOperation.id,{selections:[{primary:{...null!=(r=null==(n=this._selectionManagerService.getCurrentLastSelection())?void 0:n.primary)?r:c},range:{...c,rangeType:O.RANGE_TYPE.NORMAL}}],unitId:l,subUnitId:a});let m=[],g=[];h.forEach(e=>{var t;let{undos:i,redos:n}=(null==(t=e.onFillData)?void 0:t.call(e,{source:o,target:s,unitId:l,subUnitId:a},d,u))||{};i&&m.push(...i),n&&g.push(...n)});let p=g.every(e=>this._commandService.syncExecuteCommand(e.id,e.params)),v=[];u!==iH.NO_FORMAT&&g.forEach(e=>{if(e.id===A.SetRangeValuesMutation.id){let{cellValue:t}=e.params;new(0,O.ObjectMatrix)(t).forValue((e,t,i)=>{let n=Object.keys((null==i?void 0:i.s)||{});n.length&&t4.some(e=>n.includes(e))&&v.push({startRow:e,endRow:e,startColumn:t,endColumn:t})})}});let S=this._getAutoHeightUndoRedos(e,t,v);return S.redos.every(e=>this._commandService.syncExecuteCommand(e.id,e.params))&&(m.push(...S.undos),g.push(...S.redos)),p&&(this._prevUndos=m,this._undoRedoService.pushUndoRedo({unitID:l,undoMutations:m,redoMutations:g})),h.forEach(e=>{var t;null==(t=e.onAfterFillData)||t.call(e,{source:o,target:s,unitId:l,subUnitId:a},d,u)}),this.setShowMenu(!0),!0}_getAutoHeightUndoRedos(e,t,i){var n,r;let o=null==(n=this._renderManagerService.getRenderById(e))?void 0:n.with(ev),s=null==(r=null==o?void 0:o.getCurrent())?void 0:r.skeleton;if(!s)return{redos:[],undos:[]};let l={subUnitId:t,unitId:e,rowsAutoHeightInfo:s.calculateAutoHeightInRange(i)},a=s.worksheet,d=(0,A.SetWorksheetRowAutoHeightMutationFactory)(l,a);return{undos:[{id:A.SetWorksheetRowAutoHeightMutation.id,params:d}],redos:[{id:A.SetWorksheetRowAutoHeightMutation.id,params:l}]}}},"AutoFillService"),iJ);i5=i1([i2(0,O.ICommandService),i2(1,O.IUndoRedoService),i2(2,x.IRenderManagerService),i2(3,(0,O.Inject)(O.IUniverInstanceService)),i2(4,(0,O.Inject)(A.SheetsSelectionsService)),i2(5,(0,O.Inject)(O.Injector))],i5);let i9=(0,O.createIdentifier)("univer.auto-fill-service"),i6={type:O.CommandType.COMMAND,id:"sheet.command.auto-fill",handler:/* @__PURE__ */el(async(e,t)=>e.get(i9).fillData(t.unitId,t.subUnitId),"handler")},i3={id:"sheet.command.auto-clear-content",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.IUniverInstanceService),n=e.get(O.ICommandService),r=e.get(O.IUndoRedoService),o=(0,A.getSheetCommandTarget)(i);if(!o)return!1;let{unitId:s,subUnitId:l}=o,{clearRange:a,selectionRange:d}=t,c={subUnitId:l,unitId:s,cellValue:(0,A.generateNullCellValue)([a])},u=(0,A.SetRangeValuesUndoMutationFactory)(e,c),{startColumn:h,startRow:m}=d;return n.executeCommand(A.SetSelectionsOperation.id,{selections:[{primary:{startColumn:h,startRow:m,endColumn:h,endRow:m,actualRow:m,actualColumn:h,isMerge:!1,isMergedMainCell:!1},range:{...d}}],unitId:s,subUnitId:l}),!!n.syncExecuteCommand(A.SetRangeValuesMutation.id,c)&&(r.pushUndoRedo({unitID:s,undoMutations:[{id:A.SetRangeValuesMutation.id,params:u}],redoMutations:[{id:A.SetRangeValuesMutation.id,params:c}]}),!0)},"handler")},i7={id:"sheet.operation.set-cell-edit-visible",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>!!t&&(e.get(tA).changeVisible(t),!0),"handler")},i4={id:"sheet.operation.set-cell-edit-visible-f2",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>(e.get(O.ICommandService).syncExecuteCommand(i7.id,t),!0),"handler")},i8={id:"sheet.operation.set-cell-edit-visible-arrow",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el(()=>!0,"handler")},ne={id:"sheet.command.change-zoom-ratio",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{if(!t)return!1;let i=e.get(O.IUniverInstanceService),n=(0,A.getSheetCommandTarget)(i);if(!n)return!1;let{worksheet:r,subUnitId:o,unitId:s}=n,{delta:l,reset:a}=t,d=a?100:Math.round((r.getConfig().zoomRatio+l)*100),c=(d=Math.min(400,d=Math.max(10,d)))/100,u=e.get(tA).isVisible();return(u.unitId!==s&&u.unitId!==O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY||!u.visible)&&e.get(O.ICommandService).executeCommand(na.id,{unitId:s,subUnitId:o,zoomRatio:c})},"handler")},nt={id:"sheet.command.set-zoom-ratio",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{if(!t)return!1;let{unitId:i,subUnitId:n,zoomRatio:r}=t,o=e.get(tA).isVisible();return(o.unitId!==i&&o.unitId!==O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY||!o.visible)&&e.get(O.ICommandService).executeCommand(na.id,{unitId:i,subUnitId:n,zoomRatio:r})},"handler")};var ni,nn=Object.defineProperty,nr=Object.getOwnPropertyDescriptor,no=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?nr(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&nn(t,i,o),o},"__decorateClass$P"),ns=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$P");let nl=(el(ni=class extends O.Disposable{constructor(e,t,i,n,r){super(),this._context=e,this._sheetSkeletonManagerService=t,this._commandService=i,this._contextService=n,this._editorBridgeService=r,this._initSkeletonListener(),this._initZoomEventListener()}updateZoom(e,t){let i=this._context.unit.getSheetBySheetId(e);return!!i&&(i.getConfig().zoomRatio=t,i===this._context.unit.getActiveSheet()&&this._updateViewZoom(t),!0)}_initZoomEventListener(){let e=this._getSheetObject().scene;this.disposeWithMe(e.onMouseWheel$.subscribeEvent(t=>{if(!t.ctrlKey||!this._contextService.getContextValue(O.FOCUSING_SHEET))return;if(this._editorBridgeService){let e=this._editorBridgeService.isVisible();if((e.unitId===this._context.unitId||e.unitId===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)&&e.visible)return}let i=Math.abs(t.deltaX),n=i<40?.2:i<80?.4:.2;n*=t.deltaY>0?-1:1,e.scaleX<1&&(n/=2);let r=this._context.unit,o=r.getActiveSheet();if(!o)return;let s=o.getZoomRatio(),l=+Number.parseFloat(`${s+n}`).toFixed(1);l=l>=4?4:l<=.1?.1:l,this._commandService.executeCommand(nt.id,{zoomRatio:Math.round(10*l)/10,unitId:r.getUnitId(),subUnitId:o.getSheetId()}),t.preventDefault()}))}_initSkeletonListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(null==e)return;let t=this._context.unit.getActiveSheet();if(!t)return;let i=t.getZoomRatio()||1;this._updateViewZoom(i)}))}_updateViewZoom(e){let t=this._getSheetObject();null==t||t.scene.scale(e,e),null==t||t.spreadsheet.makeForceDirty()}_getSheetObject(){return tg(this._context.unit,this._context)}},"SheetsZoomRenderController"),ni);nl=no([ns(1,(0,O.Inject)(ev)),ns(2,O.ICommandService),ns(3,O.IContextService),ns(4,(0,O.Optional)(tA))],nl);let na={id:"sheet.operation.set-zoom-ratio",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>{let i=e.get(x.IRenderManagerService).getRenderById(t.unitId);return!!i&&i.with(nl).updateZoom(t.subUnitId,t.zoomRatio)},"handler")};var nd,nc=Object.defineProperty,nu=Object.getOwnPropertyDescriptor,nh=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?nu(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&nc(t,i,o),o},"__decorateClass$O"),nm=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$O");let ng=(nd=class extends O.Disposable{constructor(e,t,i,n,r,o,s){super(),ea(this,"_beforeApplyData",[]),ea(this,"_currentLocation",null),ea(this,"_copyData",[]),ea(this,"_defaultHook"),this._univerInstanceService=e,this._commandService=t,this._autoFillService=i,this._editorBridgeService=n,this._renderManagerService=r,this._injector=o,this._sheetsRenderService=s,this._defaultHook={id:"default",type:iV.Default,priority:0,onBeforeFillData:/* @__PURE__ */el((e,t)=>this._presetAndCacheData(e,t),"onBeforeFillData"),onFillData:/* @__PURE__ */el((e,t,i)=>this._fillData(e,t,i),"onFillData")},this._init()}_init(){this._initDefaultHook(),this._onSelectionControlFillChanged(),this._onApplyTypeChanged(),this._initQuitListener(),this._initSkeletonChange()}_initSkeletonChange(){this.disposeWithMe(this._sheetsRenderService.registerSkeletonChangingMutations(i6.id))}_initDefaultHook(){this.disposeWithMe(this._autoFillService.addHook(this._defaultHook))}_initQuitListener(){let e=[i7.id,i3.id,A.SetRangeValuesCommand.id,na.id,A.SetWorksheetActiveOperation.id,A.MoveRangeMutation.id,A.RemoveRowMutation.id,A.RemoveColMutation.id,A.InsertRowMutation.id,A.InsertColMutation.id,A.MoveRowsMutation.id,A.MoveColsMutation.id,A.SetWorksheetColWidthMutation.id,A.SetWorksheetRowHeightMutation.id,A.SetRangeValuesMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted((t,i)=>{var n,r;let o=null==i?void 0:i.fromCollab,s=null==i?void 0:i.fromSync,l=null==i?void 0:i.fromFormula;!e.includes(t.id)||o||s||l||t.params.trigger===i6.id||this._quit(),t.id===A.RemoveSheetMutation.id&&t.params.unitId===(null==(n=this._currentLocation)?void 0:n.unitId)&&t.params.subUnitId===(null==(r=this._currentLocation)?void 0:r.subUnitId)&&this._quit()})),this.disposeWithMe(this._univerInstanceService.unitDisposed$.subscribe(e=>{var t;e.getUnitId()===(null==(t=this._currentLocation)?void 0:t.unitId)&&this._quit()}))}_quit(){this._currentLocation=null,this._beforeApplyData=[],this._copyData=[],this._autoFillService.setShowMenu(!1)}_onSelectionControlFillChanged(){let e=new O.DisposableCollection,t=/* @__PURE__ */el(e=>{e.dispose();let t=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_SHEET);t&&t.with(ez).getSelectionControls().forEach(i=>{e.add((0,O.toDisposable)(i.selectionFilled$.subscribe(e=>{if(null==e||-1===e.startColumn||-1===e.startRow||-1===e.endColumn||-1===e.endRow)return;let t={startColumn:i.model.startColumn,endColumn:i.model.endColumn,startRow:i.model.startRow,endRow:i.model.endRow},n={startColumn:e.startColumn,endColumn:e.endColumn,startRow:e.startRow,endRow:e.endRow};this._triggerAutoFill(t,n)}))),e.add((0,O.toDisposable)(i.fillControl.onDblclick$.subscribeEvent(()=>{let e={startColumn:i.model.startColumn,endColumn:i.model.endColumn,startRow:i.model.startRow,endRow:i.model.endRow};this._handleDbClickFill(e)}))),e.add((0,O.toDisposable)(i.fillControl.onPointerDown$.subscribeEvent(()=>{this._editorBridgeService.isVisible().visible&&this._editorBridgeService.changeVisible({visible:!1,eventType:x.DeviceInputEventType.PointerDown,unitId:t.unitId})})))})},"addListener");t(e),this.disposeWithMe(this._commandService.onCommandExecuted(i=>{i.id===A.SetSelectionsOperation.id&&t(e)}))}_onApplyTypeChanged(){this.disposeWithMe((0,O.toDisposable)(this._autoFillService.applyType$.subscribe(()=>{this._handleFillData()})))}_triggerAutoFill(e,t){var i,n;if(e.startColumn===t.startColumn&&e.startRow===t.startRow&&e.endColumn===t.endColumn&&e.endRow===t.endRow)return;if(t.endColumn<e.endColumn&&t.endColumn>e.startColumn){this._commandService.executeCommand(i3.id,{clearRange:{startRow:t.startRow,endRow:t.endRow,startColumn:t.endColumn+1,endColumn:e.endColumn},selectionRange:t});return}if(t.endRow<e.endRow&&t.endRow>e.startRow){this._commandService.executeCommand(i3.id,{clearRange:{startRow:t.endRow+1,endRow:e.endRow,startColumn:t.startColumn,endColumn:t.endColumn},selectionRange:t});return}let r={startRow:t.startRow,endRow:t.endRow,startColumn:t.startColumn,endColumn:t.endColumn},o=null;if(t.startRow<e.startRow)o=O.Direction.UP,r.endRow=e.startRow-1;else if(t.endRow>e.endRow)o=O.Direction.DOWN,r.startRow=e.endRow+1;else if(t.startColumn<e.startColumn)o=O.Direction.LEFT,r.endColumn=e.startColumn-1;else{if(!(t.endColumn>e.endColumn))return;o=O.Direction.RIGHT,r.startColumn=e.endColumn+1}let s=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!s)return;let l=s.getUnitId(),a=null==(i=s.getActiveSheet())?void 0:i.getSheetId();if(!a)return;this._autoFillService.direction=o;let d=this._injector.invoke(t=>ie(e,t)),c=this._injector.invoke(e=>ie(r,e));if(!d||!c)return;this._autoFillService.autoFillLocation={source:d,target:c,unitId:l,subUnitId:a};let u=[];this._autoFillService.getActiveHooks().forEach(e=>{var t;let i=null==(t=null==e?void 0:e.onBeforeFillData)?void 0:t.call(e,{source:d,target:c,unitId:l,subUnitId:a},o);i&&u.unshift(i)}),this._autoFillService.initPrevUndo();for(let e=0;e<u.length;e++){let t=this._autoFillService.menu.find(t=>t.value===u[e]);if(t&&!t.disable){this._autoFillService.applyType=u[e];return}}let h=null==(n=this._autoFillService.menu.find(e=>!1===e.disable))?void 0:n.value;h&&(this._autoFillService.applyType=h)}_handleDbClickFill(e){let t=this._detectFillRange(e);t.endRow<=e.endRow||this._triggerAutoFill(e,t)}_detectFillRange(e){var t,i,n,r,o,s;let{startRow:l,endRow:a,startColumn:d,endColumn:c}=e,u=null==(t=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET))?void 0:t.getActiveSheet();if(!u)return e;let h=u.getCellMatrix(),m=u.getMaxRows()-1,g=u.getMaxColumns()-1,p=a;if(d>0&&(null==(i=h.getValue(l,d-1))?void 0:i.v)!=null){let e=l;for(;(null==(n=h.getValue(e,d-1))?void 0:n.v)!=null&&e<m;)e+=1;p=e-1}else if(c<g&&(null==(r=h.getValue(a,c+1))?void 0:r.v)!=null){let e=l;for(;(null==(o=h.getValue(e,c+1))?void 0:o.v)!=null&&e<m;)e+=1;p=e-1}for(let e=a+1;e<=p;e++)for(let t=d;t<=c;t++)if((null==(s=h.getValue(e,t))?void 0:s.v)!=null){p=e-1;break}return{startColumn:d,endColumn:c,startRow:l,endRow:p}}_handleFillData(){var e,t;this._currentLocation&&this._commandService.executeCommand(i6.id,{unitId:null==(e=this._currentLocation)?void 0:e.unitId,subUnitId:null==(t=this._currentLocation)?void 0:t.subUnitId})}_getApplyData(e,t,i,n,r,o=!0){let s=[],l=Math.floor(i/t),a=i%t,d=this._autoFillService.getRules();if(!o&&r===iH.ONLY_FORMAT)return console.error("ERROR: only format can not be applied when hasStyle is false"),[];let c={};d.forEach(e=>{c[e.type]=[]}),d.forEach(o=>{let{type:s,applyFunctions:d={}}=o,u=e[s];u&&u.forEach(o=>{let u=iS(o.index,a),h=o.index.length*l+u,m=this._applyFunctions(o,h,n,r,d,e),g=iI(t,i,o.index);c[s].push({data:m,index:g})})});for(let e=0;e<i;e++)d.forEach(t=>{let{type:i}=t,n=c[i];for(let t=0;t<n.length;t++)e in n[t].index&&s.push(n[t].data[n[t].index[e]])});return s}_applyFunctions(e,t,i,n,r,o){let{data:s}=e,l=i===O.Direction.UP||i===O.Direction.LEFT;if(n===iH.COPY){let n=null==r?void 0:r[iH.COPY];return n?n(e,t,i,o):(l&&s.reverse(),ib(s,t))}if(n===iH.SERIES){let n=null==r?void 0:r[iH.SERIES];return n?n(e,t,i,o):(l&&s.reverse(),null!=r&&r[iH.COPY]?r[iH.COPY](e,t,i,o):ib(s,t))}if(n===iH.ONLY_FORMAT){let n=null==r?void 0:r[iH.ONLY_FORMAT];return n?n(e,t,i,o):i_(s,t)}}_getCopyData(e,t){let i,n;let r=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getActiveSheet();if(!r)throw Error("No active sheet found");let o=r.getCellMatrix(),s=this._autoFillService.getRules(),l=[],a=t===O.Direction.DOWN||t===O.Direction.UP;return a?(i=e.cols,n=e.rows):(i=e.rows,n=e.cols),i.forEach(e=>{let t=this._getEmptyCopyDataPiece(),i={type:void 0,cellData:void 0};n.forEach(r=>{let l;l=a?o.getValue(r,e):o.getValue(e,r);let{type:d,isContinue:c}=s.find(e=>e.match(l,this._injector))||iB;if(c(i,l)){let e=t[d],i=e[e.length-1];i.data.push(l),i.index.push(r-n[0])}else{let e=t[d];e?e.push({data:[l],index:[r-n[0]]}):t[d]=[{data:[l],index:[r-n[0]]}]}i.type=d,i.cellData=l}),l.push(t)}),l}_getEmptyCopyDataPiece(){let e={};return this._autoFillService.getRules().forEach(t=>{e[t.type]=[]}),e}_getMergeApplyData(e,t,i,n){let r=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getActiveSheet();if(!r)throw Error("No active sheet found");let o=[];for(let s=e.startRow;s<=e.endRow;s++)for(let l=e.startColumn;l<=e.endColumn;l++){let{isMergedMainCell:e,startRow:a,startColumn:d,endRow:c,endColumn:u}=r.getCellInfoInMergeData(s,l);if(e){if(i===O.Direction.DOWN){let e=a+n,i=c+n;for(;i<=t.endRow;)o.push({startRow:e,startColumn:d,endRow:i,endColumn:u}),e+=n,i+=n}else if(i===O.Direction.UP){let e=a-n,i=c-n;for(;e>=t.startRow;)o.push({startRow:e,startColumn:d,endRow:i,endColumn:u}),e-=n,i-=n}else if(i===O.Direction.RIGHT){let e=d+n,i=u+n;for(;i<=t.endColumn;)o.push({startRow:a,startColumn:e,endRow:c,endColumn:i}),e+=n,i+=n}else if(i===O.Direction.LEFT){let e=d-n,i=u-n;for(;e>=t.startColumn;)o.push({startRow:a,startColumn:e,endRow:c,endColumn:i}),e-=n,i-=n}}}return o}_presetAndCacheData(e,t){let{source:i,target:n}=e,r=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getActiveSheet();if(!r)throw Error("No active sheet found");let o=r.getCellMatrix(),s=[];return n.rows.forEach(e=>{let t=[];n.cols.forEach(i=>{t.push((0,O.Tools).deepClone(o.getValue(e,i)))}),s.push(t)}),this._beforeApplyData=s,this._copyData=this._getCopyData(i,t),this._currentLocation=e,this._shouldDisableSeries(this._copyData)?(this._autoFillService.setDisableApplyType(iH.SERIES,!0),iH.COPY):(this._autoFillService.setDisableApplyType(iH.SERIES,!1),this._getPreferredApplyType(this._copyData))}_fillData(e,t,i){var n,r;let o;let s=[],l=[],a=!0;i===iH.NO_FORMAT&&(a=!1,i=iH.SERIES);let{source:d,target:c,unitId:u,subUnitId:h}=e;if(!d||!c||null==t)return{undos:s,redos:l};let m=it(d),g=it(c),{cols:p,rows:v}=c,{cols:S,rows:f}=d,C=this._copyData;o=t===O.Direction.DOWN||t===O.Direction.UP?f.length:S.length;let I=[];if(t===O.Direction.DOWN||t===O.Direction.UP){let e=v.length,n=[];p.forEach((r,s)=>{let l=C[s],d=this._getApplyData(l,o,e,t,i,a);n.push(d)});for(let e=0;e<n[0].length;e++){let t=[];for(let i=0;i<n.length;i++)t.push({s:null,...n[i][e]});I.push(t)}}else{let e=p.length;v.forEach((n,r)=>{let s=C[r],l=this._getApplyData(s,o,e,t,i,a),d=[];for(let e=0;e<l.length;e++)d.push({s:null,...l[e]});I.push(d)})}let b=[],_=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getStyles();if(a?(b=this._getMergeApplyData(m,g,t,o),I.forEach(e=>{e.forEach(e=>{e&&_&&_&&(e.s=_.getStyleByCell(e))})})):I.forEach((e,t)=>{e.forEach((e,i)=>{e&&_&&(e.s=_.getStyleByCell(this._beforeApplyData[t][i])||null)})}),i===iH.ONLY_FORMAT&&I.forEach((e,t)=>{e.forEach((e,i)=>{if(e){let n=this._beforeApplyData[t][i]||{};e.f=n.f,e.si=n.si,e.t=n.t,e.v=n.v}})}),a){let e=[],t=null==(r=null==(n=this._univerInstanceService.getUniverSheetInstance(u))?void 0:n.getSheetBySheetId(h))?void 0:r.getMergeData();t&&t.forEach(t=>{(0,O.Rectangle).intersects(t,g)&&e.push(t)});let i={unitId:u,subUnitId:h,ranges:e},o=this._injector.invoke(A.RemoveMergeUndoMutationFactory,i);e.length&&(l.push({id:A.RemoveWorksheetMergeMutation.id,params:i}),s.unshift({id:A.AddWorksheetMergeMutation.id,params:o}))}let R={subUnitId:h,unitId:u,cellValue:ir([c])},y=this._injector.invoke(A.SetRangeValuesUndoMutationFactory,R);l.push({id:A.SetRangeValuesMutation.id,params:R}),s.unshift({id:A.SetRangeValuesMutation.id,params:y});let T=new O.ObjectMatrix;v.forEach((e,t)=>{p.forEach((i,n)=>{I[t][n]&&T.setValue(e,i,I[t][n])})});let E={subUnitId:h,unitId:u,cellValue:T.getMatrix()},w=this._injector.invoke(A.SetRangeValuesUndoMutationFactory,E);if(s.unshift({id:A.SetRangeValuesMutation.id,params:w}),l.push({id:A.SetRangeValuesMutation.id,params:E}),null!=b&&b.length){let e={unitId:u,subUnitId:h,ranges:(0,A.getAddMergeMutationRangeByType)(b)},t=this._injector.invoke(A.AddMergeUndoMutationFactory,e);s.unshift({id:A.RemoveWorksheetMergeMutation.id,params:t}),l.push({id:A.AddWorksheetMergeMutation.id,params:e})}return{undos:s,redos:l}}_shouldDisableSeries(e){return e.every(e=>Object.keys(e).every(t=>{var i;return(null==(i=e[t])?void 0:i.length)===0||[iW.OTHER,iW.FORMULA].includes(t)}))}_getPreferredApplyType(e){return e.every(e=>Object.keys(e).every(t=>{var i,n;return(null==(i=e[t])?void 0:i.length)===0||(null==(n=e[t])?void 0:n.length)===1&&1===e[t][0].data.length&&iW.NUMBER===t}))?iH.COPY:iH.SERIES}},el(nd,"AutoFillController"),nd);ng=nh([nm(0,O.IUniverInstanceService),nm(1,O.ICommandService),nm(2,i9),nm(3,tA),nm(4,x.IRenderManagerService),nm(5,(0,O.Inject)(O.Injector)),nm(6,(0,O.Inject)(tK))],ng);var np,nv=Object.defineProperty,nS=Object.getOwnPropertyDescriptor,nf=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?nS(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&nv(t,i,o),o},"__decorateClass$N"),nC=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$N");let nI=(np=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_enterActiveRender"),this._context=e,this._sheetSkeletonManagerService=t,this._renderManagerService=i,this._permissionService=n,this._initEventBinding()}_initEventBinding(){let e=new O.DisposableCollection,t=this._context.unit,i=/* @__PURE__ */el(i=>{if(e.dispose(),!i)return;let n=this._context.unitId,{skeleton:r}=i,o=this._renderManagerService.getRenderById(n);if(o&&o.mainComponent){let i=o.mainComponent,s=/* @__PURE__ */el(e=>{let{offsetX:i,offsetY:s}=e,l=o.scene,a=t.getActiveSheet();if(!a)return;let d=l.getActiveViewportByCoord((0,x.Vector2).FromArray([i,s]));if(!d)return;let{scaleX:c,scaleY:u}=l.getAncestorScale(),h={x:d.viewportScrollX,y:d.viewportScrollY},m=r.getCellPositionByOffset(i,s,c,u,h),g=r.worksheet.getMergedCell(m.row,m.column),p={actualRow:g?g.startRow:m.row,actualCol:g?g.startColumn:m.column,mergeCell:g,row:m.row,col:m.column};if(!p||!r)return;let v=a.getCell(p.actualRow,p.actualCol);if(!v)return;let S=v.customRender;if(!(null!=S&&S.length))return;let f=p.actualRow,C=p.actualCol,I=S.sort(O.sortRules),b=a.getSheetId(),_={data:v,style:r.getsStyles().getStyleByCell(v),primaryWithCoord:r.getCellByIndex(p.actualRow,p.actualCol),unitId:n,subUnitId:b,row:f,col:C,workbook:t,worksheet:a},R={x:h.x+i/c,y:h.y+s/u},y=I.find(e=>{var t;return null==(t=e.isHit)?void 0:t.call(e,R,_)});if(y)return[y,_]},"getActiveRender"),l=i.onPointerDown$.subscribeEvent(e=>{var t,i,n,r;let o=s(e);if(o){let[s,l]=o,{row:a,col:d,worksheet:c,unitId:u,subUnitId:h}=l;if(!(null==(t=this._permissionService.composePermission([new A.WorkbookEditablePermission(u).id,new A.WorksheetEditPermission(u,h).id]))?void 0:t.every(e=>e.value)))return!1;let m=null==(n=null==(i=c.getCell(a,d))?void 0:i.selectionProtection)?void 0:n[0];if((null==m?void 0:m[A.UnitAction.Edit])===!1)return!1;null==(r=s.onPointerDown)||r.call(s,l,e)}}),a=i.onPointerMove$.subscribeEvent(e=>{var t,i,n,r;let o=s(e);if(o){let[s,l]=o;this._enterActiveRender?this._enterActiveRender.render!==s&&(null==(i=(t=this._enterActiveRender.render).onPointerLeave)||i.call(t,this._enterActiveRender.cellContext,e),this._enterActiveRender={render:s,cellContext:l},null==(n=s.onPointerEnter)||n.call(s,l,e)):(this._enterActiveRender={render:s,cellContext:l},null==(r=s.onPointerEnter)||r.call(s,l,e))}});l&&e.add(l),a&&e.add(a)}},"handleSkeletonChange");this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(i)),i(this._sheetSkeletonManagerService.getCurrent()),this.disposeWithMe(e)}},el(np,"CellCustomRenderController"),np);nI=nf([nC(1,(0,O.Inject)(ev)),nC(2,x.IRenderManagerService),nC(3,O.IPermissionService)],nI);var nb=function(){return(nb=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},n_=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)0>t.indexOf(n[r])&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]]);return i},nR=(0,ee.forwardRef)(function(e,t){var i=e.icon,n=e.id,r=e.className,o=e.extend,s=n_(e,["icon","id","className","extend"]),l="univerjs-icon univerjs-icon-".concat(n," ").concat(r||"").trim(),a=(0,ee.useRef)("_".concat(nw()));return ny(i,"".concat(n),{defIds:i.defIds,idSuffix:a.current},nb({ref:t,className:l},s),o)});function ny(e,t,i,n,r){return(0,ee.createElement)(e.tag,nb(nb({key:t},nT(e,i,r)),n),(nE(e,i).children||[]).map(function(n,o){return ny(n,"".concat(t,"-").concat(e.tag,"-").concat(o),i,void 0,r)}))}function nT(e,t,i){var n=nb({},e.attrs);null!=i&&i.colorChannel1&&"colorChannel1"===n.fill&&(n.fill=i.colorChannel1);var r=t.defIds;return r&&0!==r.length&&("use"===e.tag&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(function(e){var i=e[0],r=e[1];"string"==typeof r&&(n[i]=r.replace(/url\(#(.*)\)/,"url(#$1".concat(t.idSuffix,")")))})),n}function nE(e,t){var i,n=t.defIds;return n&&0!==n.length&&"defs"===e.tag&&!(null===(i=e.children)||void 0===i)&&i.length?nb(nb({},e),{children:e.children.map(function(e){return"string"==typeof e.attrs.id&&n&&n.indexOf(e.attrs.id)>-1?nb(nb({},e),{attrs:nb(nb({},e.attrs),{id:e.attrs.id+t.idSuffix})}):e})}):e}function nw(){return Math.random().toString(36).substring(2,8)}el(ny,"render"),el(nT,"replaceRuntimeIdsAndExtInAttrs"),el(nE,"replaceRuntimeIdsInDefs"),el(nw,"generateShortUuid"),nR.displayName="UniverIcon";var nP={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M11.0363 12.2367V14.0367C11.0363 14.3681 11.3049 14.6367 11.6363 14.6367C11.9676 14.6367 12.2363 14.3681 12.2363 14.0367V12.2367H14.0364C14.3677 12.2367 14.6364 11.9681 14.6364 11.6367C14.6364 11.3054 14.3677 11.0367 14.0364 11.0367H12.2363V9.23672C12.2363 8.90535 11.9676 8.63672 11.6363 8.63672C11.3049 8.63672 11.0363 8.90535 11.0363 9.23672V11.0367H9.23635C8.90498 11.0367 8.63635 11.3054 8.63635 11.6367C8.63635 11.9681 8.90498 12.2367 9.23635 12.2367H11.0363Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.56365 1.36377C1.90091 1.36377 1.36365 1.90103 1.36365 2.56377V6.16377C1.36365 6.82651 1.90091 7.36377 2.56365 7.36377H6.16365C6.82639 7.36377 7.36365 6.82651 7.36365 6.16377V2.56377C7.36365 1.90103 6.82639 1.36377 6.16365 1.36377H2.56365zM6.16365 2.56377H2.56365L2.56365 6.16377H6.16365V2.56377zM2.56365 8.63647C1.90091 8.63647 1.36365 9.17373 1.36365 9.83647V13.4365C1.36365 14.0992 1.90091 14.6365 2.56365 14.6365H6.16365C6.82639 14.6365 7.36365 14.0992 7.36365 13.4365V9.83647C7.36365 9.17373 6.82639 8.63647 6.16365 8.63647H2.56365zM6.16365 9.83647H2.56365L2.56365 13.4365H6.16365V9.83647zM9.83635 7.36377C9.17361 7.36377 8.63635 6.82651 8.63635 6.16377V2.56377C8.63635 1.90103 9.17361 1.36377 9.83635 1.36377H13.4364C14.0991 1.36377 14.6364 1.90103 14.6364 2.56377V6.16377C14.6364 6.82651 14.0991 7.36377 13.4364 7.36377H9.83635zM9.83635 6.16377V2.56377L13.4364 2.56377V6.16377H9.83635z",fillRule:"evenodd",clipRule:"evenodd"}}]},nM=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"autofill",ref:t,icon:nP}))});nM.displayName="Autofill";var nO={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},nx=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"check-mark-single",ref:t,icon:nO}))});nx.displayName="CheckMarkSingle";var nA={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},nk=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"close-single",ref:t,icon:nA}))});nk.displayName="CloseSingle";var nN={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"g",attrs:{fill:"currentColor",clipPath:"url(#convert-single_clip0_911_593)"},children:[{tag:"path",attrs:{d:"M2.44766.848145C1.564.848145.847656 1.56449.847656 2.44814V6.44814C.847656 7.3318 1.564 8.04814 2.44766 8.04814H6.44766C7.33131 8.04814 8.04766 7.3318 8.04766 6.44814V2.44814C8.04766 1.56449 7.33131.848145 6.44766.848145H2.44766zM2.04766 6.44814V5.04824H3.84775V6.84814H2.44766C2.22674 6.84814 2.04766 6.66906 2.04766 6.44814zM2.04766 3.84824H3.84775V2.04814H2.44766C2.22674 2.04814 2.04766 2.22723 2.04766 2.44814V3.84824zM5.04775 6.84814V5.04824H6.84766V6.44814C6.84766 6.66906 6.66857 6.84814 6.44766 6.84814H5.04775zM5.04775 3.84824H6.84766V2.44814C6.84766 2.22723 6.66857 2.04814 6.44766 2.04814H5.04775V3.84824zM9.55215 7.95166C8.66849 7.95166 7.95215 8.668 7.95215 9.55166V13.5517C7.95215 14.4353 8.66849 15.1517 9.55215 15.1517L11.5522 15.1517 13.5521 15.1517C14.4358 15.1517 15.1521 14.4353 15.1521 13.5517L15.1521 11.5518 15.1521 9.55166C15.1521 8.668 14.4358 7.95166 13.5521 7.95166H9.55215zM13.9521 10.9518V9.55166C13.9521 9.33075 13.7731 9.15166 13.5521 9.15166H12.1522V10.9518H13.9521zM10.9522 10.9518V9.15166H9.55215C9.33123 9.15166 9.15215 9.33075 9.15215 9.55166V10.9518H10.9522zM9.15215 12.1518H10.9522V13.9517H9.55215C9.33123 13.9517 9.15215 13.7726 9.15215 13.5517V12.1518zM12.1522 12.1518H13.9521V13.5517C13.9521 13.7726 13.7731 13.9517 13.5521 13.9517H12.1522V12.1518z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{d:"M9.62158 2.44912C9.62158 2.11775 9.89021 1.84912 10.2216 1.84912H12.7516C13.6352 1.84912 14.3516 2.56547 14.3516 3.44912V5.9791C14.3516 6.31047 14.0829 6.5791 13.7516 6.5791 13.4202 6.5791 13.1516 6.31047 13.1516 5.9791V3.44912C13.1516 3.22821 12.9725 3.04912 12.7516 3.04912H10.2216C9.89021 3.04912 9.62158 2.78049 9.62158 2.44912zM5.77871 14.1507C6.11008 14.1507 6.37871 13.8821 6.37871 13.5507 6.37871 13.2193 6.11008 12.9507 5.77871 12.9507L3.24873 12.9507C3.02782 12.9507 2.84873 12.7716 2.84873 12.5507L2.84873 10.0207C2.84873 9.68933 2.5801 9.4207 2.24873 9.4207 1.91736 9.4207 1.64873 9.68933 1.64873 10.0207L1.64873 12.5507C1.64873 13.4343 2.36507 14.1507 3.24873 14.1507H5.77871z"}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"convert-single_clip0_911_593"},children:[{tag:"path",attrs:{fill:"#fff",d:"M0 0H16V16H0z"}}]}]}],defIds:["convert-single_clip0_911_593"]},nD=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"convert-single",ref:t,icon:nN}))});nD.displayName="ConvertSingle";var nV={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993.866699 5.9313.866699H10.069C10.4004.866699 10.669 1.13533 10.669 1.4667 10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667zM1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443 14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443zM6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928 9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171 10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778 9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539 9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263 6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539 5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778 6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},nW=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"delete-single",ref:t,icon:nV}))});nW.displayName="DeleteSingle";var nH={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_371_77",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_371_77)"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.85869 12.9216C8.38445 13.4708 7.61555 13.4708 7.14131 12.9216L0.358114 5.06726C-0.406895 4.18144 0.134916 2.66683 1.2168 2.66683L14.7832 2.66683C15.8651 2.66683 16.4069 4.18144 15.6419 5.06726L8.85869 12.9216Z"}}]}]},nU=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"dropdown-single",ref:t,icon:nH}))});nU.displayName="DropdownSingle";var nL={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM10.3097 5.69014C10.544 5.92445 10.544 6.30435 10.3097 6.53867L8.84843 7.9999L10.3099 9.46137C10.5442 9.69569 10.5442 10.0756 10.3099 10.3099C10.0756 10.5442 9.69569 10.5442 9.46137 10.3099L7.9999 8.84843L6.53842 10.3099C6.30411 10.5442 5.92421 10.5442 5.6899 10.3099C5.45558 10.0756 5.45558 9.69569 5.6899 9.46137L7.15137 7.9999L5.69014 6.53867C5.45583 6.30435 5.45583 5.92445 5.69014 5.69014C5.92445 5.45583 6.30435 5.45583 6.53867 5.69014L7.9999 7.15137L9.46113 5.69014C9.69544 5.45583 10.0753 5.45583 10.3097 5.69014Z",fillRule:"evenodd",clipRule:"evenodd"}}]},nB=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"error-single",ref:t,icon:nL}))});nB.displayName="ErrorSingle";var nF={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.28096 4.6541C1.57489 4.50109 1.93721 4.61533 2.09022 4.90926C2.27315 5.26067 2.55999 5.60455 2.94829 5.92278C4.04628 6.82266 5.87505 7.44865 7.99828 7.44865C10.1215 7.44865 11.9503 6.82267 13.0482 5.92279C13.4366 5.60455 13.7234 5.26067 13.9063 4.90927C14.0594 4.61533 14.4217 4.50109 14.7156 4.65409C15.0095 4.8071 15.1238 5.16941 14.9708 5.46334C14.6995 5.98445 14.2981 6.44997 13.8089 6.8509C13.7298 6.91575 13.6481 6.97914 13.564 7.041L15.2245 8.70153C15.4588 8.93585 15.4588 9.31575 15.2245 9.55006C14.9902 9.78438 14.6103 9.78438 14.376 9.55006L12.5041 7.67822C11.8977 7.97568 11.2181 8.21208 10.4884 8.37706L11.0996 10.6581C11.1853 10.9782 10.9954 11.3072 10.6753 11.393C10.3552 11.4787 10.0262 11.2888 9.94045 10.9687L9.29949 8.57652C8.8758 8.62404 8.44081 8.64865 7.99828 8.64865C7.55276 8.64865 7.11487 8.62371 6.68846 8.57555L6.04723 10.9687C5.96147 11.2888 5.63247 11.4788 5.31239 11.393C4.99231 11.3073 4.80236 10.9783 4.88812 10.6582L5.49983 8.37516C4.7743 8.2105 4.09843 7.9752 3.49498 7.67947L1.62436 9.55009C1.39005 9.78441 1.01015 9.78441 0.775835 9.5501C0.54152 9.31578 0.541518 8.93588 0.775832 8.70157L2.43478 7.04261C2.34987 6.98024 2.26746 6.91632 2.18764 6.8509C1.69842 6.44997 1.29706 5.98445 1.0258 5.46335C0.872791 5.16942 0.987031 4.80711 1.28096 4.6541Z"}}]},nj=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"eyelash-single",ref:t,icon:nF}))});nj.displayName="EyelashSingle";var nz={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6.06409 5.53454C5.93592 5.53454 5.84083 5.41567 5.86897 5.29063L5.95442 4.9109C6.05444 4.48178 6.23806 4.11547 6.51182 3.81952 6.81082 3.49628 7.25398 3.35405 7.79738 3.35405 7.99847 3.35405 8.21359 3.37775 8.44188 3.42245 8.46089 3.42617 8.47974 3.43006 8.49846 3.4341 8.7099 3.4798 8.93698 3.38478 9.02031 3.18514L9.24767 2.6404C9.33457 2.43219 9.23178 2.19404 9.01582 2.12874 8.98358 2.11899 8.95028 2.10912 8.91591 2.09914 8.62745 2.01631 8.28392 1.97217 7.88074 1.97217 6.82015 1.97217 6.02714 2.23936 5.4746 2.7444 4.90987 3.26069 4.50889 3.99917 4.28413 4.9762L2.83703 11.1909C2.76126 11.5286 2.666 11.8917 2.54844 12.2812 2.42975 12.6734 2.2873 13.0595 2.12221 13.4373 1.95577 13.8159 1.76813 14.1762 1.55955 14.5171 1.49345 14.6251 1.42515 14.7282 1.35467 14.8263 1.26508 14.9509 1.3347 15.133 1.48655 15.1554 2.13635 15.2509 2.8179 15.0763 3.18197 14.5296 3.32661 14.3124 3.46779 14.0646 3.60509 13.7851 3.96635 13.0497 4.30522 12.0103 4.61867 10.6574L5.469 7.01534C5.49013 6.92483 5.57082 6.86081 5.66376 6.86081H7.62478C7.8097 6.86081 7.97051 6.73405 8.01371 6.55425L8.14014 6.02798C8.20057 5.77642 8.00992 5.53454 7.75121 5.53454H6.06409zM14.3211 5.72037L12.5124 7.96963 11.4089 5.77754C11.3422 5.63012 11.1954 5.5354 11.0336 5.5354H10.3129C10.0085 5.5354 9.80921 5.85428 9.9427 6.1279L11.4089 9.05502 8.79783 12.1493C8.56587 12.4158 8.75519 12.8315 9.10855 12.8315H9.68607C9.80672 12.8315 9.9605 12.7822 10.0388 12.6904L12.1108 10.2648 13.1176 12.561C13.1786 12.7231 13.333 12.8315 13.5061 12.8315H14.3C14.5831 12.8315 14.7417 12.6175 14.6426 12.3524L13.1728 9.28628C13.1728 9.28628 15.4009 6.45542 15.6013 6.17892 15.7966 5.90929 15.6023 5.5354 15.2693 5.5354H14.6661C14.5275 5.5354 14.4333 5.58887 14.3211 5.72037z"}}]},nX=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"fx-single",ref:t,icon:nz}))});nX.displayName="FxSingle";var nY={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M6.4833 1.65005C6.4833 1.31868 6.21467 1.05005 5.8833 1.05005C5.55193 1.05005 5.2833 1.31868 5.2833 1.65005V5.28345H1.65029C1.31892 5.28345 1.05029 5.55208 1.05029 5.88345C1.05029 6.21482 1.31892 6.48345 1.65029 6.48345H5.2833V9.51684H1.65029C1.31892 9.51684 1.05029 9.78547 1.05029 10.1168C1.05029 10.4482 1.31892 10.7168 1.65029 10.7168H5.2833V14.35C5.2833 14.6814 5.55193 14.95 5.8833 14.95C6.21467 14.95 6.4833 14.6814 6.4833 14.35V10.7168H9.5167V14.35C9.5167 14.6814 9.78533 14.95 10.1167 14.95C10.4481 14.95 10.7167 14.6814 10.7167 14.35V10.7168H14.3503C14.6817 10.7168 14.9503 10.4482 14.9503 10.1168C14.9503 9.78547 14.6817 9.51685 14.3503 9.51685H10.7167V6.48345H14.3503C14.6817 6.48345 14.9503 6.21482 14.9503 5.88345C14.9503 5.55208 14.6817 5.28345 14.3503 5.28345H10.7167V1.65005C10.7167 1.31868 10.4481 1.05005 10.1167 1.05005C9.78533 1.05005 9.5167 1.31868 9.5167 1.65005V5.28345L6.4833 5.28345V1.65005ZM6.4833 6.48345V9.51684L9.5167 9.51685V6.48345L6.4833 6.48345Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.0498 3.65005C1.0498 2.21411 2.21386 1.05005 3.6498 1.05005H12.3498C13.7857 1.05005 14.9498 2.21411 14.9498 3.65005V12.3501C14.9498 13.786 13.7857 14.95 12.3498 14.95H3.6498C2.21386 14.95 1.0498 13.786 1.0498 12.35V3.65005ZM3.6498 2.25005C2.87661 2.25005 2.2498 2.87685 2.2498 3.65005V12.35C2.2498 13.1232 2.87661 13.75 3.6498 13.75H12.3498C13.123 13.75 13.7498 13.1232 13.7498 12.3501V3.65005C13.7498 2.87685 13.123 2.25005 12.3498 2.25005H3.6498Z",fillRule:"evenodd",clipRule:"evenodd"}}]},nG=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"hide-gridlines",ref:t,icon:nY}))});nG.displayName="HideGridlines";var nZ={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},nK=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"increase-single",ref:t,icon:nZ}))});nK.displayName="IncreaseSingle";var nq={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.62402 7.72905C2.58427 7.72905 2.55205 7.76127 2.55205 7.80102V13.6782C2.55205 13.7179 2.58427 13.7502 2.62402 13.7502H13.3755C13.4152 13.7502 13.4474 13.7179 13.4474 13.6782V7.80102C13.4474 7.76127 13.4152 7.72905 13.3755 7.72905H2.62402ZM1.35205 7.80102C1.35205 7.09853 1.92153 6.52905 2.62402 6.52905H13.3755C14.0779 6.52905 14.6474 7.09853 14.6474 7.80102V13.6782C14.6474 14.3807 14.0779 14.9502 13.3755 14.9502H2.62402C1.92153 14.9502 1.35205 14.3807 1.35205 13.6782V7.80102Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M8 2.25005C6.69847 2.25003 5.64336 3.30513 5.64336 4.60666V7.12895C5.64336 7.46032 5.37473 7.72895 5.04336 7.72895 4.71199 7.72895 4.44336 7.46032 4.44336 7.12895V4.60666C4.44336 2.64239 6.04451 1.05565 8.00879 1.05566M8 2.25005L8.00879 1.05566 8 2.25005zM8.00879 1.05566L8 2.25005C9.30154 2.25003 10.3567 3.30513 10.3567 4.60666V7.12895C10.3567 7.46032 10.6253 7.72895 10.9567 7.72895 11.288 7.72895 11.5567 7.46032 11.5567 7.12895V4.60666C11.5567 2.64239 9.97306 1.05565 8.00879 1.05566zM8.00039 9.4668C8.33176 9.4668 8.60039 9.73543 8.60039 10.0668V12.0827C8.60039 12.4141 8.33176 12.6827 8.00039 12.6827 7.66902 12.6827 7.40039 12.4141 7.40039 12.0827V10.0668C7.40039 9.73543 7.66902 9.4668 8.00039 9.4668z",fillRule:"evenodd",clipRule:"evenodd"}}]},nQ=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"lock-single",ref:t,icon:nq}))});nQ.displayName="LockSingle";var nJ={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",fillRule:"evenodd",clipRule:"evenodd"}}]},n$=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"more-down-single",ref:t,icon:nJ}))});n$.displayName="MoreDownSingle";var n0={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.90913 3.57564C6.14345 3.34132 6.52335 3.34132 6.75766 3.57564L10.7577 7.57564C10.992 7.80995 10.992 8.18985 10.7577 8.42417L6.75766 12.4242C6.52335 12.6585 6.14345 12.6585 5.90913 12.4242C5.67482 12.1899 5.67482 11.81 5.90913 11.5756L9.48487 7.9999L5.90913 4.42417C5.67482 4.18985 5.67482 3.80995 5.90913 3.57564Z",fillRule:"evenodd",clipRule:"evenodd"}}]},n1=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"more-single",ref:t,icon:n0}))});n1.displayName="MoreSingle";var n2={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"mask",attrs:{id:"mask0_102_1204",style:{maskType:"alpha"},width:16,height:16,x:0,y:0,maskUnits:"userSpaceOnUse"},children:[{tag:"path",attrs:{fill:"#DCDCDC",d:"M0 0H16V16H0z"}}]},{tag:"g",attrs:{mask:"url(#mask0_102_1204)"},children:[{tag:"rect",attrs:{width:12.62,height:2.79,x:1.69,y:12.25,fill:"colorChannel1",rx:1.4}},{tag:"path",attrs:{fill:"currentColor",d:"M7.74646 2.1642C7.34284 1.65121 6.85947 1.28205 6.38447 1.09593C5.86863 0.893787 5.15166 0.852126 4.70047 1.42917C4.29842 1.94344 4.33082 2.70249 4.57691 3.50395C4.68808 3.8661 4.86846 4.22254 5.12522 4.56617C5.13695 4.58185 5.14927 4.5968 5.16211 4.61102C5.17152 4.6214 5.18122 4.63139 5.19115 4.64096C5.20459 4.65393 5.21855 4.66618 5.23296 4.6777L3.5064 6.40422C3.26756 6.64306 3.26756 7.03033 3.5064 7.26919L7.23756 11.0004C7.47648 11.2392 7.86375 11.2392 8.1026 11.0004L12.8329 6.27001C13.0717 6.03117 13.0717 5.6439 12.8329 5.40505L9.10172 1.67387C8.86288 1.43503 8.47561 1.43503 8.23676 1.67387L7.74646 2.1642ZM7.46162 4.50638C7.47252 4.57574 7.48163 4.64652 7.4888 4.71868C7.52232 5.05481 7.82194 5.30013 8.15807 5.26661C8.4942 5.23311 8.73954 4.93345 8.70601 4.59732C8.65786 4.11463 8.54251 3.6666 8.37892 3.26169L8.66928 2.97135L11.5354 5.83753L10.6106 6.76237H4.87824L7.40802 4.2326C7.42885 4.32128 7.44684 4.41255 7.46162 4.50638ZM6.87284 3.03784C6.57441 2.62008 6.22261 2.34634 5.93815 2.23487C5.80233 2.18165 5.71528 2.17827 5.67638 2.18335C5.6725 2.18387 5.66929 2.18443 5.6666 2.18497L5.6619 2.18607C5.64166 2.21954 5.53594 2.45979 5.74626 3.1449C5.81241 3.36036 5.92262 3.58602 6.09307 3.81761L6.87284 3.03784Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M12.1932 11.5463C12.6454 11.5463 13.012 11.1797 13.012 10.7275C13.012 10.4475 12.6981 9.92821 12.459 9.5733C12.3299 9.38173 12.0564 9.38174 11.9274 9.57331C11.6883 9.92822 11.3744 10.4475 11.3744 10.7275C11.3744 11.1797 11.741 11.5463 12.1932 11.5463Z"}}]}]},n5=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"paint-bucket",ref:t,icon:n2}))});n5.displayName="PaintBucket";var n9={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.785 6.77762C5.78908 6.7777 5.79316 6.77774 5.79725 6.77774C5.80134 6.77774 5.80543 6.7777 5.8095 6.77762H10.0184C10.0225 6.7777 10.0266 6.77774 10.0307 6.77774C10.0347 6.77774 10.0388 6.7777 10.0429 6.77762H13.6638V7.63727C13.6638 7.96864 13.9324 8.23727 14.2638 8.23727C14.5951 8.23727 14.8638 7.96864 14.8638 7.63727V3.9999C14.8638 2.56395 13.6997 1.39989 12.2637 1.3999L3.56389 1.39999C2.12797 1.40001 0.96393 2.56405 0.96392 3.99998L0.963867 11.6666C0.963857 13.1025 2.12792 14.2666 3.56387 14.2666H8.0542C8.38557 14.2666 8.6542 13.9979 8.6542 13.6666C8.6542 13.3352 8.38557 13.0666 8.0542 13.0666H3.56387C2.79067 13.0666 2.16386 12.4398 2.16387 11.6666L2.1639 6.77762H5.785ZM6.39725 2.59996L9.43065 2.59993V5.57762H6.39725V2.59996ZM5.19725 5.57762V2.59998L3.56391 2.59999C2.79072 2.6 2.16393 3.22679 2.16392 3.99998L2.16391 5.57762H5.19725ZM13.6638 5.57762V3.9999C13.6638 3.2267 13.037 2.59989 12.2638 2.5999L10.6307 2.59992V5.57762H13.6638Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.1223 10.2333V10.7496C14.7087 10.9869 15.1223 11.5618 15.1223 12.2333V12.8999C15.1223 13.7836 14.406 14.4999 13.5223 14.4999H11.5223C10.6387 14.4999 9.92235 13.7836 9.92235 12.8999V12.2333C9.92235 11.5618 10.336 10.9869 10.9223 10.7496V10.2333C10.9223 9.34961 11.6387 8.63328 12.5223 8.63328C13.406 8.63328 14.1223 9.34961 14.1223 10.2333ZM11.1223 12.2333C11.1223 12.0124 11.3014 11.8333 11.5223 11.8333H13.5223C13.7433 11.8333 13.9223 12.0124 13.9223 12.2333V12.8999C13.9223 13.1209 13.7433 13.2999 13.5223 13.2999H11.5223C11.3014 13.2999 11.1223 13.1209 11.1223 12.8999V12.2333ZM12.9223 10.2333V10.6333H12.1223V10.2333C12.1223 10.0124 12.3014 9.83328 12.5223 9.83328C12.7433 9.83328 12.9223 10.0124 12.9223 10.2333Z",fillRule:"evenodd",clipRule:"evenodd"}}]},n6=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"protect-single",ref:t,icon:n9}))});n6.displayName="ProtectSingle";var n3={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM8.00008 12.3671C8.46031 12.3671 8.83342 11.994 8.83342 11.5338C8.83342 11.0735 8.46031 10.7004 8.00008 10.7004C7.53985 10.7004 7.16675 11.0735 7.16675 11.5338C7.16675 11.994 7.53985 12.3671 8.00008 12.3671ZM8.5999 4.4335C8.5999 4.10213 8.33127 3.8335 7.9999 3.8335C7.66853 3.8335 7.3999 4.10213 7.3999 4.4335V9.36683C7.3999 9.6982 7.66853 9.96683 7.9999 9.96683C8.33127 9.96683 8.5999 9.6982 8.5999 9.36683V4.4335Z",fillRule:"evenodd",clipRule:"evenodd"}}]},n7=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"warning-single",ref:t,icon:n3}))});n7.displayName="WarningSingle";var n4={tag:"svg",attrs:{fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.6551 1.98906C11.7476 1.08113 10.2757 1.08149 9.3686 1.98987L4.82542 6.53955C4.75087 6.61421 4.69336 6.70411 4.65682 6.80309L3.2461 10.625C3.16506 10.8446 3.21909 11.0912 3.3845 11.2568C3.54991 11.4224 3.79651 11.4767 4.01616 11.3959L7.85031 9.98517C7.94979 9.94856 8.04014 9.89077 8.11508 9.81579L12.6552 5.27327C13.5618 4.36621 13.5618 2.89607 12.6551 1.98906ZM10.2177 2.83779C10.6562 2.39869 11.3677 2.39851 11.8064 2.8374C12.2447 3.27584 12.2447 3.9865 11.8065 4.42497L7.3392 8.89457L4.82213 9.82068L5.74706 7.31487L10.2177 2.83779Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.79238 13.2999C1.46101 13.2999 1.19238 13.5685 1.19238 13.8999C1.19238 14.2313 1.46101 14.4999 1.79238 14.4999H14.4924C14.8238 14.4999 15.0924 14.2313 15.0924 13.8999C15.0924 13.5685 14.8238 13.2999 14.4924 13.2999H1.79238Z"}}]},n8=(0,ee.forwardRef)(function(e,t){return(0,ee.createElement)(nR,Object.assign({},e,{id:"write-single",ref:t,icon:n4}))});function re(e,t){if(e.length!==t.length)return!1;let i=e.sort((e,t)=>e.id.localeCompare(t.id)),n=t.sort((e,t)=>e.id.localeCompare(t.id));return i.every((e,t)=>{var i,r;return(null==(i=e.subject)?void 0:i.userID)===(null==(r=n[t].subject)?void 0:r.userID)&&e.role===n[t].role})}function rt(e,t){return t.some(t=>ri(e,t))}function ri(e,t){let{startRow:i,startColumn:n,endColumn:r,endRow:o}=t,s=e.getMatrixWithMergedCells(i,n,o,r),l=!1;return s.forValue((t,r,o)=>{if(o&&(t!==i||r!==n)&&e.cellHasValue(o))return l=!0,!1}),l}function rn(e,t,i,n){let r=[],o=[],s=i.getSheetId();return n.forEach(n=>{let l={unitId:t,subUnitId:s,cellValue:rr(i,n).getData()},a=(0,A.SetRangeValuesUndoMutationFactory)(e,l);r.push({id:A.SetRangeValuesMutation.id,params:a}),o.push({id:A.SetRangeValuesMutation.id,params:l})}),{undos:r,redos:o}}function rr(e,t){let{startRow:i,startColumn:n,endColumn:r,endRow:o}=t,s=e.getMatrixWithMergedCells(i,n,o,r,!0),l=new O.ObjectMatrix,a=null;return s.forValue((t,r,o)=>{o&&t>=i&&r>=n&&(!a&&e.cellHasValue(o)&&(a=o),l.setValue(t,r,null))}),l.setValue(i,n,a),l}function ro(e,t,i,n){let r=i.getActiveViewportByCoord((0,x.Vector2).FromArray([e,t]));if(!r)return;let{scaleX:o,scaleY:s}=i.getAncestorScale(),l={x:r.viewportScrollX,y:r.viewportScrollY},a=n.getCellPositionByOffset(e,t,o,s,l),d=n.worksheet.getMergedCell(a.row,a.column);return{actualRow:d?d.startRow:a.row,actualCol:d?d.startColumn:a.column,mergeCell:d,row:a.row,col:a.column}}function rs(e,t,i,n){let r=n.getFreeze();return!r||r.startRow<=0&&r.startColumn<=0||e>r.startRow&&t>r.startColumn?i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN):e<=r.startRow&&t<=r.startColumn?i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP):e<=r.startRow&&t>r.startColumn?i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP):e>r.startRow&&t<=r.startColumn?i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT):void 0}function rl(e,t,i,n){let r=ra(e.left,e.top,t,i,n),o=ra(e.right,e.bottom,t,i,n);return{left:r.x,top:r.y,right:o.x,bottom:o.y}}function ra(e,t,i,n,r){let{scaleX:o,scaleY:s}=i.getAncestorScale(),l=i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(!l)return{x:e,y:t};let{startColumn:a,startRow:d,xSplit:c,ySplit:u}=r.getFreeze(),h=n.getNoMergeCellPositionByIndexWithNoHeader(d-u,a-c),m=n.getNoMergeCellPositionByIndexWithNoHeader(d,a),{rowHeaderWidth:g,columnHeaderHeight:p}=n,v=m.startX-h.startX,S=m.startY-h.startY,{top:f,left:C,viewportScrollX:I,viewportScrollY:b}=l;return{x:e>C?(e-I)*o:(v+g-(C-e))*o,y:t>f?(t-b)*s:(S+p-(f-t))*o}}function rd(e,t,i,n,r){let o=n,s=r;i.overflowCache.forValue((e,t,i)=>{i.startRow<=o&&i.endRow>=o&&i.startColumn<=s&&i.endColumn>=s&&(s=t,o=e)});let l=i.getCellByIndex(o,s);return{unitId:e.getUnitId(),subUnitId:t.getSheetId(),workbook:e,worksheet:t,row:l.actualRow,col:l.actualColumn}}function rc(e,t,i,n,r,o){let s;let{scene:l}=e,a=t.getUnitId(),{skeleton:d,sheetId:c}=n,u=ro(r,o,l,d);if(!u)return null;let{actualCol:h,actualRow:m}=u;d.overflowCache.forValue((e,t,i)=>{i.startRow<=m&&i.endRow>=m&&i.startColumn<=h&&i.endColumn>=h&&(h=t,m=e)});let g=d.getCellByIndex(m,h),p={unitId:a,subUnitId:c,workbook:t,worksheet:i,row:g.actualRow,col:g.actualColumn},v=rd(t,i,d,m,h);s=g.mergeInfo?g.mergeInfo:{startRow:v.row,endRow:v.row,startColumn:v.col,endColumn:v.col};let S=l.getActiveViewportByCoord((0,x.Vector2).FromArray([r,o]));if(!S)return;let{scaleX:f,scaleY:C}=l.getAncestorScale(),I={x:S.viewportScrollX,y:S.viewportScrollY};return{position:{startX:(d.getOffsetByPositionX(s.startColumn-1)-I.x)*f,endX:(d.getOffsetByPositionX(s.endColumn)-I.x)*f,startY:(d.getOffsetByPositionY(s.startRow-1)-I.y)*C,endY:(d.getOffsetByPositionY(s.endRow)-I.y)*C},location:p,overflowLocation:v}}n8.displayName="WriteSingle",el(re,"getUserListEqual"),el(rt,"checkCellContentInRanges"),el(ri,"checkCellContentInRange"),el(rn,"getClearContentMutationParamsForRanges"),el(rr,"getClearContentMutationParamForRange"),el(ro,"getCellIndexByOffsetWithMerge"),el(rs,"getViewportByCell"),el(rl,"transformBound2OffsetBound"),el(ra,"transformPosition2Offset"),el(rd,"getCellRealRange"),el(rc,"getHoverCellPosition");let ru={type:O.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge",handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.ICommandService),n=e.get(O.IUndoRedoService),r=e.get(O.IUniverInstanceService),o=e.get(J.IConfirmService),s=e.get(O.LocaleService),l=t.unitId,a=t.subUnitId,d=t.selections,c=(0,A.getAddMergeMutationRangeByType)(d,t.value),u=r.getUniverSheetInstance(l).getSheetBySheetId(a),h=[],m=[],g=rt(u,c);if(g&&!await o.confirm({id:"merge.confirm.add-worksheet-merge",title:{title:"merge.confirm.title"},cancelText:s.t("merge.confirm.cancel"),confirmText:s.t("merge.confirm.confirm")}))return!1;let p={unitId:l,subUnitId:a,ranges:(0,O.Tools).deepClone(c)},v={unitId:l,subUnitId:a,ranges:(0,O.Tools).deepClone(c)},S=(0,A.RemoveMergeUndoMutationFactory)(e,p),f=(0,A.AddMergeUndoMutationFactory)(e,v);if(S.ranges.length>0&&h.push({id:A.RemoveWorksheetMergeMutation.id,params:S}),h.push({id:A.AddWorksheetMergeMutation.id,params:v}),m.push({id:A.RemoveWorksheetMergeMutation.id,params:f}),S.ranges.length>0&&m.push({id:A.AddWorksheetMergeMutation.id,params:S}),g){let t=rn(e,l,u,c);h.unshift(...t.redos),m.push(...t.undos)}let C=(0,A.AddMergeRedoSelectionsOperationFactory)(e,t,c);C&&h.push(C);let I=(0,A.AddMergeUndoSelectionsOperationFactory)(e,t);return I&&m.push(I),!!(0,O.sequenceExecute)(h,i).result&&(n.pushUndoRedo({unitID:l,undoMutations:m,redoMutations:h}),!0)},"handler")},rh={type:O.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-all",handler:/* @__PURE__ */el(async e=>{var t;let i=e.get(O.ICommandService),n=null==(t=e.get(A.SheetsSelectionsService).getCurrentSelections())?void 0:t.map(e=>e.range),r=ts(e1.MergeAll,n);if(!(null!=r&&r.length))return!1;let o=e.get(O.IUniverInstanceService).getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!o)return!1;let s=o.getActiveSheet();if(!s)return!1;let l=o.getUnitId(),a=s.getSheetId();return i.executeCommand(ru.id,{selections:r,unitId:l,subUnitId:a})},"handler")},rm={type:O.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-vertical",handler:/* @__PURE__ */el(async e=>{var t;let i=e.get(O.ICommandService),n=null==(t=e.get(A.SheetsSelectionsService).getCurrentSelections())?void 0:t.map(e=>e.range),r=ts(e1.MergeVertical,n);if(!(null!=r&&r.length))return!1;let o=e.get(O.IUniverInstanceService).getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!o)return!1;let s=o.getActiveSheet();if(!s)return!1;let l=o.getUnitId(),a=s.getSheetId();return i.executeCommand(ru.id,{value:O.Dimension.COLUMNS,selections:r,unitId:l,subUnitId:a})},"handler")},rg={type:O.CommandType.COMMAND,id:"sheet.command.add-worksheet-merge-horizontal",handler:/* @__PURE__ */el(async e=>{var t;let i=e.get(O.ICommandService),n=null==(t=e.get(A.SheetsSelectionsService).getCurrentSelections())?void 0:t.map(e=>e.range),r=ts(e1.MergeHorizontal,n);if(!(null!=r&&r.length))return!1;let o=e.get(O.IUniverInstanceService).getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!o)return!1;let s=o.getActiveSheet();if(!s)return!1;let l=o.getUnitId(),a=s.getSheetId();return i.executeCommand(ru.id,{value:O.Dimension.ROWS,selections:r,unitId:l,subUnitId:a})},"handler")},rp={type:O.CommandType.COMMAND,id:"sheet.command.delete-range-move-left-confirm",handler:/* @__PURE__ */el(async e=>{let t=e.get(J.IConfirmService),i=e.get(O.ICommandService),n=e.get(O.LocaleService),r=e.get(A.SheetsSelectionsService),o=e.get(O.IUniverInstanceService),s=r.getCurrentSelections();if(!s)return!1;let l=(0,A.getSheetCommandTarget)(o);if(!l)return!1;let{worksheet:a}=l,d=s[0].range;if(!d)return!1;d={...d,endColumn:a.getColumnCount()-1};let c=/* @__PURE__ */el(e=>e.endRow-e.startRow,"getRowLength");return a.getMergeData().find(e=>{let t=(0,O.Rectangle).getIntersects(e,d);return!!t&&c(e)>c(t)})&&!await t.confirm({id:rp.id,title:{title:n.t("merge.confirm.waring")},children:{title:n.t("merge.confirm.dismantleMergeCellWaring")},cancelText:n.t("button.cancel"),confirmText:n.t("button.confirm")})||i.executeCommand(A.DeleteRangeMoveLeftCommand.id)},"handler")},rv={type:O.CommandType.COMMAND,id:"sheet.command.delete-range-move-up-confirm",handler:/* @__PURE__ */el(async e=>{let t=e.get(J.IConfirmService),i=e.get(O.ICommandService),n=e.get(O.LocaleService),r=e.get(A.SheetsSelectionsService),o=e.get(O.IUniverInstanceService),s=r.getCurrentSelections();if(!s)return!1;let l=(0,A.getSheetCommandTarget)(o);if(!l)return!1;let{worksheet:a}=l,d=s[0].range;if(!d)return!1;d={...d,endRow:a.getRowCount()-1};for(let e=d.startRow;e<=d.endRow;e++)if(a.getRowFiltered(e)&&await t.confirm({id:rv.id,title:{title:n.t("filter.confirm.error")},children:{title:n.t("filter.confirm.notAllowedToInsertRange")},confirmText:n.t("button.confirm")}))return!1;let c=/* @__PURE__ */el(e=>e.endColumn-e.startColumn,"getColLength");return a.getMergeData().find(e=>{let t=(0,O.Rectangle).getIntersects(e,d);return!!t&&c(e)>c(t)})&&!await t.confirm({id:rv.id,title:{title:n.t("merge.confirm.waring")},children:{title:n.t("merge.confirm.dismantleMergeCellWaring")},cancelText:n.t("button.cancel"),confirmText:n.t("button.confirm")})||i.executeCommand(A.DeleteRangeMoveUpCommand.id)},"handler")},rS={id:"sheet.command.hide-row-confirm",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async e=>{var t;let i=null==(t=e.get(A.SheetsSelectionsService).getCurrentSelections())?void 0:t.map(e=>e.range);if(!(null!=i&&i.length))return!1;let n=e.get(O.ICommandService),r=e.get(O.IUniverInstanceService),o=(0,A.getSheetCommandTarget)(r);if(!o)return!1;let{worksheet:s}=o;if(tr(s.getVisibleRows(),i)){let t=e.get(J.IConfirmService),i=e.get(O.LocaleService);return await t.confirm({id:"sheet.confirm.hide-row",title:{title:i.t("info.problem")},children:{title:i.t("rightClick.hideAllRowsAlert")},cancelText:i.t("button.cancel"),confirmText:i.t("button.confirm")}),!1}return await n.executeCommand(A.SetRowHiddenCommand.id),!0},"handler")},rf={id:"sheet.command.hide-col-confirm",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async e=>{var t;let i=null==(t=e.get(A.SheetsSelectionsService).getCurrentSelections())?void 0:t.map(e=>e.range);if(!(null!=i&&i.length))return!1;let n=e.get(O.ICommandService),r=e.get(O.IUniverInstanceService),o=(0,A.getSheetCommandTarget)(r);if(!o)return!1;let{worksheet:s}=o;if(to(s.getVisibleCols(),i)){let t=e.get(J.IConfirmService),i=e.get(O.LocaleService);return await t.confirm({id:"sheet.confirm.hide-col",title:{title:i.t("info.problem")},children:{title:i.t("rightClick.hideAllColumnsAlert")},cancelText:i.t("button.cancel"),confirmText:i.t("button.confirm")}),!1}return await n.executeCommand(A.SetColHiddenCommand.id),!0},"handler")},rC={type:O.CommandType.COMMAND,id:"sheet.command.set-range-bold",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?t.executeCommand(M.SetInlineFormatBoldCommand.id):t.executeCommand(A.SetBoldCommand.id)},"handler")},rI={type:O.CommandType.COMMAND,id:"sheet.command.set-range-italic",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?t.executeCommand(M.SetInlineFormatItalicCommand.id):t.executeCommand(A.SetItalicCommand.id)},"handler")},rb={type:O.CommandType.COMMAND,id:"sheet.command.set-range-underline",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?t.executeCommand(M.SetInlineFormatUnderlineCommand.id):t.executeCommand(A.SetUnderlineCommand.id)},"handler")},r_={type:O.CommandType.COMMAND,id:"sheet.command.set-range-stroke",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?t.executeCommand(M.SetInlineFormatStrikethroughCommand.id):t.executeCommand(A.SetStrikeThroughCommand.id)},"handler")},rR={type:O.CommandType.COMMAND,id:"sheet.command.set-range-subscript",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return!!e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)&&t.executeCommand(M.SetInlineFormatSubscriptCommand.id)},"handler")},ry={type:O.CommandType.COMMAND,id:"sheet.command.set-range-superscript",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return!!e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)&&t.executeCommand(M.SetInlineFormatSuperscriptCommand.id)},"handler")},rT={type:O.CommandType.COMMAND,id:"sheet.command.set-range-fontsize",handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?i.executeCommand(M.SetInlineFormatFontSizeCommand.id,t):i.executeCommand(A.SetFontSizeCommand.id,t)},"handler")},rE={type:O.CommandType.COMMAND,id:"sheet.command.set-range-font-family",handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?i.executeCommand(M.SetInlineFormatFontFamilyCommand.id,t):i.executeCommand(A.SetFontFamilyCommand.id,t)},"handler")},rw={type:O.CommandType.COMMAND,id:"sheet.command.set-range-text-color",handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?i.executeCommand(M.SetInlineFormatTextColorCommand.id,t):i.executeCommand(A.SetTextColorCommand.id,t)},"handler")},rP={type:O.CommandType.COMMAND,id:"sheet.command.reset-range-text-color",handler:/* @__PURE__ */el(async e=>{let t=e.get(O.ICommandService);return e.get(O.IContextService).getContextValue(O.EDITOR_ACTIVATED)?t.executeCommand(M.SetInlineFormatTextColorCommand.id,{value:null}):t.executeCommand(A.SetTextColorCommand.id,{value:null})},"handler")},rM={type:O.CommandType.COMMAND,id:"sheet.command.insert-range-move-down-confirm",handler:/* @__PURE__ */el(async e=>{let t=e.get(J.IConfirmService),i=e.get(O.ICommandService),n=e.get(O.LocaleService),r=e.get(A.SheetsSelectionsService),o=e.get(O.IUniverInstanceService),s=r.getCurrentSelections();if(!s)return!1;let l=(0,A.getSheetCommandTarget)(o);if(!l)return!1;let{worksheet:a}=l,d=s[0].range;if(!d)return!1;d={...d,endRow:a.getRowCount()-1};for(let e=d.startRow;e<=d.endRow;e++)if(a.getRowFiltered(e)&&await t.confirm({id:rM.id,title:{title:n.t("filter.confirm.error")},children:{title:n.t("filter.confirm.notAllowedToInsertRange")},confirmText:n.t("button.confirm")}))return!1;let c=/* @__PURE__ */el(e=>e.endColumn-e.startColumn,"getColLength");return a.getMergeData().find(e=>{let t=(0,O.Rectangle).getIntersects(e,d);return!!t&&c(e)>c(t)})&&!await t.confirm({id:rM.id,title:{title:n.t("merge.confirm.waring")},children:{title:n.t("merge.confirm.dismantleMergeCellWaring")},cancelText:n.t("button.cancel"),confirmText:n.t("button.confirm")})||i.executeCommand(A.InsertRangeMoveDownCommand.id)},"handler")},rO={type:O.CommandType.COMMAND,id:"sheet.command.insert-range-move-right-confirm",handler:/* @__PURE__ */el(async e=>{let t=e.get(J.IConfirmService),i=e.get(O.ICommandService),n=e.get(O.LocaleService),r=e.get(A.SheetsSelectionsService),o=e.get(O.IUniverInstanceService),s=r.getCurrentSelections();if(!s)return!1;let l=(0,A.getSheetCommandTarget)(o);if(!l)return!1;let{worksheet:a}=l,d=s[0].range;if(!d)return!1;d={...d,endColumn:a.getColumnCount()-1};let c=/* @__PURE__ */el(e=>e.endRow-e.startRow,"getRowLength");return a.getMergeData().find(e=>{let t=(0,O.Rectangle).getIntersects(e,d);return!!t&&c(e)>c(t)})&&!await t.confirm({id:rO.id,title:{title:n.t("merge.confirm.waring")},children:{title:n.t("merge.confirm.dismantleMergeCellWaring")},cancelText:n.t("button.cancel"),confirmText:n.t("button.confirm")})||i.executeCommand(A.InsertRangeMoveRightCommand.id)},"handler")};var rx=((p=rx||{})[p.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",p[p.UNIVER_DOC=1]="UNIVER_DOC",p[p.UNIVER_SHEET=2]="UNIVER_SHEET",p[p.UNIVER_SLIDE=3]="UNIVER_SLIDE",p[p.UNIVER_PROJECT=4]="UNIVER_PROJECT",p[p.UNRECOGNIZED=-1]="UNRECOGNIZED",p),rA=((v=rA||{})[v.View=0]="View",v[v.Edit=1]="Edit",v[v.ManageCollaborator=2]="ManageCollaborator",v[v.Print=3]="Print",v[v.Duplicate=4]="Duplicate",v[v.Comment=5]="Comment",v[v.Copy=6]="Copy",v[v.Share=7]="Share",v[v.Export=8]="Export",v[v.MoveWorksheet=9]="MoveWorksheet",v[v.DeleteWorksheet=10]="DeleteWorksheet",v[v.HideWorksheet=11]="HideWorksheet",v[v.RenameWorksheet=12]="RenameWorksheet",v[v.CreateWorksheet=13]="CreateWorksheet",v[v.SetWorksheetStyle=14]="SetWorksheetStyle",v[v.EditWorksheetCell=15]="EditWorksheetCell",v[v.InsertHyperlink=16]="InsertHyperlink",v[v.Sort=17]="Sort",v[v.Filter=18]="Filter",v[v.PivotTable=19]="PivotTable",v[v.FloatImg=20]="FloatImg",v[v.History=21]="History",v[v.RwHgtClWdt=22]="RwHgtClWdt",v[v.ViemRwHgtClWdt=23]="ViemRwHgtClWdt",v[v.ViewFilter=24]="ViewFilter",v[v.MoveSheet=25]="MoveSheet",v[v.DeleteSheet=26]="DeleteSheet",v[v.HideSheet=27]="HideSheet",v[v.CopySheet=28]="CopySheet",v[v.RenameSheet=29]="RenameSheet",v[v.CreateSheet=30]="CreateSheet",v[v.SelectProtectedCells=31]="SelectProtectedCells",v[v.SelectUnProtectedCells=32]="SelectUnProtectedCells",v[v.SetCellStyle=33]="SetCellStyle",v[v.SetCellValue=34]="SetCellValue",v[v.SetRowStyle=35]="SetRowStyle",v[v.SetColumnStyle=36]="SetColumnStyle",v[v.InsertRow=37]="InsertRow",v[v.InsertColumn=38]="InsertColumn",v[v.DeleteRow=39]="DeleteRow",v[v.DeleteColumn=40]="DeleteColumn",v[v.EditExtraObject=41]="EditExtraObject",v[v.Delete=42]="Delete",v[v.RecoverHistory=43]="RecoverHistory",v[v.ViewHistory=44]="ViewHistory",v[v.CreatePermissionObject=45]="CreatePermissionObject",v[v.UNRECOGNIZED=-1]="UNRECOGNIZED",v),rk=((S=rk||{})[S.Reader=0]="Reader",S[S.Editor=1]="Editor",S[S.Owner=2]="Owner",S[S.UNRECOGNIZED=-1]="UNRECOGNIZED",S),rN=((f=rN||{})[f.Unkonwn=0]="Unkonwn",f[f.Workbook=1]="Workbook",f[f.Worksheet=2]="Worksheet",f[f.SelectRange=3]="SelectRange",f[f.Document=4]="Document",f[f.Slide=5]="Slide",f[f.UNRECOGNIZED=-1]="UNRECOGNIZED",f),rD=((C=rD||{})[C.SomeCollaborator=0]="SomeCollaborator",C[C.AllCollaborator=1]="AllCollaborator",C[C.OneSelf=2]="OneSelf",C[C.UNRECOGNIZED=-1]="UNRECOGNIZED",C);let rV={name:"",unitId:"",subUnitId:"",permissionId:"",unitType:rN.Unkonwn,id:"",ranges:[]};var rW=((I=rW||{}).othersCanView="othersCanView",I.noOneElseCanView="noOneElseCanView",I),rH=((b=rH||{}).designedUserCanEdit="designedUserCanEdit",b.onlyMe="onlyMe",b);let rU=class{constructor(){ea(this,"_rule",rV),ea(this,"_rule$",new k.BehaviorSubject(this._rule)),ea(this,"_oldRule"),ea(this,"_rangeErrorMsg$",new k.BehaviorSubject(void 0)),ea(this,"_visible",!1),ea(this,"rangeErrorMsg$",this._rangeErrorMsg$.asObservable()),ea(this,"rule$",this._rule$.asObservable())}setVisible(e){this._visible=e}getVisible(){return this._visible}setRangeErrorMsg(e){this._rangeErrorMsg$.next(e)}get rule(){return this._rule}setRule(e){this._rule={...this._rule,...e},this._rule$.next(this._rule)}resetRule(){this._rule=rV,this._rule$.next(this._rule)}reset(){this.setVisible(!1),this.resetRule(),this.setRangeErrorMsg(""),this.setOldRule(null)}get oldRule(){return this._oldRule}setOldRule(e){this._oldRule=e}};el(rU,"SheetPermissionPanelModel");let rL=class{constructor(){ea(this,"_userList",[]),ea(this,"_oldCollaboratorList",[]),ea(this,"_selectUserList",[]),ea(this,"_allUserList",[]),ea(this,"_selectUserList$",new k.BehaviorSubject(this._selectUserList)),ea(this,"selectUserList$",this._selectUserList$.asObservable())}get userList(){return this._userList}get allUserList(){return this._allUserList}setAllUserList(e){this._allUserList=e}setUserList(e){this._userList=e}reset(){this._userList=[],this._oldCollaboratorList=[],this._selectUserList=[],this._selectUserList$.next([]),this._allUserList=[]}get oldCollaboratorList(){return this._oldCollaboratorList}setOldCollaboratorList(e){this._oldCollaboratorList=e}get selectUserList(){return this._selectUserList}setSelectUserList(e){this._selectUserList=e,this._selectUserList$.next(e)}};el(rL,"SheetPermissionUserManagerService");let rB="UNIVER_SHEET_PERMISSION_PANEL",rF="UNIVER_SHEET_PERMISSION_PANEL_FOOTER",rj="UNIVER_SHEET_PERMISSION_USER_DIALOG",rz="UNIVER_SHEET_PERMISSION_DIALOG",rX="UNIVER_SHEET_PERMISSION_USER_DIALOG_ID",rY="UNIVER_SHEET_PERMISSION_DIALOG_ID",rG={[rA.Copy]:"Copy",[rA.SetCellStyle]:"SetCellStyle",[rA.SetCellValue]:"SetCellValue",[rA.SetRowStyle]:"SetRowStyle",[rA.SetColumnStyle]:"SetColumnStyle",[rA.InsertRow]:"InsertRow",[rA.InsertColumn]:"InsertColumn",[rA.InsertHyperlink]:"InsertHyperlink",[rA.DeleteRow]:"DeleteRow",[rA.DeleteColumn]:"DeleteColumn",[rA.Sort]:"Sort",[rA.Filter]:"Filter",[rA.PivotTable]:"PivotTable",[rA.EditExtraObject]:"EditExtraObject"},rZ=(rA.Copy,rA.SetCellStyle,rA.SetCellValue,rA.SetRowStyle,rA.SetColumnStyle,rA.InsertRow,rA.InsertColumn,rA.InsertHyperlink,rA.DeleteRow,rA.DeleteColumn,rA.Sort,rA.Filter,rA.PivotTable,rA.EditExtraObject,rA.View,"sheet-permission-menu-icon"),rK="sheet-permission-lock-icon",rq={type:O.CommandType.OPERATION,id:"sheet-permission.operation.openPanel",async handler(e,t={}){let i=e.get(J.ISidebarService),n=e.get(rU),r=e.get(rL),{showDetail:o=!0,fromSheetBar:s=!1}=t,l={header:{title:"permission.panel.title"},children:{label:rB,showDetail:o,fromSheetBar:s},width:330,footer:{label:rF,showDetail:o},onClose:/* @__PURE__ */el(()=>{n.reset(),r.reset()},"onClose")};return n.setVisible(!0),i.open(l),!0}},rQ={type:O.CommandType.COMMAND,id:"sheet.command.add-worksheet-protection",async handler(e,t){if(!t)return!1;let i=e.get(O.ICommandService),n=e.get(O.IUndoRedoService),{rule:r,unitId:o}=t,s=r.subUnitId;if(await i.executeCommand(A.AddWorksheetProtectionMutation.id,{unitId:o,rule:r,subUnitId:r.subUnitId})){let e=[{id:A.AddWorksheetProtectionMutation.id,params:{unitId:o,rule:r,subUnitId:r.subUnitId}}],t=[{id:A.DeleteWorksheetProtectionMutation.id,params:{unitId:o,subUnitId:s}}];n.pushUndoRedo({unitID:o,redoMutations:e,undoMutations:t})}return!0}},rJ={type:O.CommandType.COMMAND,id:"sheet.command.delete-worksheet-protection",handler(e,t){if(!t)return!1;let i=e.get(O.ICommandService),n=e.get(O.IUndoRedoService),{rule:r,unitId:o,subUnitId:s}=t;i.executeCommand(A.DeleteWorksheetProtectionMutation.id,{unitId:o,subUnitId:s});let l=[{id:A.DeleteWorksheetProtectionMutation.id,params:{unitId:o,subUnitId:s}}],a=[{id:A.AddWorksheetProtectionMutation.id,params:{unitId:o,rule:r,subUnitId:s}}];return n.pushUndoRedo({unitID:o,redoMutations:l,undoMutations:a}),!0}},r$={type:O.CommandType.COMMAND,id:"sheet.command.set-worksheet-protection",async handler(e,t){if(!t)return!1;let i=e.get(O.ICommandService),n=e.get(rU),r=e.get(O.IUndoRedoService),{rule:o,permissionId:s}=t,{unitId:l,subUnitId:a}=o,d={...o,permissionId:s},c=n.oldRule;if(await i.executeCommand(A.SetWorksheetProtectionMutation.id,{unitId:l,subUnitId:a,newRule:d})){let e=[{id:A.SetWorksheetProtectionMutation.id,params:{unitId:l,subUnitId:a,newRule:d}}],t=[{id:A.SetWorksheetProtectionMutation.id,params:{unitId:l,subUnitId:a,rule:c}}];r.pushUndoRedo({unitID:l,redoMutations:e,undoMutations:t})}return!0}},r0={type:O.CommandType.COMMAND,id:"sheet.command.delete-worksheet-protection-from-sheet-bar",async handler(e,t){if(!t)return!1;let i=e.get(O.ICommandService),n=e.get(O.IUndoRedoService),r=e.get(A.WorksheetProtectionRuleModel),o=e.get(O.IUniverInstanceService).getCurrentUnitForType(rx.UNIVER_SHEET),s=null==o?void 0:o.getActiveSheet(),l=o.getUnitId();if(!s)return!1;let a=s.getSheetId(),d=r.getRule(l,a);if(await i.executeCommand(rJ.id,{unitId:l,subUnitId:a})){let e=[{id:rJ.id,params:{unitId:l,subUnitId:a}}],t=[{id:rQ.id,params:{unitId:l,rule:d}}];n.pushUndoRedo({unitID:l,redoMutations:e,undoMutations:t})}return!0}},r1={type:O.CommandType.COMMAND,id:"sheet.command.change-sheet-protection-from-sheet-bar",handler:async e=>(await e.get(O.ICommandService).executeCommand("sheet-permission.operation.openDialog"),!0)},r2={type:O.CommandType.COMMAND,id:"sheet.command.add-range-protection-from-toolbar",async handler(e){let t=e.get(O.ICommandService);return e.get(rU).resetRule(),await t.executeCommand(rq.id,{showDetail:!0}),!0}},r5={type:O.CommandType.COMMAND,id:"sheet.command.add-range-protection-from-context-menu",async handler(e){let t=e.get(O.ICommandService);return e.get(rU).resetRule(),await t.executeCommand(rq.id,{showDetail:!0}),!0}},r9={type:O.CommandType.COMMAND,id:"sheet.command.view-sheet-permission-from-context-menu",handler:async e=>(await e.get(O.ICommandService).executeCommand(rq.id,{showDetail:!1}),!0)},r6={type:O.CommandType.COMMAND,id:"sheet.command.add-range-protection-from-sheet-bar",async handler(e){let t=e.get(O.ICommandService);return e.get(rU).resetRule(),await t.executeCommand(rq.id,{fromSheetBar:!0,showDetail:!0}),!0}},r3={type:O.CommandType.COMMAND,id:"sheet.command.view-sheet-permission-from-sheet-bar",handler:async e=>(await e.get(O.ICommandService).executeCommand(rq.id,{showDetail:!1}),!0)},r7=(O.CommandType.COMMAND,O.CommandType.COMMAND,O.CommandType.COMMAND,{type:O.CommandType.COMMAND,id:"sheet.command.delete-range-protection-from-context-menu",async handler(e){var t;let i=e.get(O.ICommandService),n=e.get(O.IUniverInstanceService),r=e.get(O.IUndoRedoService),o=e.get(A.SheetsSelectionsService),s=e.get(A.WorksheetProtectionRuleModel),l=n.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),a=l.getActiveSheet(),d=l.getUnitId(),c=a.getSheetId(),u=s.getRule(d,c);if(null!=u&&u.permissionId)return i.executeCommand(rJ.id,{unitId:d,subUnitId:c,rule:u});{let n=null==(t=o.getCurrentLastSelection())?void 0:t.range;if(!n)return!1;let s=e.get(A.RangeProtectionRuleModel).getSubunitRuleList(d,c).find(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(e,n)));if(!s)return!1;{let e={unitId:d,subUnitId:c,ruleIds:[s.id]};return await i.executeCommand(A.DeleteRangeProtectionMutation.id,e)&&r.pushUndoRedo({unitID:d,redoMutations:[{id:A.DeleteRangeProtectionMutation.id,params:e}],undoMutations:[{id:A.AddRangeProtectionMutation.id,params:{unitId:d,subUnitId:c,rules:[s]}}]}),!0}}}}),r4={type:O.CommandType.COMMAND,id:"sheet.command.set-range-protection-from-context-menu",async handler(e){var t;let i=e.get(O.ICommandService),n=e.get(O.IUniverInstanceService),r=e.get(A.SheetsSelectionsService),o=e.get(A.WorksheetProtectionRuleModel),s=n.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),l=s.getActiveSheet(),a=s.getUnitId(),d=l.getSheetId(),c=o.getRule(a,d),u=e.get(rU);if(null!=c&&c.permissionId){let e={...c,unitId:a,subUnitId:d,ranges:[]};return u.setRule(e),u.setOldRule(e),await i.executeCommand(rq.id,{showDetail:!0}),!0}{let n=null==(t=r.getCurrentLastSelection())?void 0:t.range;if(!n)return!1;let o=e.get(A.RangeProtectionRuleModel).getSubunitRuleList(a,d).find(e=>{var t;return null==(t=null==e?void 0:e.ranges)?void 0:t.some(e=>(0,O.Rectangle).intersects(e,n))});if(!o)return!1;{let e={...o,unitId:a,subUnitId:d};return u.setRule(e),u.setOldRule(e),await i.executeCommand(rq.id,{showDetail:!0}),!0}}}},r8={type:O.CommandType.COMMAND,id:"sheet.command.set-protection",async handler(e,t){if(!t)return!1;let i=e.get(O.ICommandService),n=e.get(O.IUndoRedoService),r=e.get(rU),o=e.get(A.RangeProtectionRuleModel),{rule:s}=t,{unitId:l,subUnitId:a}=s,d=[],c=[],u=r.oldRule;return(null==u?void 0:u.unitType)===s.unitType?s.unitType===rN.Worksheet?(d.push({id:A.SetWorksheetProtectionMutation.id,params:{unitId:l,subUnitId:a,rule:s}}),c.push({id:A.SetWorksheetProtectionMutation.id,params:{unitId:l,subUnitId:a,rule:u}})):(d.push({id:A.SetRangeProtectionMutation.id,params:{unitId:l,subUnitId:a,rule:s,ruleId:s.id}}),c.push({id:A.SetRangeProtectionMutation.id,params:{unitId:l,subUnitId:a,ruleId:u.id,rule:u}})):(u&&(u.unitType===rN.Worksheet?(d.push({id:A.DeleteWorksheetProtectionMutation.id,params:{unitId:l,subUnitId:a}}),c.push({id:A.AddWorksheetProtectionMutation.id,params:{unitId:l,rule:u,subUnitId:u.subUnitId}})):u.unitType===rN.SelectRange&&(d.push({id:A.DeleteRangeProtectionMutation.id,params:{unitId:l,subUnitId:a,ruleIds:[u.id]}}),c.push({id:A.AddRangeProtectionMutation.id,params:{unitId:l,subUnitId:a,rules:[u]}}))),s.unitType===rN.Worksheet?(d.push({id:A.AddWorksheetProtectionMutation.id,params:{unitId:l,rule:s,subUnitId:s.subUnitId}}),c.unshift({id:A.DeleteWorksheetProtectionMutation.id,params:{unitId:l,subUnitId:a}})):s.unitType===rN.SelectRange&&(s.id=o.createRuleId(l,a),d.push({id:A.AddRangeProtectionMutation.id,params:{unitId:l,subUnitId:a,rules:[s]}}),c.unshift({id:A.DeleteRangeProtectionMutation.id,params:{unitId:l,subUnitId:a,ruleIds:[s.id]}}))),(0,O.sequenceExecute)(d,i)&&n.pushUndoRedo({unitID:l,undoMutations:c,redoMutations:d}),!0}},oe={id:"sheet.command.refill",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>(e.get(i9).applyType=t.type,!0),"handler")},ot={id:"sheet.command.remove-row-confirm",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{var i;let n=e.get(A.SheetsSelectionsService),r=null==t?void 0:t.range;if(r||(r=null==(i=n.getCurrentLastSelection())?void 0:i.range),!r)return!1;let o=e.get(O.ICommandService),s=e.get(O.IUniverInstanceService),l=(0,A.getSheetCommandTarget)(s);if(!l)return!1;let{worksheet:a}=l;if(tr(a.getVisibleRows(),[r])){let t=e.get(J.IConfirmService),i=e.get(O.LocaleService);return await t.confirm({id:"sheet.confirm.remove-row",title:{title:i.t("info.problem")},children:{title:i.t("rightClick.deleteAllRowsAlert")},cancelText:i.t("button.cancel"),confirmText:i.t("button.confirm")}),!1}return await o.executeCommand(A.RemoveRowCommand.id,{range:r}),!0},"handler")},oi={id:"sheet.command.remove-col-confirm",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{var i;let n=e.get(A.SheetsSelectionsService),r=null==t?void 0:t.range;if(r||(r=null==(i=n.getCurrentLastSelection())?void 0:i.range),!r)return!1;let o=e.get(O.ICommandService),s=e.get(O.IUniverInstanceService),l=(0,A.getSheetCommandTarget)(s);if(!l)return!1;let{worksheet:a}=l;if(to(a.getVisibleCols(),[r])){let t=e.get(J.IConfirmService),i=e.get(O.LocaleService);return await t.confirm({id:"sheet.confirm.remove-col",title:{title:i.t("info.problem")},children:{title:i.t("rightClick.deleteAllColumnsAlert")},cancelText:i.t("button.cancel"),confirmText:i.t("button.confirm")}),!1}return await o.executeCommand(A.RemoveColCommand.id,{range:r}),!0},"handler")},on={id:"sheet.command.remove-sheet-confirm",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{let{subUnitId:i}=t,n=e.get(J.IConfirmService),r=e.get(O.ICommandService),o=e.get(O.LocaleService);return!!await n.confirm({id:"sheet.confirm.remove-sheet",title:{title:o.t("sheetConfig.deleteSheet")},children:{title:o.t("sheetConfig.deleteSheetContent")},cancelText:o.t("button.cancel"),confirmText:o.t("button.confirm")})&&(await r.executeCommand(A.RemoveSheetCommand.id,{subUnitId:i}),!0)},"handler")};var or=Object.defineProperty,oo=Object.getOwnPropertyDescriptor,os=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?oo(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&or(t,i,o),o},"__decorateClass$M"),ol=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$M");let oa=eN.MARK_SELECTION,od=(0,O.createIdentifier)("univer.mark-selection-service"),oc=(el(cw=class extends O.Disposable{constructor(e,t,i){super(),ea(this,"_shapeMap",/* @__PURE__ */new Map),this._currentService=e,this._renderManagerService=t,this._themeService=i}addShape(e,t=[],i=oa){var n;let r=this._currentService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),o=null==(n=r.getActiveSheet())?void 0:n.getSheetId();if(!o)return null;let s=(0,O.Tools).generateRandomId();return this._shapeMap.set(s,{selection:e,subUnitId:o,unitId:r.getUnitId(),zIndex:i,control:null,exits:t}),this.refreshShapes(),s}refreshShapes(){var e;let t=this._currentService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!t)return;let i=t.getUnitId(),n=null==(e=t.getActiveSheet())?void 0:e.getSheetId();this._shapeMap.forEach(e=>{var t;let{unitId:r,subUnitId:o,selection:s,control:l,zIndex:a}=e;if(null==l||l.dispose(),r!==i||o!==n)return;let d=this._renderManagerService.getRenderById(r);if(!d)return;let c=null==(t=this._renderManagerService.withCurrentTypeOfUnit(O.UniverInstanceType.UNIVER_SHEET,ev))?void 0:t.getCurrentSkeleton();if(!c)return;let{scene:u}=d,{rowHeaderWidth:h,columnHeaderHeight:m}=c,g=new eH(u,a,this._themeService,!1,{rowHeaderWidth:h,columnHeaderHeight:m}),{rangeWithCoord:p,primaryWithCoord:v}=d.with(ez).attachSelectionWithCoord(s);g.updateRange(p,v);let{style:S}=s;S&&g.updateStyle(S),e.control=g})}getShapeMap(){return this._shapeMap}removeShape(e){let t=this._shapeMap.get(e);if(!t)return;let{control:i}=t;null==i||i.dispose(),this._shapeMap.delete(e)}removeAllShapes(){for(let e of this._shapeMap.values()){let{control:t}=e;null==t||t.dispose()}this._shapeMap.clear()}},"MarkSelectionService"),cw);function ou(e){return{strokeWidth:1.5,stroke:e.getCurrentTheme().primaryColor,fill:"rgba(178, 178, 178, 0.10)",widgets:{},hasAutoFill:!1,strokeDash:8}}oc=os([ol(0,O.IUniverInstanceService),ol(1,x.IRenderManagerService),ol(2,(0,O.Inject)(O.ThemeService))],oc),el(ou,"createCopyPasteSelectionStyle");var oh=Object.defineProperty,om=Object.getOwnPropertyDescriptor,og=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?om(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&oh(t,i,o),o},"__decorateClass$L"),op=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$L"),ov=((_=ov||{})[_.OFF=0]="OFF",_[_.ONCE=1]="ONCE",_[_.INFINITE=2]="INFINITE",_);let oS=(0,O.createIdentifier)("univer.format-painter-service"),of=(el(cP=class extends O.Disposable{constructor(e,t,i,n,r,o){super(),ea(this,"status$"),ea(this,"_selectionFormat"),ea(this,"_markId",null),ea(this,"_status$"),ea(this,"_defaultHook",null),ea(this,"_extendHooks",[]),this._selectionManagerService=e,this._themeService=t,this._markSelectionService=i,this._logService=n,this._commandService=r,this._undoRedoService=o,this._status$=new k.BehaviorSubject(0),this.status$=this._status$.asObservable(),this._selectionFormat={styles:new O.ObjectMatrix,merges:[]}}addHook(e){var t,i,n;e.isDefaultHook&&(null!=(t=e.priority)?t:0)>(null!=(n=null==(i=this._defaultHook)?void 0:i.priority)?n:-1)?this._defaultHook=e:(this._extendHooks.push(e),this._extendHooks.sort((e,t)=>(e.priority||0)-(t.priority||0)))}getHooks(){return this._defaultHook?[this._defaultHook,...this._extendHooks]:this._extendHooks}setStatus(e){this._updateRangeMark(e),this._status$.next(e),this.getHooks().forEach(t=>{void 0!==t.onStatusChange&&t.onStatusChange(e)})}getStatus(){return this._status$.getValue()}setSelectionFormat(e){this._selectionFormat=e}getSelectionFormat(){return this._selectionFormat}applyFormatPainter(e,t,i){let n=this.getHooks(),r=[],o=[];for(let s of(n.forEach(n=>{if(void 0!==n.onApply){let s=n.onApply(e,t,i,this._selectionFormat);s&&(r.push(...s.redos),o.push(...s.undos))}}),n))if(void 0!==s.onBeforeApply&&!s.onBeforeApply({unitId:e,subUnitId:t,range:i,redoMutationsInfo:r,format:this._selectionFormat,undoMutationsInfo:o}))return!1;this._logService.log("[FormatPainterService]","apply mutations",{undoMutationsInfo:o,redoMutationsInfo:r});let s=r.every(e=>this._commandService.executeCommand(e.id,e.params));return s&&this._undoRedoService.pushUndoRedo({unitID:e,undoMutations:o,redoMutations:r}),s}_updateRangeMark(e){if(this._markSelectionService.removeAllShapes(),0!==e){let t=this._selectionManagerService.getCurrentLastSelection();if(t){let i=ou(this._themeService);2===e?this._markId=this._markSelectionService.addShape({...t,style:i}):this._markId=this._markSelectionService.addShape({...t,style:i},[A.SetRangeValuesMutation.id])}}}},"FormatPainterService"),cP);of=og([op(0,(0,O.Inject)(A.SheetsSelectionsService)),op(1,(0,O.Inject)(O.ThemeService)),op(2,od),op(3,O.ILogService),op(4,O.ICommandService),op(5,O.IUndoRedoService)],of);let oC={id:"sheet.operation.set-format-painter",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>!!t&&(e.get(oS).setStatus(t.status),!0),"handler")},oI={type:O.CommandType.COMMAND,id:"sheet.command.set-infinite-format-painter",handler:/* @__PURE__ */el(async e=>{let t;return t=e.get(oS).getStatus()!==ov.OFF?ov.OFF:ov.INFINITE,e.get(O.ICommandService).executeCommand(oC.id,{status:t})},"handler")},ob={type:O.CommandType.COMMAND,id:"sheet.command.set-once-format-painter",handler:/* @__PURE__ */el(async e=>{let t;return t=e.get(oS).getStatus()!==ov.OFF?ov.OFF:ov.ONCE,e.get(O.ICommandService).executeCommand(oC.id,{status:t})},"handler")},o_={type:O.CommandType.COMMAND,id:"sheet.command.apply-format-painter",handler:/* @__PURE__ */el(async(e,t)=>e.get(oS).applyFormatPainter(t.unitId,t.subUnitId,t.range),"handler")},oR={type:O.CommandType.COMMAND,id:"sheet.command.set-selection-frozen",handler:/* @__PURE__ */el(async(e,t)=>{let i,n,r,o;let{type:s}=t||{},l=e.get(O.IUniverInstanceService),a=e.get(O.IUndoRedoService),d=(0,A.getSheetCommandTarget)(l);if(!d)return!1;let{unitId:c,subUnitId:u}=d,h=e.get(O.ICommandService),m=e.get(A.SheetsSelectionsService).getCurrentSelections();if(!m)return!1;let{range:g}=m[(null==m?void 0:m.length)-1],{sheetViewStartRow:p=0,sheetViewStartColumn:v=0}=e.get(x.IRenderManagerService).getRenderById(c).with(eR).getCurrentScrollState()||{},{startRow:S,startColumn:f,rangeType:C}=g;if(C===O.RANGE_TYPE.ROW||1===s)i=S,r=S-p,n=-1,o=0;else if(C===O.RANGE_TYPE.COLUMN||2===s)i=-1,r=0,n=f,o=f-v;else{if(C!==O.RANGE_TYPE.NORMAL)return!1;i=S,r=S-p,n=f,o=f-v}let I={unitId:c,subUnitId:u,startRow:i,startColumn:n,xSplit:n>0?Math.max(1,o):o,ySplit:i>0?Math.max(1,r):r},b=(0,A.SetFrozenMutationFactory)(e,I);return h.syncExecuteCommand(A.SetFrozenMutation.id,I)&&a.pushUndoRedo({unitID:c,undoMutations:[{id:A.SetFrozenMutation.id,params:b}],redoMutations:[{id:A.SetFrozenMutation.id,params:I}]}),!0},"handler")},oy={type:O.CommandType.COMMAND,id:"sheet.command.set-row-frozen",handler:/* @__PURE__ */el(async e=>(e.get(O.ICommandService).executeCommand(oR.id,{type:1}),!0),"handler")},oT={type:O.CommandType.COMMAND,id:"sheet.command.set-col-frozen",handler:/* @__PURE__ */el(async e=>(e.get(O.ICommandService).executeCommand(oR.id,{type:2}),!0),"handler")},oE={type:O.CommandType.COMMAND,id:"sheet.command.cancel-frozen",handler:/* @__PURE__ */el((e,t)=>{let i=e.get(O.ICommandService),n=e.get(O.IUniverInstanceService),r=e.get(O.IUndoRedoService),o=(0,A.getSheetCommandTarget)(n,{unitId:null==t?void 0:t.unitId,subUnitId:null==t?void 0:t.subUnitId});if(!o)return!1;let{unitId:s,subUnitId:l}=o,a={unitId:s,subUnitId:l,startRow:-1,startColumn:-1,xSplit:0,ySplit:0},d=(0,A.SetFrozenMutationFactory)(e,a);return i.syncExecuteCommand(A.SetFrozenMutation.id,a)&&r.pushUndoRedo({unitID:s,undoMutations:[{id:A.SetFrozenMutation.id,params:d}],redoMutations:[{id:A.SetFrozenMutation.id,params:a}]}),!0},"handler")};var ow=Object.defineProperty,oP=Object.getOwnPropertyDescriptor,oM=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?oP(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&ow(t,i,o),o},"__decorateClass$K"),oO=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$K");let ox=/* @__PURE__ */el((e,t)=>{let{unitId:i,subUnitId:n,ranges:r}=e,o={},s=t.getColumnManager();for(let e=0;e<r.length;e++){let t=r[e];for(let e=t.startColumn;e<t.endColumn+1;e++){let t=s.getColumnOrCreate(e);o[e]=t.w}}return{unitId:i,subUnitId:n,ranges:r,colWidth:o}},"createAutoColWidthUndoMutationsByRedos"),oA=(el(cM=class extends O.Disposable{constructor(e,t){super(),this._renderManagerService=e,this._univerInstanceService=t}getUndoRedoParamsOfColWidth(e){let t={redos:[],undos:[]},{_univerInstanceService:i}=this,n=(0,A.getSheetCommandTarget)(i);if(!n)return t;let{unitId:r,subUnitId:o,worksheet:s}=n,l=this._renderManagerService.getRenderById(r).with(ev);if(!l.getCurrent())return t;let{skeleton:a}=l.getCurrent(),d=a.calculateAutoWidthInRange(e.ranges),c={};for(let{col:e,width:t}of d)c[e]=t;let u={subUnitId:o,unitId:r,ranges:e.ranges,colWidth:c},h=ox(u,s);return{undos:[{id:A.SetWorksheetColWidthMutation.id,params:h}],redos:[{id:A.SetWorksheetColWidthMutation.id,params:u}]}}},"AutoWidthController"),cM);oA=oM([oO(0,x.IRenderManagerService),oO(1,(0,O.Inject)(O.IUniverInstanceService))],oA);let ok={type:O.CommandType.COMMAND,id:"sheet.command.set-col-auto-width",handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(O.ICommandService),n=e.get(O.IUndoRedoService),r=e.get(A.SheetsSelectionsService),o=e.get(O.IUniverInstanceService),s=(0,A.getSheetCommandTarget)(o,t);if(!s)return!1;let{unitId:l,subUnitId:a}=s,d=[];if(null!=t&&t.ranges)d=[...t.ranges];else{let e=r.getCurrentSelections();for(let t=0;t<e.length;t++)d.push(e[t].range)}if(!(null!=d&&d.length))return!1;let c={unitId:l,subUnitId:a,ranges:d},{redos:u,undos:h}=e.get(oA).getUndoRedoParamsOfColWidth(c);return!!(0,O.sequenceExecute)([...u],i).result&&(n.pushUndoRedo({unitID:l,undoMutations:[...h],redoMutations:[...u]}),!0)},"handler")},oN=(0,O.createIdentifier)("univer.sheetbar-service"),oD=class extends O.Disposable{constructor(){super(),ea(this,"renameId$"),ea(this,"removeId$"),ea(this,"scroll$"),ea(this,"scrollX$"),ea(this,"addSheet$"),ea(this,"_renameId$"),ea(this,"_removeId$"),ea(this,"_scroll$"),ea(this,"_scrollX$"),ea(this,"_addSheet$"),ea(this,"_currentHandler",null),this._renameId$=new Y.Subject,this.renameId$=this._renameId$.asObservable(),this._removeId$=new Y.Subject,this.removeId$=this._removeId$.asObservable(),this._scroll$=new Y.Subject,this.scroll$=this._scroll$.asObservable(),this._scrollX$=new Y.Subject,this.scrollX$=this._scrollX$.asObservable(),this._addSheet$=new Y.Subject,this.addSheet$=this._addSheet$.asObservable()}setRenameId(e){this._renameId$.next(e)}setRemoveId(e){this._removeId$.next(e)}setScroll(e){this._scroll$.next(e)}setScrollX(e){this._scrollX$.next(e)}setAddSheet(e){this._addSheet$.next(e)}triggerSheetBarMenu(){var e;null==(e=this._currentHandler)||e.handleSheetBarMenu()}registerSheetBarMenuHandler(e){if(this._currentHandler)throw Error("There is already a context menu handler!");return this._currentHandler=e,(0,O.toDisposable)(()=>{this._currentHandler=null})}};el(oD,"SheetBarService");let oV={id:"ui-sheet.command.show-menu-list",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el(async e=>(e.get(oN).triggerSheetBarMenu(),!0),"handler")},oW={id:"sheet.operation.set-activate-cell-edit",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>(e.get(tA).setEditCell(t),!0),"handler")},oH={id:"sheet.operation.rename-sheet",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(oN);return t&&i.setRenameId(t.subUnitId),!0},"handler")},oU={id:"sheet.operation.scroll-to-range",type:O.CommandType.OPERATION,handler:/* @__PURE__ */el((e,t)=>{if(!t)return!1;let i=e.get(O.IUniverInstanceService);return e.get(x.IRenderManagerService).getRenderById(i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId()).with(tR).scrollToRange(t.range)},"handler")},oL={type:O.CommandType.OPERATION,id:"sheet-permission.operation.openDialog",async handler(e,t){let i=e.get(J.IDialogService);return i.close("DESKTOP_FIND_REPLACE_DIALOG"),i.open({id:rY,title:{title:"permission.dialog.allowedPermissionType"},children:{label:rz},width:393,destroyOnClose:!0,onClose:/* @__PURE__ */el(()=>i.close(rY),"onClose")}),!0}},oB="DefinedNameContainer",oF="AllDefaultWorkbook",oj={id:"sidebar.operation.defined-name",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(J.ISidebarService),n=e.get(M.IEditorService),r=e.get(O.LocaleService),o=e.get(O.IUniverInstanceService),s=(0,A.getSheetCommandTarget)(o);if(!s)return!1;let{unitId:l}=s;return"open"===t.value?(n.setOperationSheetUnitId(l),i.open({id:oB,header:{title:r.t("definedName.featureTitle")},children:{label:oB},onClose:/* @__PURE__ */el(()=>{n.closeRangePrompt()},"onClose"),width:333})):i.close(),!0},"handler")};var oz={exports:{}},oX={},oY=/*@__PURE__*/e(ee),oG=Symbol.for("react.element"),oZ=Symbol.for("react.fragment"),oK=Object.prototype.hasOwnProperty,oq=oY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oQ={key:!0,ref:!0,__self:!0,__source:!0};function oJ(e,t,i){var n,r={},o=null,s=null;for(n in void 0!==i&&(o=""+i),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(s=t.ref),t)oK.call(t,n)&&!oQ.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:oG,type:e,key:o,ref:s,props:r,_owner:oq.current}}el(oJ,"q"),oX.Fragment=oZ,oX.jsx=oJ,oX.jsxs=oJ,oz.exports=oX;var o$=oz.exports;let o0=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M0.98999 1.08218H-0.0100098V0.0821838H0.98999V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M5.78992 1.08218H2.78992V0.0821838H5.78992V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M7.58984 1.08218H8.58984V0.0821838H7.58984V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M14.9152 1.08218H13.9152V0.0821838H14.9152V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M16.7151 1.08218H19.7151V0.0821838H16.7151V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M22.515 1.08218H21.515V0.0821838H22.515V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M27.8405 1.08218H28.8405V0.0821838H27.8405V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M33.6404 1.08218H30.6404V0.0821838H33.6404V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M35.4403 1.08218H36.4403V0.0821838H35.4403V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M42.7657 1.08218H41.7657V0.0821838H42.7657V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M44.5657 1.08218H47.5657V0.0821838H44.5657V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M50.3656 1.08218H49.3656V0.0821838H50.3656V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M55.691 1.08218H56.691V0.0821838H55.691V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M61.491 1.08218H58.491V0.0821838H61.491V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M63.2909 1.08218H64.2909V0.0821838H63.2909V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M70.6163 1.08218H69.6163V0.0821838H70.6163V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M72.4163 1.08218H75.4163V0.0821838H72.4163V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M78.2162 1.08218H77.2162V0.0821838H78.2162V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M83.5416 1.08218H84.5416V0.0821838H83.5416V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M89.3416 1.08218H86.3416V0.0821838H89.3416V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M91.1415 1.08218H92.1415V0.0821838H91.1415V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M98.4669 1.08218H97.4669V0.0821838H98.4669V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M100.267 1.08218H103.267V0.0821838H100.267V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M106.067 1.08218H105.067V0.0821838H106.067V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M111.392 1.08218H112.392V0.0821838H111.392V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M117.192 1.08218H114.192V0.0821838H117.192V1.08218Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M118.992 1.08218H119.992V0.0821838H118.992V1.08218Z",fill:"black"})]}),"BorderDashDot"),o1=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M-0.0100098 1.15771H0.98999V0.157715H-0.0100098V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M2.78992 1.15771H5.78992V0.157715H2.78992V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M8.58984 1.15771H7.58984V0.157715H8.58984V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M10.3899 1.15771H11.3899V0.157715H10.3899V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M19.0903 1.15771H18.0903V0.157715H19.0903V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M20.8903 1.15771H23.8903V0.157715H20.8903V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M26.6902 1.15771H25.6902V0.157715H26.6902V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M28.4902 1.15771H29.4902V0.157715H28.4902V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M37.1907 1.15771H36.1907V0.157715H37.1907V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M38.9906 1.15771H41.9906V0.157715H38.9906V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M44.7905 1.15771H43.7905V0.157715H44.7905V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M46.5906 1.15771H47.5906V0.157715H46.5906V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M55.291 1.15771H54.291V0.157715H55.291V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M57.0909 1.15771H60.0909V0.157715H57.0909V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M62.8909 1.15771H61.8909V0.157715H62.8909V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M64.6909 1.15771H65.6909V0.157715H64.6909V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M73.3914 1.15771H72.3914V0.157715H73.3914V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M75.1913 1.15771H78.1913V0.157715H75.1913V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M80.9912 1.15771H79.9912V0.157715H80.9912V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M82.7913 1.15771H83.7913V0.157715H82.7913V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M91.4917 1.15771H90.4917V0.157715H91.4917V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M93.2916 1.15771H96.2916V0.157715H93.2916V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M99.0916 1.15771H98.0916V0.157715H99.0916V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M100.892 1.15771H101.892V0.157715H100.892V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M109.592 1.15771H108.592V0.157715H109.592V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M111.392 1.15771H114.392V0.157715H111.392V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M117.192 1.15771H116.192V0.157715H117.192V1.15771Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M118.992 1.15771H119.992V0.157715H118.992V1.15771Z",fill:"black"})]}),"BorderDashDotDot"),o2=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M-0.00842285 1.22449H2.99158V0.224487H-0.00842285V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M6.14941 1.22449H9.14941V0.224487H6.14941V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M15.3073 1.22449H12.3073V0.224487H15.3073V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M18.4651 1.22449H21.4651V0.224487H18.4651V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M27.6229 1.22449H24.6229V0.224487H27.6229V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M30.7808 1.22449H33.7808V0.224487H30.7808V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M39.9386 1.22449H36.9386V0.224487H39.9386V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M43.0964 1.22449H46.0964V0.224487H43.0964V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M52.2543 1.22449H49.2543V0.224487H52.2543V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M55.4121 1.22449H58.4121V0.224487H55.4121V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M64.5699 1.22449H61.5699V0.224487H64.5699V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M67.7278 1.22449H70.7278V0.224487H67.7278V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M76.8856 1.22449H73.8856V0.224487H76.8856V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M80.0435 1.22449H83.0435V0.224487H80.0435V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M89.2013 1.22449H86.2013V0.224487H89.2013V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M92.3591 1.22449H95.3591V0.224487H92.3591V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M101.517 1.22449H98.517V0.224487H101.517V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M104.675 1.22449H107.675V0.224487H104.675V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M113.833 1.22449H110.833V0.224487H113.833V1.22449Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M116.99 1.22449H119.99V0.224487H116.99V1.22449Z",fill:"black"})]}),"BorderDashed"),o5=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M-0.00976562 1.65707H0.990234V0.657074H-0.00976562V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M2.32361 1.65707H3.32361V0.657074H2.32361V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M5.65698 1.65707H4.65698V0.657074H5.65698V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M6.99036 1.65707H7.99036V0.657074H6.99036V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M10.3237 1.65707H9.32373V0.657074H10.3237V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M11.6571 1.65707H12.6571V0.657074H11.6571V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M14.9905 1.65707H13.9905V0.657074H14.9905V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M16.3239 1.65707H17.3239V0.657074H16.3239V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M19.6572 1.65707H18.6572V0.657074H19.6572V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M20.9906 1.65707H21.9906V0.657074H20.9906V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M24.324 1.65707H23.324V0.657074H24.324V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M25.6573 1.65707H26.6573V0.657074H25.6573V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M28.9907 1.65707H27.9907V0.657074H28.9907V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M30.3241 1.65707H31.3241V0.657074H30.3241V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M33.6575 1.65707H32.6575V0.657074H33.6575V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M34.9908 1.65707H35.9908V0.657074H34.9908V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M38.3242 1.65707H37.3242V0.657074H38.3242V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M39.6576 1.65707H40.6576V0.657074H39.6576V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M42.991 1.65707H41.991V0.657074H42.991V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M44.3243 1.65707H45.3243V0.657074H44.3243V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M47.6577 1.65707H46.6577V0.657074H47.6577V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M48.9911 1.65707H49.9911V0.657074H48.9911V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M52.3245 1.65707H51.3245V0.657074H52.3245V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M53.6578 1.65707H54.6578V0.657074H53.6578V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M56.9912 1.65707H55.9912V0.657074H56.9912V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M58.3246 1.65707H59.3246V0.657074H58.3246V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M61.658 1.65707H60.658V0.657074H61.658V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M62.9913 1.65707H63.9913V0.657074H62.9913V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M66.3247 1.65707H65.3247V0.657074H66.3247V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M67.6581 1.65707H68.6581V0.657074H67.6581V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M70.9915 1.65707H69.9915V0.657074H70.9915V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M72.3248 1.65707H73.3248V0.657074H72.3248V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M75.6582 1.65707H74.6582V0.657074H75.6582V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M76.9916 1.65707H77.9916V0.657074H76.9916V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M80.325 1.65707H79.325V0.657074H80.325V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M81.6583 1.65707H82.6583V0.657074H81.6583V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M84.9917 1.65707H83.9917V0.657074H84.9917V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M86.3251 1.65707H87.3251V0.657074H86.3251V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M89.6584 1.65707H88.6584V0.657074H89.6584V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M90.9918 1.65707H91.9918V0.657074H90.9918V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M94.3252 1.65707H93.3252V0.657074H94.3252V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M95.6586 1.65707H96.6586V0.657074H95.6586V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M98.9919 1.65707H97.9919V0.657074H98.9919V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M100.325 1.65707H101.325V0.657074H100.325V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M103.659 1.65707H102.659V0.657074H103.659V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M104.992 1.65707H105.992V0.657074H104.992V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M108.325 1.65707H107.325V0.657074H108.325V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M109.659 1.65707H110.659V0.657074H109.659V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M112.992 1.65707H111.992V0.657074H112.992V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M114.325 1.65707H115.325V0.657074H114.325V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M117.659 1.65707H116.659V0.657074H117.659V1.65707Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M118.992 1.65707H119.992V0.657074H118.992V1.65707Z",fill:"black"})]}),"BorderHair"),o9=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsx("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:/* @__PURE__ */o$.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 2.42035H-0.0090332V0.420349H119.991V2.42035Z",fill:"black"})}),"BorderMedium"),o6=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"120",height:"3",viewBox:"0 0 120 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M-0.0100098 2.47614H1.98999V0.476135H-0.0100098V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M3.99014 2.47614H9.99014V0.476135H3.99014V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M13.9901 2.47614H11.9901V0.476135H13.9901V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M21.1904 2.47614H23.1904V0.476135H21.1904V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M31.1906 2.47614H25.1906V0.476135H31.1906V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M33.1906 2.47614H35.1906V0.476135H33.1906V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M44.3909 2.47614H42.3909V0.476135H44.3909V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M46.391 2.47614H52.391V0.476135H46.391V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M56.391 2.47614H54.391V0.476135H56.391V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M63.5913 2.47614H65.5913V0.476135H63.5913V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M73.5915 2.47614H67.5915V0.476135H73.5915V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M75.5915 2.47614H77.5915V0.476135H75.5915V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M86.7917 2.47614H84.7917V0.476135H86.7917V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M88.7919 2.47614H94.7919V0.476135H88.7919V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M98.7919 2.47614H96.7919V0.476135H98.7919V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M105.992 2.47614H107.992V0.476135H105.992V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M115.992 2.47614H109.992V0.476135H115.992V2.47614Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M117.992 2.47614H119.992V0.476135H117.992V2.47614Z",fill:"black"})]}),"BorderMediumDashDot"),o3=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M-0.0100098 2.00415H1.98999V0.00415039H-0.0100098V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M3.99014 2.00415H9.99014V0.00415039H3.99014V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M13.9901 2.00415H11.9901V0.00415039H13.9901V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M15.9901 2.00415H17.9901V0.00415039H15.9901V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M27.4905 2.00415H25.4905V0.00415039H27.4905V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M29.4906 2.00415H35.4906V0.00415039H29.4906V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M39.4906 2.00415H37.4906V0.00415039H39.4906V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M41.4906 2.00415H43.4906V0.00415039H41.4906V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M52.991 2.00415H50.991V0.00415039H52.991V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M54.9911 2.00415H60.9911V0.00415039H54.9911V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M64.9911 2.00415H62.9911V0.00415039H64.9911V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M66.9911 2.00415H68.9911V0.00415039H66.9911V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M78.4915 2.00415H76.4915V0.00415039H78.4915V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M80.4916 2.00415H86.4916V0.00415039H80.4916V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M90.4916 2.00415H88.4916V0.00415039H90.4916V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M92.4916 2.00415H94.4916V0.00415039H92.4916V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M103.992 2.00415H101.992V0.00415039H103.992V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M105.992 2.00415H111.992V0.00415039H105.992V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M115.992 2.00415H113.992V0.00415039H115.992V2.00415Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M117.992 2.00415H119.992V0.00415039H117.992V2.00415Z",fill:"black"})]}),"BorderMediumDashDotDot"),o7=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsxs("svg",{width:"118",height:"3",viewBox:"0 0 118 3",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[/* @__PURE__ */o$.jsx("path",{d:"M-0.00854492 2.94815H1.99146V0.948151H-0.00854492V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M6.09668 2.94815H8.09668V0.948151H6.09668V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M14.2019 2.94815H12.2019V0.948151H14.2019V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M18.3071 2.94815H20.3071V0.948151H18.3071V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M26.4124 2.94815H24.4124V0.948151H26.4124V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M30.5176 2.94815H32.5176V0.948151H30.5176V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M38.6228 2.94815H36.6228V0.948151H38.6228V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M42.728 2.94815H44.728V0.948151H42.728V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M50.8333 2.94815H48.8333V0.948151H50.8333V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M54.9385 2.94815H56.9385V0.948151H54.9385V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M63.0437 2.94815H61.0437V0.948151H63.0437V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M67.1489 2.94815H69.1489V0.948151H67.1489V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M75.2542 2.94815H73.2542V0.948151H75.2542V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M79.3594 2.94815H81.3594V0.948151H79.3594V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M87.4645 2.94815H85.4645V0.948151H87.4645V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M91.5697 2.94815H93.5697V0.948151H91.5697V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M99.6749 2.94815H97.6749V0.948151H99.6749V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M103.78 2.94815H105.78V0.948151H103.78V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M111.885 2.94815H109.885V0.948151H111.885V2.94815Z",fill:"black"}),/* @__PURE__ */o$.jsx("path",{d:"M115.991 2.94815H117.991V0.948151H115.991V2.94815Z",fill:"black"})]}),"BorderMediumDashed"),o4=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsx("svg",{width:"120",height:"4",viewBox:"0 0 120 4",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:/* @__PURE__ */o$.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 3.86215H-0.0090332V0.862152H119.991V3.86215Z",fill:"black"})}),"BorderThick"),o8=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsx("svg",{width:"120",height:"2",viewBox:"0 0 120 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:/* @__PURE__ */o$.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M119.991 1.15668H-0.0090332V0.156677H119.991V1.15668Z",fill:"black"})}),"BorderThin");function se(e){let{type:t=O.BorderStyleTypes.THIN}=e;switch(t){case O.BorderStyleTypes.DASH_DOT:return /* @__PURE__ */o$.jsx(o0,{});case O.BorderStyleTypes.DASH_DOT_DOT:return /* @__PURE__ */o$.jsx(o1,{});case O.BorderStyleTypes.DASHED:return /* @__PURE__ */o$.jsx(o2,{});case O.BorderStyleTypes.HAIR:return /* @__PURE__ */o$.jsx(o5,{});case O.BorderStyleTypes.MEDIUM:return /* @__PURE__ */o$.jsx(o9,{});case O.BorderStyleTypes.MEDIUM_DASH_DOT:return /* @__PURE__ */o$.jsx(o6,{});case O.BorderStyleTypes.MEDIUM_DASH_DOT_DOT:return /* @__PURE__ */o$.jsx(o3,{});case O.BorderStyleTypes.MEDIUM_DASHED:return /* @__PURE__ */o$.jsx(o7,{});case O.BorderStyleTypes.THICK:return /* @__PURE__ */o$.jsx(o4,{});case O.BorderStyleTypes.THIN:default:return /* @__PURE__ */o$.jsx(o8,{})}}el(se,"BorderLine");let st={uiPluginSheetsBorderPanel:"univer-ui-plugin-sheets-border-panel",uiPluginSheetsBorderPanelPosition:"univer-ui-plugin-sheets-border-panel-position",uiPluginSheetsBorderPanelPositionItem:"univer-ui-plugin-sheets-border-panel-position-item",uiPluginSheetsBorderPanelPositionItemActive:"univer-ui-plugin-sheets-border-panel-position-item-active",uiPluginSheetsBorderPanelStyles:"univer-ui-plugin-sheets-border-panel-styles",uiPluginSheetsBorderPanelBoard:"univer-ui-plugin-sheets-border-panel-board",uiPluginSheetsBorderPanelButton:"univer-ui-plugin-sheets-border-panel-button",uiPluginSheetsBorderPanelMoreIcon:"univer-ui-plugin-sheets-border-panel-more-icon"},si="UI_PLUGIN_SHEETS",sn=`${si}_BORDER_PANEL_COMPONENT`,sr=[{label:"borderLine.borderTop",icon:"UpBorder",value:"top"},{label:"borderLine.borderBottom",icon:"DownBorder",value:"bottom"},{label:"borderLine.borderLeft",icon:"LeftBorder",value:"left"},{label:"borderLine.borderRight",icon:"RightBorder",value:"right"},{label:"borderLine.borderNone",icon:"NoBorderSingle",value:"none"},{label:"borderLine.borderAll",icon:"AllBorderSingle",value:"all"},{label:"borderLine.borderOutside",icon:"OuterBorder",value:"outside"},{label:"borderLine.borderInside",icon:"InnerBorder",value:"inside"},{label:"borderLine.borderHorizontal",icon:"HorizontalBorder",value:"horizontal"},{label:"borderLine.borderVertical",icon:"VerticalBorder",value:"vertical"},{label:"borderLine.borderTlbr",icon:"BackSlashSingle",value:"tlbr"},{label:"borderLine.borderTlbcTlmr",icon:"LeftDoubleDiagonalSingle",value:"tlbc_tlmr"},{label:"borderLine.borderTlbrTlbcTlmr",icon:"LeftTridiagonalSingle",value:"tlbr_tlbc_tlmr"},{label:"borderLine.borderBlTr",icon:"SlashSingle",value:"bltr"},{label:"borderLine.borderMltrBctr",icon:"RightDoubleDiagonalSingle",value:"mltr_bctr"}],so=[{label:O.BorderStyleTypes.THIN,value:O.BorderStyleTypes.THIN},{label:O.BorderStyleTypes.HAIR,value:O.BorderStyleTypes.HAIR},{label:O.BorderStyleTypes.DOTTED,value:O.BorderStyleTypes.DOTTED},{label:O.BorderStyleTypes.DASHED,value:O.BorderStyleTypes.DASHED},{label:O.BorderStyleTypes.DASH_DOT,value:O.BorderStyleTypes.DASH_DOT},{label:O.BorderStyleTypes.DASH_DOT_DOT,value:O.BorderStyleTypes.DASH_DOT_DOT},{label:O.BorderStyleTypes.MEDIUM,value:O.BorderStyleTypes.MEDIUM},{label:O.BorderStyleTypes.MEDIUM_DASHED,value:O.BorderStyleTypes.MEDIUM_DASHED},{label:O.BorderStyleTypes.MEDIUM_DASH_DOT,value:O.BorderStyleTypes.MEDIUM_DASH_DOT},{label:O.BorderStyleTypes.MEDIUM_DASH_DOT_DOT,value:O.BorderStyleTypes.MEDIUM_DASH_DOT_DOT},{label:O.BorderStyleTypes.THICK,value:O.BorderStyleTypes.THICK}];function ss(e){var t;let i=(0,O.useDependency)(J.ComponentManager),n=(0,O.useDependency)(A.BorderStyleManagerService),{onChange:r,value:o}=e;function s(e,t){null==r||r({...o,[t]:e})}function l(e){let t=i.get(e);return t&&/* @__PURE__ */o$.jsx(t,{extend:{colorChannel1:"rgb(var(--primary-color))"}})}function a(e){e.stopPropagation()}return el(s,"handleClick"),el(l,"renderIcon"),el(a,"stopPropagation"),/* @__PURE__ */o$.jsxs("section",{className:st.uiPluginSheetsBorderPanel,children:[/* @__PURE__ */o$.jsx("div",{className:st.uiPluginSheetsBorderPanelPosition,children:sr.map(e=>/* @__PURE__ */o$.jsx("div",{className:n.getBorderInfo().type===e.value?`${st.uiPluginSheetsBorderPanelPositionItemActive} ${st.uiPluginSheetsBorderPanelPositionItem}`:st.uiPluginSheetsBorderPanelPositionItem,onClick:/* @__PURE__ */el(t=>{t.stopPropagation(),s(e.value,"type")},"onClick"),children:l(e.icon)},e.value))}),/* @__PURE__ */o$.jsxs("div",{className:st.uiPluginSheetsBorderPanelStyles,children:[/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(et.Dropdown,{align:{offset:[0,18]},overlay:/* @__PURE__ */o$.jsx("section",{className:st.uiPluginSheetsBorderPanelBoard,onClick:a,children:/* @__PURE__ */o$.jsx(et.ColorPicker,{onChange:/* @__PURE__ */el(e=>s(e,"color"),"onChange")})}),children:/* @__PURE__ */o$.jsxs("a",{className:st.uiPluginSheetsBorderPanelButton,onClick:a,children:[/* @__PURE__ */o$.jsx(n5,{extend:{colorChannel1:null!=(t=null==o?void 0:o.color)?t:"rgb(var(--primary-color))"}}),/* @__PURE__ */o$.jsx("span",{className:st.uiPluginSheetsBorderPanelMoreIcon,children:/* @__PURE__ */o$.jsx(n$,{})})]})})}),/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(et.Dropdown,{align:{offset:[0,18]},overlay:/* @__PURE__ */o$.jsx("section",{onClick:a,children:/* @__PURE__ */o$.jsx(et.Menu,{children:so.map(e=>/* @__PURE__ */o$.jsx(et.MenuItem,{eventKey:e.value.toString(),onClick:/* @__PURE__ */el(()=>s(e.value,"style"),"onClick"),children:/* @__PURE__ */o$.jsx(se,{type:e.value})},e.value))})}),children:/* @__PURE__ */o$.jsxs("a",{className:st.uiPluginSheetsBorderPanelButton,onClick:a,children:[/* @__PURE__ */o$.jsx(se,{type:O.BorderStyleTypes.THIN}),/* @__PURE__ */o$.jsx("span",{className:st.uiPluginSheetsBorderPanelMoreIcon,children:/* @__PURE__ */o$.jsx(n$,{})})]})})})]})]})}el(ss,"BorderPanel");let sl=`${si}_COLOR_PICKER_COMPONENT`,sa=`${si}_FONT_FAMILY_COMPONENT`,sd=`${si}_FONT_FAMILY_ITEM_COMPONENT`,sc=`${si}_FONT_SIZE_COMPONENT`,su=`${si}_MENU_ITEM_INPUT_COMPONENT`,sh=/* @__PURE__ */el(e=>{let{prefix:t,suffix:i,value:n,onChange:r,min:o=Number.MIN_SAFE_INTEGER,max:s=Number.MAX_SAFE_INTEGER}=e,l=(0,O.useDependency)(O.LocaleService),a=(0,O.useDependency)(J.IContextMenuService),[d,c]=(0,ee.useState)(),u=/* @__PURE__ */el(e=>{var t;c(null==e?void 0:e.toString()),r(null!=(t=null==e?void 0:e.toString())?t:"")},"handleChange");function h(e){"Backspace"===e.key&&e.stopPropagation()}return(0,ee.useEffect)(()=>{a.visible||c(n)},[a.visible]),(0,ee.useEffect)(()=>{c(n)},[n]),el(h,"handleKeyDown"),/* @__PURE__ */o$.jsxs("div",{className:"univer-sheets-ui-context-menu-input",children:[l.t(t),/* @__PURE__ */o$.jsx("span",{className:"univer-sheets-ui-context-menu-input-container",onClick:/* @__PURE__ */el(e=>e.stopPropagation(),"onClick"),children:/* @__PURE__ */o$.jsx(et.InputNumber,{className:"univer-sheets-ui-context-menu-input-number",value:Number(d),precision:0,onKeyDown:h,onChange:u,min:o,max:s})}),l.t(i)]})},"MenuItemInput");function sm(e){var t,i,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e){if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(i=sm(e[t]))&&(n&&(n+=" "),n+=i)}else for(i in e)e[i]&&(n&&(n+=" "),n+=i)}return n}function sg(){for(var e,t,i=0,n="",r=arguments.length;i<r;i++)(e=arguments[i])&&(t=sm(e))&&(n&&(n+=" "),n+=t);return n}el(sm,"r"),el(sg,"clsx");let sp={definedName:"univer-defined-name",definedNameDropDown:"univer-defined-name-drop-down",definedNameDropDownDisable:"univer-defined-name-drop-down-disable",definedNameOverlay:"univer-defined-name-overlay",definedNameOverlayContainer:"univer-defined-name-overlay-container",definedNameOverlayItem:"univer-defined-name-overlay-item",definedNameOverlayItemName:"univer-defined-name-overlay-item-name",definedNameOverlayItemNameForSheet:"univer-defined-name-overlay-item-name-for-sheet",definedNameOverlayItemFormula:"univer-defined-name-overlay-item-formula",definedNameOverlayManager:"univer-defined-name-overlay-manager",definedNameOverlayManagerTitle:"univer-defined-name-overlay-manager-title",definedNameOverlayManagerContent:"univer-defined-name-overlay-manager-content",definedNameContainer:"univer-defined-name-container",definedNameContainerScroll:"univer-defined-name-container-scroll",definedNameContainerAddButton:"univer-defined-name-container-addButton",definedNameContainerAddButtonText:"univer-defined-name-container-addButton-text",definedNameContainerItem:"univer-defined-name-container-item",definedNameContainerItemName:"univer-defined-name-container-item-name",definedNameContainerItemNameForSheet:"univer-defined-name-container-item-name-for-sheet",definedNameContainerItemFormulaOrRefString:"univer-defined-name-container-item-formula-or-refString",definedNameContainerItemUpdate:"univer-defined-name-container-item-update",definedNameContainerItemDelete:"univer-defined-name-container-item-delete",definedNameContainerItemShow:"univer-defined-name-container-item-show",definedNameInput:"univer-defined-name-input",definedNameInputFormulaSelectorTextWrap:"univer-defined-name-input-formula-selector-text-wrap",definedNameInputTextEditorContainer:"univer-defined-name-input-text-editor-container",definedNameInputValidation:"univer-defined-name-input-validation",definedNameInputDisable:"univer-defined-name-input-disable"},sv={width:"100%"},sS=/* @__PURE__ */el(e=>{let{inputId:t,state:i=!1,type:n="range",confirm:r,cancel:o,name:s,formulaOrRefString:l,comment:a="",localSheetId:d=oF,hidden:c=!1,id:u}=e,h=(0,O.useDependency)(O.IUniverInstanceService).getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),m=(0,O.useDependency)(O.LocaleService),g=(0,O.useDependency)(ei.IDefinedNamesService),p=(0,O.useDependency)(ei.IFunctionService),v=(0,O.useDependency)(ei.LexerTreeBuilder),S=(0,O.useDependency)(J.ComponentManager),f=(0,ee.useMemo)(()=>S.get(eM),[]);if(null==h)return;let C=h.getUnitId(),I=h.getActiveSheet().getSheetId(),[b,_]=(0,ee.useState)(s),[R,y]=(0,ee.useState)(l),[T,E]=(0,ee.useState)(a),[w,P]=(0,ee.useState)(d),[A,k]=(0,ee.useState)(""),[N,D]=(0,ee.useState)(n),[V,W]=(0,ee.useState)(!0),H=(0,ee.useRef)({}),[U,L]=(0,ee.useState)(!1),B=[{label:m.t("definedName.scopeWorkbook"),value:oF}],F=/* @__PURE__ */el(e=>!(0,ei.isReferenceStrings)(e),"isFormula");(0,ee.useEffect)(()=>{L(!1)},[I]),(0,ee.useEffect)(()=>{W(!0),_(s),E(a),P(d);let e=l;l.substring(0,1)===ei.operatorToken.EQUALS?D("formula"):F(l)?(D("formula"),e=ei.operatorToken.EQUALS+l):D("range"),y(e),k("")},[i]),h.getSheetOrders().forEach(e=>{let t=h.getSheetBySheetId(e);B.push({label:(null==t?void 0:t.getName())||"",value:e})});let j=/* @__PURE__ */el(e=>{y(e)},"rangeSelectorChange"),z=/* @__PURE__ */el(e=>{y(e||"")},"formulaEditorChange"),X=/* @__PURE__ */el(()=>{if(0===b.length){k(m.t("definedName.nameEmpty"));return}if(null!=g.getValueByName(C,b)&&(null==u||0===u.length)){k(m.t("definedName.nameDuplicate"));return}if(!(0,O.Tools).isValidParameter(b)||(0,ei.isReferenceStringWithEffectiveColumn)(b)||!(0,O.Tools).isStartValidPosition(b)&&!(0,x.hasCJKText)(b.substring(0,1))){k(m.t("definedName.nameInvalid"));return}if(h.getSheetOrders().map(e=>{var t;return(null==(t=h.getSheetBySheetId(e))?void 0:t.getName())||""}).includes(b)){k(m.t("definedName.nameSheetConflict"));return}if(0===R.length){k(m.t("definedName.formulaOrRefStringEmpty"));return}if(!V){k(m.t("definedName.formulaOrRefStringInvalid"));return}if(p.hasExecutor(b.toUpperCase())){k(m.t("definedName.nameConflict"));return}r&&r({id:u||"",name:b,formulaOrRefString:v.convertRefersToAbsolute(R,O.AbsoluteRefType.ALL,O.AbsoluteRefType.ALL),comment:T,localSheetId:w})},"confirmChange"),Y=/* @__PURE__ */el(e=>{"formula"===e&&R.substring(0,1)!==ei.operatorToken.EQUALS?(y(`${ei.operatorToken.EQUALS}`),y(`${ei.operatorToken.EQUALS}`)):R.substring(0,1)===ei.operatorToken.EQUALS&&(y(""),y("")),D(e)},"typeValueChange"),G=/* @__PURE__ */el(e=>{var t;let i=null==(t=H.current)?void 0:t.handleOutClick;i&&i(e,L)},"handlePanelClick");return /* @__PURE__ */o$.jsxs("div",{className:sp.definedNameInput,style:{display:i?"block":"none"},onClick:G,children:[/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(et.Input,{placeholder:m.t("definedName.inputNamePlaceholder"),value:b,allowClear:!0,onChange:_,affixWrapperStyle:sv})}),/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsxs(et.RadioGroup,{value:N,onChange:Y,children:[/* @__PURE__ */o$.jsx(et.Radio,{value:"range",children:m.t("definedName.ratioRange")}),/* @__PURE__ */o$.jsx(et.Radio,{value:"formula",children:m.t("definedName.ratioFormula")})]})}),f&&"range"===N&&/* @__PURE__ */o$.jsx(f,{unitId:C,subUnitId:I,initValue:R,onChange:j,isFocus:U,actions:H.current,isSupportAcrossSheet:!0,onBlur:/* @__PURE__ */el(()=>{L(!1)},"onBlur")}),"range"!==N&&/* @__PURE__ */o$.jsx("div",{className:"univer-defined-name-input-formula-selector-text-wrap",children:/* @__PURE__ */o$.jsx(M.TextEditor,{value:R,onValid:W,onChange:z,id:(0,O.createInternalEditorID)(`${t}-editor`),placeholder:m.t("definedName.inputFormulaPlaceholder"),openForSheetUnitId:C,onlyInputFormula:!0,className:"univer-defined-name-input-text-editor-container",canvasStyle:{fontSize:10}},`${t}-editor`)}),/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(et.Select,{style:sv,value:w,options:B,onChange:P})}),/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(et.Input,{affixWrapperStyle:sv,placeholder:m.t("definedName.inputCommentPlaceholder"),value:T,onChange:E})}),/* @__PURE__ */o$.jsxs("div",{style:{display:0===A.length?"none":"flex"},className:sp.definedNameInputValidation,children:[/* @__PURE__ */o$.jsx("span",{children:A}),/* @__PURE__ */o$.jsx(nB,{})]}),/* @__PURE__ */o$.jsxs("div",{children:[/* @__PURE__ */o$.jsx(et.Button,{onClick:/* @__PURE__ */el(()=>{o&&o()},"onClick"),children:m.t("definedName.cancel")}),/* @__PURE__ */o$.jsx(et.Button,{style:{marginLeft:15},type:"primary",onClick:X,children:m.t("definedName.confirm")})]})]})},"DefinedNameInput"),sf=/* @__PURE__ */el(()=>{let e=(0,O.useDependency)(O.ICommandService),t=(0,O.useDependency)(O.IUniverInstanceService).getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),i=(0,O.useDependency)(O.LocaleService),n=(0,O.useDependency)(ei.IDefinedNamesService),r=(0,O.useDependency)(A.SheetsSelectionsService);if(null==t)return;let o=t.getUnitId(),s=/* @__PURE__ */el(()=>{let e=n.getDefinedNameMap(o);return e?Array.from(Object.values(e)):[]},"getDefinedNameMap"),[l,a]=(0,ee.useState)(!1),[d,c]=(0,ee.useState)(s()),[u,h]=(0,ee.useState)(null),[m,g]=(0,ee.useState)();(0,ee.useEffect)(()=>{let e=n.update$.subscribe(()=>{c(s())});return()=>{e.unsubscribe()}},[]);let p=/* @__PURE__ */el(t=>{let{name:i,formulaOrRefString:n,comment:r,localSheetId:s,hidden:l}=t,d=t.id;if(null==d||0===d.length)d=(0,O.Tools).generateRandomId(10),e.executeCommand(A.InsertDefinedNameCommand.id,{id:d,unitId:o,name:i,formulaOrRefString:n,comment:r,localSheetId:s,hidden:l});else{let t={id:d,unitId:o,name:i,formulaOrRefString:n,comment:r,localSheetId:s,hidden:l};e.executeCommand(A.SetDefinedNameCommand.id,t)}a(!1),h(null)},"insertConfirm"),v=/* @__PURE__ */el(e=>{g(e)},"deleteDefinedName");function S(){g(null)}function f(t){let i=n.getValueById(o,t);e.executeCommand(A.RemoveDefinedNameCommand.id,{...i,unitId:o}),g(null)}el(S,"handleDeleteClose"),el(f,"handleDeleteConfirm");let C=/* @__PURE__ */el(async t=>{let{formulaOrRefString:i,id:r}=t,s=n.getWorksheetByRef(o,i);s&&(s.isSheetHidden()&&await e.executeCommand(A.SetWorksheetShowCommand.id,{unitId:o,subUnitId:s.getSheetId()}),n.focusRange(o,r))},"focusDefinedName"),I=/* @__PURE__ */el(()=>{let e=d.length+1,t=i.t("definedName.defaultName")+e;if(null==n.getValueByName(o,t))return t;let r=e+1;for(;;){let e=i.t("definedName.defaultName")+r;if(null==n.getValueByName(o,e))return e;r++}},"getInsertDefinedName"),b=/* @__PURE__ */el(()=>{var e;let i=null==(e=t.getActiveSheet())?void 0:e.getName();if(!i)return"";let n=r.getCurrentSelections();return null==n?"":n.map(e=>(0,ei.serializeRangeWithSheet)(i,e.range)).join(",")},"getInertFormulaOrRefString"),_=/* @__PURE__ */el(()=>{a(!1),h(null)},"closeInput"),R=/* @__PURE__ */el(()=>{a(!0),h(null)},"openInsertCloseKeyEditor"),y=/* @__PURE__ */el(e=>{a(!1),h(e)},"closeInsertOpenKeyEditor"),T=/* @__PURE__ */el(e=>{let i=t.getSheetBySheetId(e);return null==i?"":i.getName()},"getSheetNameBySheetId");return /* @__PURE__ */o$.jsx("div",{className:sp.definedNameContainer,children:/* @__PURE__ */o$.jsxs("div",{className:sp.definedNameContainerScroll,children:[/* @__PURE__ */o$.jsxs("div",{children:[/* @__PURE__ */o$.jsxs("div",{onClick:R,className:sp.definedNameContainerAddButton,style:{display:l?"none":"flex"},children:[/* @__PURE__ */o$.jsx(nK,{}),/* @__PURE__ */o$.jsx("span",{className:sp.definedNameContainerAddButtonText,children:i.t("definedName.addButton")})]}),l&&/* @__PURE__ */o$.jsx(sS,{confirm:p,cancel:_,state:l,inputId:"insertDefinedName",name:I(),formulaOrRefString:b()})]},"insertDefinedName"),d.map((e,t)=>/* @__PURE__ */o$.jsxs("div",{children:[/* @__PURE__ */o$.jsxs("div",{onClick:/* @__PURE__ */el(()=>{C(e)},"onClick"),className:sp.definedNameContainerItem,style:{display:e.id===u?"none":"flex"},children:[/* @__PURE__ */o$.jsxs("div",{title:e.comment,children:[/* @__PURE__ */o$.jsxs("div",{className:sp.definedNameContainerItemName,children:[e.name,/* @__PURE__ */o$.jsx("span",{className:sp.definedNameContainerItemNameForSheet,children:e.localSheetId===oF||null==e.localSheetId?"":T(e.localSheetId)})]}),/* @__PURE__ */o$.jsx("div",{className:sp.definedNameContainerItemFormulaOrRefString,children:e.formulaOrRefString})]}),/* @__PURE__ */o$.jsx(et.Tooltip,{title:i.t("definedName.updateButton"),placement:"top",style:{pointerEvents:"none"},children:/* @__PURE__ */o$.jsx("div",{className:sg(sp.definedNameContainerItemUpdate,sp.definedNameContainerItemShow),onClick:/* @__PURE__ */el(()=>{y(e.id)},"onClick"),children:/* @__PURE__ */o$.jsx(nx,{})})}),/* @__PURE__ */o$.jsx(et.Tooltip,{title:i.t("definedName.deleteButton"),placement:"top",style:{pointerEvents:"none"},children:/* @__PURE__ */o$.jsx("div",{className:sg(sp.definedNameContainerItemDelete,sp.definedNameContainerItemShow),onClick:/* @__PURE__ */el(()=>{v(e.id)},"onClick"),children:/* @__PURE__ */o$.jsx(nW,{})})})]}),/* @__PURE__ */o$.jsx(et.Confirm,{visible:m===e.id,onClose:S,onConfirm:/* @__PURE__ */el(()=>{f(e.id)},"onConfirm"),children:i.t("definedName.deleteConfirmText")}),e.id===u&&/* @__PURE__ */o$.jsx(sS,{confirm:p,cancel:_,state:e.id===u,id:e.id,inputId:e.id+t,name:e.name,formulaOrRefString:e.formulaOrRefString,comment:e.comment,localSheetId:e.localSheetId})]},t))]})})},"DefinedNameContainer");function sC(){let e=(0,O.useDependency)(O.IUniverInstanceService),t=(0,J.useObservable)(()=>e.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]);return null!=t?t:null}el(sC,"useActiveWorkbook"),el(function(e){return(0,J.useObservable)(()=>{var t;return null!=(t=null==e?void 0:e.activeSheet$)?t:(0,j.of)(null)},void 0,void 0,[e])},"useActiveWorksheet"),el(function(){let e=(0,O.useDependency)(O.IUniverInstanceService);return(0,J.useObservable)(()=>(0,B.merge)([e.getTypeOfUnitAdded$(O.UniverInstanceType.UNIVER_SHEET),e.getTypeOfUnitDisposed$(O.UniverInstanceType.UNIVER_SHEET)]).pipe((0,L.map)(()=>e.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET)),(0,X.startWith)(e.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET))),[],void 0,[e])},"useWorkbooks");let sI=[50,80,100,130,150,170,200,400];function sb(){let e=(0,O.useDependency)(O.ICommandService),t=(0,O.useDependency)(O.IUniverInstanceService),i=sC(),n=(0,O.useDependency)(tA),r=(0,O.useObservable)(n.visible$),o=(0,ee.useCallback)(()=>{if(!i)return 100;let e=i.getActiveSheet();return Math.round(e&&100*e.getZoomRatio()||100)},[i]),[s,l]=(0,ee.useState)(()=>o());function a(i){l(i);let n=t.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),r=null==n?void 0:n.getActiveSheet();null!=r&&e.executeCommand(nt.id,{unitId:n.getUnitId(),subUnitId:r.getSheetId(),zoomRatio:i/100})}(0,ee.useEffect)(()=>(l(o()),e.onCommandExecuted(e=>{(e.id===na.id||e.id===A.SetWorksheetActiveOperation.id)&&l(o())}).dispose),[e,o]),el(a,"handleChange");let d=(null==r?void 0:r.visible)&&(r.unitId===(null==i?void 0:i.getUnitId())||r.unitId===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);return /* @__PURE__ */o$.jsx(et.Slider,{disabled:d,min:10,value:s,shortcuts:sI,onChange:a})}function s_(e){return /* @__PURE__ */o$.jsx("section",{className:"univer-count-bar",children:/* @__PURE__ */o$.jsx(sb,{})})}el(sb,"ZoomSlider"),el(s_,"CountBar");let sR=class{constructor(){ea(this,"_state",null),ea(this,"_rect",null),ea(this,"_state$",new k.BehaviorSubject(null)),ea(this,"state$",this._state$.asObservable()),ea(this,"_rect$",new k.BehaviorSubject(null)),ea(this,"rect$",this._rect$.asObservable()),ea(this,"_focus",!1),ea(this,"_focus$",new k.BehaviorSubject(this._focus)),ea(this,"focus$",this._focus$.asObservable())}dispose(){this._state$.complete(),this._state=null,this._rect$.complete(),this._rect=null}setState(e){this._state=e,this._refresh(e)}getRect(){return this._rect}setRect(e){this._rect=e,this._rect$.next(e)}getState(){return this._state}setFocus(e=!1){this._focus=e,this._focus$.next(e)}_refresh(e){this._state$.next(e)}};el(sR,"CellEditorManagerService");let sy=(0,O.createIdentifier)("univer.sheet-cell-editor-manager.service"),sT={width:0,height:0,top:-1e3,left:-1e3},sE=/* @__PURE__ */el(()=>{let[e,t]=(0,ee.useState)({...sT}),i=(0,O.useDependency)(sy),n=(0,O.useDependency)(M.IEditorService),r=(0,O.useDependency)(O.IContextService),o=(0,J.useObservable)(()=>r.subscribeContextValue$(J.DISABLE_AUTO_FOCUS_KEY),!1,void 0,[r,J.DISABLE_AUTO_FOCUS_KEY]),s={id:O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,body:{dataStream:`${O.DEFAULT_EMPTY_DOCUMENT_VALUE}`,tables:[],textRuns:[],paragraphs:[{startIndex:0}],sectionBreaks:[{startIndex:1}]},tableSource:{},documentStyle:{documentFlavor:O.DocumentFlavor.UNSPECIFIED}};return(0,ee.useEffect)(()=>{let e=i.state$.subscribe(e=>{if(null==e)return;let{startX:r=-1e3,startY:o=-1e3,endX:s=0,endY:l=0,show:a=!1}=e;if(a){t({width:s-r-x.FIX_ONE_PIXEL_BLUR_OFFSET+2,height:l-o-x.FIX_ONE_PIXEL_BLUR_OFFSET+2,left:r+x.FIX_ONE_PIXEL_BLUR_OFFSET,top:o+x.FIX_ONE_PIXEL_BLUR_OFFSET});let e=n.getEditor(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);if(null==e)return;let{left:a,top:d,width:c,height:u}=e.getBoundingClientRect();i.setRect({left:a,top:d,width:c,height:u})}else t({...sT})});return()=>{e.unsubscribe()}},[]),(0,ee.useEffect)(()=>{o||i.setFocus(!0)},[o,e]),/* @__PURE__ */o$.jsx("div",{className:"univer-editor-container",style:{left:e.left,top:e.top,width:e.width,height:e.height},children:/* @__PURE__ */o$.jsx(M.TextEditor,{id:O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,className:"univer-editor-input",snapshot:s,cancelDefaultResizeListener:!0,isSheetEditor:!0,isSingle:!1})})},"EditorContainer"),sw=class{constructor(){ea(this,"_position",null),ea(this,"_position$",new k.BehaviorSubject(null)),ea(this,"position$",this._position$.asObservable()),ea(this,"_focus",!1),ea(this,"_focus$",new k.BehaviorSubject(this._focus)),ea(this,"focus$",this._focus$.asObservable()),ea(this,"_fxBtnClick$",new Y.Subject),ea(this,"fxBtnClick$",this._fxBtnClick$.asObservable()),ea(this,"_foldBtnStatus$",new Y.Subject),ea(this,"foldBtnStatus$",this._foldBtnStatus$.asObservable())}dispose(){this._position$.complete(),this._focus$.complete(),this._position=null,this._focus=!1}setPosition(e){this._position=e,this._refresh(e)}getPosition(){return this._position}setFocus(e=!1){this._focus=e,this._focus$.next(e)}handleFxBtnClick(e){this._fxBtnClick$.next(e)}handleFoldBtnClick(e){this._foldBtnStatus$.next(e)}_refresh(e){this._position$.next(e)}};el(sw,"FormulaEditorManagerService");let sP=(0,O.createIdentifier)("univer.sheet-formula-editor-manager.service");function sM(e){let t=(0,O.useDependency)(O.ICommandService),i=(0,O.useDependency)(O.LocaleService),n=(0,O.useDependency)(ei.IDefinedNamesService),r=(0,O.useDependency)(O.IUniverInstanceService),o=(0,O.useDependency)(J.ISidebarService),s=r.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId(),l=/* @__PURE__ */el(()=>{let e=n.getDefinedNameMap(s);return e?Array.from(Object.values(e)):[]},"getDefinedNameMap"),[a,d]=(0,ee.useState)(l());(0,ee.useEffect)(()=>{let e=n.update$.subscribe(()=>{d(l())});return()=>{e.unsubscribe()}},[]),(0,ee.useEffect)(()=>{let e=o.sidebarOptions$.subscribe(e=>{e.id===oB&&(e.visible||setTimeout(()=>{o.sidebarOptions$.next({visible:!1})}))});return()=>{e.unsubscribe()}},[]);let c=/* @__PURE__ */el(()=>{t.executeCommand(oj.id,{value:"open"})},"openSlider"),u=/* @__PURE__ */el(async e=>{let{formulaOrRefString:i,id:r}=e,o=n.getWorksheetByRef(s,i);o&&(o.isSheetHidden()&&await t.executeCommand(A.SetWorksheetShowCommand.id,{unitId:s,subUnitId:o.getSheetId()}),n.focusRange(s,r))},"focusDefinedName");return /* @__PURE__ */o$.jsxs("div",{className:sp.definedNameOverlay,children:[/* @__PURE__ */o$.jsx("div",{className:sp.definedNameOverlayContainer,children:a.map((e,t)=>/* @__PURE__ */o$.jsxs("div",{className:sp.definedNameOverlayItem,onClick:/* @__PURE__ */el(()=>{u(e)},"onClick"),children:[/* @__PURE__ */o$.jsx("div",{className:sp.definedNameOverlayItemName,title:e.name,children:e.name}),/* @__PURE__ */o$.jsx("div",{className:sp.definedNameOverlayItemFormula,title:e.formulaOrRefString,children:e.formulaOrRefString})]},t))}),/* @__PURE__ */o$.jsxs("div",{className:sp.definedNameOverlayManager,onClick:c,children:[/* @__PURE__ */o$.jsx("div",{className:sp.definedNameOverlayManagerTitle,children:i.t("definedName.managerTitle")}),/* @__PURE__ */o$.jsx("div",{className:sp.definedNameOverlayManagerContent,children:i.t("definedName.managerDescription")})]})]})}function sO({disable:t}){let[i,n]=/*@__PURE__*/e(ee).useState(""),r=(0,O.useDependency)(ei.IDefinedNamesService);return(0,ee.useEffect)(()=>{let e=r.currentRange$.subscribe(()=>{n(r.getCurrentRangeForString())});return()=>{e.unsubscribe()}},[]),/* @__PURE__ */o$.jsxs("div",{className:sp.definedName,children:[/* @__PURE__ */o$.jsx(et.Input,{className:sg({[sp.defineNameInputDisable]:t}),value:i,type:"text",size:"small",affixWrapperStyle:{border:"none",paddingLeft:"6px",paddingRight:"6px",height:"100%"}}),/* @__PURE__ */o$.jsx(et.Dropdown,{overlay:/* @__PURE__ */o$.jsx(sM,{}),children:/* @__PURE__ */o$.jsx("div",{className:sg(sp.definedNameDropDown,{[sp.definedNameDropDownDisable]:t}),children:/* @__PURE__ */o$.jsx(n$,{})})})]})}el(sM,"DefinedNameOverlay"),el(sO,"DefinedName");let sx={formulaBox:"univer-formula-box",nameRanges:"univer-name-ranges",formulaBar:"univer-formula-bar",formulaIcon:"univer-formula-icon",formulaIconDisable:"univer-formula-icon-disable",formulaIconWrapper:"univer-formula-icon-wrapper",iconContainer:"univer-icon-container",iconContainerSuccess:"univer-icon-container-success",formulaActive:"univer-formula-active",iconContainerError:"univer-icon-container-error",iconContainerFx:"univer-icon-container-fx",formulaInput:"univer-formula-input",formulaContent:"univer-formula-content",arrowContainer:"univer-arrow-container",arrowContainerDisable:"univer-arrow-container-disable"};function sA(){let[e,t]=(0,ee.useState)(sx.formulaGrey),[i,n]=(0,ee.useState)(0),r=(0,O.useDependency)(sP),o=(0,O.useDependency)(tA),s=(0,O.useDependency)(A.WorksheetProtectionRuleModel),l=(0,O.useDependency)(A.RangeProtectionRuleModel),a=(0,O.useDependency)(O.IUniverInstanceService),d=(0,O.useDependency)(A.SheetsSelectionsService),c=(0,O.useDependency)(O.IPermissionService),[u,h]=(0,ee.useState)(!1),m=sC(),g=(0,O.useObservable)(()=>a.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),p=(0,J.useComponentsOfPart)(ed.FORMULA_AUX);function v(e,t){return[new A.WorkbookEditablePermission(e).id,new A.WorksheetSetCellValuePermission(e,t).id,new A.WorksheetEditPermission(e,t).id]}el(v,"getPermissionIds"),(0,ee.useLayoutEffect)(()=>{let e=g.activeSheet$.pipe((0,Z.switchMap)(e=>e?(0,B.merge)(s.ruleChange$,l.ruleChange$,d.selectionMoveEnd$).pipe((0,Z.switchMap)(()=>{var t,i;let n=g.getUnitId(),r=e.getSheetId();if(!(null==(t=d.getCurrentLastSelection())?void 0:t.range))return H.EMPTY;let o=v(n,r),s=null==(i=d.getCurrentSelections())?void 0:i.map(e=>e.range);return l.getSubunitRuleList(n,r).filter(e=>e.ranges.some(e=>null==s?void 0:s.some(t=>(0,O.Rectangle).intersects(e,t)))).forEach(e=>{o.push(new A.RangeProtectionPermissionEditPoint(n,r,e.permissionId).id)}),c.composePermission$(o)})):H.EMPTY)).subscribe(e=>{e&&h(!e.every(e=>e.value))});return()=>{e.unsubscribe()}},[g]);let S={id:O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,body:{dataStream:`${O.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],tables:[],paragraphs:[{startIndex:0}],sectionBreaks:[{startIndex:1}]},tableSource:{},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},documentFlavor:O.DocumentFlavor.UNSPECIFIED,marginTop:5,marginBottom:5,marginRight:0,marginLeft:0,paragraphLineGapDefault:0,renderConfig:{horizontalAlign:O.HorizontalAlign.UNSPECIFIED,verticalAlign:O.VerticalAlign.TOP,centerAngle:0,vertexAngle:0,wrapStrategy:O.WrapStrategy.WRAP,isRenderStyle:O.BooleanNumber.FALSE}}};function f(e){if(null==e)return;let t=e.getBoundingClientRect();r.setPosition(t)}function C(){n(0===i?1:0),setTimeout(()=>{r.handleFoldBtnClick(1===i)},150)}function I(){var e;o.isVisible().visible&&o.changeVisible({visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.ESC,unitId:null!=(e=null==m?void 0:m.getUnitId())?e:""})}function b(){var e;o.isVisible().visible&&o.changeVisible({visible:!1,eventType:x.DeviceInputEventType.PointerDown,unitId:null!=(e=null==m?void 0:m.getUnitId())?e:""})}function _(){r.handleFxBtnClick(!0)}return(0,ee.useEffect)(()=>{let e=o.visible$.subscribe(e=>{t(e.visible?sx.formulaActive:sx.formulaGrey)});return()=>e.unsubscribe()},[o.visible$]),el(f,"resizeCallBack"),el(C,"handleArrowClick"),el(I,"handleCloseBtnClick"),el(b,"handleConfirmBtnClick"),el(_,"handlerFxBtnClick"),/* @__PURE__ */o$.jsxs("div",{className:sx.formulaBox,style:{height:0===i?"28px":"82px",pointerEvents:u?"none":"auto"},children:[/* @__PURE__ */o$.jsx("div",{className:sx.nameRanges,children:/* @__PURE__ */o$.jsx(sO,{disable:u})}),/* @__PURE__ */o$.jsxs("div",{className:sx.formulaBar,children:[/* @__PURE__ */o$.jsx("div",{className:sg(sx.formulaIcon,{[sx.formulaIconDisable]:u}),children:/* @__PURE__ */o$.jsxs("div",{className:sx.formulaIconWrapper,children:[/* @__PURE__ */o$.jsx("span",{className:sg(sx.iconContainer,sx.iconContainerError,e),onClick:I,children:/* @__PURE__ */o$.jsx(nk,{})}),/* @__PURE__ */o$.jsx("span",{className:sg(sx.iconContainer,sx.iconContainerSuccess,e),onClick:b,children:/* @__PURE__ */o$.jsx(nx,{})}),/* @__PURE__ */o$.jsx("span",{className:sg(sx.iconContainer,sx.iconContainerFx),onClick:_,children:/* @__PURE__ */o$.jsx(nX,{})})]})}),/* @__PURE__ */o$.jsxs("div",{className:sx.formulaInput,children:[/* @__PURE__ */o$.jsx(M.TextEditor,{id:O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,isSheetEditor:!0,resizeCallBack:f,cancelDefaultResizeListener:!0,onContextMenu:/* @__PURE__ */el(e=>e.preventDefault(),"onContextMenu"),className:sx.formulaContent,snapshot:S,isSingle:!1}),/* @__PURE__ */o$.jsx("div",{className:sg(sx.arrowContainer,{[sx.arrowContainerDisable]:u}),onClick:C,children:0===i?/* @__PURE__ */o$.jsx(nU,{}):/* @__PURE__ */o$.jsx(nU,{style:{transform:"rotateZ(180deg)"}})})]})]}),/* @__PURE__ */o$.jsx(J.ComponentContainer,{components:p},"formula-aux")]})}el(sA,"FormulaBar");let sk={operateContainer:"univer-operate-container",autoFillPopupMenu:"univer-auto-fill-popup-menu",autoFillPopupMenuItem:"univer-auto-fill-popup-menu-item",autoFillPopupMenuItemIcon:"univer-auto-fill-popup-menu-item-icon",autoFillPopupMenuItemTitle:"univer-auto-fill-popup-menu-item-title",btnContainer:"univer-btn-container",btnContainerExpand:"univer-btn-container-expand"},sN=/* @__PURE__ */el(()=>{let[,e]=(0,ee.useState)({});return(0,ee.useCallback)(()=>e(e=>!e),[])},"useUpdate"),sD=/* @__PURE__ */el(()=>{let e=(0,O.useDependency)(O.ICommandService),t=(0,O.useDependency)(O.IUniverInstanceService),i=(0,O.useDependency)(x.IRenderManagerService),n=(0,O.useDependency)(i9),r=(0,O.useDependency)(O.LocaleService),[o,s]=(0,ee.useState)([]),[l,a]=(0,ee.useState)(!1),[d,c]=(0,ee.useState)({row:-1,col:-1}),[u,h]=(0,ee.useState)(iH.SERIES),[m,g]=(0,ee.useState)(!1),p=sC(),{sheetSkeletonManagerService:v,selectionRenderService:S}=(0,ee.useMemo)(()=>{if(p){let e=i.getRenderById(p.getUnitId());return{sheetSkeletonManagerService:null==e?void 0:e.with(ev),selectionRenderService:null==e?void 0:e.with(ez)}}return{sheetSkeletonManagerService:null,selectionRenderService:null}},[p,i]),f=/* @__PURE__ */el(()=>{g(!0)},"handleMouseEnter"),C=/* @__PURE__ */el(()=>{g(!1)},"handleMouseLeave"),I=sN();if((0,ee.useEffect)(()=>e.onCommandExecuted((e,t)=>{e.id===ey.id&&I()}).dispose,[I,e]),(0,ee.useEffect)(()=>{let e=v&&(0,O.toDisposable)(v.currentSkeleton$.subscribe(e=>{e&&I()}));return null==e?void 0:e.dispose},[v,I]),(0,ee.useEffect)(()=>(0,O.toDisposable)(n.menu$.subscribe(e=>{s(e.map(t=>({...t,index:e.indexOf(t)})))})).dispose,[n]),(0,ee.useEffect)(()=>(0,O.toDisposable)(n.showMenu$.subscribe(e=>{let{source:t,target:i}=n.autoFillLocation||{source:null,target:null};e&&t&&i?c({row:Math.max(t.rows[t.rows.length-1],i.rows[i.rows.length-1]),col:Math.max(t.cols[t.cols.length-1],i.cols[i.cols.length-1])}):c({row:-1,col:-1})})).dispose,[n]),(0,ee.useEffect)(()=>(0,O.toDisposable)(n.applyType$.subscribe(e=>{h(e)})).dispose,[n]),(0,ee.useEffect)(()=>{function e(){a(!1)}return el(e,"handleClose"),document.addEventListener("wheel",e),()=>{document.removeEventListener("wheel",e)}},[l]),d.col<0||d.row<0)return null;let b=tg(t,i);if(!b||!S)return null;let{scene:_}=b,R=null==v?void 0:v.getCurrentSkeleton(),y=S.getViewPort(),T=null==_?void 0:_.scaleX,E=null==_?void 0:_.scaleY,w=null==_?void 0:_.getViewportScrollXY(y);if(!T||!_||!T||!E||!w)return null;let P=(null==R?void 0:R.getNoMergeCellPositionByIndex(d.row,d.col).endX)||0,M=(null==R?void 0:R.getNoMergeCellPositionByIndex(d.row,d.col).endY)||0,A=null==R?void 0:R.convertTransformToOffsetX(P,T,w),k=null==R?void 0:R.convertTransformToOffsetY(M,E,w);if(null==A||null==k)return null;let N=/* @__PURE__ */el(e=>{a(e)},"onVisibleChange"),D=/* @__PURE__ */el(t=>{e.executeCommand(oe.id,{type:t.value}),a(!1)},"handleClick"),V=l||m,W=o.filter(e=>!e.disable);return /* @__PURE__ */o$.jsx("div",{onMouseEnter:f,onMouseLeave:C,style:{left:`${A+2}px`,top:`${k+2}px`,position:"absolute"},children:/* @__PURE__ */o$.jsx(et.Dropdown,{placement:"bottomLeft",trigger:["click"],overlay:/* @__PURE__ */o$.jsx("ul",{className:sk.autoFillPopupMenu,children:W.map(e=>/* @__PURE__ */o$.jsxs("li",{onClick:/* @__PURE__ */el(()=>D(e),"onClick"),className:sk.autoFillPopupMenuItem,children:[/* @__PURE__ */o$.jsx("span",{className:sk.autoFillPopupMenuItemIcon,children:e.value===u&&/* @__PURE__ */o$.jsx(nx,{style:{color:"rgb(var(--green-700, #409f11))"}})}),/* @__PURE__ */o$.jsx("span",{className:sk.autoFillPopupMenuItemTitle,children:r.t(e.label)})]},e.index))}),visible:l,onVisibleChange:N,children:/* @__PURE__ */o$.jsxs("div",{className:sg(sk.btnContainer,{[sk.btnContainerExpand]:l}),children:[/* @__PURE__ */o$.jsx(nM,{style:{color:"#35322B"},extend:{colorChannel1:"rgb(var(--green-700, #409f11))"}}),V&&/* @__PURE__ */o$.jsx(n$,{style:{color:"#CCCCCC",fontSize:"8px",marginLeft:"8px"}})]})})})},"AutoFillPopupMenu"),sV=/* @__PURE__ */el(()=>/* @__PURE__ */o$.jsx("div",{className:sk.operateContainer,children:/* @__PURE__ */o$.jsx(sD,{})}),"OperateContainer"),sW={sheetBar:"univer-sheet-bar",sheetBarOptions:"univer-sheet-bar-options",sheetBarOptionsDivider:"univer-sheet-bar-options-divider"};function sH(e){let{children:t,className:i,style:n,disabled:r=!1,onClick:o,...s}=e,l=/* @__PURE__ */el(e=>{if(r){e.preventDefault();return}o&&o(e)},"handleClick");return /* @__PURE__ */o$.jsx("button",{className:"univer-sheet-bar-btn",style:n,disabled:r,onClick:l,...s,children:t})}el(sH,"SheetBarButton");let sU={sheetBarMenu:"univer-sheet-bar-menu",sheetBarMenuItem:"univer-sheet-bar-menu-item",sheetBarMenuItemIcon:"univer-sheet-bar-menu-item-icon",sheetBarMenuItemHide:"univer-sheet-bar-menu-item-hide",sheetBarMenuItemSelect:"univer-sheet-bar-menu-item-select",sheetBarMenuItemLabel:"univer-sheet-bar-menu-item-label"};function sL(e){let{style:t}=e,[i,n]=(0,ee.useState)([]),[r,o]=(0,ee.useState)(!1),s=(0,O.useDependency)(O.IUniverInstanceService),l=(0,O.useDependency)(O.ICommandService),a=(0,O.useDependency)(oN),d=(0,O.useDependency)(A.WorksheetProtectionRuleModel),c=(0,J.useObservable)(()=>s.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),null,!1,[]),u=/* @__PURE__ */el(e=>{let{sheetId:t}=e;t&&c&&(e.hidden?l.executeCommand(A.SetWorksheetShowCommand.id,{unitId:c.getUnitId(),subUnitId:t,value:t}):e.selected||l.executeCommand(A.SetWorksheetActivateCommand.id,{unitId:c.getUnitId(),subUnitId:t}),o(!1))},"handleClick"),h=(0,ee.useCallback)(()=>{if(!c)return;let e=c.getSheets(),t=c.getActiveSheet();n(e.map((e,i)=>({label:e.getName(),index:`${i}`,sheetId:e.getSheetId(),hidden:e.isSheetHidden()===O.BooleanNumber.TRUE,selected:t===e})))},[c,d]),m=(0,ee.useCallback)(()=>l.onCommandExecuted(e=>{switch(e.id){case A.SetWorksheetHideMutation.id:case A.RemoveSheetMutation.id:case A.SetWorksheetNameMutation.id:case A.InsertSheetMutation.id:case A.SetWorksheetOrderMutation.id:case A.SetWorksheetActiveOperation.id:h()}}),[l,h]);function g(){o(!0)}el(g,"handleSheetBarMenu");let p=/* @__PURE__ */el(e=>{o(e)},"onVisibleChange");return(0,ee.useEffect)(()=>{h();let e=new O.DisposableCollection;return e.add(m()),e.add(a.registerSheetBarMenuHandler({handleSheetBarMenu:g})),()=>e.dispose()},[m,a,h,c]),/* @__PURE__ */o$.jsx(et.Dropdown,{placement:"topLeft",trigger:["click"],overlay:/* @__PURE__ */o$.jsx("ul",{className:sU.sheetBarMenu,style:{...t},children:i.map(e=>/* @__PURE__ */o$.jsxs("li",{onClick:/* @__PURE__ */el(()=>u(e),"onClick"),className:e.selected?`${sU.sheetBarMenuItem} ${sU.sheetBarMenuItemSelect}`:e.hidden?`${sU.sheetBarMenuItem} ${sU.sheetBarMenuItemHide}`:sU.sheetBarMenuItem,children:[/* @__PURE__ */o$.jsx("span",{className:sU.sheetBarMenuItemIcon,children:e.selected?/* @__PURE__ */o$.jsx(nx,{}):e.hidden?/* @__PURE__ */o$.jsx(nj,{}):/* @__PURE__ */o$.jsx(nx,{})}),/* @__PURE__ */o$.jsx("div",{className:sU.sheetBarMenuItemLabel,children:e.label})]},e.index))}),visible:r,onVisibleChange:p,children:/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(sH,{children:/* @__PURE__ */o$.jsx(nD,{})})})})}el(sL,"SheetBarMenu");let sB={slideTabBarContainer:"univer-slide-tab-bar-container",slideTabBar:"univer-slide-tab-bar",slideTabItem:"univer-slide-tab-item",slideTabActive:"univer-slide-tab-active",slideTabDiv:"univer-slide-tab-div",slideTabDivEdit:"univer-slide-tab-div-edit",slideTabItemDropdown:"univer-slide-tab-item-dropdown"};function sF(e){let{sheetId:t,label:i,color:n,selected:r}=e,[o,s]=(0,ee.useState)(r),l=(0,O.useDependency)(O.ThemeService);(0,ee.useEffect)(()=>{s(r)},[r]);let a=/* @__PURE__ */el(e=>{let t=l.getCurrentTheme(),i=t.textColor,n=t.colorWhite;return new(0,O.ColorKit)(e).isDark()?n:i},"getTextColor");return /* @__PURE__ */o$.jsx("div",{"data-id":t,className:o?`${sB.slideTabActive} ${sB.slideTabItem}`:sB.slideTabItem,style:{backgroundColor:!o&&n?n:"",color:!o&&n?a(n):"",boxShadow:o&&n?`0px 0px 8px rgba(0, 0, 0, 0.08), inset 0px -2px 0px 0px ${n}`:""},children:/* @__PURE__ */o$.jsx("div",{className:sB.slideTabDiv,children:i})},t)}el(sF,"SheetBarItem");let sj={easeOutStrong:(e,t,i,n)=>-i*((e=e/n-1)*e*e*e-1)+t,backOut:(e,t,i,n,r)=>(typeof r>"u"&&(r=.7),i*((e=e/n-1)*e*((r+1)*e+r)+1)+t)},sz={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(e){},success(e){},cancel(e){},complete(e){}},sX=class{constructor(e){ea(this,"_config"),ea(this,"_status",0),ea(this,"_start",0),ea(this,"_handle",0),ea(this,"_delayHandle",null),this._config={...sz,...e},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}static success(...e){let t=0;return new Promise(i=>{for(let n=0;n<e.length;n++){let r=e[n],o=r._config,s=o.success;o.loop||(o.success=n=>{t++,s&&s.call(r,n),t===e.length&&i()})}})}request(){0===this._config.delay?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;let t=sj[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(t),1===this._status){this._config.cancel(t),this._config.complete(t);return}if(e===this._config.duration){this._config.success(t),this._config.complete(t);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}};el(sX,"Animate");let sY=class e{constructor(e,t){ea(this,"_slideTabItem"),ea(this,"_animate"),ea(this,"_midline",0),ea(this,"_translateX"),ea(this,"_scrollbar"),ea(this,"_slideTabBar"),ea(this,"_editMode"),ea(this,"_placeholder"),this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=t,this._placeholder=null,this._scrollbar=t.getScrollbar(),this.update()}static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static leftLine(e){return e.getBoundingRect().x}static rightLine(e){return e.getBoundingRect().x+e.getBoundingRect().width}static make(t,i){let n=[];return t.forEach(t=>n.push(new e(t,i))),n}getSlideTabItem(){return this._slideTabItem}getEditor(){return this._slideTabItem.querySelector("span")}focus(){var e;null==(e=this.getEditor())||e.focus()}selectAll(){let e=this.getEditor();e&&sK.keepSelectAll(e)}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}setEditor(e){if(!this._slideTabBar.getConfig().onNameChangeCheck())return;let t=!0;if(!1===this._editMode){let i=this._slideTabItem.querySelector("span"),n=/* @__PURE__ */el(t=>{if(!this.nameCheck()){if(this._editMode=!1,i&&(i.removeAttribute("contentEditable"),i.removeEventListener("focusout",n),i.removeEventListener("compositionstart",o),i.removeEventListener("compositionend",s),i.removeEventListener("input",l),i.removeEventListener("keydown",r),i.classList.remove(this._slideTabBar.getConfig().slideTabBarSpanEditClassName)),this._slideTabBar.removeListener(),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName){let e=(null==i?void 0:i.innerText)||"",t=this.getId();this._slideTabBar.getConfig().onChangeName(t,e)}e&&e(t)}},"blurAction"),r=/* @__PURE__ */el(e=>{i&&(e.stopPropagation(),"Enter"===e.key&&i.blur())},"keydownAction"),o=/* @__PURE__ */el(e=>{t=!1},"compositionstartAction"),s=/* @__PURE__ */el(e=>{t=!0},"compositionendAction"),l=/* @__PURE__ */el(e=>{i&&setTimeout(()=>{if(t){let e=i.innerText;e.length>31&&(i.innerText=e.substring(0,31),sK.keepLastIndex(i))}},0)},"inputAction");i&&(i.setAttribute("contentEditable","true"),i.addEventListener("focusout",n),i.addEventListener("compositionstart",o),i.addEventListener("compositionend",s),i.addEventListener("input",l),i.addEventListener("keydown",r),i.classList.add(this._slideTabBar.getConfig().slideTabBarSpanEditClassName),this._editMode=!0,sK.keepSelectAll(i))}}nameCheck(){let e=this._slideTabItem.querySelector("span");if(!e)return!1;let t=e.innerText;return this._slideTabBar.getConfig().onNameCheckAlert(t)}animate(){return{translateX:/* @__PURE__ */el(e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new sX({begin:this._translateX,end:e,receive:/* @__PURE__ */el(e=>{this._slideTabItem.style.transform=`translateX(${e}px)`},"receive")}),this._translateX=e,this._animate.request())},"translateX"),cancel:/* @__PURE__ */el(()=>{this._animate&&(this._animate.cancel(),this._animate=null)},"cancel")}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=e.midline(this)}disableFixed(){if(this._placeholder){let e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("background"),this._slideTabItem.style.removeProperty("padding"),this._slideTabItem.style.removeProperty("box-sizing"),this._slideTabItem.style.removeProperty("font-size"),this._slideTabItem.style.removeProperty("font-family"),this._slideTabItem.style.removeProperty("font-weight"),this._slideTabItem.style.removeProperty("color"),this._slideTabItem.style.removeProperty("border-radius"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){let e=document.createElement("div"),t=this.getBoundingRect(),i=getComputedStyle(this._slideTabItem),n=this._slideTabItem.querySelector("span");if(this._placeholder=e,this._placeholder.style.width=`${t.width}px`,this._placeholder.style.height=`${t.height}px`,this._placeholder.style.flexShrink="0",this._placeholder.style.margin=i.margin,this._slideTabItem.style.background=i.background,n){let e=getComputedStyle(n).padding;this._slideTabItem.style.padding=e}this._slideTabItem.style.boxSizing=i.boxSizing,this._slideTabItem.style.fontSize=i.fontSize,this._slideTabItem.style.fontFamily=i.fontFamily,this._slideTabItem.style.fontWeight=i.fontWeight,this._slideTabItem.style.color=i.color,this._slideTabItem.style.borderRadius=i.borderRadius,this._slideTabItem.style.left=`${t.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${t.y}px`,this._slideTabItem.style.width=`${t.width}px`,this._slideTabItem.style.height=`${t.height}px`,this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,t,i){this._slideTabItem.addEventListener(e,t,i)}removeEventListener(e,t,i){this._slideTabItem.removeEventListener(e,t,i)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){let e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){let t=e.midline(this);return t>this._midline?1:t<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}getId(){return this._slideTabItem.dataset.id||""}};el(sY,"SlideTabItem");let sG=class{constructor(e){ea(this,"_slideTabBar"),ea(this,"_scrollX");let t=e.primeval();this._scrollX=t.scrollLeft,this._slideTabBar=e}scrollX(e){let t=this._slideTabBar.primeval();t.scrollLeft=e,this._scrollX=t.scrollLeft}scrollRight(){let e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}};el(sG,"SlideScrollbar");let sZ=class e{constructor(t){var i;if(ea(this,"_activeTabItemIndex",0),ea(this,"_slideTabBar"),ea(this,"_slideTabItems",[]),ea(this,"_config"),ea(this,"_downActionX",0),ea(this,"_moveActionX",0),ea(this,"_compareIndex",0),ea(this,"_activeTabItem",null),ea(this,"_moveAction"),ea(this,"_upAction"),ea(this,"_downAction"),ea(this,"_wheelAction"),ea(this,"_scrollIncremental",0),ea(this,"_compareDirection",0),ea(this,"_autoScrollTime",null),ea(this,"_slideScrollbar"),ea(this,"_longPressTimer",null),ea(this,"_leftBoundingLine",0),ea(this,"_rightBoundingLine",0),ea(this,"_leftMoveX",0),ea(this,"_rightMoveX",0),null==t.slideTabBarContainer)throw Error("not found slide-tab-bar root element");let n=t.slideTabBarContainer.querySelector(`.${null!=(i=t.slideTabBarClassName)?i:"slide-tab-bar"}`);if(null==n)throw Error("not found slide-tab-bar");this._slideTabBar=n,this._slideScrollbar=new sG(this),this._config=t,this._initConfig();let r=0,o=0,s=0;this._downAction=i=>{var n,l,a,d,c,u;if(null!=(n=this._activeTabItem)&&n.isEditMode())return;this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null);let h=null==(a=null==(l=i.target)?void 0:l.closest(`.${t.slideTabBarItemClassName}`))?void 0:a.getAttribute("data-id"),m=this._slideTabItems.findIndex(e=>e.getId()===h);if(null==h||-1===m)return;if(this._activeTabItemIndex!==m){null==(d=this._activeTabItem)||d.removeEventListener("pointermove",this._moveAction),null==(c=this._activeTabItem)||c.removeEventListener("pointerup",this._upAction),this.removeListener(),this._config.onChangeTab(i,h);return}if(this._compareIndex=m,this._downActionX=i.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[m],!this._activeTabItem){console.error("Not found active slide-tab-item in sheet bar");return}let g=this._activeTabItem.getSlideTabItem();null==g||g.setPointerCapture(i.pointerId),null==(u=this._activeTabItem)||u.addEventListener("pointerup",this._upAction);let{x:p,width:v}=this._activeTabItem.getBoundingRect(),{x:S,width:f}=this.getBoundingRect(),C=this._slideScrollbar.getScrollX();if(this._leftBoundingLine=this._downActionX-(p-C),this._rightBoundingLine=p-C+v-this._downActionX,this._leftMoveX=p-S-C,this._rightMoveX=S+f-(p+v)+C,2===i.button||this._hasEditItem())return;let{pageX:I,pageY:b}=i,_=Date.now(),R=_-s<=e.DoubleClickDelay,y=10>Math.abs(I-r),T=10>Math.abs(b-o);R&&y&&T&&this._activeTabItem.setEditor(),r=I,o=b,s=_,this._longPressTimer=setTimeout(()=>{var e,t,n;!g||null!=(e=this._activeTabItem)&&e.isEditMode()||(null==(t=this._activeTabItem)||t.enableFixed(),this._startAutoScroll(),g.setPointerCapture(i.pointerId),g.style.cursor="move",null==(n=this._activeTabItem)||n.addEventListener("pointermove",this._moveAction))},e.LongPressDelay)},this._upAction=e=>{var t,i,n,r;if(null!=(t=this._activeTabItem)&&t.isEditMode()||(this._longPressTimer&&(clearTimeout(this._longPressTimer),this._longPressTimer=null),!this._activeTabItem))return;let o=null!==this._autoScrollTime;this._closeAutoScroll(),this._activeTabItem.disableFixed(),this.updateItems();let s=null==(i=this._activeTabItem)?void 0:i.getSlideTabItem();s&&(s.style.cursor="",s.releasePointerCapture(e.pointerId),null==(n=this._activeTabItem)||n.removeEventListener("pointermove",this._moveAction),null==(r=this._activeTabItem)||r.removeEventListener("pointerup",this._upAction),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&o&&(this.removeListener(),this._config.onSlideEnd(e,this._compareIndex||0)),this._scrollIncremental=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0)},this._moveAction=e=>{this._activeTabItem&&(this._moveActionX=e.pageX-this._downActionX,this._moveActionX<=-this._leftMoveX?this._moveActionX=-this._leftMoveX:this._moveActionX>=this._rightMoveX&&(this._moveActionX=this._rightMoveX),this._scrollIncremental=0,this._scrollLeft(e),this._scrollRight(e))},this._wheelAction=e=>{this.setScroll(e.deltaY)},this.addListener()}static checkedSkipSlide(e){let t=e.target;for(;null!=t&&t!==document.body;){if(t.getAttribute("data-slide-skip"))return!0;t=t.parentElement}return!1}static keepLastIndex(e){setTimeout(()=>{let t=window.getSelection();t&&(t.selectAllChildren(e),t.collapseToEnd())})}static keepSelectAll(e){setTimeout(()=>{let t=window.getSelection();if(!t)return;let i=document.createRange();i.selectNodeContents(e),t.removeAllRanges(),t.addRange(i)})}update(e){this._config.currentIndex=e,this._initConfig(),this.removeListener(),this.addListener(),this.scrollToItem(e)}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}getActiveItem(){return this._activeTabItem}isLeftEnd(){return 0===this._slideTabBar.scrollLeft}isRightEnd(){let e=this._slideTabBar.parentElement;return!!e&&this._slideTabBar.scrollWidth-e.clientWidth===this._slideTabBar.scrollLeft}addListener(){this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.addEventListener("pointerdown",this._downAction)})}removeListener(){this._slideTabBar.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.removeEventListener("pointerdown",this._downAction)})}setScroll(e){if(this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e),e>0){let e=this.calculateLeftScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}else if(e<0){let e=this.calculateRightScrollX();this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}flipPage(e){if(e>0){let e=this.calculateLeftScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}else if(e<0){let e=this.calculateRightScrollX(!0);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+e)}this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}scrollToItem(e){if((e=null!=e?e:this._config.currentIndex)<0||e>=this._slideTabItems.length){console.error("Index out of bounds");return}let t=this.calculateTabItemScrollX(e);this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+t),this._config.onScroll({leftEnd:this.isLeftEnd(),rightEnd:this.isRightEnd()})}calculateLeftScrollX(e){let t=0;return this._slideTabItems.some(i=>{let n=this._slideTabBar.getBoundingClientRect(),r=n.left+n.width,o=i.getSlideTabItem().getBoundingClientRect(),s=o.left,l=o.width;return s<r&&s+l+8>r&&(t=e?s-n.left-4:s+l-r+4,!0)}),t}calculateRightScrollX(e){let t=0;return this._slideTabItems.some(i=>{let n=this._slideTabBar.getBoundingClientRect(),r=n.left,o=i.getSlideTabItem().getBoundingClientRect(),s=o.left,l=o.width;return s-8<r&&s+l>r&&(t=e?s+l-n.left-n.width+4:s-r-4,!0)}),t}calculateTabItemScrollX(e){let t=0,i=this._slideTabBar.getBoundingClientRect(),n=i.left,r=i.left+i.width,o=this._slideTabItems[e].getSlideTabItem().getBoundingClientRect(),s=o.left,l=o.width;return s-8<n&&(t=s-n-4),s+l+8>r&&(t=s+l-r+4),t}calculateActiveTabItemScrollX(){var e;let t=0,i=this._slideTabBar.getBoundingClientRect(),n=i.left,r=i.left+i.width,o=null==(e=this._activeTabItem)?void 0:e.getSlideTabItem().getBoundingClientRect();if(!o)return 0;let s=o.left,l=o.width;return s-8<n&&s+l>n&&(t=s-n-4),s<r&&s+l+8>r&&(t=s+l-r+4),t}destroy(){this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=[],this._activeTabItem=null,this.removeListener()}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++)if(this._slideTabItems[e].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break;case 0:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break;case -1:this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft()}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){null==this._autoScrollTime&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){let t=this.getBoundingRect(),i=e.pageX-t.x;i<this._leftBoundingLine&&(this._scrollIncremental=-Math.min(.1*Math.abs(i-this._leftBoundingLine),50))}_scrollRight(e){let t=this.getBoundingRect(),i=e.pageX-t.x;i>t.width-this._rightBoundingLine&&(this._scrollIncremental=Math.min(.1*Math.abs(i-(t.width-this._rightBoundingLine)),50))}_sortedItems(){if(null!=this._activeTabItem&&null!=this._activeTabItemIndex&&null!=this._compareIndex&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){let t=this._slideTabItems[e],i=this._slideTabItems[e+1];i&&t.after(i)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){let e=this._slideTabItems.findIndex(e=>e.equals(this._activeTabItem)),t=this._slideTabItems.length,i=[];for(let t=0;t<e&&!(t>=e);t++)i.push(this._slideTabItems[t]);for(let i=e+1;i<t;i++)this._slideTabItems[i].animate().translateX(0);let n=!0;for(let e=i.length-1;e>=0;e--){let t=i[e];sY.leftLine(this._activeTabItem)<t.getMidLine()?(t.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=e,n=!1):(t.animate().translateX(0),n&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){let e=this._slideTabItems.findIndex(e=>e.equals(this._activeTabItem)),t=this._slideTabItems.length,i=[];for(let n=e+1;n<t;n++)i.push(this._slideTabItems[n]);for(let t=0;t<e;t++)this._slideTabItems[t].animate().translateX(0);let n=!0;for(let t=0;t<i.length;t++){let r=i[t];sY.rightLine(this._activeTabItem)>r.getMidLine()?(r.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+t+1,n=!1):(r.animate().translateX(0),n&&(this._compareIndex=this._activeTabItemIndex))}}}_initConfig(){var e;let t=this._slideTabBar.querySelectorAll(`.${null!=(e=this._config.slideTabBarItemClassName)?e:"slide-tab-item"}`);this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._slideTabItems=sY.make(t,this),this._activeTabItemIndex=this._config.currentIndex,this._activeTabItem=this._slideTabItems[this._activeTabItemIndex]}};el(sZ,"SlideTabBar"),ea(sZ,"LongPressDelay",500),ea(sZ,"DoubleClickDelay",300);let sK=sZ;function sq(){var e;let[t,i]=(0,ee.useState)([]),[n,r]=(0,ee.useState)(""),[o,s]=(0,ee.useState)(""),[l,a]=(0,ee.useState)(!1),[d,c]=(0,ee.useState)([0,0]),u=(0,ee.useRef)({slideTabBar:null}),h=(0,ee.useRef)(null),m=(0,O.useDependency)(O.ICommandService),g=(0,O.useDependency)(oN),p=(0,O.useDependency)(O.LocaleService),v=(0,O.useDependency)(J.IConfirmService),S=(0,O.useDependency)(O.IConfigService),f=(0,O.useDependency)(tA,O.Quantity.OPTIONAL),C=(0,O.useDependency)(A.WorksheetProtectionRuleModel),I=(0,O.useDependency)(A.RangeProtectionRuleModel),b=(0,J.useObservable)(C.resetOrder$),_=sC(),R=(0,O.useDependency)(O.IPermissionService),y=(0,ee.useCallback)(()=>{var e;let t=(null==(e=_.getActiveSheet())?void 0:e.getSheetId())||"";r(t);let n=_.getSheets(),o=_.getActiveSheet();i(n.filter(e=>!e.isSheetHidden()).map((e,t)=>{var i;let n=C.getRule(_.getUnitId(),e.getSheetId()),r=I.getSubunitRuleList(_.getUnitId(),e.getSheetId()).length>0,s=(null==n?void 0:n.permissionId)||r?/* @__PURE__ */o$.jsxs(o$.Fragment,{children:[/* @__PURE__ */o$.jsx(nQ,{}),/* @__PURE__ */o$.jsx("span",{children:e.getName()})]}):/* @__PURE__ */o$.jsx("span",{children:e.getName()});return{sheetId:e.getSheetId(),label:s,index:t,selected:o===e,color:null!=(i=e.getTabColor())?i:void 0}})),r(t)},[I,_,C]);(0,ee.useEffect)(()=>{y();let e=T(),t=V(),i=[W(),H(),U()];return()=>{t.dispose(),e.destroy(),i.forEach(e=>e.unsubscribe())}},[b,_]),(0,ee.useEffect)(()=>{t.length>0&&D()},[t]),(0,ee.useEffect)(()=>{let e=(0,B.merge)(C.ruleChange$,I.ruleChange$).subscribe(()=>{y()});return()=>{e.unsubscribe()}},[C,y]);let T=/* @__PURE__ */el(()=>{let e=new sK({slideTabBarClassName:sB.slideTabBar,slideTabBarItemActiveClassName:sB.slideTabActive,slideTabBarItemClassName:sB.slideTabItem,slideTabBarSpanEditClassName:sB.slideTabDivEdit,slideTabBarItemAutoSort:!0,slideTabBarContainer:h.current,currentIndex:0,onChangeName:/* @__PURE__ */el((e,t)=>{m.executeCommand(A.SetWorksheetNameCommand.id,{subUnitId:e,name:t})},"onChangeName"),onSlideEnd:/* @__PURE__ */el(async(e,t)=>{await m.executeCommand(A.SetWorksheetOrderCommand.id,{order:t})},"onSlideEnd"),onChangeTab:/* @__PURE__ */el((e,t)=>{m.executeCommand(A.SetWorksheetActiveOperation.id,{subUnitId:t,unitId:_.getUnitId()}).then(()=>{2===e.button&&z(!0)})},"onChangeTab"),onScroll:/* @__PURE__ */el(e=>{g.setScroll(e)},"onScroll"),onNameCheckAlert:/* @__PURE__ */el(e=>P(e)||M(e)||x(e),"onNameCheckAlert"),onNameChangeCheck:/* @__PURE__ */el(()=>{var e,t,i,n;let r=_.getUnitId(),o=null==_?void 0:_.getActiveSheet();if(!o)throw Error("No active sheet found");let s=o.getSheetId(),l=C.getRule(r,s),a=I.getSubunitRuleList(r,s).length>0;return l||a?null!=(t=null==(e=R.getPermissionPoint(new A.WorkbookManageCollaboratorPermission(r).id))?void 0:e.value)&&t:null!=(n=null==(i=R.getPermissionPoint(new A.WorkbookRenameSheetPermission(r).id))?void 0:i.value)&&n},"onNameChangeCheck")});return u.current.slideTabBar=e,j(e),e},"setupSlideTabBarInit"),E=S.getConfig(J.PLUGIN_CONFIG_KEY),w=null==(e=null==E?void 0:E.contextMenu)||e,P=/* @__PURE__ */el(e=>{if(""===e.trim()){let e="sheetNameEmptyAlert";return v.open({id:e,title:{title:p.t("sheetConfig.sheetNameErrorTitle")},children:{title:p.t("sheetConfig.sheetNameCannotIsEmptyError")},cancelText:p.t("button.cancel"),confirmText:p.t("button.confirm"),onClose(){k(),v.close(e)},onConfirm(){k(),v.close(e)}}),!0}return!1},"nameEmptyCheck"),M=/* @__PURE__ */el(e=>{if(!(0,O.nameCharacterCheck)(e)){let e="sheetNameSpecCharAlert";return v.open({id:e,title:{title:p.t("sheetConfig.sheetNameErrorTitle")},children:{title:p.t("sheetConfig.sheetNameSpecCharError")},cancelText:p.t("button.cancel"),confirmText:p.t("button.confirm"),onClose(){k(),v.close(e)},onConfirm(){k(),v.close(e)}}),!0}return!1},"sheetNameSpecCharCheck"),x=/* @__PURE__ */el(e=>{let t=_.getActiveSheet();if((null==t?void 0:t.getName())===e)return!1;let i=_.checkSheetName(e);if(i){let e="sheetNameRepeatAlert";v.open({id:e,title:{title:p.t("sheetConfig.sheetNameErrorTitle")},children:{title:p.t("sheetConfig.sheetNameAlreadyExistsError")},cancelText:p.t("button.cancel"),confirmText:p.t("button.confirm"),onClose(){v.close(e),k()},onConfirm(){v.close(e),k()}})}return i},"nameRepeatCheck"),k=/* @__PURE__ */el(()=>{setTimeout(()=>{var e;let t=null==(e=u.current.slideTabBar)?void 0:e.getActiveItem();t&&(t.focus(),t.selectAll())},0)},"focusTabEditor"),N=/* @__PURE__ */el(()=>{var e,t;null==(t=null==(e=u.current.slideTabBar)?void 0:e.getActiveItem())||t.setEditor()},"setTabEditor"),D=/* @__PURE__ */el(()=>{var e;let i=t.findIndex(e=>e.selected);null==(e=u.current.slideTabBar)||e.update(i)},"setupSlideTabBarUpdate"),V=/* @__PURE__ */el(()=>m.onCommandExecuted(e=>{switch(e.id){case A.SetTabColorMutation.id:case A.SetWorksheetHideMutation.id:case A.RemoveSheetMutation.id:case A.SetWorksheetNameMutation.id:case A.InsertSheetMutation.id:case A.SetWorksheetOrderMutation.id:case A.SetWorksheetActiveOperation.id:y()}}),"setupStatusUpdate"),W=/* @__PURE__ */el(()=>g.scroll$.subscribe(e=>{L(e)}),"setupSubscribeScroll"),H=/* @__PURE__ */el(()=>g.scrollX$.subscribe(e=>{var t;null==(t=u.current.slideTabBar)||t.flipPage(e)}),"setupSubscribeScrollX"),U=/* @__PURE__ */el(()=>g.renameId$.subscribe(()=>{N()}),"setupSubscribeRenameId"),L=/* @__PURE__ */el(e=>{let{leftEnd:t,rightEnd:i}=e,n="";t&&i?n="":t&&!i?n="inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)":!t&&i?n="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2)":t||i||(n="inset 10px 0px 10px -10px rgba(0, 0, 0, 0.2), inset -10px 0px 10px -10px rgba(0, 0, 0, 0.2)"),s(n)},"updateScrollButtonState"),F=/* @__PURE__ */el(e=>{let t=e.calculateActiveTabItemScrollX();if(t){let i=e.getScrollbar();i.scrollX(i.getScrollX()+t)}g.setScroll({leftEnd:e.isLeftEnd(),rightEnd:e.isRightEnd()})},"buttonScroll"),j=/* @__PURE__ */el(e=>{var t;let i=null==(t=h.current)?void 0:t.querySelector(`.${sB.slideTabBar}`);i&&new ResizeObserver(()=>{F(e)}).observe(i)},"resizeInit"),z=/* @__PURE__ */el(e=>{var t,i,n,r,o;if(w&&!(null!=f&&f.isForceKeepVisible())){if(e){let{left:e}=null!=(i=null==(t=h.current)?void 0:t.getBoundingClientRect())?i:{},{left:s}=null!=(o=null==(r=null==(n=u.current.slideTabBar)?void 0:n.getActiveItem())?void 0:r.getSlideTabItem().getBoundingClientRect())?o:{};void 0!==e&&void 0!==s&&c([s-e,0])}a(e)}},"onVisibleChange");return /* @__PURE__ */o$.jsx(et.Dropdown,{className:sB.slideTabItemDropdown,visible:l,align:{offset:d},trigger:["contextMenu"],overlay:/* @__PURE__ */o$.jsx(J.Menu,{menuType:J.ContextMenuPosition.FOOTER_TABS,onOptionSelect:/* @__PURE__ */el(e=>{let{label:t,value:i,commandId:r}=e;m.executeCommand(null!=r?r:t,{value:i,subUnitId:n}),a(!1)},"onOptionSelect")}),onVisibleChange:z,children:/* @__PURE__ */o$.jsx("div",{className:sB.slideTabBarContainer,ref:h,onDragStart:/* @__PURE__ */el(e=>e.preventDefault(),"onDragStart"),onContextMenu:/* @__PURE__ */el(e=>e.preventDefault(),"onContextMenu"),children:/* @__PURE__ */o$.jsx("div",{className:sB.slideTabBar,style:{boxShadow:o},children:t.map(e=>/* @__PURE__ */(0,ee.createElement)(sF,{...e,key:e.sheetId,selected:n===e.sheetId}))})})})}el(sq,"SheetBarTabs");let sQ=/* @__PURE__ */el(()=>{let[e,t]=(0,ee.useState)(!0),[i,n]=(0,ee.useState)(!0),r=(0,O.useDependency)(O.ICommandService),o=(0,O.useDependency)(oN),s=(0,O.useDependency)(O.IPermissionService),l=sC().getUnitId(),a=(0,J.useObservable)(s.getPermissionPoint$(new A.WorkbookEditablePermission(l).id)),d=(0,J.useObservable)(s.getPermissionPoint$(new A.WorkbookCreateSheetPermission(l).id));(0,ee.useEffect)(()=>{let e=o.scroll$.subscribe(e=>{c(e)});return()=>{e.unsubscribe()}},[]);let c=/* @__PURE__ */el(e=>{let{leftEnd:i,rightEnd:r}=e;t(i),n(r)},"updateScrollButtonState"),u=/* @__PURE__ */el(()=>{r.executeCommand(A.InsertSheetCommand.id),setTimeout(()=>{o.setAddSheet(0)},0)},"addSheet"),h=/* @__PURE__ */el(()=>{o.setScrollX(-100)},"handleScrollLeft"),m=/* @__PURE__ */el(()=>{o.setScrollX(100)},"handleScrollRight");return /* @__PURE__ */o$.jsxs("div",{className:sW.sheetBar,children:[/* @__PURE__ */o$.jsxs("div",{className:sW.sheetBarOptions,children:[/* @__PURE__ */o$.jsx(sH,{onClick:u,disabled:!(null!=d&&d.value&&null!=a&&a.value),children:/* @__PURE__ */o$.jsx(nK,{})}),/* @__PURE__ */o$.jsx(sL,{})]}),/* @__PURE__ */o$.jsx(sq,{}),(!e||!i)&&/* @__PURE__ */o$.jsxs("div",{className:`${sW.sheetBarOptions} ${sW.sheetBarOptionsDivider}`,children:[/* @__PURE__ */o$.jsx(sH,{disabled:e,onClick:h,children:/* @__PURE__ */o$.jsx(n1,{style:{transform:"rotateZ(180deg)"}})}),/* @__PURE__ */o$.jsx(sH,{disabled:i,onClick:m,children:/* @__PURE__ */o$.jsx(n1,{})})]})]})},"SheetBar"),sJ=class{constructor(){ea(this,"_functions",[{func:ei.FUNCTION_NAMES_STATISTICAL.MAX,filter:/* @__PURE__ */el(e=>{var t,i,n,r;return(null!=(i=null==(t=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNTA))?void 0:t.value)?i:0)>1&&(null!=(r=null==(n=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNT))?void 0:n.value)?r:0)>0},"filter")},{func:ei.FUNCTION_NAMES_STATISTICAL.MIN,filter:/* @__PURE__ */el(e=>{var t,i,n,r;return(null!=(i=null==(t=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNTA))?void 0:t.value)?i:0)>1&&(null!=(r=null==(n=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNT))?void 0:n.value)?r:0)>0},"filter")},{func:ei.FUNCTION_NAMES_MATH.SUM,filter:/* @__PURE__ */el(e=>{var t,i,n,r;return(null!=(i=null==(t=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNTA))?void 0:t.value)?i:0)>1&&(null!=(r=null==(n=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNT))?void 0:n.value)?r:0)>0},"filter")},{func:ei.FUNCTION_NAMES_STATISTICAL.COUNTA,filter:/* @__PURE__ */el(e=>{var t,i;return(null!=(i=null==(t=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNTA))?void 0:t.value)?i:0)>1},"filter")},{func:ei.FUNCTION_NAMES_STATISTICAL.COUNT,filter:/* @__PURE__ */el(e=>{var t,i,n,r;return(null!=(i=null==(t=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNTA))?void 0:t.value)?i:0)>1&&(null!=(r=null==(n=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNT))?void 0:n.value)?r:0)>0},"filter")},{func:ei.FUNCTION_NAMES_STATISTICAL.AVERAGE,filter:/* @__PURE__ */el(e=>{var t,i,n,r;return(null!=(i=null==(t=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNTA))?void 0:t.value)?i:0)>1&&(null!=(r=null==(n=e.values.find(e=>e.func===ei.FUNCTION_NAMES_STATISTICAL.COUNT))?void 0:n.value)?r:0)>0},"filter")}]),ea(this,"_state$",new k.BehaviorSubject(null)),ea(this,"state$",this._state$.asObservable())}dispose(){this._state$.complete()}setState(e){var t;let i={values:[],pattern:null};null==e||e.values.forEach(t=>{let n=this._functions.find(e=>e.func===t.func);n&&(void 0===n.filter||n.filter(e))&&i.values.push(t)}),i.pattern=null!=(t=null==e?void 0:e.pattern)?t:null,this._state$.next(i)}getState(){return this._state$.getValue()}getFunctions(){return this._functions}addFunctions(e){this._functions.push(...e)}};el(sJ,"StatusBarService");let s$=(0,O.createIdentifier)("univer.sheet-status-bar.service"),s0={statusBar:"univer-status-bar",singleMode:"univer-single-mode",statusBarDiv:"univer-status-bar-div",statisticList:"univer-statistic-list",statisticListColumn:"univer-statistic-list-column",statisticItem:"univer-statistic-item"},s1=[ei.FUNCTION_NAMES_MATH.SUM,ei.FUNCTION_NAMES_STATISTICAL.AVERAGE,ei.FUNCTION_NAMES_STATISTICAL.MIN,ei.FUNCTION_NAMES_STATISTICAL.MAX],s2={[ei.FUNCTION_NAMES_MATH.SUM]:"statusbar.sum",[ei.FUNCTION_NAMES_STATISTICAL.AVERAGE]:"statusbar.average",[ei.FUNCTION_NAMES_STATISTICAL.MIN]:"statusbar.min",[ei.FUNCTION_NAMES_STATISTICAL.MAX]:"statusbar.max",[ei.FUNCTION_NAMES_STATISTICAL.COUNT]:"statusbar.count",[ei.FUNCTION_NAMES_STATISTICAL.COUNTA]:"statusbar.countA",[ei.FUNCTION_NAMES_TEXT.CONCATENATE]:"concatenate"},s5=/* @__PURE__ */el(e=>{let t=(0,O.useDependency)(O.LocaleService),i=(0,O.useDependency)(J.IMessageService),n=(0,O.useDependency)(J.IClipboardInterfaceService),r=s9(e),o=/* @__PURE__ */el(async()=>{await n.writeText(e.value.toString()),i.show({type:et.MessageType.Success,content:t.t("statusbar.copied")})},"copyToClipboard");return /* @__PURE__ */o$.jsx(et.Tooltip,{title:t.t("statusbar.clickToCopy"),placement:"top",children:/* @__PURE__ */o$.jsx("div",{className:s0.statisticItem,onClick:o,children:/* @__PURE__ */o$.jsx("span",{children:`${t.t((null==s2?void 0:s2[e.name])||e.name)}: ${r}`})},e.name)})},"CopyableStatisticItem");function s9(e){let{pattern:t,value:i}=e;return"number"!=typeof i?0:i>=1e8?i.toExponential(2):t&&s1.includes(e.name)?(0,O.numfmt).format(t,i,{throws:!1}):i.toLocaleString()}el(s9,"formatNumber");let s6=/* @__PURE__ */el(()=>{let[e,t]=(0,ee.useState)(window.innerWidth<800),[i,n]=(0,ee.useState)(!0),r=(0,O.useDependency)(s$),o=r.getFunctions().map((e,t)=>({name:e.func,value:0,show:!0,disable:!1,pattern:null})),[s,l]=(0,ee.useState)(o),a=s.find(e=>e.show&&!e.disable),d=e&&a?[a]:s.filter(e=>e.show&&!e.disable);(0,ee.useEffect)(()=>{let e=r.state$.subscribe(e=>{let t=null==e?void 0:e.values;t&&0!==t.length?(n(!0),l(s.map(i=>{var n;let r=t.find(e=>e.func===i.name);return r?(i.value=r.value,i.disable=!1):i.disable=!0,i.pattern=null!=(n=null==e?void 0:e.pattern)?n:null,i}))):n(!1)});return()=>{e.unsubscribe()}},[r]);let c=(0,O.debounce)(()=>{let i=window.innerWidth<800;e!==i&&t(i)},100);(0,ee.useEffect)(()=>(window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}),[e]);let u=null;if(d.length>3){let e=[];d.forEach((t,i)=>{i%2==0&&e.push(d.slice(i,i+2))}),u=/* @__PURE__ */o$.jsxs(o$.Fragment,{children:[" ",e.map((e,t)=>/* @__PURE__ */o$.jsxs("div",{className:s0.statisticListColumn,children:[(null==e?void 0:e[0])&&/* @__PURE__ */o$.jsx(s5,{...null==e?void 0:e[0]},null==e?void 0:e[0].name),(null==e?void 0:e[1])&&/* @__PURE__ */o$.jsx(s5,{...null==e?void 0:e[1]},null==e?void 0:e[1].name)]},`stat-col-${t}`))," "]})}else u=/* @__PURE__ */o$.jsx(o$.Fragment,{children:d.map(e=>/* @__PURE__ */o$.jsx(s5,{...e},e.name))});return i&&/* @__PURE__ */o$.jsxs("div",{className:sg(s0.statusBar,{[s0.singleMode]:e}),children:[/* @__PURE__ */o$.jsx("div",{className:sg(s0.statisticList),children:u}),/* @__PURE__ */o$.jsx("div",{className:s0.statusBarDiv})]})},"StatusBar"),s3={sheetFooterBarHeight:"36",sheetContainer:"univer-sheet-container"};function s7(){let e=(0,O.useDependency)(J.IMenuManagerService),t=sC(),i=e.getMenuByPositionKey(J.ContextMenuPosition.FOOTER_MENU);return t?/* @__PURE__ */o$.jsxs("section",{className:s3.sheetContainer,"data-range-selector":!0,children:[/* @__PURE__ */o$.jsx(sQ,{}),/* @__PURE__ */o$.jsx(s6,{}),i.map(e=>{var t;return null==(t=e.children)?void 0:t.map(e=>(null==e?void 0:e.item)&&/* @__PURE__ */o$.jsx(J.ToolbarItem,{align:{offset:[-32,18]},...e.item},e.key))}),/* @__PURE__ */o$.jsx(s_,{})]}):null}function s4(){return le()?/* @__PURE__ */o$.jsx(sA,{}):null}function s8(){return le()?/* @__PURE__ */o$.jsxs(o$.Fragment,{children:[/* @__PURE__ */o$.jsx(sE,{}),/* @__PURE__ */o$.jsx(sV,{})]}):null}function le(){let e=(0,O.useDependency)(O.IUniverInstanceService),t=(0,J.useObservable)(()=>e.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),null,!1,[]);return(0,ee.useMemo)(()=>e.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET).length>0,[e,t])}el(s7,"RenderSheetFooter"),el(s4,"RenderSheetHeader"),el(s8,"RenderSheetContent"),el(le,"useHasWorkbook");let lt="sheets-ui.config",li={formulaBar:!0};function ln(e){return e.getContextValue(O.FOCUSING_SHEET)}function lr(e){return e.getContextValue(O.FOCUSING_SHEET)&&e.getContextValue(O.FOCUSING_UNIVER_EDITOR)&&!e.getContextValue(O.EDITOR_ACTIVATED)&&!e.getContextValue(O.FOCUSING_COMMON_DRAWINGS)}function lo(e){return e.getContextValue(O.FOCUSING_SHEET)&&e.getContextValue(O.FOCUSING_UNIVER_EDITOR)&&!e.getContextValue(O.EDITOR_ACTIVATED)&&!e.getContextValue(O.FOCUSING_FX_BAR_EDITOR)&&!e.getContextValue(O.FOCUSING_COMMON_DRAWINGS)}function ls(e){return e.getContextValue(O.FOCUSING_SHEET)&&e.getContextValue(O.FOCUSING_UNIVER_EDITOR)&&e.getContextValue(O.EDITOR_ACTIVATED)}function ll(e){return e.getContextValue(O.FOCUSING_UNIVER_EDITOR)&&e.getContextValue(O.EDITOR_ACTIVATED)}function la(e){return e.getContextValue(O.FOCUSING_FX_BAR_EDITOR)&&e.getContextValue(O.FOCUSING_UNIVER_EDITOR)}function ld(e){return e.getContextValue(O.FOCUSING_SHEET)&&e.getContextValue(O.EDITOR_ACTIVATED)&&e.getContextValue(O.FOCUSING_EDITOR_INPUT_FORMULA)&&e.getContextValue(O.FOCUSING_UNIVER_EDITOR)}function lc(e){return e.getContextValue(O.FOCUSING_SHEET)&&e.getContextValue(O.FOCUSING_UNIVER_EDITOR)&&e.getContextValue(O.EDITOR_ACTIVATED)&&!e.getContextValue(O.FOCUSING_EDITOR_INPUT_FORMULA)&&!e.getContextValue(O.FOCUSING_EDITOR_STANDALONE)}function lu(){return(0,O.Tools).generateRandomId(6)}function lh(e){let t=e.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}el(ln,"whenSheetFocused"),el(lr,"whenSheetEditorFocused"),el(lo,"whenSheetEditorFocusedAndFxNotFocused"),el(ls,"whenSheetEditorActivated"),el(ll,"whenEditorActivated"),el(la,"whenFormulaEditorFocused"),el(ld,"whenFormulaEditorActivated"),el(lc,"whenEditorDidNotInputFormulaActivated"),el(lu,"genId"),el(lh,"extractId");let lm=class{constructor(){ea(this,"_cache",new O.LRUMap(10))}set(e,t){this._cache.set(e,t)}get(e){return this._cache.get(e)}del(e){this._cache.delete(e)}clear(){this._cache.clear()}};function lg(e,t){let i=null!=t?t:e.style,n={},r=e.tagName.toLowerCase();switch(r){case"b":case"em":case"strong":n.bl=O.BooleanNumber.TRUE;break;case"s":n.st={s:O.BooleanNumber.TRUE};break;case"u":n.ul={s:O.BooleanNumber.TRUE};break;case"i":n.it=O.BooleanNumber.TRUE;break;case"sub":case"sup":n.va="sup"===r?O.BaselineOffset.SUPERSCRIPT:O.BaselineOffset.SUBSCRIPT}return lp(i,n),n}function lp(e,t){if(e instanceof CSSStyleDeclaration)for(let i=0;i<e.length;i++){let n=e[i],r=e.getPropertyValue(n);lv(n,r,t)}else for(let i in e){let n=e[i];lv(i,n,t)}}function lv(e,t,i){switch(e){case"font-family":i.ff=t;break;case"font-size":{let e=Number.parseInt(t);Number.isNaN(e)||(t.endsWith("pt")?i.fs=e:t.endsWith("px")&&(i.fs=.75*e));break}case"font-style":"italic"===t&&(i.it=O.BooleanNumber.TRUE);break;case"font-weight":(Number(t)>400||"bold"===t)&&(i.bl=O.BooleanNumber.TRUE);break;case"text-decoration":/underline/.test(t)?i.ul={s:O.BooleanNumber.TRUE}:/overline/.test(t)?i.ol={s:O.BooleanNumber.TRUE}:/line-through/.test(t)&&(i.st={s:O.BooleanNumber.TRUE});break;case"color":try{let e=new O.ColorKit(t);e.isValid&&(i.cl={rgb:e.toRgbString()})}catch{}break;case"background-color":{let e=new O.ColorKit(t),n=e.isValid?e.toRgbString():"";n!==J.DEFAULT_BACKGROUND_COLOR_RGB&&n!==J.DEFAULT_BACKGROUND_COLOR_RGBA&&(i.bg={rgb:n})}}}function lS(e){let t=document.createElement("body");return t.innerHTML=e,t}function lf(e){let t=e.style,i={};for(let e=0;e<t.length;e++){let n=t[e],r=t.getPropertyValue(n);switch(n){case"margin-top":{let e=Number.parseInt(r);i.spaceAbove={v:/pt/.test(r)?(0,x.ptToPixel)(e):e};break}case"margin-bottom":{let e=Number.parseInt(r);i.spaceBelow={v:/pt/.test(r)?(0,x.ptToPixel)(e):e};break}case"line-height":{let e=Number.parseFloat(r);i.lineSpacing=e}}}return Object.getOwnPropertyNames(i).length?i:null}function lC(e,t){let i=[];for(let t=0,n=e.length;t<n;t++)e[t]===O.DataStreamTreeTokenType.PARAGRAPH&&i.push({startIndex:t});return i}el(lm,"CopyContentCache"),el(lg,"extractNodeStyle"),el(lp,"parseStyleByProperty"),el(lv,"handleStyle"),el(lS,"parseToDom"),el(lf,"getParagraphStyle"),el(lC,"generateParagraphs");let lI=["color","background","font-size","text-align","vertical-align","font-weight","font-style","font-family","text-decoration","white-space","word-wrap","border-left","border-right","border-top","border-bottom","--data-rotate"];function lb(e,t){let i=e.tagName.toLowerCase();return"string"==typeof t?i===t:Array.isArray(t)?t.some(e=>e===i):t(e)}el(lb,"matchFilter");let l_=class e{constructor(e){ea(this,"_styleMap",/* @__PURE__ */new Map),ea(this,"_styleCache",/* @__PURE__ */new Map),ea(this,"_styleRules",[]),ea(this,"_afterProcessRules",[]),ea(this,"_dom",null),ea(this,"_getCurrentSkeleton"),this._getCurrentSkeleton=e.getCurrentSkeleton}static use(e){if(this._pluginList.includes(e))throw Error(`Univer paste plugin ${e.name} already added`);this._pluginList.push(e)}convert(t){var i;let n=e._pluginList.find(e=>e.checkPasteType(t));n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]);let r=new O.ObjectMatrix;this._dom=lS(t);let o=this._dom.querySelector("style");if(o){let e=document.createElement("div"),t=e.attachShadow({mode:"open"});for(let i of(document.body.appendChild(e),t.appendChild(o),o.sheet.cssRules)){let e=i.selectorText,t=i.style;this._styleMap.set(e,t)}o.remove(),e.remove()}let s={dataStream:"",textRuns:[]},l=[],a=[],d=t.match(/<table\b[^>]*>([\s\S]*?)<\/table>/gi);this.process(null,this._dom.childNodes,s,[]);let{paragraphs:c,dataStream:u,textRuns:h,payloads:m,customRanges:g}=s;if(c){let e=c.map(e=>e.startIndex+1);e.unshift(0);for(let t=0;t<e.length;t++){let i;if(t===e.length-1){if((i=`${u.substring(e[t])}\r
`)==`\r
`)continue}else i=`${u.substring(e[t],e[t+1]-1)}\r
`;let n=[];null==h||h.forEach(i=>{i.st>=e[t]&&i.ed<=e[t+1]&&n.push({st:i.st-e[t],ed:i.ed-e[t],ts:i.ts})});let o=[];null==g||g.forEach(i=>{i.startIndex>=e[t]&&i.endIndex<=e[t+1]&&o.push({...i,startIndex:i.startIndex-e[t],endIndex:i.endIndex-e[t]})});let s=this._generateDocumentDataModelSnapshot({body:{dataStream:i,textRuns:n,paragraphs:lC(i),customRanges:o}}),a=0===Object.keys(r.getMatrix()).length;r.setValue(a?0:r.getLength(),0,{v:i,p:s}),l.push({})}}else if(u){let e=`${u}\r
`,t={dataStream:e,textRuns:h,paragraphs:lC(e),payloads:m,customRanges:g},n=u.length,o=null!=(i=null==h?void 0:h.length)?i:0;if(null!=g&&g.length||o&&(1!==o||0!==h[0].st||h[0].ed!==n)){let e=this._generateDocumentDataModelSnapshot({body:t});r.setValue(0,0,{v:u,p:e})}else r.setValue(0,0,{v:u});l.push({})}return d&&d.forEach((e,t)=>{let i=r.getDataRange().endRow+1,{cellMatrix:n,rowProperties:o,colProperties:s}=this._parseTable(e,t);n&&n.forValue((e,t,n)=>{r.setValue(i+e,t,n)}),s&&a.push(...s),l.push(...o)}),this.dispose(),{rowProperties:l,colProperties:a,cellMatrix:r}}_getStyleBySelectorText(e,t){var i;return(null==(i=this._styleMap.get(e))?void 0:i.getPropertyValue(t))||""}_getStyle(e,t){let i=ly(t),n=e.style,r="";for(let t=0;t<lI.length;t++){let o=lI[t];if("background"===o){let t="";e.classList.forEach(e=>{t=this._getStyleBySelectorText(`.${e}`,"background-color")||this._getStyleBySelectorText(`.${e}`,o)});let s=n.getPropertyValue("background-color")||t||this._getStyleBySelectorText(`#${e.id}`,"background-color")||this._getStyleBySelectorText(`#${e.id}`,o)||this._getStyleBySelectorText(e.nodeName.toLowerCase(),o)||this._getStyleBySelectorText(e.nodeName,"background-color")||i["background-color"]||"";s&&(r+=`background:${s};`);continue}if("text-decoration"===o){let t="";e.classList.forEach(e=>{t=this._getStyleBySelectorText(`.${e}`,"text-decoration-line")||this._getStyleBySelectorText(`.${e}`,o)});let s=n.getPropertyValue("text-decoration-line")||n.getPropertyValue("text-decoration")||t||this._getStyleBySelectorText(`#${e.id}`,"text-decoration-line")||this._getStyleBySelectorText(`#${e.id}`,o)||this._getStyleBySelectorText(e.nodeName.toLowerCase(),o)||this._getStyleBySelectorText(e.nodeName,"text-decoration-line")||i["text-decoration-line"]||"";s&&(r+=`text-decoration:${s};`);continue}let s="";e.classList.forEach(e=>{s=this._getStyleBySelectorText(`.${e}`,o)}),(s=n.getPropertyValue(o)||this._getStyleBySelectorText(`#${e.id}`,o)||s||this._getStyleBySelectorText(e.nodeName.toLowerCase(),o)||i[o]||"")&&(r+=`${o}:${s};`)}return r}_parseTable(e,t){var i,n;let r=new O.ObjectMatrix,o=null!=(i=lE(e))?i:[],{rowProperties:s=[]}=lR(e),l=this._parseTableByHtml(this._dom,t,null==(n=this._getCurrentSkeleton())?void 0:n.skeleton);return l&&l.forValue((e,t,i)=>{var n,o,s,l,a,d,c,u,h,m,g,p,v,S,f,C,I,b,_,R,y,T,E,w;let P=(0,J.handleStringToStyle)(void 0,i.style);if(null!=(l=null==(s=null==(o=null==(n=null==i?void 0:i.richTextParma)?void 0:n.p)?void 0:o.body)?void 0:s.textRuns)&&l.length){let e=null==(d=null==(a=null==i?void 0:i.richTextParma)?void 0:a.v)?void 0:d.length;for(let t=0;t<(null==(m=null==(h=null==(u=null==(c=null==i?void 0:i.richTextParma)?void 0:c.p)?void 0:u.body)?void 0:h.textRuns)?void 0:m.length);t++){let n=null==(v=null==(p=null==(g=null==i?void 0:i.richTextParma)?void 0:g.p)?void 0:p.body)?void 0:v.textRuns[t];0===n.st&&n.ed===e&&(P={...n.ts,...P},null==(C=null==(f=null==(S=null==i?void 0:i.richTextParma)?void 0:S.p)?void 0:f.body)||C.textRuns.splice(t,1),t--)}(null==(R=null==(_=null==(b=null==(I=null==i?void 0:i.richTextParma)?void 0:I.p)?void 0:b.body)?void 0:_.textRuns)?void 0:R.length)===0&&(i.content=null==(y=null==i?void 0:i.richTextParma)?void 0:y.v,delete i.richTextParma)}let M=null!=(w=null==(E=null==(T=null==i?void 0:i.richTextParma)?void 0:T.p)?void 0:E.body)&&w.textRuns?{v:i.richTextParma.v,p:i.richTextParma.p,s:P,rowSpan:i.rowSpan,colSpan:i.colSpan}:{v:i.content,s:P,rowSpan:i.rowSpan,colSpan:i.colSpan};r.setValue(e,t,M)}),{rowProperties:s,colProperties:o,cellMatrix:r}}_parseTableByHtml(e,t,i){var n,r;let o=new O.ObjectMatrix,s=e.querySelectorAll("table")[t];if(!s)return o;let l=this._getStyle(s,""),a=null==s?void 0:s.querySelectorAll("tr");for(let e=0;e<a.length;e++){let t=a[e],s=this._getStyle(t,l),d=t.querySelectorAll("td, th"),c=0;for(let t=0;t<d.length;){let l=d[t],a="",u=Number(l.getAttribute("rowSpan"))||1,h=Number(l.getAttribute("colSpan"))||1;if(a=this._getStyle(l,s),e>0){let t=o.getValue(e-1,c);if(null!=(n=null==t?void 0:t.style)&&n.includes("border-bottom")&&a.includes("border-top")){let e=lP(t.style,"border-bottom");e&&"none"!==(0,J.textTrim)(e.substr(e.indexOf(":")+1))&&(a=a.replace(/border-top:[^;]+;/,""))}}if(t>0){let t=o.getValue(e,c-1);if(null!=(r=null==t?void 0:t.style)&&r.includes("border-right")&&a.includes("border-left")){let e=lP(t.style,"border-right");e&&"none"!==(0,J.textTrim)(e.substr(e.indexOf(":")+1))&&(a=a.replace(/border-left:[^;]+;/,""))}}let{cellText:m,cellRichStyle:g}=this._getCellTextAndRichText(l,a,i),p={rowSpan:u,colSpan:h,content:m,style:a,richTextParma:{p:g,v:m}};if(o.getValue(e,c)){c+=1;continue}u>1||h>1?lM(o,a,p,{colSpan:h,rowSpan:u,rowIndex:e,colIndex:t,colSetValueIndex:c}):o.setValue(e,c,p),c+=h,t++}}return o}_parseCellHtml(e,t,i,n=/* @__PURE__ */new Map,r){var o;for(let s of t)if(s.nodeType===Node.TEXT_NODE){let t;let r=null==(o=s.nodeValue)?void 0:o.replace(/[\r\n]/g,"");e&&n.has(e)&&(t=n.get(e)),i.dataStream+=r,t&&Object.getOwnPropertyNames(t).length&&i.textRuns.push({st:i.dataStream.length-r.length,ed:i.dataStream.length,ts:t})}else{if(s.nodeType===Node.COMMENT_NODE||"STYLE"===s.nodeName)continue;if(s.nodeType===Node.ELEMENT_NODE){let t=this._getStyle(s,r),o=e?n.get(e):{},l=lg(s,ly(t));n.set(s,{...o,...l});let{childNodes:a}=s;this._parseCellHtml(s,a,i,n,t)}}}_getCellTextAndRichText(e,t,i){var n;let r="",o;if(/<[^>]+>/.test(e.innerHTML)&&i){let s={dataStream:"",textRuns:[]};this._parseCellHtml(null,e.childNodes,s,void 0,t);let l=null==(n=i.getBlankCellDocumentModel())?void 0:n.documentModel,a=null==l?void 0:l.getSnapshot(),d=`${s.dataStream}\r
`,c={...a,body:{dataStream:d,textRuns:s.textRuns,paragraphs:lC(d)}};null==l||l.reset(c),o=null==l?void 0:l.getSnapshot(),r=s.dataStream}else r=lw(e.innerHTML.replace(/[\r\n]/g,""));return{cellText:r,cellRichStyle:o}}_generateDocumentDataModelSnapshot(e){var t;let i=this._getCurrentSkeleton();if(null==i)return null;let{skeleton:n}=i,r=null==(t=n.getBlankCellDocumentModel())?void 0:t.documentModel,o={...null==r?void 0:r.getSnapshot(),...e};return null==r||r.reset(o),null==r?void 0:r.getSnapshot()}process(e,t,i,n){var r,o,s;for(let l of t)if("table"===l.nodeName.toLowerCase())n.push({index:(null==(r=null==i?void 0:i.paragraphs)?void 0:r.length)||0});else if(l.nodeType===Node.TEXT_NODE){let t;if((null==(o=l.nodeValue)?void 0:o.trim())==="")continue;let n=null==(s=l.nodeValue)?void 0:s.replace(/[\r\n]/g,"");e&&this._styleCache.has(e)&&(t=this._styleCache.get(e));let r={dataStream:"",textRuns:[]};i.dataStream+=n,r.dataStream+=n,t&&Object.getOwnPropertyNames(t).length&&(i.textRuns.push({st:i.dataStream.length-n.length,ed:i.dataStream.length,ts:t}),r.textRuns.push({st:i.dataStream.length-n.length,ed:i.dataStream.length,ts:t}))}else{if((0,O.skipParseTagNames).includes(l.nodeName.toLowerCase()))continue;if(l.nodeType===Node.ELEMENT_NODE){if("STYLE"===l.nodeName)continue;let t=this._processBeforeLink(l,{body:i}),r=e?this._styleCache.get(e):{},o=this._styleRules.find(({filter:e})=>lb(l,e)),s=o?o.getStyle(l):lg(l);this._styleCache.set(l,{...r,...s});let{childNodes:a}=l;this.process(l,a,i,n);let d=this._afterProcessRules.find(({filter:e})=>lb(l,e));d&&d.handler(i,l),this._processAfterLink(l,{body:i},t)}}}_processBeforeLink(e,t){let i=t.body,n=i.dataStream.length;return"A"===e.tagName.toUpperCase()&&(i.dataStream+=O.DataStreamTreeTokenType.CUSTOM_RANGE_START),n}_processAfterLink(e,t,i){var n,r;let o=t.body;"A"===e.tagName.toUpperCase()&&(o.dataStream+=O.DataStreamTreeTokenType.CUSTOM_RANGE_END,o.customRanges=null!=(n=o.customRanges)?n:[],o.customRanges.push({startIndex:i,endIndex:o.dataStream.length-1,rangeId:null!=(r=e.dataset.rangeid)?r:(0,O.generateRandomId)(),rangeType:O.CustomRangeType.HYPERLINK,properties:{url:e.href}}))}dispose(){this._dom=null,this._styleCache.clear(),this._styleMap.clear()}};function lR(e){let t=e.matchAll(/<tr([\s\S]*?)>([\s\S]*?)<\/tr>/gi);if(!t)return{rowProperties:[],rowCount:0};let i=Array.from(t).map(e=>lT(e[1])).map(e=>{if(!e.height){let t=e.style,i=t&&t.match(/height\s*:\s*(\d+(\.\d+)?)px/);e.height=`${i?Number.parseInt(i[1],10):O.DEFAULT_WORKSHEET_ROW_HEIGHT}`}return e});return{rowProperties:i,rowCount:i.length}}function ly(e){let t={};return e.split(";").forEach(e=>{let[i,n]=e.split(":");t[i]=n}),t}function lT(e){let t;if(!e)return{};let i={},n=/([\w-]+)\s*=\s*(?:(['"])([^'"]*)\2|(\S+))/g;for(;null!==(t=n.exec(e));){let[,e,,n,r]=t,o=void 0!==n?n:r;i[e]=o}return i}function lE(e){let t;let i=e.match(/<colgroup([\s\S]*?)>(.*?)<\/colgroup>/),n=/<col([\s\S]*?)>/g;if(!(t=null!=i&&i[2]?i[2].matchAll(n):e.matchAll(n)))return null;let r=Array.from(t).map(e=>lT(e[1])),o=[];return r.forEach(e=>{let t=Number(e.span);if(t)for(let i=0;i<t;i++){let t={...e};delete t.span,o.push(t)}else o.push(e)}),o}function lw(e){let t={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&#39;":"'","&nbsp;":" "};return e.replace(/&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;|<br>/g,e=>t[e])}function lP(e,t){if(!e||!t)return null;let i=RegExp(`(${t}\\s*:\\s*[^;]+);`,"i"),n=e.match(i);return n?n[1]:null}function lM(e,t,i,n){let{rowSpan:r,colSpan:o,rowIndex:s,colSetValueIndex:l}=n;for(let n=s;n<s+r;n++)for(let r=l;r<l+o;r++)n===s&&r===l?e.setValue(n,r,{...i,style:t}):e.setValue(n,r,{style:t})}el(l_,"HtmlToUSMService"),ea(l_,"_pluginList",[]),el(lR,"parseTableRows"),el(ly,"turnToStyleObject"),el(lT,"parseProperties"),el(lE,"parseColGroup"),el(lw,"decodeHTMLEntities"),el(lP,"extractStyleProperty"),el(lM,"setMergedCellStyle");var lO=((R=lO||{}).COPY="COPY",R.CUT="CUT",R);function lx(e,t,i,n,r){let o=lD(lN(i.map(t=>{var i;return null==(i=t.onCopyRow)?void 0:i.call(t,e)}).filter(e=>!!e))),s=t.map(t=>{if(!r.has(`${e}-${t}`)){let o=n.getValue(e,t);if(null!=o&&o.rowSpan&&null!=o&&o.colSpan)for(let i=e;i<e+o.rowSpan;i++)for(let e=t;e<t+o.colSpan;e++)r.add(`${i}-${e}`);return lA(e,t,i,n)}return null}).filter(e=>!!e).join("");return`<tr${o}>${s}</tr>`}function lA(e,t,i,n){let r=n.getValue(e,t),o=lD(lN(i.map(i=>{var n;return null==(n=i.onCopyCellStyle)?void 0:n.call(i,e,t,null==r?void 0:r.rowSpan,null==r?void 0:r.colSpan)}).filter(e=>!!e))),s=i.reduce((i,n)=>{var r;return i||(null==(r=n.onCopyCellContent)?void 0:r.call(n,e,t))||""},"");return`<td${o}>${s}</td>`}function lk(e,t){return`<colgroup>${e.map(e=>{let i=lN(t.map(t=>{var i;return null==(i=t.onCopyColumn)?void 0:i.call(t,e)}).filter(e=>!!e));return`<col ${lD(i)}>`}).join("")}</colgroup>`}function lN(e){return e.reduce((e,t)=>(Object.keys(t).forEach(i=>{e[i]?e[i]+=`;${t[i]}`:e[i]=t[i]}),e),{})}function lD(e){return Object.keys(e).reduce((t,i)=>t+=` ${i}="${e[i]}"`,"")}el(lx,"getRowContent"),el(lA,"getTDContent"),el(lk,"getColStyle"),el(lN,"mergeProperties"),el(lD,"zipClipboardPropertyItemToString");let lV=class{convert(e,t,i){let{cols:n,rows:r}=t;if(!n.length)return"";let o=lk(n,i),s=[],l=/* @__PURE__ */new Set;return r.forEach(t=>{s.push(lx(t,n,i,e,l))}),`<google-sheets-html-origin><table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" cellpadding="0" dir="ltr" style="table-layout:fixed;font-size:10pt;font-family:Arial;width:0px;border-collapse:collapse;border:none">${o}
<tbody>${s.join("")}</tbody></table>`}};el(lV,"USMToHtmlService");let lW=/* @__PURE__ */el((e,t,i=!1)=>{let n=/* @__PURE__ */el(e=>e.endRow-e.startRow+1,"getRowLength"),r=/* @__PURE__ */el(e=>e.endColumn-e.startColumn+1,"getColLength"),o=n(t)%n(e),s=r(t)%r(e),l={startRow:0,endRow:n(e)-1,startColumn:0,endColumn:r(e)-1},a=Math.floor(n(t)/n(e)),d=Math.floor(r(t)/r(e)),c=[];if(o||s){if(o||!s||i){if(!o||s||i){let e={startRow:t.startRow,endRow:t.startRow,startColumn:t.startColumn,endColumn:t.startColumn};c.push({startRange:e,repeatRelativeRange:l})}else for(let i=1;i<=d;i++){let n=r(e)*(i-1),o={startRow:0+t.startRow,endRow:0+t.startRow,startColumn:n+t.startColumn,endColumn:n+t.startColumn};c.push({repeatRelativeRange:l,startRange:o})}}else for(let i=1;i<=a;i++){let r=n(e)*(i-1),o={startRow:r+t.startRow,endRow:r+t.startRow,startColumn:0+t.startColumn,endColumn:0+t.startColumn};c.push({repeatRelativeRange:l,startRange:o})}}else for(let i=1;i<=a;i++)for(let o=1;o<=d;o++){let s=n(e)*(i-1),a=r(e)*(o-1),d={startRow:s+t.startRow,endRow:s+t.startRow,startColumn:a+t.startColumn,endColumn:a+t.startColumn};c.push({repeatRelativeRange:l,startRange:d})}return c},"getRepeatRange");async function lH(e){return!!e&&/<td[^>]*class=".*?xl.*?"[^>]*>.*?<\/td>/.test(e)}function lU(...e){if(1===e.length)return e[0];let t=new O.ObjectMatrix;return e.forEach(e=>{e&&new(0,O.ObjectMatrix)(e).forValue((e,i,n)=>{t.setValue(e,i,{...t.getValue(e,i),...n})})}),t.getMatrix()}function lL(e,t){return e.id===t.id&&e.params.unitId===t.params.unitId&&e.params.subUnitId===t.params.subUnitId}function lB(e){let t=[];for(let i=0;i<e.length;){let n=1;if(e[i].id===A.SetRangeValuesMutation.id){let r=e[i],o=[r];for(;i+n<e.length&&lL(r,e[i+n]);)o.push(e[i+n]),n+=1;let s=lU(...o.map(e=>e.params.cellValue||{}));t.push({...r,params:{...r.params,cellValue:s}})}else t.push(e[i]);i+=n}return t}function lF(e,t){let{startRow:i,endRow:n,startColumn:r,endColumn:o}=e;for(let e=i;e<=n;e++)for(let i=r;i<=o;i++)if(t.rows.includes(e)&&t.cols.includes(i))return!0}function lj(e,t){let{startRow:i,endRow:n,startColumn:r,endColumn:o}=t;for(let t=i;t<=n;t++)if(!e.rows.includes(t))return!1;for(let t=r;t<=o;t++)if(!e.cols.includes(t))return!1;return!0}function lz(e){let t=e.trim().split(`
`),i="<table>";return t.forEach(e=>{let t=e.split("	");i+="<tr>",t.forEach(e=>{i+=`<td>${e}</td>`}),i+="</tr>"}),i+="</table>"}el(lH,"clipboardItemIsFromExcel"),el(lU,"mergeCellValues"),el(lL,"getRangeValuesMergeable"),el(lB,"mergeSetRangeValues"),el(lF,"rangeIntersectWithDiscreteRange"),el(lj,"discreteRangeContainsRange"),el(lz,"convertTextToTable");var lX=Object.defineProperty,lY=Object.getOwnPropertyDescriptor,lG=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?lY(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&lX(t,i,o),o},"__decorateClass$J"),lZ=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$J");let lK={DEFAULT_COPY:"default-copy",DEFAULT_PASTE:"default-paste",SPECIAL_PASTE_VALUE:"special-paste-value",SPECIAL_PASTE_FORMAT:"special-paste-format",SPECIAL_PASTE_COL_WIDTH:"special-paste-col-width",SPECIAL_PASTE_BESIDES_BORDER:"special-paste-besides-border",SPECIAL_PASTE_FORMULA:"special-paste-formula"};l_.use({name:"univer-doc-paste-plugin-word",checkPasteType:e=>/word|mso/i.test(e),stylesRules:[{filter:["b"],getStyle(e){let t=lg(e);return{bl:O.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter:e=>"P"===e.tagName&&/mso/i.test(e.className),handler(e,t){null==e.paragraphs&&(e.paragraphs=[]);let i={startIndex:e.dataStream.length},n=lf(t);n&&(i.paragraphStyle=n),e.paragraphs.push(i),e.dataStream+="\r"}}]}),l_.use({name:"univer-doc-paste-plugin-lark",checkPasteType:e=>/lark-record-clipboard/i.test(e),stylesRules:[{filter:["s"],getStyle(e){let t=lg(e);return{st:{s:O.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter:e=>"DIV"===e.tagName&&/ace-line/i.test(e.className),handler(e){null==e.paragraphs&&(e.paragraphs=[]),e.paragraphs.push({startIndex:e.dataStream.length}),e.dataStream+="\r"}}]}),l_.use({name:"univer-doc-paste-plugin-univer",checkPasteType:e=>/UniverNormal/i.test(e),stylesRules:[],afterProcessRules:[{filter:e=>"P"===e.tagName&&/UniverNormal/i.test(e.className),handler(e,t){null==e.paragraphs&&(e.paragraphs=[]);let i={startIndex:e.dataStream.length},n=lf(t);n&&(i.paragraphStyle=n),e.paragraphs.push(i),e.dataStream+="\r"}}]});let lq=(0,O.createIdentifier)("sheet.clipboard-service"),lQ=(cO=class extends O.Disposable{constructor(e,t,i,n,r,o,s,l,a,d,c,u,h,m){super(),ea(this,"_clipboardHooks",[]),ea(this,"_clipboardHooks$",new k.BehaviorSubject([])),ea(this,"clipboardHooks$",this._clipboardHooks$.asObservable()),ea(this,"_htmlToUSM"),ea(this,"_usmToHtml"),ea(this,"_copyContentCache"),ea(this,"_copyMarkId",null),this._logService=e,this._univerInstanceService=t,this._selectionManagerService=i,this._clipboardInterfaceService=n,this._undoRedoService=r,this._commandService=o,this._markSelectionService=s,this._notificationService=l,this._platformService=a,this._renderManagerService=d,this._themeService=c,this._localeService=u,this._errorService=h,this._injector=m,this._htmlToUSM=new l_({getCurrentSkeleton:/* @__PURE__ */el(()=>{var e;return null==(e=this._renderManagerService.withCurrentTypeOfUnit(O.UniverInstanceType.UNIVER_SHEET,ev))?void 0:e.getCurrent()},"getCurrentSkeleton")}),this._usmToHtml=new lV,this._copyContentCache=new lm,this.disposeWithMe(this._htmlToUSM)}copyContentCache(){return this._copyContentCache}generateCopyContent(e,t,i){let n=this._clipboardHooks;n.forEach(n=>{var r;return null==(r=n.onBeforeCopy)?void 0:r.call(n,e,t,i)});let r=this._generateCopyContent(e,t,i,n);return n.forEach(e=>{var t;return null==(t=e.onAfterCopy)?void 0:t.call(e)}),r}async copy(e=lO.COPY){let t=this._selectionManagerService.getCurrentLastSelection();if(!t)return!1;let i=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),n=i.getActiveSheet();if(!n)return!1;let r=this.generateCopyContent(i.getUnitId(),n.getSheetId(),t.range);if(!r)return!1;let{html:o,plain:s,matrixFragment:l,copyId:a,discreteRange:d}=r;this._copyContentCache.set(a,{unitId:i.getUnitId(),subUnitId:n.getSheetId(),range:d,matrix:l,copyType:e}),await this._clipboardInterfaceService.write(s,o),this._markSelectionService.removeAllShapes();let c=ou(this._themeService);return this._copyMarkId=this._markSelectionService.addShape({...t,style:c}),!0}async cut(){return this.copy(lO.CUT)}async paste(e,t=lK.DEFAULT_PASTE){let i=e.types,n=-1!==i.indexOf(J.PLAIN_TEXT_CLIPBOARD_MIME_TYPE)?await e.getType(J.PLAIN_TEXT_CLIPBOARD_MIME_TYPE).then(e=>e&&e.text()):"",r=-1!==i.indexOf(J.HTML_CLIPBOARD_MIME_TYPE)?await e.getType(J.HTML_CLIPBOARD_MIME_TYPE).then(e=>e&&e.text()):"";return r?this._platformService.isWindows&&await lH(r)?(this._notificationService.show({type:"warning",title:this._localeService.t("clipboard.shortCutNotify.title"),content:this._localeService.t("clipboard.shortCutNotify.useShortCutInstead")}),!1):this._pasteHTML(r,t):n?this._pastePlainText(n,t):(this._logService.error("[SheetClipboardService]","No valid data on clipboard"),!1)}legacyPaste(e,t){return e?this._pasteHTML(e,lK.DEFAULT_PASTE):t?/[\n\t]/.test(t)?this._pasteHTML(lz(t),lK.DEFAULT_PASTE):this._pastePlainText(t,lK.DEFAULT_PASTE):Promise.resolve(!1)}addClipboardHook(e){if(-1!==this._clipboardHooks.findIndex(t=>t.id===e.id))return this._logService.error("[SheetClipboardService]","hook already exists",e.id),{dispose:/* @__PURE__ */el(()=>{},"dispose")};let t=this._clipboardHooks.findIndex(t=>{let i=t.priority||0;return(e.priority||0)<i});return this._clipboardHooks.splice(-1!==t?t:this._clipboardHooks.length,0,e),this._notifyClipboardHook(),(0,O.toDisposable)(()=>{let t=this._clipboardHooks.indexOf(e);t>-1&&(this._clipboardHooks.splice(t,1),this._notifyClipboardHook())})}getClipboardHooks(){return this._clipboardHooks}_generateCopyContent(e,t,i,n){let r=this._univerInstanceService.getUniverSheetInstance(e),o=null==r?void 0:r.getSheetBySheetId(t);if(!r||!o)return null;let s=n.reduce((e,t)=>{var n;let r=null==(n=t.getFilteredOutRows)?void 0:n.call(t,i);return null==r||r.forEach(t=>e.add(t)),e},/* @__PURE__ */new Set),{startColumn:l,startRow:a,endColumn:d,endRow:c}=i,u=o.getMatrixWithMergedCells(a,l,c,d,!0),h=new O.ObjectMatrix,m=a,g={rows:[],cols:[]};for(let e=a;e<=c;e++)if(!s.has(e)){g.rows.push(e);for(let t=l;t<=d;t++){let i=u.getValue(e,t);i?h.setValue(m-a,t-l,{...l5(),...(0,O.Tools).deepClone(i)}):(h.setValue(m-a,t-l,l5()),u.setValue(e,t,l5()))}m+=1}for(let e=l;e<=d;e++)g.cols.push(e);let p=this._usmToHtml.convert(u,g,n),v=lJ(h),S=lu();return p=p.replace(/(<[a-z]+)/,(e,t)=>`${t} data-copy-id="${S}"`),{copyId:S,plain:v,html:p,matrixFragment:h,discreteRange:g}}_notifyClipboardHook(){this._clipboardHooks$.next(this._clipboardHooks)}async _pastePlainText(e,t){let i=this._getPastingTarget();if(!i.subUnitId||!i.selection)return!1;let n=this._injector.invoke(e=>ie(i.selection.range,e,i.unitId,i.subUnitId));if(!n)return!1;let{unitId:r,subUnitId:o}=i,s=this._clipboardHooks,l=[];if(s.some(e=>{var t;return l.push(e)&&(null==(t=e.onBeforePaste)?void 0:t.call(e,{unitId:r,subUnitId:o,range:n}))===!1}))return l.forEach(e=>{var t;return null==(t=e.onAfterPaste)?void 0:t.call(e,!1)}),!1;let a=[],d=[];l.forEach(i=>{var s;let l=null==(s=i.onPastePlainText)?void 0:s.call(i,{unitId:r,subUnitId:o,range:n},e,{pasteType:t});l&&(a.push(...l.redos),d.push(...l.undos))});let c=a.every(e=>this._commandService.executeCommand(e.id,e.params));return c&&this._undoRedoService.pushUndoRedo({unitID:this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId(),undoMutations:d,redoMutations:a}),c}async _pasteHTML(e,t){let i=lh(e);return i&&this._copyContentCache.get(i)?this._pasteInternal(i,t):this._pasteExternal(e,t)}async _pasteExternal(e,t){var i;let{rowProperties:n,colProperties:r,cellMatrix:o}=this._htmlToUSM.convert(e);if(!o)return!1;let s=this._getPastedRange(o);if(!s)return!1;let l=null==(i=this._univerInstanceService.getUniverSheetInstance(s.unitId))?void 0:i.getSheetBySheetId(s.subUnitId);if(!l)return!1;let a=null==l?void 0:l.getMergeData();return a.length&&a.some(e=>lF(e,s.pastedRange)&&!lj(s.pastedRange,e))?(this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")),!1):this._pasteUSM({rowProperties:n,colProperties:r,cellMatrix:o},s,t)}async _pasteInternal(e,t){var i,n;let r=(0,O.Tools).deepClone(this._copyContentCache.get(e)),{range:o,matrix:s,unitId:l,subUnitId:a}=r||{};if(!s||!r||!o||!l||!a||!s||!r)return!1;let d=null==(i=this._univerInstanceService.getUniverSheetInstance(l))?void 0:i.getStyles();s.forValue((e,t,i)=>{if("string"==typeof i.s){let n=(0,O.Tools).deepClone(i);n.s=null==d?void 0:d.getStyleByCell(i),s.setValue(e,t,n)}if(i.colSpan||i.rowSpan)for(let n=0;n<i.rowSpan;n++)for(let r=0;r<i.colSpan;r++){if(0===n&&0===r)continue;let o=e+n,l=t+r;s.setValue(o,l,{s:null==d?void 0:d.getStyleByCell(i)})}});let c=this._getPastedRange(s);if(!c)return!1;let u=null==(n=this._univerInstanceService.getUniverSheetInstance(c.unitId))?void 0:n.getSheetBySheetId(c.subUnitId);if(!u)return!1;let h=null==u?void 0:u.getMergeData();if(h&&h.some(e=>lF(e,c.pastedRange)&&!lj(c.pastedRange,e)))return this._errorService.emit(this._localeService.t("clipboard.paste.overlappingMergedCells")),!1;let m=this._univerInstanceService.getUnit(l);if(!m)return!1;let g=m.getSheetBySheetId(a);if(!g)return!1;let p=g.getColumnManager(),v=g.getRowManager(),S=g.getConfig().defaultColumnWidth,f=g.getConfig().defaultRowHeight,C=[],I=[];if(o.cols.forEach(e=>{let t=p.getColumnOrCreate(e);C.push({width:`${t.w||S}`})}),o.rows.forEach(e=>{let{ah:t=f,h:i=f}=v.getRowOrCreate(e),n=Math.max(t,i);I.push({height:`${n}`})}),r.copyType===lO.CUT){let e=c.pastedRange.rows[0],t=o.rows[o.rows.length-1]-o.rows[0]+e;c.pastedRange.rows=Array.from(Array(t+1).keys()).slice(e)}let b=this._pasteUSM({cellMatrix:s,colProperties:C,rowProperties:I},c,t,{range:o,unitId:r.unitId,subUnitId:r.subUnitId,copyType:r.copyType,copyId:e});return r.copyType===lO.CUT&&(this._copyContentCache.set(e,{...r,matrix:null}),this._copyMarkId&&this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null),b}_pasteUSM(e,t,i,n){let{rowProperties:r,colProperties:o,cellMatrix:s}=e,{unitId:l,subUnitId:a,pastedRange:d}=t,c=d.cols.length,u=this._clipboardHooks,h=[];if(u.some(e=>{var t;return h.push(e)&&(null==(t=e.onBeforePaste)?void 0:t.call(e,{unitId:l,subUnitId:a,range:d}))===!1}))return h.forEach(e=>{var t;return null==(t=e.onAfterPaste)?void 0:t.call(e,!1)}),!1;if(!s)return!1;let m=n?{unitId:n.unitId,subUnitId:n.subUnitId,range:n.range}:null,g={copyType:(null==n?void 0:n.copyType)||lO.COPY,copyId:null==n?void 0:n.copyId,pasteType:i},p=[],v=[];h.filter(e=>!e.specialPasteInfo&&e.id!==lK.DEFAULT_PASTE||i===e.id).forEach(e=>{var t,n,u;if(r){let n=null==(t=e.onPasteRows)?void 0:t.call(e,{range:d,unitId:l,subUnitId:a},r,{pasteType:i});n&&(p.push(...n.redos),v.push(...n.undos))}let h=null==(n=e.onPasteColumns)?void 0:n.call(e,{range:d,unitId:l,subUnitId:a},o||Array(c).map(()=>({})),{pasteType:i});h&&(p.push(...h.redos),v.push(...h.undos));let S=null==(u=e.onPasteCells)?void 0:u.call(e,m,{range:d,unitId:l,subUnitId:a},s,g);S&&(p.push(...S.redos),v.push(...S.undos))});let S=this._getSetSelectionOperation(l,a,d,s);S&&p.push(S),p=lB(p),v=lB(v),this._logService.log("[SheetClipboardService]","pasting mutations",{undoMutationsInfo:v,redoMutationsInfo:p});let f=p.every(e=>this._commandService.syncExecuteCommand(e.id,e.params));return f&&this._undoRedoService.pushUndoRedo({unitID:l,undoMutations:v,redoMutations:p}),f}_getSetSelectionOperation(e,t,i,n){var r;let o=null==(r=this._univerInstanceService.getUniverSheetInstance(e))?void 0:r.getSheetBySheetId(t);if(!o)return null;let{rows:s,cols:l}=i,a=s[0],d=l[0],c=s[s.length-1],u=l[l.length-1],h=(0,A.getPrimaryForRange)({startRow:a,endRow:a,startColumn:d,endColumn:d},o),m=n.getValue(0,0),g=(null==m?void 0:m.rowSpan)||1,p=(null==m?void 0:m.colSpan)||1;if(g>1||p>1){let e={startRow:a,endRow:a+g-1,startColumn:d,endColumn:d+p-1};h.startRow=e.startRow,h.endRow=e.endRow,h.startColumn=e.startColumn,h.endColumn=e.endColumn,h.isMerged=!0,h.isMergedMainCell=!0}return{id:A.SetSelectionsOperation.id,params:{unitId:e,subUnitId:t,selections:[{range:{startRow:a,endRow:c,startColumn:d,endColumn:u},primary:h,style:null}]}}}_getPastingTarget(){let e=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),t=e.getActiveSheet(),i=this._selectionManagerService.getCurrentLastSelection();return{unitId:e.getUnitId(),subUnitId:null==t?void 0:t.getSheetId(),selection:i}}_transformPastedData(e,t,i){let{selection:n,unitId:r,subUnitId:o}=this._getPastingTarget();if(!o||!n)return null;let s=this._injector.invoke(e=>ie(n.range,e,r,o));if(!s)return null;let{ranges:[l],mapFunc:a}=ii([s]),{startRow:d,startColumn:c,endRow:u,endColumn:h}=l,m=u-d+1,g=h-c+1,p=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),v=null==p?void 0:p.getActiveSheet();if(!v)return null;let S=v.getMergeData().filter(e=>s.rows.includes(e.startRow)&&s.cols.includes(e.startColumn)),f=S[0],C=0,I=0,b=0,_=0;if(f&&(C=f.startRow,I=f.startColumn,b=f.endRow,_=f.endColumn),m%e==0&&g%t==0){if(S.length>0&&(m!==e||g!==t)){if(C===s.rows[0]&&I===s.cols[0]&&b===s.rows[m-1]&&_===s.cols[g-1]){if(l2(i))for(let n=0;n<m;n++)for(let r=0;r<g;r++){let o=i.getValue(n%e,r%t);o&&i.setValue(n,r,o)}else i.forValue((e,t,i)=>{i.s=null,delete i.colSpan,delete i.rowSpan})}else for(let n=0;n<m;n++)for(let r=0;r<g;r++){let o=i.getValue(n%e,r%t);o&&i.setValue(n,r,o)}}else for(let n=0;n<m;n++)for(let r=0;r<g;r++){let o=i.getValue(n%e,r%t);o&&i.setValue(n,r,o)}}else if(S.length>0){let{row:n,col:l}=a(d,c);if(this._topLeftCellsMatch(e,t,{topRow:n,leftCol:l})){let i=this._expandOrShrinkRowsCols(r,o,s,t,e);s.rows=i.rows,s.cols=i.cols}else{if(u>f.endRow||h>f.endColumn)return null;i.forValue((e,t,i)=>{i.s=null,delete i.colSpan,delete i.rowSpan})}}else{let i=this._expandOrShrinkRowsCols(r,o,s,t,e);s.rows=i.rows,s.cols=i.cols}return{pastedRange:s,unitId:r,subUnitId:o}}_getPastedRange(e){var t;let{selection:i,unitId:n,subUnitId:r}=this._getPastingTarget();if(!r||!i)return null;let o=this._injector.invoke(e=>ie(i.range,e,n,r));if(!o)return null;let{startColumn:s,endColumn:l,startRow:a,endRow:d}=e.getDataRange(),c=d-a+1,u=l-s+1;if(c<=0||u<=0)return null;let h=o.rows.length,m=o.cols.length,g=null==(t=this._univerInstanceService.getUniverSheetInstance(n))?void 0:t.getSheetBySheetId(r);if(!g)return null;let p=null==g?void 0:g.getMergeData();if(h%c==0&&m%u==0&&!(null==p?void 0:p.some(e=>lF(e,o)))){for(let t=0;t<h;t++)for(let i=0;i<m;i++){let n=e.getValue(t%c,i%u);n&&e.setValue(t,i,n)}return{pastedRange:o,unitId:n,subUnitId:r}}let v=this._expandOrShrinkRowsCols(n,r,o,u,c);return o.rows=v.rows,o.cols=v.cols,{pastedRange:o,unitId:n,subUnitId:r}}_expandOrShrinkRowsCols(e,t,i,n,r){let o,s;let{rows:l,cols:a}=i,d=this._univerInstanceService.getUniverSheetInstance(e),c=null==d?void 0:d.getSheetBySheetId(t);if(l.length>=r)o=l.slice(0,r);else{o=l.slice(0);let e=l[l.length-1]+1;for(;o.length<r;)c.getRowFiltered(e)||o.push(e),e++}if(a.length>=n)s=a.slice(0,n);else{s=a.slice(0);let e=a[a.length-1]+1;for(;s.length<n;)s.push(e),e++}return{rows:o,cols:s}}_topLeftCellsMatch(e,t,i){let n=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),r=null==n?void 0:n.getActiveSheet();if(!r)return!1;let{topRow:o,leftCol:s}=i,l=l0(o+e-1,s,s+t-1,r),a=l1(s+t-1,o,o+e-1,r);return!l&&!a}removeMarkSelection(){this._copyMarkId&&(this._markSelectionService.removeShape(this._copyMarkId),this._copyMarkId=null)}},el(cO,"SheetClipboardService"),cO);function lJ(e){let t="",i=e.getLength();return e.forRow((n,r)=>{let o=[];r.forEach(t=>{let i=e.getValue(n,t);if(i){let e=l$(i);o.push(e)}}),t+=o.join("	"),n!==i-1&&(t+=`
`)}),t}function l$(e){return(0,O.extractPureTextFromCell)(e)}function l0(e,t,i,n){return n.getMergeData().some(n=>n.startRow<=e&&e<n.endRow&&t<=n.startColumn&&n.startColumn<=i)}function l1(e,t,i,n){return n.getMergeData().some(n=>n.startColumn<=e&&e<n.endColumn&&t<=n.startRow&&n.startRow<=i)}function l2(e){let t=0;return e.forValue((e,i,n)=>{if(n&&t++,t>1)return!1}),t>1}function l5(){return{p:null,v:null,s:null,f:null,si:null,t:null}}lQ=lG([lZ(0,O.ILogService),lZ(1,O.IUniverInstanceService),lZ(2,(0,O.Inject)(A.SheetsSelectionsService)),lZ(3,J.IClipboardInterfaceService),lZ(4,O.IUndoRedoService),lZ(5,O.ICommandService),lZ(6,od),lZ(7,J.INotificationService),lZ(8,J.IPlatformService),lZ(9,x.IRenderManagerService),lZ(10,(0,O.Inject)(O.ThemeService)),lZ(11,(0,O.Inject)(O.LocaleService)),lZ(12,(0,O.Inject)(O.ErrorService)),lZ(13,(0,O.Inject)(O.Injector))],lQ),el(lJ,"getMatrixPlainText"),el(l$,"getCellTextForClipboard"),el(l0,"rowAcrossMergedCell"),el(l1,"columnAcrossMergedCell"),el(l2,"isMultipleCells"),el(l5,"getEmptyCell");let l9={id:J.CopyCommand.id,name:"sheet.command.copy",type:O.CommandType.COMMAND,multi:!0,priority:998,preconditions:ln,handler:/* @__PURE__ */el(async e=>e.get(lq).copy(),"handler")},l6={id:J.CutCommand.id,name:"sheet.command.cut",type:O.CommandType.COMMAND,multi:!0,priority:998,preconditions:ln,handler:/* @__PURE__ */el(async e=>e.get(lq).cut(),"handler")},l3={id:J.PasteCommand.id,type:O.CommandType.COMMAND,multi:!0,name:"sheet.command.paste",priority:998,preconditions:ln,handler:/* @__PURE__ */el(async(e,t)=>{let i=await e.get(J.IClipboardInterfaceService).read(),n=e.get(lq);return 0!==i.length&&n.paste(i[0],null==t?void 0:t.value)},"handler")},l7={id:"sheet.command.paste-bu-short-key",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async(e,t)=>{let i=e.get(lq),{htmlContent:n,textContent:r}=t;return i.legacyPaste(n,r),!0},"handler")},l4={id:"sheet.command.paste-value",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async e=>e.get(O.ICommandService).executeCommand(l3.id,{value:lK.SPECIAL_PASTE_VALUE}),"handler")},l8={id:"sheet.command.paste-format",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async e=>e.get(O.ICommandService).executeCommand(l3.id,{value:lK.SPECIAL_PASTE_FORMAT}),"handler")},ae={id:"sheet.command.paste-col-width",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async e=>e.get(O.ICommandService).executeCommand(l3.id,{value:lK.SPECIAL_PASTE_COL_WIDTH}),"handler")},at={id:"sheet.command.paste-besides-border",type:O.CommandType.COMMAND,handler:/* @__PURE__ */el(async e=>e.get(O.ICommandService).executeCommand(l3.id,{value:lK.SPECIAL_PASTE_BESIDES_BORDER}),"handler")};function ai(e){let t=e.get(A.BorderStyleManagerService),i=tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]});return{id:A.SetBorderBasicCommand.id,icon:new F.Observable(t=>{let i="AllBorderSingle",n=e.get(A.BorderStyleManagerService),r=e.get(O.ICommandService).onCommandExecuted(e=>{var r;if(e.id!==A.SetBorderBasicCommand.id)return;let{type:o}=n.getBorderInfo(),s=sr.find(e=>e.value===o),l=null!=(r=null==s?void 0:s.icon)?r:i;t.next(l)});return t.next(i),r.dispose}),tooltip:"toolbar.border.main",type:J.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:sn,hoverable:!1},value$:t.borderInfo$}],value$:t.borderInfo$,hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:i}}el(ai,"CellBorderSelectorMenuItemFactory");let an="sheet.menu.clear-selection";function ar(e){return{id:an,type:J.MenuItemType.SUBITEMS,icon:"ClearFormat",title:"rightClick.clearSelection",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function ao(e){return{id:A.ClearSelectionContentCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.clearContent",disabled$:tV(e,tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellValuePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function as(e){return{id:A.ClearSelectionFormatCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.clearFormat",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function al(e){return{id:A.ClearSelectionAllCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.clearAll",disabled$:tV(e,tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellValuePermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}el(ar,"ClearSelectionMenuItemFactory"),el(ao,"ClearSelectionContentMenuItemFactory"),el(as,"ClearSelectionFormatMenuItemFactory"),el(al,"ClearSelectionAllMenuItemFactory");let aa="sheet.menu.delete";function ad(e){return{id:aa,type:J.MenuItemType.SUBITEMS,title:"rightClick.delete",icon:"Reduce",hidden$:tV(e,tH(e)),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission]})}}function ac(e){return{id:oi.id,type:J.MenuItemType.BUTTON,icon:"DeleteColumn",title:"rightClick.deleteSelectedColumn",hidden$:tV(e,tB(e,"col")),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetDeleteColumnPermission]})}}function au(e){return{id:ot.id,type:J.MenuItemType.BUTTON,icon:"DeleteRow",title:"rightClick.deleteSelectedRow",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetDeleteRowPermission]}),hidden$:tB(e,"row")}}function ah(e){return{id:rp.id,type:J.MenuItemType.BUTTON,title:"rightClick.moveLeft",icon:"DeleteCellShiftLeft",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tF(e,"col")}}function am(e){return{id:rv.id,type:J.MenuItemType.BUTTON,title:"rightClick.moveUp",icon:"DeleteCellShiftUp",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tF(e,"row")}}function ag(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService);return{id:A.ToggleGridlinesCommand.id,type:J.MenuItemType.BUTTON,tooltip:"toolbar.toggleGridlines",icon:"HideGridlines",activated$:new F.Observable(e=>{let n=/* @__PURE__ */el(()=>{let e=i.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);return!!e&&e.getActiveSheet().getConfig().showGridlines===O.BooleanNumber.TRUE},"getValue"),r=new O.DisposableCollection;return r.add(t.onCommandExecuted(t=>{(t.id===A.ToggleGridlinesMutation.id||t.id===A.SetWorksheetActiveOperation.id)&&e.next(n())})),r.add(i.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).subscribe(()=>{e.next(n())})),e.next(n()),()=>r.dispose()})}}el(ad,"DeleteRangeMenuItemFactory"),el(ac,"RemoveColMenuItemFactory"),el(au,"RemoveRowMenuItemFactory"),el(ah,"DeleteRangeMoveLeftMenuItemFactory"),el(am,"DeleteRangeMoveUpMenuItemFactory"),el(ag,"ToggleGridlinesMenuFactory");let ap="sheet.menu.col-insert";function av(e){return{id:ap,type:J.MenuItemType.SUBITEMS,title:"rightClick.insert",icon:"Insert",hidden$:tH(e),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetInsertColumnPermission]})}}el(av,"ColInsertMenuItemFactory");let aS="sheet.menu.row-insert";function af(e){return{id:aS,type:J.MenuItemType.SUBITEMS,title:"rightClick.insert",icon:"Insert",hidden$:tH(e),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetInsertRowPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}el(af,"RowInsertMenuItemFactory");let aC="sheet.menu.cell-insert";function aI(e){return{id:aC,type:J.MenuItemType.SUBITEMS,title:"rightClick.insert",icon:"Insert",hidden$:tV(e,tH(e)),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetInsertColumnPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function ab(e){return{id:A.InsertRowBeforeCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.insertRowBefore",icon:"InsertRowAbove",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetInsertRowPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tL(e,"row")}}function a_(e){return{id:A.InsertRowAfterCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.insertRow",icon:"InsertRowBelow",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetInsertRowPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tU(e,"row")}}function aR(e){return{id:A.InsertColBeforeCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.insertColumnBefore",icon:"LeftInsertColumn",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetInsertColumnPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tL(e,"col")}}function ay(e){return{id:A.InsertColAfterCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.insertColumn",icon:"RightInsertColumn",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetInsertColumnPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tU(e,"col")}}function aT(e){return{id:rO.id,type:J.MenuItemType.BUTTON,title:"rightClick.moveRight",icon:"InsertCellShiftRight",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tF(e,"col")}}function aE(e){return{id:rM.id,type:J.MenuItemType.BUTTON,title:"rightClick.moveDown",icon:"InsertCellDown",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:tF(e,"row")}}el(aI,"CellInsertMenuItemFactory"),el(ab,"InsertRowBeforeMenuItemFactory"),el(a_,"InsertRowAfterMenuItemFactory"),el(aR,"InsertColBeforeMenuItemFactory"),el(ay,"InsertColAfterMenuItemFactory"),el(aT,"InsertRangeMoveRightMenuItemFactory"),el(aE,"InsertRangeMoveDownMenuItemFactory");var aw=((y=aw||{}).ROW_HEADER_CONTEXT_MENU="ROW_HEADER_CONTEXT_MENU",y.COL_HEADER_CONTEXT_MENU="COL_HEADER_CONTEXT_MENU",y.SHEET_BAR="SHEET_BAR",y.SHEET_FOOTER="SHEET_FOOTER",y);function aP(e){let t=e.get(oS);return{id:ob.id,subId:oI.id,type:J.MenuItemType.BUTTON,icon:"BrushSingle",title:"Format Painter",tooltip:"toolbar.formatPainter",activated$:new F.Observable(e=>{let i=!1,n=t.status$.subscribe(t=>{i=t!==ov.OFF,e.next(i)});return e.next(i),()=>{n.unsubscribe()}}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetCopyPermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0)}}function aM(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(O.IContextService),r=e.get(A.SheetsSelectionsService);return{id:rC.id,type:J.MenuItemType.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0),activated$:tN(i,!1,({worksheet:i})=>new F.Observable(o=>{var s;let l=t.onCommandExecuted(t=>{var s,l;let a=t.id;if(a===A.SetRangeValuesMutation.id||a===A.SetSelectionsOperation.id||a===A.SetWorksheetActiveOperation.id){let e=null==(s=r.getCurrentLastSelection())?void 0:s.primary,t=O.FontWeight.NORMAL;if(null!=e){let n=i.getRange(e.startRow,e.startColumn);t=null==n?void 0:n.getFontWeight()}o.next(t===O.FontWeight.BOLD)}if((a===$.SetTextSelectionsOperation.id||a===M.SetInlineFormatCommand.id)&&n.getContextValue(O.EDITOR_ACTIVATED)&&n.getContextValue(O.FOCUSING_SHEET)){let t=dd(e);if(null==t)return;let i=null==(l=t.ts)?void 0:l.bl;o.next(i===O.BooleanNumber.TRUE)}}),a=null==(s=r.getCurrentLastSelection())?void 0:s.primary;if(!i){o.next(!1);return}let d=O.FontWeight.NORMAL;if(null!=a){let e=i.getRange(a.startRow,a.startColumn);d=null==e?void 0:e.getFontWeight()}return o.next(d===O.FontWeight.BOLD),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function aO(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(O.IContextService);return{id:rI.id,type:J.MenuItemType.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0),activated$:tN(i,!1,({worksheet:i})=>new F.Observable(o=>{var s;let l=t.onCommandExecuted(t=>{var s,l;let a=t.id;if(a===A.SetRangeValuesMutation.id||a===A.SetSelectionsOperation.id||a===A.SetWorksheetActiveOperation.id){let e=null==(s=n.getCurrentLastSelection())?void 0:s.primary,t=O.FontItalic.NORMAL;if(null!=e){let n=i.getRange(e.startRow,e.startColumn);t=null==n?void 0:n.getFontStyle()}o.next(t===O.FontItalic.ITALIC)}if((a===$.SetTextSelectionsOperation.id||a===M.SetInlineFormatCommand.id)&&r.getContextValue(O.EDITOR_ACTIVATED)&&r.getContextValue(O.FOCUSING_SHEET)){let t=dd(e);if(null==t)return;let i=null==(l=t.ts)?void 0:l.it;o.next(i===O.BooleanNumber.TRUE)}}),a=null==(s=n.getCurrentLastSelection())?void 0:s.primary,d=O.FontItalic.NORMAL;if(null!=a){let e=i.getRange(a.startRow,a.startColumn);d=null==e?void 0:e.getFontStyle()}return o.next(d===O.FontItalic.ITALIC),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function ax(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(O.IContextService);return{id:rb.id,type:J.MenuItemType.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",activated$:tN(i,!1,({worksheet:i})=>new F.Observable(o=>{var s;let l;let a=t.onCommandExecuted(t=>{var s,l;let a=t.id;if(a===A.SetRangeValuesMutation.id||a===A.SetSelectionsOperation.id||a===A.SetWorksheetActiveOperation.id){let e;let t=null==(s=n.getCurrentLastSelection())?void 0:s.primary;if(null!=t){let n=i.getRange(t.startRow,t.startColumn);e=null==n?void 0:n.getUnderline()}o.next(!!(e&&e.s))}if((a===$.SetTextSelectionsOperation.id||a===M.SetInlineFormatCommand.id)&&r.getContextValue(O.EDITOR_ACTIVATED)&&r.getContextValue(O.FOCUSING_SHEET)){let t=dd(e);if(null==t)return;let i=null==(l=t.ts)?void 0:l.ul;o.next((null==i?void 0:i.s)===O.BooleanNumber.TRUE)}}),d=null==(s=n.getCurrentLastSelection())?void 0:s.primary;if(null!=d){let e=i.getRange(d.startRow,d.startColumn);l=null==e?void 0:e.getUnderline()}return o.next(!!(l&&l.s)),a.dispose})),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function aA(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(O.IContextService);return{id:r_.id,type:J.MenuItemType.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0),activated$:tN(i,!1,({worksheet:i})=>new F.Observable(o=>{var s;let l;let a=t.onCommandExecuted(t=>{var s,l;let a=t.id;if(a===A.SetRangeValuesMutation.id||a===A.SetSelectionsOperation.id||a===A.SetWorksheetActiveOperation.id){let e;let t=null==(s=n.getCurrentLastSelection())?void 0:s.primary;if(null!=t){let n=i.getRange(t.startRow,t.startColumn);e=null==n?void 0:n.getStrikeThrough()}o.next(!!(e&&e.s))}if((a===$.SetTextSelectionsOperation.id||a===M.SetInlineFormatCommand.id)&&r.getContextValue(O.EDITOR_ACTIVATED)&&r.getContextValue(O.FOCUSING_SHEET)){let t=dd(e);if(null==t)return;let i=null==(l=t.ts)?void 0:l.st;o.next((null==i?void 0:i.s)===O.BooleanNumber.TRUE)}}),d=null==(s=n.getCurrentLastSelection())?void 0:s.primary;if(null!=d){let e=i.getRange(d.startRow,d.startColumn);l=null==e?void 0:e.getStrikeThrough()}return o.next(!!(l&&l.s)),a.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function ak(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=O.DEFAULT_STYLES.ff;return{id:rE.id,tooltip:"toolbar.font",type:J.MenuItemType.SELECTOR,label:sa,selections:(0,J.FONT_FAMILY_LIST).map(e=>({label:{name:sd,hoverable:!0},value:e.value})),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0),value$:tN(i,r,({worksheet:e})=>new F.Observable(i=>{var o;let s;let l=t.onCommandExecuted(t=>{var o;let s;let l=t.id;if(l!==A.SetRangeValuesMutation.id&&l!==A.SetSelectionsOperation.id&&l!==A.SetWorksheetActiveOperation.id)return;let a=null==(o=n.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let t=e.getRange(a.startRow,a.startColumn);s=null==t?void 0:t.getFontFamily()}i.next(null!=s?s:r)}),a=null==(o=n.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let t=e.getRange(a.startRow,a.startColumn);s=null==t?void 0:t.getFontFamily()}return i.next(null!=s?s:r),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function aN(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService),r=e.get(O.IContextService),o=O.DEFAULT_STYLES.fs,s=tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0);return{id:rT.id,type:J.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:sc,props:{min:1,max:400,disabled$:s}},selections:J.FONT_SIZE_LIST,disabled$:s,value$:tN(i,o,({worksheet:i})=>new F.Observable(s=>{var l;let a;let d=t.onCommandExecuted(t=>{var l,a;let d=t.id;if(d===A.SetRangeValuesMutation.id||d===A.SetSelectionsOperation.id||d===A.SetWorksheetActiveOperation.id){let e;let t=null==(l=n.getCurrentLastSelection())?void 0:l.primary;if(null!=t){let n=i.getRange(t.startRow,t.startColumn);e=null==n?void 0:n.getFontSize()}s.next(null!=e?e:o)}if((d===$.SetTextSelectionsOperation.id||d===M.SetInlineFormatCommand.id)&&r.getContextValue(O.EDITOR_ACTIVATED)&&r.getContextValue(O.FOCUSING_SHEET)){let t=dd(e);if(null==t)return;let i=null==(a=t.ts)?void 0:a.fs;s.next(null!=i?i:o)}}),c=null==(l=n.getCurrentLastSelection())?void 0:l.primary;if(null!=c){let e=i.getRange(c.startRow,c.startColumn);a=null==e?void 0:e.getFontSize()}return s.next(null!=a?a:o),d.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function aD(e){return{id:rP.id,type:J.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColor",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function aV(e){let t=e.get(O.ICommandService),i=e.get(O.ThemeService);return{id:rw.id,icon:"FontColor",tooltip:"toolbar.textColor.main",type:J.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:sl,hoverable:!1}}],value$:new F.Observable(e=>{let n=i.getCurrentTheme().textColor,r=t.onCommandExecuted(t=>{if(t.id===rw.id){let i=t.params.value;e.next(null!=i?i:n)}});return e.next(n),r.dispose}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]},!0)}}function aW(e){return{id:A.ResetBackgroundColorCommand.id,type:J.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColor",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function aH(e){let t=e.get(O.ICommandService),i=e.get(O.ThemeService);return{id:A.SetBackgroundColorCommand.id,tooltip:"toolbar.fillColor.main",type:J.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucket",selections:[{label:{name:sl,hoverable:!1}}],value$:new F.Observable(e=>{let n=i.getCurrentTheme().primaryColor,r=t.onCommandExecuted(t=>{if(t.id===A.SetBackgroundColorCommand.id){let i=t.params.value;e.next(null!=i?i:n)}});return e.next(n),r.dispose}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}el(aP,"FormatPainterMenuItemFactory"),el(aM,"BoldMenuItemFactory"),el(aO,"ItalicMenuItemFactory"),el(ax,"UnderlineMenuItemFactory"),el(aA,"StrikeThroughMenuItemFactory"),el(ak,"FontFamilySelectorMenuItemFactory"),el(aN,"FontSizeSelectorMenuItemFactory"),el(aD,"ResetTextColorMenuItemFactory"),el(aV,"TextColorSelectorMenuItemFactory"),el(aW,"ResetBackgroundColorMenuItemFactory"),el(aH,"BackgroundColorSelectorMenuItemFactory");let aU=[{label:"align.left",icon:"LeftJustifyingSingle",value:O.HorizontalAlign.LEFT},{label:"align.center",icon:"HorizontallySingle",value:O.HorizontalAlign.CENTER},{label:"align.right",icon:"RightJustifyingSingle",value:O.HorizontalAlign.RIGHT}];function aL(e){let t=e.get(O.IUniverInstanceService),i=e.get(A.SheetsSelectionsService),n=O.HorizontalAlign.LEFT;return{id:A.SetHorizontalTextAlignCommand.id,icon:aU[0].icon,tooltip:"toolbar.horizontalAlignMode.main",type:J.MenuItemType.SELECTOR,selections:aU,value$:tN(t,n,({worksheet:t})=>new F.Observable(r=>{var o;let s;let l=e.get(O.ICommandService).onCommandExecuted(e=>{var o;let s;let l=e.id;if(l!==A.SetHorizontalTextAlignCommand.id&&l!==A.SetSelectionsOperation.id&&l!==A.SetWorksheetActiveOperation.id)return;let a=null==(o=i.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let e=t.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getHorizontalAlignment()}r.next(null!=s?s:n)}),a=null==(o=i.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let e=t.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getHorizontalAlignment()}return r.next(null!=s?s:n),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}el(aL,"HorizontalAlignMenuItemFactory");let aB=[{label:"align.top",icon:"AlignTopSingle",value:O.VerticalAlign.TOP},{label:"align.middle",icon:"VerticalCenterSingle",value:O.VerticalAlign.MIDDLE},{label:"align.bottom",icon:"AlignBottomSingle",value:O.VerticalAlign.BOTTOM}];function aF(e){let t=e.get(O.IUniverInstanceService),i=e.get(A.SheetsSelectionsService),n=O.VerticalAlign.BOTTOM;return{id:A.SetVerticalTextAlignCommand.id,icon:aB[2].icon,tooltip:"toolbar.verticalAlignMode.main",type:J.MenuItemType.SELECTOR,selections:aB,value$:tN(t,n,({worksheet:t})=>new F.Observable(r=>{var o;let s;let l=e.get(O.ICommandService).onCommandExecuted(e=>{var o;let s;let l=e.id;if(l!==A.SetVerticalTextAlignCommand.id&&l!==A.SetSelectionsOperation.id&&l!==A.SetWorksheetActiveOperation.id)return;let a=null==(o=i.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let e=t.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getVerticalAlignment()}r.next(null!=s?s:n)}),a=null==(o=i.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let e=t.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getVerticalAlignment()}return r.next(null!=s?s:n),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}el(aF,"VerticalAlignMenuItemFactory");let aj=[{label:"textWrap.overflow",icon:"OverflowSingle",value:O.WrapStrategy.OVERFLOW},{label:"textWrap.wrap",icon:"AutowrapSingle",value:O.WrapStrategy.WRAP},{label:"textWrap.clip",icon:"TruncationSingle",value:O.WrapStrategy.CLIP}];function az(e){let t=e.get(A.SheetsSelectionsService),i=e.get(O.IUniverInstanceService),n=O.WrapStrategy.OVERFLOW;return{id:A.SetTextWrapCommand.id,tooltip:"toolbar.textWrapMode.main",icon:aj[0].icon,type:J.MenuItemType.SELECTOR,selections:aj,value$:tN(i,n,({worksheet:i})=>new F.Observable(r=>{var o;let s;let l=e.get(O.ICommandService).onCommandExecuted(e=>{var o;let s;let l=e.id;if(l!==A.SetTextWrapCommand.id&&l!==A.SetSelectionsOperation.id&&l!==A.SetWorksheetActiveOperation.id)return;let a=null==(o=t.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let e=i.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getWrapStrategy()}r.next(null!=s?s:n)}),a=null==(o=t.getCurrentLastSelection())?void 0:o.primary;if(null!=a){let e=i.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getWrapStrategy()}return r.next(null!=s?s:n),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}el(az,"WrapTextMenuItemFactory");let aX=[{label:"textRotate.none",icon:"NoRotationSingle",value:0},{label:"textRotate.angleUp",icon:"LeftRotationFortyFiveDegreesSingle",value:-45},{label:"textRotate.angleDown",icon:"RightRotationFortyFiveDegreesSingle",value:45},{label:"textRotate.vertical",icon:"VerticalTextSingle",value:"v"},{label:"textRotate.rotationUp",icon:"LeftRotationNinetyDegreesSingle",value:-90},{label:"textRotate.rotationDown",icon:"RightRotationNinetyDegreesSingle",value:90}];function aY(e){let t=e.get(A.SheetsSelectionsService),i=e.get(O.IUniverInstanceService);return{id:A.SetTextRotationCommand.id,tooltip:"toolbar.textRotateMode.main",icon:aX[0].icon,type:J.MenuItemType.SELECTOR,selections:aX,value$:tN(i,0,({worksheet:i})=>new F.Observable(n=>{var r,o;let s;let l=e.get(O.ICommandService).onCommandExecuted(e=>{var r,o;let s;let l=e.id;if(l!==A.SetTextRotationCommand.id&&l!==A.SetSelectionsOperation.id&&l!==A.SetWorksheetActiveOperation.id)return;let a=null==(r=t.getCurrentLastSelection())?void 0:r.primary;if(null!=a){let e=i.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getTextRotation()}(null==s?void 0:s.v)===O.BooleanNumber.TRUE?n.next("v"):n.next(null!=(o=s&&s.a)?o:0)}),a=null==(r=t.getCurrentLastSelection())?void 0:r.primary;if(null!=a){let e=i.getRange(a.startRow,a.startColumn);s=null==e?void 0:e.getTextRotation()}return(null==s?void 0:s.v)===O.BooleanNumber.TRUE?n.next("v"):n.next(null!=(o=s&&s.a)?o:0),l.dispose})),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function aG(e){return new F.Observable(t=>t.next(!e.get(J.IClipboardInterfaceService).supportClipboard))}function aZ(e){return{id:l9.name,commandId:l9.id,type:J.MenuItemType.BUTTON,title:"rightClick.copy",icon:"Copy",disabled$:tW(e,{workbookTypes:[A.WorkbookCopyPermission],worksheetTypes:[A.WorksheetCopyPermission],rangeTypes:[A.RangeProtectionPermissionViewPoint]}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function aK(e){return{id:l3.name,commandId:l3.id,type:J.MenuItemType.BUTTON,title:"rightClick.paste",icon:"PasteSpecial",disabled$:aG(e).pipe((0,D.combineLatestWith)(tW(e,{rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission,A.WorksheetSetCellValuePermission],workbookTypes:[A.WorkbookEditablePermission]})),(0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}el(aY,"TextRotateMenuItemFactory"),el(aG,"menuClipboardDisabledObservable"),el(aZ,"CopyMenuItemFactory"),el(aK,"PasteMenuItemFactory");let aq="sheet.menu.paste-special";function aQ(e){return{id:aq,type:J.MenuItemType.SUBITEMS,icon:"PasteSpecial",title:"rightClick.pasteSpecial",hidden$:tV(e,(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET))}}function aJ(e){return{id:l4.id,type:J.MenuItemType.BUTTON,title:"rightClick.pasteValue",disabled$:aG(e).pipe((0,D.combineLatestWith)(tW(e,{rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellValuePermission,A.WorksheetEditPermission],workbookTypes:[A.WorkbookEditablePermission]})),(0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function a$(e){return{id:l8.id,type:J.MenuItemType.BUTTON,title:"rightClick.pasteFormat",disabled$:aG(e).pipe((0,D.combineLatestWith)(tW(e,{rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellStylePermission,A.WorksheetEditPermission],workbookTypes:[A.WorkbookEditablePermission]})),(0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function a0(e){return{id:ae.id,type:J.MenuItemType.BUTTON,title:"rightClick.pasteColWidth",disabled$:aG(e).pipe((0,D.combineLatestWith)(tW(e,{rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetColumnStylePermission,A.WorksheetEditPermission],workbookTypes:[A.WorkbookEditablePermission]})),(0,L.map)(([e,t])=>e||t))}}function a1(e){return{id:at.id,type:J.MenuItemType.BUTTON,title:"rightClick.pasteBesidesBorder",disabled$:aG(e).pipe((0,D.combineLatestWith)(tW(e,{rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellStylePermission,A.WorksheetSetCellValuePermission,A.WorksheetSetRowStylePermission,A.WorksheetSetColumnStylePermission],workbookTypes:[A.WorkbookEditablePermission]})),(0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function a2(e){return{id:A.SetWorksheetRowIsAutoHeightCommand.id,type:J.MenuItemType.BUTTON,icon:"AutoHeight",title:"rightClick.fitContent",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetSetRowStylePermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function a5(e){return{id:ok.id,type:J.MenuItemType.BUTTON,icon:"AutoWidth",title:"rightClick.fitContent",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetSetRowStylePermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}el(aQ,"PasteSpacialMenuItemFactory"),el(aJ,"PasteValueMenuItemFactory"),el(a$,"PasteFormatMenuItemFactory"),el(a0,"PasteColWidthMenuItemFactory"),el(a1,"PasteBesidesBorderMenuItemFactory"),el(a2,"FitContentMenuItemFactory"),el(a5,"ColAutoWidthMenuItemFactory");let a9="sheet.menu.sheet-frozen";function a6(e){return{id:a9,type:J.MenuItemType.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}el(a6,"SheetFrozenMenuItemFactory");let a3="sheet.header-menu.sheet-frozen";function a7(e){return{id:a3,type:J.MenuItemType.SUBITEMS,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function a4(e){return{id:oR.id,type:J.MenuItemType.BUTTON,title:"rightClick.freeze",icon:"FreezeToSelectedSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function a8(e){return{id:oy.id,type:J.MenuItemType.BUTTON,title:"rightClick.freezeRow",icon:"FreezeRowSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function de(e){return{id:oT.id,type:J.MenuItemType.BUTTON,title:"rightClick.freezeCol",icon:"FreezeColumnSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dt(e){return{id:oE.id,type:J.MenuItemType.BUTTON,title:"rightClick.cancelFreeze",icon:"CancelFreezeSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function di(e){return{id:rS.id,type:J.MenuItemType.BUTTON,icon:"Hide",title:"rightClick.hideSelectedRow",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetSetRowStylePermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dn(e){return{id:rf.id,type:J.MenuItemType.BUTTON,icon:"Hide",title:"rightClick.hideSelectedColumn",disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetColumnStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dr(e){let t=e.get(O.IUniverInstanceService),i=e.get(A.SheetsSelectionsService),n=e.get(O.ICommandService),r=[(0,A.SetSelectionsOperation),(0,A.SetRowHiddenMutation),(0,A.SetRowVisibleMutation)].map(e=>e.id);return{id:A.SetSelectedRowsVisibleCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.showHideRow",hidden$:tN(t,!0,({worksheet:e})=>new F.Observable(t=>{function o(){var t;let n=null==(t=i.getCurrentSelections())?void 0:t.map(e=>e.range).filter(e=>e.rangeType===O.RANGE_TYPE.ROW);return!!(null!=n&&n.some(t=>{for(let i=t.startRow;i<=t.endRow;i++)if(!e.getRowRawVisible(i))return!0;return!1}))}el(o,"hasHiddenRowsInSelections");let s=n.onCommandExecuted(e=>{-1!==r.findIndex(t=>t===e.id)&&t.next(!o())});return t.next(!o()),()=>s.dispose()})),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetRowStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function ds(e){let t=e.get(O.IUniverInstanceService),i=e.get(A.SheetsSelectionsService),n=e.get(O.ICommandService),r=[(0,A.SetSelectionsOperation),(0,A.SetColHiddenMutation),(0,A.SetColVisibleMutation)].map(e=>e.id);return{id:A.SetSelectedColsVisibleCommand.id,type:J.MenuItemType.BUTTON,title:"rightClick.showHideColumn",hidden$:tN(t,!0,({worksheet:e})=>new F.Observable(t=>{function o(){var t;let n=null==(t=i.getCurrentSelections())?void 0:t.map(e=>e.range).filter(e=>e.rangeType===O.RANGE_TYPE.COLUMN);return!!n&&0!==n.length&&!!n.some(t=>{for(let i=t.startColumn;i<=t.endColumn;i++)if(!e.getColVisible(i))return!0;return!1})}el(o,"hasHiddenColsInSelections");let s=n.onCommandExecuted(e=>{-1!==r.findIndex(t=>t===e.id)&&t.next(!o())});return t.next(!o()),()=>s.dispose()})),disabled$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetSetColumnStylePermission,A.WorksheetEditPermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function dl(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService);return{id:A.SetRowHeightCommand.id,type:J.MenuItemType.BUTTON,icon:"AdjustHeight",label:{name:su,props:{prefix:"rightClick.rowHeight",suffix:"px",min:2,max:1e3}},value$:tN(i,0,({worksheet:e})=>new F.Observable(i=>{function r(){var t;let r=null==(t=n.getCurrentLastSelection())?void 0:t.primary,o=r?e.getRowHeight(r.startRow):0;i.next(o)}el(r,"update");let o=t.onCommandExecuted(e=>{let t=e.id;if(t===A.SetRangeValuesMutation.id||t===A.SetSelectionsOperation.id||t===A.SetWorksheetRowIsAutoHeightMutation.id)return r()});return r(),o.dispose})),hidden$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetRowStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function da(e){let t=e.get(O.ICommandService),i=e.get(O.IUniverInstanceService),n=e.get(A.SheetsSelectionsService);return{id:A.SetColWidthCommand.id,type:J.MenuItemType.BUTTON,icon:"AdjustWidth",label:{name:su,props:{prefix:"rightClick.columnWidth",suffix:"px",min:2,max:1e3}},value$:tN(i,0,({worksheet:e})=>new F.Observable(i=>{function r(){var t;let r=null==(t=n.getCurrentLastSelection())?void 0:t.primary,o=0;null!=r&&(o=e.getColumnWidth(r.startColumn)),i.next(o)}el(r,"update");let o=t.onCommandExecuted(e=>{let t=e.id;if(t===A.SetRangeValuesMutation.id||t===A.SetSelectionsOperation.id||t===A.SetWorksheetColWidthMutation.id)return r()});return r(),o.dispose})),hidden$:tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetColumnStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]})}}function dd(e){var t;let i=e.get(O.IUniverInstanceService),n=e.get($.DocSelectionManagerService),r=i.getUniverDocInstance(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY),o=n.getActiveTextRange();if(null==r||null==o)return null;let s=null==(t=r.getBody())?void 0:t.textRuns;if(null==s)return;let{startOffset:l}=o;return s.find(({st:e,ed:t})=>l>=e&&l<=t)}function dc(e){let t=e.get(A.SheetsSelectionsService),i=e.get(A.RangeProtectionRuleModel),n=e.get(O.IUniverInstanceService),r=e.get(A.MergeCellController),o=n.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET);return(0,N.combineLatest)([t.selectionMoveEnd$,o.pipe((0,L.map)(e=>{var t;return null!=(t=null==e?void 0:e.getUnitId())?t:""})),o.pipe((0,Z.switchMap)(e=>{var t;return null!=(t=null==e?void 0:e.activeSheet$)?t:(0,j.of)(null)}))]).pipe((0,L.map)(([e,t,n])=>{if(!n||!e||0===e.length)return!1;let o=n.getSheetId(),s=e.map(e=>e.range);if(r.interceptor.fetchThroughInterceptors(A.MERGE_CELL_INTERCEPTOR_CHECK)(!1,s))return!0;let l=i.getSubunitRuleList(t,o).map(e=>e.ranges).flat();if(e.length<2){let t=e[0].range;return l.some(e=>(0,O.Rectangle).intersects(e,t)&&!(0,O.Rectangle).contains(e,t))}for(let t=0;t<e.length;t++)for(let i=t+1;i<e.length;i++)if((0,O.Rectangle).intersects(e[t].range,e[i].range))return!0;return!1}))}function du(e,t){return!!dm(e,t,O.RANGE_TYPE.ROW)}function dh(e,t){return!!dm(e,t,O.RANGE_TYPE.COLUMN)}function dm(e,t,i){return e.find(e=>{let{startRow:n,endRow:r,startColumn:o,endColumn:s,rangeType:l}=e.range;return l!==O.RANGE_TYPE.ALL&&l!==O.RANGE_TYPE.NORMAL&&l===i&&(i===O.RANGE_TYPE.COLUMN&&o<=t&&t<=s||i===O.RANGE_TYPE.ROW&&n<=t&&t<=r)})}function dg(e){let t=tW(e,{workbookTypes:[A.WorkbookEditablePermission],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellValuePermission,A.WorksheetSetCellStylePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint]}),i=dc(e);return{id:ru.id,icon:"MergeAllSingle",tooltip:"toolbar.mergeCell.main",type:J.MenuItemType.SUBITEMS,hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:t.pipe((0,D.combineLatestWith)(i),(0,L.map)(([e,t])=>e||t))}}function dp(e){return{id:rh.id,type:J.MenuItemType.BUTTON,title:"merge.all",icon:"MergeAllSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dv(e){return{id:rm.id,type:J.MenuItemType.BUTTON,title:"merge.vertical",icon:"VerticalIntegrationSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dS(e){return{id:rg.id,type:J.MenuItemType.BUTTON,title:"merge.horizontal",icon:"HorizontalMergeSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function df(e){return{id:A.RemoveWorksheetMergeCommand.id,type:J.MenuItemType.BUTTON,title:"merge.cancel",icon:"CancelMergeSingle",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dC(e){let t=e.get(O.IUniverInstanceService).getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),i=e.get(O.UserManagerService);return(0,N.combineLatest)([t,i.currentUser$]).pipe((0,Z.switchMap)(([t,i])=>t?t.activeSheet$.pipe((0,Z.switchMap)(i=>{if(!i)return(0,j.of)(!0);let n=e.get(A.RangeProtectionRuleModel),r=e.get(A.WorksheetProtectionRuleModel),o=e.get(A.SheetsSelectionsService);return(0,B.merge)(o.selectionMoveEnd$,n.ruleChange$,r.ruleChange$).pipe((0,L.map)(()=>{let e=t.getUnitId(),s=i.getSheetId(),l=n.getSubunitRuleList(e,s),a=o.getCurrentSelections(),d=null==a?void 0:a.map(e=>e.range),c=l.map(e=>e.ranges).flat();if(!d)return!1;let u=r.getRule(e,s);return null!=u&&!!u.permissionId||(null==d?void 0:d.some(e=>c.some(t=>(0,O.Rectangle).intersects(e,t))))}))})):(0,j.of)(!0)))}function dI(e){let t=e.get(O.IUniverInstanceService),i=e.get(A.RangeProtectionRuleModel),n=t.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),r=e.get(O.UserManagerService);return(0,N.combineLatest)([n,r.currentUser$]).pipe((0,Z.switchMap)(([t,n])=>t?t.activeSheet$.pipe((0,Z.switchMap)(n=>{if(!n)return(0,j.of)(!0);let r=e.get(A.RangeProtectionRuleModel),o=e.get(A.WorksheetProtectionRuleModel),s=e.get(O.IPermissionService),l=e.get(A.SheetsSelectionsService);return(0,B.merge)(l.selectionMoveEnd$,r.ruleChange$,o.ruleChange$).pipe((0,L.map)(()=>{var r,a;let d=t.getUnitId(),c=n.getSheetId(),u=i.getSubunitRuleList(d,c),h=null==(r=l.getCurrentSelections())?void 0:r.map(e=>e.range);if(!(null!=h&&h.length)||h.length>1)return!0;let m=h[0];if((null==m?void 0:m.rangeType)===O.RANGE_TYPE.ALL||(null==m?void 0:m.rangeType)===O.RANGE_TYPE.COLUMN||(null==m?void 0:m.rangeType)===O.RANGE_TYPE.ROW)return!0;let g=o.getRule(d,c);if(null!=g&&g.permissionId)return(null==(a=s.getPermissionPoint(new A.WorksheetManageCollaboratorPermission(d,c).id))?void 0:a.value)===!1;if(1!==u.filter(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(e,m))).length)return!0;let{startRow:p,endRow:v,startColumn:S,endColumn:f}=m,C=e.get(A.RangeProtectionCache);for(let e=p;e<=v;e++)for(let t=S;t<=f;t++){let i=C.getCellInfo(d,c,e,t);if(i)return!1===i[A.UnitAction.ManageCollaborator]}return!1}))})):(0,j.of)(!0)))}function db(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.IPermissionService),n=t.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),r=e.get(O.UserManagerService);return(0,N.combineLatest)([n,r.currentUser$]).pipe((0,Z.switchMap)(([t,n])=>t?t.activeSheet$.pipe((0,Z.switchMap)(n=>{var r;if(!n)return(0,j.of)(!0);let o=t.getUnitId(),s=e.get(A.SheetsSelectionsService),l=e.get(A.RangeProtectionRuleModel),a=e.get(A.WorksheetProtectionRuleModel),d=null!=(r=i.composePermission$([new A.WorkbookEditablePermission(o).id]).pipe((0,L.map)(e=>e.every(e=>e.value))))?r:(0,j.of)(!1),c=(0,B.merge)(l.ruleChange$,a.ruleChange$).pipe((0,X.startWith)(null));return(0,N.combineLatest)([d,c,s.selectionMoveEnd$]).pipe((0,L.map)(([e,t,i])=>{if(!e)return!0;let n=s.getCurrentSelections(),r=null==n?void 0:n.map(e=>e.range);return null!=r&&!!r.length&&r.length>1}))})):(0,j.of)(!0)))}function d_(e){var t;let i=e.get(O.IUniverInstanceService),n=e.get(O.IPermissionService),r=i.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),o=e.get(O.UserManagerService),s=e.has(tA)?e.get(tA):null,l=e.get(O.IContextService).subscribeContextValue$(O.FOCUSING_FX_BAR_EDITOR),a=null!=(t=null==s?void 0:s.visible$)?t:(0,j.of)(null);return(0,N.combineLatest)([r,o.currentUser$,a,l]).pipe((0,Z.switchMap)(([t,i,r,o])=>!t||null!=r&&r.visible&&r.unitId===t.getUnitId()||o?(0,j.of)(!0):t.activeSheet$.pipe((0,Z.switchMap)(i=>{var r;if(!i)return(0,j.of)(!0);let o=e.get(O.IContextService).subscribeContextValue$(O.FOCUSING_COMMON_DRAWINGS).pipe((0,X.startWith)(!1)),s=t.getUnitId(),l=i.getSheetId(),a=e.get(A.RangeProtectionRuleModel),d=e.get(A.WorksheetProtectionRuleModel),c=e.get(A.SheetsSelectionsService),u=null!=(r=n.composePermission$([new A.WorkbookCreateProtectPermission(s).id]).pipe((0,L.map)(e=>e.every(e=>e.value))))?r:(0,j.of)(!1),h=(0,B.merge)(a.ruleChange$,d.ruleChange$).pipe((0,X.startWith)(null));return(0,N.combineLatest)([u,h,c.selectionMoveEnd$,o]).pipe((0,L.map)(([e,t,i,n])=>{if(!e||n)return!0;let r=c.getCurrentSelections(),o=null==r?void 0:r.map(e=>e.range);if(!(null!=o&&o.length))return!0;let u=d.getRule(s,l);if(null!=u&&u.permissionId)return!0;let h=a.getSubunitRuleList(s,l);return null==o?void 0:o.some(e=>h.some(t=>t.ranges.some(t=>(0,O.Rectangle).intersects(e,t))))}))}))))}function dR(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.IPermissionService),n=t.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),r=e.get(O.UserManagerService);return(0,N.combineLatest)([n,r.currentUser$]).pipe((0,Z.switchMap)(([t,n])=>t?t.activeSheet$.pipe((0,Z.switchMap)(n=>{var r;if(!n)return(0,j.of)(!0);let o=t.getUnitId(),s=n.getSheetId(),l=e.get(A.RangeProtectionRuleModel),a=e.get(A.WorksheetProtectionRuleModel),d=null!=(r=i.composePermission$([new A.WorkbookCreateProtectPermission(o).id]).pipe((0,L.map)(e=>e.every(e=>e.value))))?r:(0,j.of)(!1),c=(0,B.merge)(l.ruleChange$,a.ruleChange$).pipe((0,X.startWith)(null));return(0,N.combineLatest)([d,c]).pipe((0,L.map)(([e,t])=>{var i;if(!e)return!0;let n=a.getRule(o,s);return null!=n&&!!n.permissionId||(null==(i=l.getSubunitRuleList(o,s))?void 0:i.filter(e=>(null==e?void 0:e.permissionId)&&(null==e?void 0:e.name))).length>0}))})):(0,j.of)(!0)))}function dy(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.IPermissionService),n=t.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),r=e.get(O.UserManagerService);return(0,N.combineLatest)([n,r.currentUser$]).pipe((0,Z.switchMap)(([t,n])=>t?t.activeSheet$.pipe((0,Z.switchMap)(n=>{if(!n)return(0,j.of)(!0);let r=t.getUnitId(),o=n.getSheetId(),s=e.get(A.WorksheetProtectionRuleModel);return s.ruleChange$.pipe((0,X.startWith)(null)).pipe((0,L.map)(()=>{var e;return!s.getRule(r,o)||(null==(e=i.getPermissionPoint(new A.WorksheetDeleteProtectionPermission(r,o).id))?void 0:e.value)===!1}))})):(0,j.of)(!0)))}function dT(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.IPermissionService),n=t.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),r=e.get(O.UserManagerService);return(0,N.combineLatest)([n,r.currentUser$]).pipe((0,Z.switchMap)(([t,n])=>t?t.activeSheet$.pipe((0,Z.switchMap)(n=>{var r;if(!n)return(0,j.of)(!0);let o=t.getUnitId(),s=e.get(A.RangeProtectionRuleModel),l=e.get(A.WorksheetProtectionRuleModel),a=null!=(r=i.composePermission$([new A.WorkbookCreateProtectPermission(o).id,new A.WorkbookManageCollaboratorPermission(o).id]).pipe((0,L.map)(e=>e.every(e=>e.value))))?r:(0,j.of)(!1),d=l.ruleChange$.pipe((0,X.startWith)(null)),c=s.ruleChange$.pipe((0,X.startWith)(null));return(0,N.combineLatest)([a,d,c]).pipe((0,L.map)(([e,t,i])=>{if(!e)return!0;let r=n.getSheetId(),a=l.getRule(o,r),d=s.getSubunitRuleList(o,r);return!(a||d.length)}))})):(0,j.of)(!0)))}function dE(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.IPermissionService),n=t.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),r=e.get(O.UserManagerService);return(0,N.combineLatest)([n,r.currentUser$]).pipe((0,Z.switchMap)(([t,n])=>t?t.activeSheet$.pipe((0,Z.switchMap)(n=>{if(!n)return(0,j.of)(!0);let r=t.getUnitId(),o=n.getSheetId(),s=e.get(A.SheetsSelectionsService),l=e.get(A.RangeProtectionRuleModel),a=e.get(A.WorksheetProtectionRuleModel);return(0,B.merge)(l.ruleChange$,a.ruleChange$,s.selectionMoveEnd$).pipe((0,X.startWith)(null)).pipe((0,L.map)(()=>{var t;let n=e.get(A.SheetsSelectionsService).getCurrentSelections(),s=null==n?void 0:n.map(e=>e.range);if(!(null!=s&&s.length)||s.length>1)return!0;let d=s[0];if((null==d?void 0:d.rangeType)===O.RANGE_TYPE.ALL||(null==d?void 0:d.rangeType)===O.RANGE_TYPE.COLUMN||(null==d?void 0:d.rangeType)===O.RANGE_TYPE.ROW)return!0;let c=a.getRule(r,o);if(null!=c&&c.permissionId)return(null==(t=i.getPermissionPoint(new A.WorksheetDeleteProtectionPermission(r,o).id))?void 0:t.value)===!1;if(1!==l.getSubunitRuleList(r,o).filter(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(e,d))).length)return!0;let{startRow:u,endRow:h,startColumn:m,endColumn:g}=d,p=e.get(A.RangeProtectionCache);for(let e=u;e<=h;e++)for(let t=m;t<=g;t++){let i=p.getCellInfo(r,o,e,t);if(i)return!1===i[A.UnitAction.Delete]}return!1}))})):(0,j.of)(!0)))}function dw(e){var t;let i=e.get(O.IUniverInstanceService),n=e.get(O.IPermissionService),r=i.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET),o=e.get(O.UserManagerService),s=e.has(tA)?e.get(tA):null,l=e.get(O.IContextService).subscribeContextValue$(O.FOCUSING_FX_BAR_EDITOR),a=null!=(t=null==s?void 0:s.visible$)?t:(0,j.of)(null);return(0,N.combineLatest)([r,o.currentUser$,a,l]).pipe((0,Z.switchMap)(([e,t,i,r])=>!e||null!=i&&i.visible&&i.unitId===e.getUnitId()||r?(0,j.of)(!0):e.activeSheet$.pipe((0,Z.switchMap)(t=>{var i,r;if(!t)return(0,j.of)(!0);let o=e.getUnitId();return(null!=(r=null==(i=n.getPermissionPoint$(new A.WorkbookEditablePermission(o).id))?void 0:i.pipe((0,L.map)(e=>!!e.value)))?r:(0,j.of)(!1)).pipe((0,L.map)(e=>!e))}))))}el(a7,"SheetFrozenHeaderMenuItemFactory"),el(a4,"FrozenMenuItemFactory"),el(a8,"FrozenRowMenuItemFactory"),el(de,"FrozenColMenuItemFactory"),el(dt,"CancelFrozenMenuItemFactory"),el(di,"HideRowMenuItemFactory"),el(dn,"HideColMenuItemFactory"),el(dr,"ShowRowMenuItemFactory"),el(ds,"ShowColMenuItemFactory"),el(dl,"SetRowHeightMenuItemFactory"),el(da,"SetColWidthMenuItemFactory"),el(dd,"getFontStyleAtCursor"),el(dc,"getSheetSelectionsDisabled$"),el(du,"isThisRowSelected"),el(dh,"isThisColSelected"),el(dm,"matchedSelectionByRowColIndex"),el(dg,"CellMergeMenuItemFactory"),el(dp,"CellMergeAllMenuItemFactory"),el(dv,"CellMergeVerticalMenuItemFactory"),el(dS,"CellMergeHorizontalMenuItemFactory"),el(df,"CellMergeCancelMenuItemFactory"),el(dC,"getAddPermissionHidden$"),el(dI,"getEditPermissionHidden$"),el(db,"getPermissionDisableBase$"),el(d_,"getAddPermissionDisableBase$"),el(dR,"getAddPermissionFromSheetBarDisable$"),el(dy,"getRemovePermissionFromSheetBarDisable$"),el(dT,"getSetPermissionFromSheetBarDisable$"),el(dE,"getRemovePermissionDisable$"),el(dw,"getViewPermissionDisable$");let dP="sheet.contextMenu.permission";function dM(e){return{id:r2.id,type:J.MenuItemType.BUTTON,icon:rZ,tooltip:"permission.toolbarMenu",hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET),disabled$:d_(e)}}function dO(e){return{id:dP,type:J.MenuItemType.SUBITEMS,title:"rightClick.protectRange",icon:rK,hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dx(e){return{id:r5.id,type:J.MenuItemType.BUTTON,title:"rightClick.turnOnProtectRange",hidden$:dC(e),disabled$:d_(e)}}function dA(e){return{id:r4.id,type:J.MenuItemType.BUTTON,title:"rightClick.editProtectRange",disabled$:db(e),hidden$:dI(e)}}function dk(e){return{id:r7.id,type:J.MenuItemType.BUTTON,title:"rightClick.removeProtectRange",disabled$:dE(e),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dN(e){return{id:r9.id,type:J.MenuItemType.BUTTON,title:"rightClick.viewAllProtectArea",disabled$:dw(e),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dD(e){return{id:r6.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.addProtectSheet",disabled$:dR(e),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dV(e){return{id:r0.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.removeProtectSheet",disabled$:dy(e),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dW(e){return{id:r1.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.changeSheetPermission",disabled$:dT(e),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dH(e){return{id:r3.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.viewAllProtectArea",disabled$:dw(e),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dU(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.ICommandService),n=new F.Observable(e=>{let n=i.onCommandExecuted(i=>{let n=i.id;(n===A.RemoveSheetMutation.id||n===A.InsertSheetMutation.id||n===A.SetWorksheetHideMutation.id)&&dX(t,e)});return dX(t,e),n.dispose}),r=tj(e,[A.WorkbookEditablePermission,A.WorkbookDeleteSheetPermission]);return{id:on.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.delete",disabled$:(0,N.combineLatest)([n,r]).pipe((0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dL(e){return{id:A.CopySheetCommand.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.copy",disabled$:tj(e,[A.WorkbookEditablePermission,A.WorkbookCreateSheetPermission]),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dB(e){return{id:oH.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.rename",disabled$:tj(e,[A.WorkbookEditablePermission,A.WorkbookRenameSheetPermission]),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dF(e){return{id:A.SetTabColorCommand.id,title:"sheetConfig.changeColor",type:J.MenuItemType.SELECTOR,selections:[{label:{name:sl,hoverable:!1}}],hidden$:tj(e,[A.WorkbookEditablePermission])}}function dj(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.ICommandService);return{id:A.SetWorksheetHideCommand.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.hide",disabled$:new(0,F.Observable)(e=>{let n=i.onCommandExecuted(i=>{let n=i.id;(n===A.RemoveSheetMutation.id||n===A.InsertSheetMutation.id||n===A.SetWorksheetHideMutation.id)&&dX(t,e)});return dX(t,e),n.dispose}).pipe((0,D.combineLatestWith)(tj(e,[A.WorkbookEditablePermission,A.WorkbookHideSheetPermission])),(0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dz(e){let t=e.get(O.IUniverInstanceService),i=e.get(O.ICommandService);return{id:oV.id,type:J.MenuItemType.BUTTON,title:"sheetConfig.unhide",disabled$:new(0,F.Observable)(e=>{function n(){let i=Array.from(t.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getWorksheets().values());e.next(1===i.length)}el(n,"disableFunction2");let r=i.onCommandExecuted(e=>{let t=e.id;(t===A.RemoveSheetMutation.id||t===A.InsertSheetMutation.id||t===A.SetWorksheetHideMutation.id)&&n()});return n(),r.dispose}).pipe((0,D.combineLatestWith)(tj(e,[A.WorkbookEditablePermission,A.WorkbookHideSheetPermission])),(0,L.map)(([e,t])=>e||t)),hidden$:(0,J.getMenuHiddenObservable)(e,O.UniverInstanceType.UNIVER_SHEET)}}function dX(e,t){let i=Array.from(e.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getWorksheets().values()).filter(e=>e.getConfig().hidden===O.BooleanNumber.FALSE);t.next(1===i.length)}el(dM,"sheetPermissionToolbarMenuFactory"),el(dO,"sheetPermissionContextMenuFactory"),el(dx,"sheetPermissionAddProtectContextMenuFactory"),el(dA,"sheetPermissionEditProtectContextMenuFactory"),el(dk,"sheetPermissionRemoveProtectContextMenuFactory"),el(dN,"sheetPermissionViewAllProtectRuleContextMenuFactory"),el(dD,"sheetPermissionProtectSheetInSheetBarMenuFactory"),el(dV,"sheetPermissionRemoveProtectionSheetBarMenuFactory"),el(dW,"sheetPermissionChangeSheetPermissionSheetBarMenuFactory"),el(dH,"sheetPermissionViewAllProtectRuleSheetBarMenuFactory"),el(dU,"DeleteSheetMenuItemFactory"),el(dL,"CopySheetMenuItemFactory"),el(dB,"RenameSheetMenuItemFactory"),el(dF,"ChangeColorSheetMenuItemFactory"),el(dj,"HideSheetMenuItemFactory"),el(dz,"ShowMenuItemFactory"),el(dX,"disableFunction");let dY={[J.RibbonStartGroup.FORMAT]:{[ob.id]:{order:0,menuItemFactory:aP},[rC.id]:{order:1,menuItemFactory:aM},[rI.id]:{order:2,menuItemFactory:aO},[rb.id]:{order:3,menuItemFactory:ax},[r_.id]:{order:4,menuItemFactory:aA},[rE.id]:{order:5,menuItemFactory:ak},[rT.id]:{order:6,menuItemFactory:aN},[rw.id]:{order:7,menuItemFactory:aV,[A.ResetTextColorCommand.id]:{order:0,menuItemFactory:aD}},[A.SetBackgroundColorCommand.id]:{order:9,menuItemFactory:aH,[A.ResetBackgroundColorCommand.id]:{order:0,menuItemFactory:aW}},[A.SetBorderBasicCommand.id]:{order:10,menuItemFactory:ai}},[J.RibbonStartGroup.LAYOUT]:{[A.AddWorksheetMergeCommand.id]:{order:0,menuItemFactory:dg,[A.AddWorksheetMergeAllCommand.id]:{order:0,menuItemFactory:dp},[A.AddWorksheetMergeVerticalCommand.id]:{order:1,menuItemFactory:dv},[A.AddWorksheetMergeHorizontalCommand.id]:{order:2,menuItemFactory:dS},[A.RemoveWorksheetMergeCommand.id]:{order:3,menuItemFactory:df}},[A.SetHorizontalTextAlignCommand.id]:{order:1,menuItemFactory:aL},[A.SetVerticalTextAlignCommand.id]:{order:1,menuItemFactory:aF},[A.SetTextWrapCommand.id]:{order:2,menuItemFactory:az},[A.SetTextRotationCommand.id]:{order:3,menuItemFactory:aY}},[J.RibbonStartGroup.OTHERS]:{[r2.id]:{order:0,menuItemFactory:dM}},[J.ContextMenuPosition.MAIN_AREA]:{[J.ContextMenuGroup.FORMAT]:{[l9.name]:{order:0,menuItemFactory:aZ},[l3.name]:{order:2,menuItemFactory:aK},[aq]:{order:3,menuItemFactory:aQ,[l4.id]:{order:0,menuItemFactory:aJ},[l8.id]:{order:1,menuItemFactory:a$},[ae.id]:{order:2,menuItemFactory:a0},[at.id]:{order:3,menuItemFactory:a1}},[an]:{order:4,menuItemFactory:ar,[A.ClearSelectionContentCommand.id]:{order:0,menuItemFactory:ao},[A.ClearSelectionFormatCommand.id]:{order:1,menuItemFactory:as},[A.ClearSelectionAllCommand.id]:{order:2,menuItemFactory:al}}},[J.ContextMenuGroup.LAYOUT]:{order:1,[aC]:{order:0,menuItemFactory:aI,[A.InsertRowBeforeCommand.id]:{order:0,menuItemFactory:ab},[A.InsertColBeforeCommand.id]:{order:1,menuItemFactory:aR},[rO.id]:{order:2,menuItemFactory:aT},[rM.id]:{order:3,menuItemFactory:aE}},[aa]:{order:0,menuItemFactory:ad,[oi.id]:{order:0,menuItemFactory:ac},[ot.id]:{order:1,menuItemFactory:au},[rp.id]:{order:2,menuItemFactory:ah},[rv.id]:{order:3,menuItemFactory:am}},[a9]:{order:2,menuItemFactory:a6,[oR.id]:{order:0,menuItemFactory:a4},[oy.id]:{order:1,menuItemFactory:a8},[oT.id]:{order:2,menuItemFactory:de},[oE.id]:{order:3,menuItemFactory:dt}},[dP]:{order:3,menuItemFactory:dO,[r5.id]:{order:0,menuItemFactory:dx},[r4.id]:{order:1,menuItemFactory:dA},[r7.id]:{order:2,menuItemFactory:dk},[r9.id]:{order:3,menuItemFactory:dN}}},[J.ContextMenuGroup.DATA]:{order:2},[J.ContextMenuGroup.OTHERS]:{order:3}},[J.ContextMenuPosition.COL_HEADER]:{[J.ContextMenuGroup.FORMAT]:{[l9.name]:{order:0,menuItemFactory:aZ},[l3.name]:{order:2,menuItemFactory:aK},[aq]:{order:3,menuItemFactory:aQ,[l4.id]:{order:0,menuItemFactory:aJ},[l8.id]:{order:1,menuItemFactory:a$},[ae.id]:{order:2,menuItemFactory:a0},[at.id]:{order:3,menuItemFactory:a1}},[an]:{order:4,menuItemFactory:ar,[A.ClearSelectionContentCommand.id]:{order:0,menuItemFactory:ao},[A.ClearSelectionFormatCommand.id]:{order:1,menuItemFactory:as},[A.ClearSelectionAllCommand.id]:{order:2,menuItemFactory:al}}},[J.ContextMenuGroup.LAYOUT]:{order:1,[ap]:{order:0,menuItemFactory:av,[A.InsertColBeforeCommand.id]:{order:0,menuItemFactory:aR},[A.InsertColAfterCommand.id]:{order:1,menuItemFactory:ay}},[rf.id]:{order:1,menuItemFactory:dn},[A.SetSelectedColsVisibleCommand.id]:{order:2,menuItemFactory:ds},[oi.id]:{order:2,menuItemFactory:ac},[A.SetColWidthCommand.id]:{order:3,menuItemFactory:da},[ok.id]:{order:4,menuItemFactory:a5},[a3]:{order:5,menuItemFactory:a7,[oR.id]:{order:0,menuItemFactory:a4},[oE.id]:{order:3,menuItemFactory:dt}},[dP]:{order:6,menuItemFactory:dO,[r5.id]:{order:0,menuItemFactory:dx},[r4.id]:{order:1,menuItemFactory:dA},[r7.id]:{order:2,menuItemFactory:dk},[r9.id]:{order:3,menuItemFactory:dN}}},[J.ContextMenuGroup.DATA]:{order:2},[J.ContextMenuGroup.OTHERS]:{order:3}},[J.ContextMenuPosition.ROW_HEADER]:{[J.ContextMenuGroup.FORMAT]:{[l9.name]:{order:0,menuItemFactory:aZ},[l3.name]:{order:2,menuItemFactory:aK},[aq]:{order:3,menuItemFactory:aQ,[l4.id]:{order:0,menuItemFactory:aJ},[l8.id]:{order:1,menuItemFactory:a$},[ae.id]:{order:2,menuItemFactory:a0},[at.id]:{order:3,menuItemFactory:a1}},[an]:{order:4,menuItemFactory:ar,[A.ClearSelectionContentCommand.id]:{order:0,menuItemFactory:ao},[A.ClearSelectionFormatCommand.id]:{order:1,menuItemFactory:as},[A.ClearSelectionAllCommand.id]:{order:2,menuItemFactory:al}}},[J.ContextMenuGroup.LAYOUT]:{order:1,[aS]:{order:0,menuItemFactory:af,[A.InsertRowBeforeCommand.id]:{order:0,menuItemFactory:ab},[A.InsertRowAfterCommand.id]:{order:1,menuItemFactory:a_}},[ot.id]:{order:1,menuItemFactory:au},[rS.id]:{order:2,menuItemFactory:di},[A.SetSelectedRowsVisibleCommand.id]:{order:2,menuItemFactory:dr},[A.SetRowHeightCommand.id]:{order:3,menuItemFactory:dl},[A.SetWorksheetRowIsAutoHeightCommand.id]:{order:4,menuItemFactory:a2},[a3]:{order:5,menuItemFactory:a7,[oR.id]:{order:0,menuItemFactory:a4},[oE.id]:{order:3,menuItemFactory:dt}},[dP]:{order:6,menuItemFactory:dO,[r5.id]:{order:0,menuItemFactory:dx},[r4.id]:{order:1,menuItemFactory:dA},[r7.id]:{order:2,menuItemFactory:dk},[r9.id]:{order:3,menuItemFactory:dN}}},[J.ContextMenuGroup.DATA]:{order:2},[J.ContextMenuGroup.OTHERS]:{order:3}},[J.ContextMenuPosition.FOOTER_TABS]:{[J.ContextMenuGroup.OTHERS]:{order:0,[on.id]:{order:0,menuItemFactory:dU},[A.CopySheetCommand.id]:{order:1,menuItemFactory:dL},[oH.id]:{order:2,menuItemFactory:dB},[A.SetTabColorCommand.id]:{order:3,menuItemFactory:dF},[A.SetWorksheetHideCommand.id]:{order:4,menuItemFactory:dj},[oV.id]:{order:6,menuItemFactory:dz},[r6.id]:{order:7,menuItemFactory:dD},[r0.id]:{order:8,menuItemFactory:dV},[r1.id]:{order:9,menuItemFactory:dW},[r3.id]:{order:10,menuItemFactory:dH}}},[J.ContextMenuPosition.FOOTER_MENU]:{[J.ContextMenuGroup.OTHERS]:{[A.ToggleGridlinesCommand.id]:{order:1,menuItemFactory:ag}}}},dG=[J.KeyCode.ARROW_DOWN,J.KeyCode.ARROW_UP,J.KeyCode.ARROW_LEFT,J.KeyCode.ARROW_RIGHT],dZ=[J.KeyCode.ENTER,J.KeyCode.TAB,...dG];function dK(){let e=[];for(let t of dG)e.push({id:i8.id,binding:t,preconditions:/* @__PURE__ */el(e=>lc(e),"preconditions"),staticParameters:{visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:t,isShift:!1}}),e.push({id:i8.id,binding:t|J.MetaKeys.SHIFT,preconditions:/* @__PURE__ */el(e=>lc(e),"preconditions"),staticParameters:{visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:t,isShift:!0}});return e}el(dK,"generateArrowSelectionShortCutItem");let dq={id:i4.id,binding:J.KeyCode.F2,description:"shortcut.sheet.start-editing",group:"4_sheet-edit",preconditions:lr,staticParameters:{visible:!0,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.F2}},dQ={id:i7.id,binding:J.KeyCode.ENTER,description:"shortcut.sheet.toggle-editing",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lc(e),"preconditions"),staticParameters:{visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.ENTER}},dJ={id:i7.id,binding:J.KeyCode.TAB,preconditions:/* @__PURE__ */el(e=>lc(e),"preconditions"),staticParameters:{visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.TAB}},d$={id:i7.id,binding:J.KeyCode.ESC,description:"shortcut.sheet.abort-editing",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lc(e),"preconditions"),staticParameters:{visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.ESC}},d0={id:M.BreakLineCommand.id,description:"shortcut.sheet.break-line",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>ls(e),"preconditions"),binding:J.KeyCode.ENTER|J.MetaKeys.ALT},d1={id:M.DeleteLeftCommand.id,preconditions:/* @__PURE__ */el(e=>ll(e)||la(e),"preconditions"),binding:J.KeyCode.BACKSPACE},d2={id:i7.id,description:"shortcut.sheet.delete-and-start-editing",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lr(e)&&!la(e),"preconditions"),binding:J.KeyCode.BACKSPACE,staticParameters:{visible:!0,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.BACKSPACE}},d5={id:A.SetRowHiddenCommand.id,preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.Digit9|J.MetaKeys.CTRL_COMMAND},d9={id:A.SetColHiddenCommand.id,preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.Digit0|J.MetaKeys.CTRL_COMMAND|J.MetaKeys.SHIFT},d6={id:td.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_DOWN,priority:100,preconditions:lr,staticParameters:{direction:O.Direction.DOWN}},d3={id:td.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_UP,priority:100,preconditions:lr,staticParameters:{direction:O.Direction.UP}},d7={id:td.id,description:"shortcut.sheet.select-left-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_LEFT,priority:100,preconditions:lo,staticParameters:{direction:O.Direction.LEFT}},d4={id:td.id,description:"shortcut.sheet.select-right-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_RIGHT,priority:100,preconditions:lo,staticParameters:{direction:O.Direction.RIGHT}},d8={id:tc.id,description:"shortcut.sheet.select-next-cell",group:"3_sheet-view",binding:J.KeyCode.TAB,priority:100,preconditions:lr,staticParameters:{direction:O.Direction.RIGHT,keycode:J.KeyCode.TAB}},ce={id:tc.id,description:"shortcut.sheet.select-previous-cell",group:"3_sheet-view",binding:J.KeyCode.TAB|J.MetaKeys.SHIFT,priority:100,preconditions:lr,staticParameters:{direction:O.Direction.LEFT,keycode:J.KeyCode.TAB}},ct={id:tc.id,description:"shortcut.sheet.select-below-cell",group:"3_sheet-view",binding:J.KeyCode.ENTER,priority:100,preconditions:lr,staticParameters:{direction:O.Direction.DOWN,keycode:J.KeyCode.ENTER}},ci={id:tc.id,description:"shortcut.sheet.select-up-cell",group:"3_sheet-view",binding:J.KeyCode.ENTER|J.MetaKeys.SHIFT,priority:100,preconditions:lr,staticParameters:{direction:O.Direction.UP,keycode:J.KeyCode.ENTER}},cn={id:td.id,description:"shortcut.sheet.select-below-value-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_DOWN|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.DOWN,jumpOver:ta.moveGap}},cr={id:td.id,description:"shortcut.sheet.select-up-value-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_UP|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.UP,jumpOver:ta.moveGap}},co={id:td.id,description:"shortcut.sheet.select-left-value-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_LEFT|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.LEFT,jumpOver:ta.moveGap}},cs={id:td.id,description:"shortcut.sheet.select-right-value-cell",group:"3_sheet-view",binding:J.KeyCode.ARROW_RIGHT|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.RIGHT,jumpOver:ta.moveGap}},cl={id:tu.id,description:"shortcut.sheet.expand-selection-down",group:"3_sheet-view",binding:J.KeyCode.ARROW_DOWN|J.MetaKeys.SHIFT,preconditions:lr,staticParameters:{direction:O.Direction.DOWN}},ca={id:tu.id,description:"shortcut.sheet.expand-selection-up",group:"3_sheet-view",binding:J.KeyCode.ARROW_UP|J.MetaKeys.SHIFT,preconditions:lr,staticParameters:{direction:O.Direction.UP}},cd={id:tu.id,description:"shortcut.sheet.expand-selection-left",group:"3_sheet-view",binding:J.KeyCode.ARROW_LEFT|J.MetaKeys.SHIFT,preconditions:lr,staticParameters:{direction:O.Direction.LEFT}},cc={id:tu.id,description:"shortcut.sheet.expand-selection-right",group:"3_sheet-view",binding:J.KeyCode.ARROW_RIGHT|J.MetaKeys.SHIFT,preconditions:lr,staticParameters:{direction:O.Direction.RIGHT}},cu={id:tu.id,description:"shortcut.sheet.expand-selection-to-below-gap",group:"3_sheet-view",binding:J.KeyCode.ARROW_DOWN|J.MetaKeys.SHIFT|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.DOWN,jumpOver:ta.moveGap}},ch={id:tu.id,description:"shortcut.sheet.expand-selection-to-up-gap",group:"3_sheet-view",binding:J.KeyCode.ARROW_UP|J.MetaKeys.SHIFT|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.UP,jumpOver:ta.moveGap}},cm={id:tu.id,description:"shortcut.sheet.expand-selection-to-left-gap",group:"3_sheet-view",binding:J.KeyCode.ARROW_LEFT|J.MetaKeys.SHIFT|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.LEFT,jumpOver:ta.moveGap}},cg={id:tu.id,description:"shortcut.sheet.expand-selection-to-right-gap",group:"3_sheet-view",binding:J.KeyCode.ARROW_RIGHT|J.MetaKeys.SHIFT|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{direction:O.Direction.RIGHT,jumpOver:ta.moveGap}},cp={id:th.id,description:"shortcut.sheet.select-all",group:"3_sheet-view",binding:J.KeyCode.A|J.MetaKeys.CTRL_COMMAND,preconditions:lr,staticParameters:{expandToGapFirst:!0,loop:!0}},cv={id:rC.id,description:"shortcut.sheet.set-bold",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.B|J.MetaKeys.CTRL_COMMAND},cS={id:rI.id,description:"shortcut.sheet.set-italic",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.I|J.MetaKeys.CTRL_COMMAND},cf={id:rb.id,description:"shortcut.sheet.set-underline",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.U|J.MetaKeys.CTRL_COMMAND},cC={id:r_.id,description:"shortcut.sheet.set-strike-through",group:"4_sheet-edit",preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.X|J.MetaKeys.SHIFT|J.MetaKeys.CTRL_COMMAND},cI={id:A.ClearSelectionContentCommand.id,preconditions:/* @__PURE__ */el(e=>lr(e),"preconditions"),binding:J.KeyCode.DELETE,mac:J.KeyCode.BACKSPACE},cb={id:ne.id,description:"shortcut.sheet.zoom-in",binding:J.KeyCode.EQUAL|J.MetaKeys.CTRL_COMMAND,group:"3_sheet-view",preconditions:lr,priority:1,staticParameters:{delta:.2}},c_={id:O.NilCommand.id,binding:J.KeyCode.EQUAL|J.MetaKeys.CTRL_COMMAND},cR={id:ne.id,description:"shortcut.sheet.zoom-out",binding:J.KeyCode.MINUS|J.MetaKeys.CTRL_COMMAND,group:"3_sheet-view",preconditions:lr,priority:1,staticParameters:{delta:-.2}},cy={id:O.NilCommand.id,binding:J.KeyCode.MINUS|J.MetaKeys.CTRL_COMMAND},cT={id:ne.id,description:"shortcut.sheet.reset-zoom",binding:J.KeyCode.Digit0|J.MetaKeys.CTRL_COMMAND,preconditions:lr,group:"3_sheet-view",priority:1,staticParameters:{reset:!0}},cE={id:O.NilCommand.id,binding:J.KeyCode.Digit0|J.MetaKeys.CTRL_COMMAND};var cw,cP,cM,cO,cx,cA=Object.defineProperty,ck=Object.getOwnPropertyDescriptor,cN=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?ck(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&cA(t,i,o),o},"__decorateClass$I"),cD=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$I");let cV=(el(cx=class extends O.Disposable{constructor(e,t,i,n,r,o,s,l){super(),this._injector=e,this._componentManager=t,this._layoutService=i,this._commandService=n,this._shortcutService=r,this._menuManagerService=o,this._uiPartsService=s,this._configService=l,this._init()}_init(){this._initComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts(),this._initFocusHandler()}_initComponents(){let e=this._componentManager;this.disposeWithMe(e.register(su,sh)),this.disposeWithMe(e.register(sn,ss)),this.disposeWithMe(e.register(sl,et.ColorPicker)),this.disposeWithMe(e.register(sa,J.FontFamily)),this.disposeWithMe(e.register(sd,J.FontFamilyItem)),this.disposeWithMe(e.register(sc,J.FontSize)),this.disposeWithMe(e.register(oB,sf)),this.disposeWithMe(e.register("HideGridlines",nG))}_initCommands(){[rh,ru,rg,rm,ne,tu,td,tc,oH,on,ot,oi,rS,rf,eE,ew,th,oW,(0,A.SetBoldCommand),i8,i7,i4,rC,rI,rb,r_,rR,ry,rT,rE,rw,rP,(0,A.SetItalicCommand),(0,A.SetStrikeThroughCommand),(0,A.SetFontFamilyCommand),(0,A.SetFontSizeCommand),oC,oI,ob,o_,ey,eT,oR,oy,oT,oU,oE,(0,A.SetUnderlineCommand),nt,na,oV,oe,rM,rv,rO,rp,oj,i6,i3,rq,oL,r2,r5,r9,r6,r3,r1,r7,r4,rQ,rJ,r$,r0,r8,ok].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}_initMenus(){this._menuManagerService.mergeMenu(dY)}_initShortcuts(){[d6,d3,d7,d4,d8,ce,ct,ci,cn,cr,co,cs,cl,ca,cd,cc,cu,ch,cm,cg,cp,cb,cR,cT,cE,c_,cy,cv,cS,cf,cC,cI,...dK(),dQ,dq,dJ,d0,d1,d2,d$,d5,d9].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_initWorkbenchParts(){let e=this._uiPartsService,t=this._injector,i=this._configService.getConfig(lt);(null==i?void 0:i.formulaBar)!==!1&&this.disposeWithMe(e.registerComponent(J.BuiltInUIPart.HEADER,()=>(0,O.connectInjector)(s4,t))),this.disposeWithMe(e.registerComponent(J.BuiltInUIPart.FOOTER,()=>(0,O.connectInjector)(s7,t))),this.disposeWithMe(e.registerComponent(J.BuiltInUIPart.CONTENT,()=>(0,O.connectInjector)(s8,t)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(O.UniverInstanceType.UNIVER_SHEET,e=>{let t=this._injector.get(x.IRenderManagerService).getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_DOC),i=null==t?void 0:t.with(M.DocSelectionRenderService);null==i||i.focus()}))}},"SheetUIController"),cx);cV=cN([cD(0,(0,O.Inject)(O.Injector)),cD(1,(0,O.Inject)(J.ComponentManager)),cD(2,J.ILayoutService),cD(3,O.ICommandService),cD(4,J.IShortcutService),cD(5,J.IMenuManagerService),cD(6,J.IUIPartsService),cD(7,O.IConfigService)],cV);var cW=Object.defineProperty,cH=Object.getOwnPropertyDescriptor,cU=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?cH(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&cW(t,i,o),o},"__decorateClass$H"),cL=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$H");let cB=(ue=class extends O.Disposable{constructor(e,t,i,n,r,o){super(),this._context=e,this._layoutService=t,this._cellEditorManagerService=i,this._editorBridgeService=n,this._renderManagerService=r,this._sheetSkeletonManagerService=o}fitTextSize(e){let t=this._editorBridgeService.getEditCellState();if(!t)return;let{position:i,documentLayoutObject:n,canvasOffset:r,scaleX:o,scaleY:s}=t,{startX:l,startY:a,endX:d,endY:c}=i,u=n.documentModel;if(null==u)return;let h=this._getEditorSkeleton();if(!h)return;let{actualWidth:m,actualHeight:g}=this._predictingSize(i,r,h,n,o,s),{verticalAlign:p,paddingData:v,fill:S}=n,f=d-l,C=c-a;if(f<m&&(f=m),C<g)C=g,u.updateDocumentDataMargin(v);else{let e=0;e=(e=p===O.VerticalAlign.MIDDLE?(C-g)/2/s:p===O.VerticalAlign.TOP?v.t||0:(C-g)/s-(v.b||0))<(v.t||0)?v.t||0:e,u.updateDocumentDataMargin({t:e})}h.calculate(),this._editAreaProcessing(f,C,i,r,S,o,s,e)}_predictingSize(e,t,i,n,r=1,o=1){let{startX:s,endX:l}=e,{textRotation:a,wrapStrategy:d}=n,c=n.documentModel,{vertexAngle:u}=(0,x.convertTextRotation)(a),h=document.body.clientWidth;if(d===O.WrapStrategy.WRAP&&0===u){let{actualWidth:e,actualHeight:t}=i.getActualSize();return{actualWidth:e*r,actualHeight:t*o}}null==c||c.updateDocumentDataPageSize((h-s-t.left)/r),i.calculate();let m=i.getActualSize(),g=l-s;return g<m.actualWidth*r+5*r&&(g=m.actualWidth*r+5*r),null==c||c.updateDocumentDataPageSize(g/r),null==c||c.updateDocumentRenderConfig({horizontalAlign:O.HorizontalAlign.UNSPECIFIED,cellValueType:void 0}),{actualWidth:g,actualHeight:m.actualHeight*o}}_getEditorMaxSize(e,t){if(null==this._getEditorObject())return;function i(e){return Number.parseInt(e.replace("px",""))}el(i,"pxToNum");let n=this._context.engine.getCanvasElement(),r=n.getBoundingClientRect(),o=i(n.style.width),{width:s}=r,{startX:l,startY:a}=e;return{height:document.body.clientHeight-a-Number.parseFloat(s3.sheetFooterBarHeight)-t.top-4,width:document.body.clientWidth-l-t.left,scaleAdjust:s/o}}_editAreaProcessing(e,t,i,n,r,o=1,s=1,l){var a;let d=this._getEditorObject();if(null==d)return;let c=this._context.engine.getCanvasElement(),{startX:u,startY:h}=i,{document:m,scene:g,engine:p}=d,v=g.getViewport(M.VIEWPORT_KEY.VIEW_MAIN),S=this._getEditorMaxSize(i,n);if(!S)return;let{height:f,width:C,scaleAdjust:I}=S,b=t,_=null==v?void 0:v.getScrollBar();b>f?(b=f,null==_?v&&new x.ScrollBar(v,{enableHorizontal:!1,barSize:8}):null==v||v.resetCanvasSizeAndUpdateScroll()):(_=null,null==(a=null==v?void 0:v.getScrollBar())||a.dispose()),(e+=(null==_?void 0:_.barSize)||0)>C&&(e=C),u-=x.FIX_ONE_PIXEL_BLUR_OFFSET,h-=x.FIX_ONE_PIXEL_BLUR_OFFSET,this._addBackground(g,e/o,t/s,r);let{scaleX:R,scaleY:y}=g.getPrecisionScale();g.transformByState({width:e*I/o,height:t*I/s,scaleX:o*I,scaleY:s*I}),m.resize(e*I/o,t*I/s),setTimeout(()=>{p.resizeBySize((0,x.fixLineWidthByScale)(e,R),(0,x.fixLineWidthByScale)(b,y)),null==l||l()},0);let T=this._layoutService.getContentElement().getBoundingClientRect(),E=c.getBoundingClientRect();u=u*I+(E.left-T.left),h=h*I+(E.top-T.top),this._cellEditorManagerService.setState({startX:u,startY:h,endX:e*I+u,endY:b*I+h,show:!0})}_addBackground(e,t,i,n){let r="_backgroundRectHelperColor_",o=e.getObject(r);null==o&&null==n||(null==o?e.addObjects([new x.Rect(r,{width:t,height:i,fill:n,evented:!1})],M.DOCS_COMPONENT_MAIN_LAYER_INDEX):null==n?o.dispose():(o.setProps({fill:n}),o.transformByState({width:t,height:i})))}resizeCellEditor(e){var t;let i=this._cellEditorManagerService.getState();if(!i||!this._editorBridgeService.isVisible().visible)return;this._editorBridgeService.refreshEditCellPosition(!0);let n=this._editorBridgeService.getEditCellState();if(!n)return;let r=null==(t=this._sheetSkeletonManagerService.getWorksheetSkeleton(n.sheetId))?void 0:t.skeleton;if(!r)return;let{row:o,column:s,scaleX:l,scaleY:a,position:d,canvasOffset:c}=n,u=this._getEditorMaxSize(d,c);if(!u)return;let{height:h,width:m,scaleAdjust:g}=u,p=r.getCellByIndex(o,s),v=Math.min((p.mergeInfo.endY-p.mergeInfo.startY)*a,h)*g,S=Math.min((p.mergeInfo.endX-p.mergeInfo.startX)*l,m)*g,f=i.endY-i.startY,C=i.endX-i.startX;if(f!==v||C!==S){if(this._editorBridgeService.refreshEditCellPosition(!0),!this._getEditorSkeleton())return;this.fitTextSize(e)}}_getEditorObject(){return ec(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}_getEditorSkeleton(){var e;return null==(e=this._renderManagerService.getRenderById(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))?void 0:e.with($.DocSkeletonManagerService).getSkeleton()}},el(ue,"SheetCellEditorResizeService"),ue);function cF(e){return e.startsWith("'")}function cj(e){return e.slice(1)}cB=cU([cL(1,J.ILayoutService),cL(2,sy),cL(3,tA),cL(4,x.IRenderManagerService),cL(5,(0,O.Inject)(ev))],cB),el(cF,"isForceString"),el(cj,"extractStringFromForceString");let cz={"":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9",:"A",:"B",:"C",:"D",:"E",:"F",:"G",:"H",:"I",:"J",:"K",:"L",:"M",:"N",:"O",:"P",:"Q",:"R",:"S",:"T",:"U",:"V",:"W",:"X",:"Y",:"Z",:"a",:"b",:"c",:"d",:"e",:"f",:"g",:"h",:"i",:"j",:"k",:"l",:"m",:"n",:"o",:"p",:"q",:"r",:"s",:"t",:"u",:"v",:"w",:"x",:"y",:"z","":"%","":"-","":".","":":","":"/","":"+","":"@","":"&","":"*","":"#","":"=","":">","":"<","":"$","":'"',"":"'","":"(","":")","":" ","":",","":"!","":"?","":";","":"[","":"]","":"{","":"}"},cX={true:"TRUE",false:"FALSE"};function cY(e){return[(0,O.LocaleType).ZH_CN,(0,O.LocaleType).ZH_TW].includes(e)}function cG(e,t,i,n){let r=e;if(cY(i)){if(e.startsWith("")||e.startsWith("'"))return`'${e.slice(1)}`;r=e.split("").map(cQ).join("")}if(r.startsWith("="))return cZ(e,r,t,n);let o=r.toLowerCase();return cX[o]?cX[o]:null==(0,O.numfmt).parseValue(r)?e:r}function cZ(e,t,i,n){let r=i.sequenceNodesBuilder(t);if(!r)return e;let o=t;return r.forEach((t,i)=>{if("object"==typeof t){let s=t.token;if(cX[s.toLowerCase()]){let e=t.startIndex+1,i=t.endIndex+2;o=cJ(s.toLocaleUpperCase(),o,e,i)}else if(t.nodeType===ei.sequenceNodeType.FUNCTION&&cK(s,n,r,i)||t.nodeType===ei.sequenceNodeType.REFERENCE){let e=s.indexOf("!");if(e>-1){let i=s.substring(e+1),n=t.startIndex+(e+1)+1,r=t.endIndex+2;o=cJ(i.toLocaleUpperCase(),o,n,r)}else{let e=t.startIndex+1,i=t.endIndex+2;o=cJ(s.toLocaleUpperCase(),o,e,i)}}else if(s.startsWith('"')&&s.endsWith('"')||s.startsWith("'")&&s.endsWith("'")){let i=t.startIndex+2,n=t.endIndex+1;o=cJ(e.slice(i,n),o,i,n)}else if(t.nodeType!==ei.sequenceNodeType.ARRAY&&null==(0,O.numfmt).parseValue(s)){let i=t.startIndex+1,n=t.endIndex+2;o=cJ(e.slice(i,n),o,i,n)}}}),o}function cK(e,t,i,n){let r=t.getDescriptions();return i[n+1]===ei.matchToken.OPEN_BRACKET&&void 0!==r.get(cq(e).toLocaleUpperCase())}function cq(e){return e.replace(/^@+/,"")}function cQ(e){return cz[e]||e}function cJ(e,t,i,n){return t.substring(0,i)+e+t.substring(n)}el(cY,"isCJKLocale"),el(cG,"normalizeString"),el(cZ,"normalizeFormulaString"),el(cK,"hasFunctionName"),el(cq,"removeLeadingAtSymbols"),el(cQ,"toHalfWidth"),el(cJ,"replaceString");let c$="range-selector",c0=/* @__PURE__ */el(e=>e.includes(c$),"isRangeSelector");var c1=Object.defineProperty,c2=Object.getOwnPropertyDescriptor,c5=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?c2(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&c1(t,i,o),o},"__decorateClass$G"),c9=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$G");let c6=(ut=class extends O.Disposable{constructor(e,t,i,n,r,o,s,l,a,d,c,u,h,m,g,p){super(),ea(this,"_cursorChange",0),ea(this,"_isUnitEditing",!1),ea(this,"_workbookSelections"),ea(this,"_d"),ea(this,"_cursorTimeout"),this._context=e,this._undoRedoService=i,this._contextService=n,this._instanceSrv=r,this._renderManagerService=o,this._editorBridgeService=s,this._cellEditorManagerService=l,this._lexerTreeBuilder=a,this._functionService=d,this._textSelectionManagerService=c,this._commandService=u,this._localService=h,this._editorService=m,this._sheetCellEditorResizeService=g,this._univerInstanceService=p,this._workbookSelections=t.getWorkbookSelections(this._context.unitId),this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{(null==e?void 0:e.getUnitId())===this._context.unitId?this._d=this._init():(this._disposeCurrent(),this._isUnitEditing&&(this._handleEditorInvisible({visible:!1,eventType:x.DeviceInputEventType.Keyboard,keycode:J.KeyCode.ESC,unitId:this._context.unitId}),this._isUnitEditing=!1))})),this._initEditorVisibilityListener()}dispose(){super.dispose(),this._disposeCurrent()}_disposeCurrent(){var e;null==(e=this._d)||e.dispose(),this._d=null}_init(){let e=new O.DisposableCollection;return this._subscribeToCurrentCell(e),this._initialCursorSync(e),this._listenEditorFocus(e),this._commandExecutedListener(e),this._initSkeletonListener(e),this.disposeWithMe(this._instanceSrv.unitDisposed$.subscribe(e=>{clearTimeout(this._cursorTimeout)})),this._cursorTimeout=setTimeout(()=>{this._cursorStateListener(e)},1e3),e}_initEditorVisibilityListener(){this.disposeWithMe(this._editorBridgeService.visible$.pipe((0,W.distinctUntilChanged)((e,t)=>e.visible===t.visible)).subscribe(e=>{(e.unitId===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY||e.unitId===this._context.unitId)&&e.visible?(this._isUnitEditing=!0,this._handleEditorVisible(e)):this._isUnitEditing&&(this._handleEditorInvisible(e),this._isUnitEditing=!1)}))}_listenEditorFocus(e){let t=this._getEditorObject();t&&e.add(t.document.onPointerDown$.subscribeEvent(()=>{if(this._isUnitEditing&&this._editorBridgeService.isVisible()){let e=this._editorBridgeService.getEditCellState(),t=this._editorBridgeService.getCurrentEditorId();e&&t&&this._editorService.isSheetEditor(t)&&this._sheetCellEditorResizeService.fitTextSize()}}))}_initialCursorSync(e){e.add(this._cellEditorManagerService.focus$.pipe((0,U.filter)(e=>!!e)).subscribe(()=>{var e;let t=null==(e=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_DOC))?void 0:e.with(M.DocSelectionRenderService);t&&t.sync()}))}_initSkeletonListener(e){let t=new Set(A.COMMAND_LISTENER_SKELETON_CHANGE);t.delete(A.SetWorksheetActiveOperation.id),e.add(this._commandService.onCommandExecuted(e=>{t.has(e.id)&&this._sheetCellEditorResizeService.resizeCellEditor(()=>{this._textSelectionManagerService.refreshSelection({unitId:O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,subUnitId:O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY})})}))}_subscribeToCurrentCell(e){e.add(this._editorBridgeService.currentEditCellState$.subscribe(e=>{var t;if(null==e||this._editorBridgeService.isForceKeepVisible())return;let i=this._editorBridgeService.getEditCellState();if(null==i)return;let{position:n,documentLayoutObject:r,scaleX:o,editorUnitId:s}=i;if(this._contextService.getContextValue(O.FOCUSING_EDITOR_STANDALONE)||this._contextService.getContextValue(O.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE)||this._instanceSrv.getUnit(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)===r.documentModel)return;let{startX:l,endX:a}=n,{textRotation:d,wrapStrategy:c,documentModel:u}=r,{vertexAngle:h}=(0,x.convertTextRotation)(d);u.updateDocumentId(s),c===O.WrapStrategy.WRAP&&0===h&&u.updateDocumentDataPageSize((a-l)/o),this._instanceSrv.changeDoc(s,u),this._contextService.setContextValue(O.FOCUSING_EDITOR_BUT_HIDDEN,!0),this._textSelectionManagerService.replaceTextRanges([{startOffset:0,endOffset:0}]);let m=null==(t=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_DOC))?void 0:t.with(M.DocSelectionRenderService);m&&m.activate(-1e3,-1e3,!document.activeElement||document.activeElement.classList.contains("univer-editor"))}))}_commandExecutedListener(e){let t=[$.RichTextEditingMutation.id,J.SetEditorResizeOperation.id];e.add(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){let{unitId:t}=e.params;!(!this._isCurrentSheetFocused()||!this._editorService.isSheetEditor(t)||c0(t))&&(this._editorBridgeService.changeEditorDirty(!0),this._editorBridgeService.isVisible().visible)&&t===O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._sheetCellEditorResizeService.fitTextSize()}}));let i=[i8.id];e.add(this._commandService.onCommandExecuted(e=>{if(i.includes(e.id)){let t=e.params,{keycode:i,isShift:n}=t;if(null!=i&&(2===this._cursorChange||this._contextService.getContextValue(O.FOCUSING_FX_BAR_EDITOR))){this._moveInEditor(i,n);return}this._editorBridgeService.changeVisible(t)}e.id===i4.id&&(this._cursorChange=2)}))}_handleEditorVisible(e){var t;let{eventType:i,keycode:n}=e;this._cursorChange=i===x.DeviceInputEventType.PointerDown||i===x.DeviceInputEventType.Dblclick?2:1;let r=this._editorBridgeService.getEditLocation();if(null==r)return;this._commandService.syncExecuteCommand(oU.id,{range:{startRow:r.row,startColumn:r.column,endRow:r.row,endColumn:r.column}}),this._editorBridgeService.refreshEditCellPosition(!1);let{documentLayoutObject:o,editorUnitId:s,unitId:l,sheetId:a,isInArrayFormulaRange:d=!1}=r,c=this._getEditorObject();if(null==c)return;this._setOpenForCurrent(l,a);let{document:u,scene:h}=c;this._contextService.setContextValue(O.EDITOR_ACTIVATED,!0);let{documentModel:m}=o,g=this._getEditorSkeleton(s);if(!(!g||!m)){if(this._sheetCellEditorResizeService.fitTextSize(()=>{let e=h.getViewport(M.VIEWPORT_KEY.VIEW_MAIN);null==e||e.scrollToViewportPos({viewportScrollX:Number.POSITIVE_INFINITY,viewportScrollY:Number.POSITIVE_INFINITY})}),i===x.DeviceInputEventType.Keyboard||i===x.DeviceInputEventType.Dblclick&&d)this._emptyDocumentDataModel(!!d),u.makeDirty(),(n===J.KeyCode.BACKSPACE||i===x.DeviceInputEventType.Dblclick)&&(g.calculate(),this._editorBridgeService.changeEditorDirty(!0)),this._textSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}]);else if(i===x.DeviceInputEventType.Dblclick){if(this._contextService.getContextValue(O.FOCUSING_EDITOR_INPUT_FORMULA))return;let e=m.getBody().dataStream.length-2||0;this._textSelectionManagerService.replaceDocRanges([{startOffset:e,endOffset:e}])}null==(t=this._renderManagerService.getRenderById(l))||t.scene.resetCursor()}}async _handleEditorInvisible(e){let t=this._editorBridgeService.getEditCellState(),{keycode:i}=e;if(this._setOpenForCurrent(null,null),this._cursorChange=0,this._exitInput(e),null==t)return;!1===this._editorBridgeService.getEditorDirty()&&(i=J.KeyCode.ESC);let n=this._context.unit.getActiveSheet(),r=this._context.unitId,o=n.getSheetId();if(i===J.KeyCode.ESC){this._editorBridgeService.isForceKeepVisible()&&this._editorBridgeService.disableForceKeepVisible();let e=this._workbookSelections.getCurrentSelections();e&&this._commandService.syncExecuteCommand(A.SetSelectionsOperation.id,{unitId:this._context.unit.getUnitId(),subUnitId:o,selections:e});return}let{unitId:s,sheetId:l}=t;r===s&&l!==o&&this._editorBridgeService.isForceKeepVisible()&&await this._commandService.executeCommand(A.SetWorksheetActivateCommand.id,{subUnitId:l,unitId:s});let a=t.documentLayoutObject.documentModel;a&&await this._submitCellData(a),this._moveCursor(i)}_setOpenForCurrent(e,t){for(let[i,n]of this._editorService.getAllEditor())n.isSheetEditor()&&(n.setOpenForSheetUnitId(e),n.setOpenForSheetSubUnitId(t))}_getEditorObject(){return ec(this._editorBridgeService.getCurrentEditorId(),this._renderManagerService)}submitCellData(e){return this._submitCellData(e)}async _submitCellData(e){let t=this._editorBridgeService.getEditCellState();if(null==t)return;let{unitId:i,sheetId:n,row:r,column:o}=t,s=this._context.unit,l=s.getActiveSheet();if(!s.getSheetBySheetId(n))return;let a=c3((l=s.getActiveSheet()).getCellRaw(r,o)||{},e,this._lexerTreeBuilder,e=>e.getSnapshot(),this._localService,this._functionService,s.getStyles());if(!a)return;let d=await this._editorBridgeService.beforeSetRangeValue(s,l,r,o,a);this._commandService.executeCommand(A.SetRangeValuesCommand.id,{subUnitId:n,unitId:i,range:{startRow:r,startColumn:o,endRow:r,endColumn:o},value:d})}_exitInput(e){var t;this._contextService.setContextValue(O.FOCUSING_EDITOR_INPUT_FORMULA,!1),this._contextService.setContextValue(O.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(O.FOCUSING_EDITOR_BUT_HIDDEN,!1),this._contextService.setContextValue(O.FOCUSING_FX_BAR_EDITOR,!1),this._cellEditorManagerService.setState({show:e.visible});let i=this._getEditorObject();null==(t=null==i?void 0:i.scene.getViewport(M.VIEWPORT_KEY.VIEW_MAIN))||t.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});let n=this._editorBridgeService.getCurrentEditorId();null!=n&&this._editorService.isSheetEditor(n)&&(this._undoRedoService.clearUndoRedo(n),this._undoRedoService.clearUndoRedo(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY))}_moveCursor(e){if(null==e||!dZ.includes(e))return;let t=O.Direction.LEFT;switch(e){case J.KeyCode.ENTER:t=O.Direction.DOWN;break;case J.KeyCode.TAB:t=O.Direction.RIGHT;break;case J.KeyCode.ARROW_DOWN:t=O.Direction.DOWN;break;case J.KeyCode.ARROW_UP:t=O.Direction.UP;break;case J.KeyCode.ARROW_LEFT:t=O.Direction.LEFT;break;case J.KeyCode.ARROW_RIGHT:t=O.Direction.RIGHT}e===J.KeyCode.ENTER||e===J.KeyCode.TAB?this._commandService.executeCommand(tc.id,{keycode:e,direction:t}):this._commandService.executeCommand(td.id,{direction:t})}_cursorStateListener(e){let t=this._getEditorObject();if(!t.document)return;let{document:i}=t;e.add((0,O.toDisposable)(i.onPointerDown$.subscribeEvent(()=>{1===this._cursorChange&&(this._cursorChange=2)})))}_moveInEditor(e,t){let i=O.Direction.LEFT;e===J.KeyCode.ARROW_DOWN?i=O.Direction.DOWN:e===J.KeyCode.ARROW_UP?i=O.Direction.UP:e===J.KeyCode.ARROW_RIGHT&&(i=O.Direction.RIGHT),t?this._commandService.executeCommand(M.MoveSelectionOperation.id,{direction:i}):this._commandService.executeCommand(M.MoveCursorOperation.id,{direction:i})}_isCurrentSheetFocused(){var e;return(null==(e=this._instanceSrv.getFocusedUnit())?void 0:e.getUnitId())===this._context.unitId}_getEditorSkeleton(e){var t;return null==(t=this._renderManagerService.getRenderById(e))?void 0:t.with($.DocSkeletonManagerService).getSkeleton()}_getEditorViewModel(e){var t;return null==(t=this._renderManagerService.getRenderById(e))?void 0:t.with($.DocSkeletonManagerService).getViewModel()}_emptyDocumentDataModel(e){let t=this._editorBridgeService.getEditCellState();if(null==t)return;let{documentLayoutObject:i}=t,n=i.documentModel;if(null==n)return;let r=/* @__PURE__ */el(t=>{let i=(0,O.Tools).deepClone(t.getSnapshot()),n=this._getEditorViewModel(t.getUnitId());null!=n&&(c8(i.body,e),t.reset(i),n.reset(t))},"empty");r(n);let o=this._univerInstanceService.getUnit(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,O.UniverInstanceType.UNIVER_DOC);o&&r(o)}},el(ut,"EditingRenderController"),ut);function c3(e,t,i,n,r,o,s){var l,a;if(e=(0,O.Tools).deepClone(e),null==t)return null;let d=n(t),{body:c}=d;if(null==c)return null;e.t=void 0;let u=c.dataStream,h=u.substring(u.length-2,u.length)===O.DEFAULT_EMPTY_DOCUMENT_VALUE?u.substring(0,u.length-2):u;if(h=cG(h,i,r.getCurrentLocale(),o),e.s&&(null==(a=null==(l=null==s?void 0:s.get(e.s))?void 0:l.n)?void 0:a.pattern)===en.DEFAULT_TEXT_FORMAT)e.v=h,e.f=null,e.si=null,e.p=null,e.t=O.CellValueType.STRING;else if((0,O.isFormulaString)(h)){if(e.f===h)return null;let t=i.checkIfAddBracket(h);for(let e=0;e<t;e++)h+=ei.matchToken.CLOSE_BRACKET;e.f=h,e.si=null,e.v=null,e.p=null}else if(cF(h)){let t=cj(h);e.v=t,e.f=null,e.si=null,e.p=null,e.t=O.CellValueType.FORCE_STRING}else if(c7(c))c.dataStream===`\r
`?(e.v="",e.f=null,e.si=null,e.p=null):(e.p=d,e.v=null,e.f=null,e.si=null);else if((0,O.numfmt).parseDate(h)||(0,O.numfmt).parseNumber(h)||(0,O.numfmt).parseTime(h))e.v=h,e.f=null,e.si=null,e.p=null,e.t=O.CellValueType.NUMBER;else{if(""===h&&null==e.v&&null==e.p)return null;e.v=h,e.f=null,e.si=null,e.p=null;let t=c4(d);t&&(e.s=t)}return e}function c7(e){let{textRuns:t=[],paragraphs:i=[],customRanges:n,customBlocks:r=[]}=e,o=e.dataStream.replace(`\r
`,""),s=["va"];return t.some(e=>{var t;return!!(e.ts&&Object.keys(e.ts).some(e=>s.includes(e)))||Object.keys(null!=(t=e.ts)?t:{}).length&&e.ed-e.st<o.length})||i.some(e=>e.bullet)||i.length>=2||!!(null!=n&&n.length)||r.length>0}function c4(e){let{body:t}=e;if(!t)return null;let{textRuns:i=[]}=t,n={},r=t.dataStream.replace(`\r
`,"");return i.forEach(e=>{let{st:t,ed:i,ts:o}=e;i-t>=r.length&&(n={...n,...o})}),Object.keys(n).length?n:null}function c8(e,t=!1){e.dataStream=O.DEFAULT_EMPTY_DOCUMENT_VALUE,null!=e.textRuns&&(1!==e.textRuns.length||t?e.textRuns=void 0:(e.textRuns[0].st=0,e.textRuns[0].ed=1)),null!=e.paragraphs&&(1===e.paragraphs.length?e.paragraphs[0].startIndex=0:e.paragraphs=[{startIndex:0}]),null!=e.sectionBreaks&&(e.sectionBreaks=void 0),null!=e.tables&&(e.tables=void 0),null!=e.customRanges&&(e.customRanges=void 0),null!=e.customBlocks&&(e.customBlocks=void 0)}c6=c5([c9(1,(0,O.Inject)(A.SheetsSelectionsService)),c9(2,O.IUndoRedoService),c9(3,O.IContextService),c9(4,O.IUniverInstanceService),c9(5,x.IRenderManagerService),c9(6,tA),c9(7,sy),c9(8,(0,O.Inject)(ei.LexerTreeBuilder)),c9(9,ei.IFunctionService),c9(10,(0,O.Inject)($.DocSelectionManagerService)),c9(11,O.ICommandService),c9(12,(0,O.Inject)(O.LocaleService)),c9(13,M.IEditorService),c9(14,(0,O.Inject)(cB)),c9(15,O.IUniverInstanceService)],c6),el(c3,"getCellDataByInput"),el(c7,"isRichText"),el(c4,"getCellStyleBySnapshot"),el(c8,"resetBodyStyle");var ue,ut,ui,un=Object.defineProperty,ur=Object.getOwnPropertyDescriptor,uo=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?ur(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&un(t,i,o),o},"__decorateClass$F"),us=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$F");let ul=(el(ui=class extends eY{constructor(e,t,i,n,r,o,s,l,a){super(t,i,n,o),ea(this,"_workbookSelections"),ea(this,"_renderDisposable",null),this._context=e,this._logService=s,this._commandService=l,this._contextService=a,this._workbookSelections=r.getWorkbookSelections(this._context.unitId),this._init()}_init(){let e=this._getSheetObject();this._initEventListeners(e),this._initSelectionChangeListener(),this._initThemeChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener()}_initEventListeners(e){let{spreadsheetRowHeader:t,spreadsheetColumnHeader:i,spreadsheet:n,spreadsheetLeftTopPlaceholder:r}=e,{scene:o}=this._context;this.disposeWithMe(null==n?void 0:n.onPointerDown$.subscribeEvent((e,t)=>{this._normalSelectionDisabled()||(this._onPointerDown(e,n.zIndex+1,O.RANGE_TYPE.NORMAL,this._getActiveViewport(e)),2!==e.button&&t.stopPropagation())})),this.disposeWithMe(null==t?void 0:t.onPointerDown$.subscribeEvent((e,t)=>{if(this._normalSelectionDisabled())return;let i=this._sheetSkeletonManagerService.getCurrent().skeleton,{row:r}=tv(e.offsetX,e.offsetY,o,i);du(this._workbookSelections.getCurrentSelections(),r)||(this._onPointerDown(e,(n.zIndex||1)+1,O.RANGE_TYPE.ROW,this._getActiveViewport(e),x.ScrollTimerType.Y),2!==e.button&&t.stopPropagation())})),this.disposeWithMe(null==i?void 0:i.onPointerDown$.subscribeEvent((e,t)=>{if(this._normalSelectionDisabled())return;let i=this._sheetSkeletonManagerService.getCurrent().skeleton,{column:r}=tv(e.offsetX,e.offsetY,o,i);dh(this._workbookSelections.getCurrentSelections(),r)||(this._onPointerDown(e,(n.zIndex||1)+1,O.RANGE_TYPE.COLUMN,this._getActiveViewport(e),x.ScrollTimerType.X),2!==e.button&&t.stopPropagation())})),this.disposeWithMe(null==r?void 0:r.onPointerDown$.subscribeEvent((e,t)=>{if(this._normalSelectionDisabled())return;this._reset();let i=this._sheetSkeletonManagerService.getCurrent().skeleton,n=eF(eG(i),i);this._addSelectionControlBySelectionData(n),this.refreshSelectionMoveEnd(),2!==e.button&&t.stopPropagation()}))}_initThemeChangeListener(){this.disposeWithMe(this._themeService.currentTheme$.subscribe(()=>{this._resetSelectionStyle();let e=this._workbookSelections.getCurrentSelections();e&&this._refreshSelectionControl(e)}))}_normalSelectionDisabled(){return this._contextService.getContextValue(A.DISABLE_NORMAL_SELECTIONS)}_initSelectionChangeListener(){this.disposeWithMe((0,B.merge)(this._workbookSelections.selectionMoveEnd$,this._workbookSelections.selectionSet$).subscribe(e=>{for(let t of(this._reset(),e)){let e=eF(t,this._skeleton);this._addSelectionControlBySelectionData(e)}}))}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe(e=>this._updateSelections(e,A.SelectionMoveType.MOVE_START))),this.disposeWithMe(this.selectionMoving$.subscribe(e=>this._updateSelections(e,A.SelectionMoveType.MOVING))),this.disposeWithMe(this._contextService.subscribeContextValue$(A.DISABLE_NORMAL_SELECTIONS).pipe((0,X.startWith)(!1),(0,W.distinctUntilChanged)()).subscribe(e=>{var t;e?(null==(t=this._renderDisposable)||t.dispose(),this._renderDisposable=null,this._reset()):this._renderDisposable=(0,O.toDisposable)(this.selectionMoveEnd$.subscribe(e=>this._updateSelections(e,A.SelectionMoveType.MOVE_END)))}))}_updateSelections(e,t){let i=this._context.unit,n=i.getUnitId(),r=i.getActiveSheet().getSheetId();0!==e.length&&this._commandService.executeCommand(A.SetSelectionsOperation.id,{unitId:n,subUnitId:r,type:t,selections:e.map(e=>(0,A.convertSelectionDataToRange)(e))})}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{var t,i;if(null==e){this._logService.error("[SelectionRenderService]: should not receive null!");return}let n=this._context.unitId,{sheetId:r,skeleton:o}=e,{scene:s}=this._context,l=s.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),a=null==(i=null==(t=this._skeleton)?void 0:t.worksheet)?void 0:i.getSheetId();if(this._changeRuntime(o,s,l),this._normalSelectionDisabled())return;if(a!==o.worksheet.getSheetId()){let e=this._workbookSelections.getCurrentSelections();this._commandService.syncExecuteCommand(A.SetSelectionsOperation.id,{unitId:n,subUnitId:r,selections:0!==e.length?e:[eZ(o)]})}let d=this._workbookSelections.getCurrentSelections();null!=d&&this._refreshSelectionControl(d)}))}_getActiveViewport(e){let t=this._getSheetObject();return null==t?void 0:t.scene.getActiveViewportByCoord((0,x.Vector2).FromArray([e.offsetX,e.offsetY]))}_getSheetObject(){return tg(this._context.unit,this._context)}},"SheetSelectionRenderService"),ui);ul=uo([us(1,(0,O.Inject)(O.Injector)),us(2,(0,O.Inject)(O.ThemeService)),us(3,J.IShortcutService),us(4,(0,O.Inject)(A.SheetsSelectionsService)),us(5,(0,O.Inject)(ev)),us(6,O.ILogService),us(7,O.ICommandService),us(8,O.IContextService)],ul);var ua,ud=Object.defineProperty,uc=Object.getOwnPropertyDescriptor,uu=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?uc(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&ud(t,i,o),o},"__decorateClass$E"),uh=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$E");let um=(el(ua=class extends O.Disposable{constructor(e,t){super(),ea(this,"_previousSheetIndex",-1),this._commandService=e,this._univerInstanceService=t,this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===A.RemoveSheetMutation.id)return this._beforeAdjustActiveSheetOnRemoveSheet(e)})),this.disposeWithMe(this._commandService.onCommandExecuted((e,t)=>e.id===A.RemoveSheetMutation.id?this._adjustActiveSheetOnRemoveSheet(e):e.id===A.SetWorksheetHideMutation.id&&e.params.hidden?this._adjustActiveSheetOnHideSheet(e):(null==t||!t.fromCollab)&&(e.id===A.InsertSheetMutation.id?this._adjustActiveSheetOnInsertSheet(e):e.id!==A.SetWorksheetHideMutation.id||e.params.hidden?e.id===A.SetSelectionsOperation.id?this._adjustActiveSheetOnSelection(e):void 0:this._adjustActiveSheetOnShowSheet(e))))}_adjustActiveSheetOnHideSheet(e){var t;let{unitId:i,subUnitId:n}=e.params,r=this._univerInstanceService.getUniverSheetInstance(i);if(!r||(null==(t=r.getActiveSheet())?void 0:t.getSheetId())!==n)return;let o=r.getActiveSheetIndex(),s=ug(r,o);this._switchToNextSheet(i,s)}_beforeAdjustActiveSheetOnRemoveSheet(e){let{unitId:t,subUnitId:i}=e.params,n=this._univerInstanceService.getUniverSheetInstance(t);if(!n)return;let r=n.getSheetBySheetId(i);r&&(this._previousSheetIndex=n.getSheetIndex(r))}_adjustActiveSheetOnRemoveSheet(e){if(-1===this._previousSheetIndex)return;let{unitId:t}=e.params,i=this._univerInstanceService.getUniverSheetInstance(t);if(i&&i.getActiveSheet().getSheetId()===e.params.subUnitId){let e=this._previousSheetIndex,n=ug(i,e>=1?e-1:0);this._switchToNextSheet(t,n)}}_adjustActiveSheetOnInsertSheet(e){let{unitId:t,sheet:i}=e.params;this._switchToNextSheet(t,i.id)}_adjustActiveSheetOnShowSheet(e){let{unitId:t,subUnitId:i}=e.params;this._switchToNextSheet(t,i)}_adjustActiveSheetOnSelection(e){var t;let{unitId:i,subUnitId:n}=e.params;n!==(null==(t=this._univerInstanceService.getUnit(i))?void 0:t.getActiveSheet().getSheetId())&&this._switchToNextSheet(i,n)}_switchToNextSheet(e,t){this._commandService.executeCommand(A.SetWorksheetActiveOperation.id,{unitId:e,subUnitId:t})}},"ActiveWorksheetController"),ua);function ug(e,t){let i=e.getSheetSize();for(let i=t;i>-1;i--){let t=e.getSheetByIndex(i);if(!t.getConfig().hidden)return t.getSheetId()}for(let n=t;n<i;n++){let t=e.getSheetByIndex(n);if(!t.getConfig().hidden)return t.getSheetId()}throw Error("[ActiveWorksheetController]: could not find the next unhidden sheet! Collaboration error perhaps.")}um=uu([uh(0,O.ICommandService),uh(1,O.IUniverInstanceService)],um),el(ug,"findTheNextUnhiddenSheet");var up,uv=Object.defineProperty,uS=Object.getOwnPropertyDescriptor,uf=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?uS(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&uv(t,i,o),o},"__decorateClass$D"),uC=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$D");let uI=(up=class extends O.Disposable{constructor(e,t,i,n,r){super(),this._globalPopupManagerService=e,this._renderManagerService=t,this._univerInstanceService=i,this._refRangeService=n,this._commandService=r}_createPositionObserver(e,t,i,n){let r=/* @__PURE__ */el(()=>{let{scene:r}=t,o=rl(e,r,i,n),s=t.engine.getCanvasElement(),l=s.getBoundingClientRect(),a=ub(s.style.width),d=l.width/a;return{left:o.left*d+l.left,right:o.right*d+l.left,top:o.top*d+l.top,bottom:o.bottom*d+l.top}},"calc"),o=r(),s=new k.BehaviorSubject(o),l=new O.DisposableCollection;return l.add(this._commandService.onCommandExecuted(e=>{(e.id===ey.id||e.id===na.id)&&s.next(r())})),{position:o,position$:s,disposable:l}}attachPopupToObject(e,t){var i;let n=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),r=n.getActiveSheet();if(!r)return{dispose:/* @__PURE__ */el(()=>{},"dispose"),canDispose:/* @__PURE__ */el(()=>!0,"canDispose")};let o=n.getUnitId(),s=r.getSheetId(),l=null==(i=this._renderManagerService.getRenderById(o))?void 0:i.with(ev).getOrCreateSkeleton({sheetId:s}),a=this._renderManagerService.getRenderById(o);if(!a||!l)return{dispose:/* @__PURE__ */el(()=>{},"dispose"),canDispose:/* @__PURE__ */el(()=>!0,"canDispose")};let{left:d,top:c,width:u,height:h}=e,{position:m,position$:g,disposable:p}=this._createPositionObserver({left:d,right:d+u,top:c,bottom:c+h},a,l,r),v=this._globalPopupManagerService.addPopup({...t,unitId:o,subUnitId:s,anchorRect:m,anchorRect$:g,canvasElement:a.engine.getCanvasElement()});return{dispose:/* @__PURE__ */el(()=>{this._globalPopupManagerService.removePopup(v),g.complete(),p.dispose()},"dispose"),canDispose:/* @__PURE__ */el(()=>this._globalPopupManagerService.activePopupId!==v,"canDispose")}}attachPopupByPosition(e,t,i,n){var r;let o=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),s=o.getActiveSheet();if(!s)return null;let l=o.getUnitId(),a=s.getSheetId();if(i&&l!==i||n&&n!==a)return null;let d=null==(r=this._renderManagerService.getRenderById(l))?void 0:r.with(ev).getOrCreateSkeleton({sheetId:a}),c=this._renderManagerService.getRenderById(l);if(!c||!d)return null;let{position:u,position$:h,disposable:m}=this._createPositionObserver(e,c,d,s),g=this._globalPopupManagerService.addPopup({...t,unitId:l,subUnitId:a,anchorRect:u,anchorRect$:h,canvasElement:c.engine.getCanvasElement()});return{dispose:/* @__PURE__ */el(()=>{this._globalPopupManagerService.removePopup(g),h.complete(),m.dispose()},"dispose"),canDispose:/* @__PURE__ */el(()=>this._globalPopupManagerService.activePopupId!==g,"canDispose")}}attachPopupToAbsolutePosition(e,t,i,n){var r;let o=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),s=o.getActiveSheet();if(!s)return null;let l=o.getUnitId(),a=s.getSheetId();if(i&&l!==i||n&&n!==a)return null;let d=null==(r=this._renderManagerService.getRenderById(l))?void 0:r.with(ev).getOrCreateSkeleton({sheetId:a}),c=this._renderManagerService.getRenderById(l);if(!c||!d)return null;let u=new k.BehaviorSubject(e),h=this._globalPopupManagerService.addPopup({...t,unitId:l,subUnitId:a,anchorRect:e,anchorRect$:u.asObservable(),canvasElement:c.engine.getCanvasElement()});return{dispose:/* @__PURE__ */el(()=>{this._globalPopupManagerService.removePopup(h),u.complete()},"dispose"),canDispose:/* @__PURE__ */el(()=>this._globalPopupManagerService.activePopupId!==h,"canDispose")}}attachPopupToCell(e,t,i,n,r,o,s=!1){let l=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),a=l.getActiveSheet();if(!a)return null;let d=l.getUnitId(),c=a.getSheetId();if(n&&d!==n||r&&c!==r)return null;let u=this._renderManagerService.getRenderById(d),h=null==u?void 0:u.with(ev).getOrCreateSkeleton({sheetId:c}),m=null==u?void 0:u.with(ez);if(!u||!h||!m)return null;if(m.selectionMoving&&!s)return;let g=null!=o?o:rs(e,t,u.scene,a);if(!g)return null;let{position:p,position$:v,disposable:S,updateRowCol:f}=this._createCellPositionObserver(e,t,u,h,g),C=this._globalPopupManagerService.addPopup({...i,unitId:d,subUnitId:c,anchorRect:p,anchorRect$:v,canvasElement:u.engine.getCanvasElement()}),I=new O.DisposableCollection;return I.add(S),I.add((0,O.toDisposable)(()=>{this._globalPopupManagerService.removePopup(C),v.complete()})),I.add(this._refRangeService.watchRange(d,c,{startRow:e,endRow:e,startColumn:t,endColumn:t},(e,t)=>{t?f(t.startRow,t.startColumn):I.dispose()})),{dispose(){I.dispose()},canDispose:/* @__PURE__ */el(()=>this._globalPopupManagerService.activePopupId!==C,"canDispose")}}_createCellPositionObserver(e,t,i,n,r){let o=e,s=t,l=this._calcCellPositionByCell(o,s,i,n,r),a=new k.BehaviorSubject(l),d=/* @__PURE__ */el(()=>a.next(this._calcCellPositionByCell(o,s,i,n,r)),"updatePosition"),c=new O.DisposableCollection;return c.add(i.engine.clientRect$.subscribe(()=>d())),c.add(this._commandService.onCommandExecuted(e=>{if(e.id===A.SetWorksheetRowAutoHeightMutation.id&&e.params.rowsAutoHeightInfo.findIndex(e=>e.row===o)>-1){d();return}((0,A.COMMAND_LISTENER_SKELETON_CHANGE).indexOf(e.id)>-1||e.id===ey.id||e.id===na.id)&&d()})),{position$:a,disposable:c,position:l,updateRowCol:/* @__PURE__ */el((e,t)=>{o=e,s=t,d()},"updateRowCol")}}_calcCellPositionByCell(e,t,i,n,r){let{scene:o,engine:s}=i,l=n.getCellByIndex(e,t),a=l.isMergedMainCell?l.mergeInfo:l,{scaleX:d,scaleY:c}=o.getAncestorScale(),u={x:r.viewportScrollX,y:r.viewportScrollY},h=s.getCanvasElement(),m=h.getBoundingClientRect(),g=ub(h.style.width),{top:p,left:v,width:S}=m,f=S/g;return{left:(a.startX-u.x)*f*d+v,right:(a.endX-u.x)*f*d+v,top:(a.startY-u.y)*f*c+p,bottom:(a.endY-u.y)*f*c+p}}},el(up,"SheetCanvasPopManagerService"),up);function ub(e){return Number.parseInt(e.replace("px",""))}uI=uf([uC(0,(0,O.Inject)(J.ICanvasPopupService)),uC(1,x.IRenderManagerService),uC(2,O.IUniverInstanceService),uC(3,(0,O.Inject)(A.RefRangeService)),uC(4,O.ICommandService)],uI),el(ub,"pxToNum");var u_,uR=Object.defineProperty,uy=Object.getOwnPropertyDescriptor,uT=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?uy(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&uR(t,i,o),o},"__decorateClass$C"),uE=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$C"),uw=((T=uw||{})[T.INFO=0]="INFO",T[T.WARNING=1]="WARNING",T[T.ERROR=2]="ERROR",T);let uP=(el(u_=class extends O.Disposable{constructor(e,t){super(),ea(this,"_currentAlert$",new Y.Subject),ea(this,"_currentAlert",/* @__PURE__ */new Map),ea(this,"currentAlert$",this._currentAlert$.asObservable()),this._renderManagerService=e,this._canvasPopManagerService=t,this.disposeWithMe(()=>{this._currentAlert$.complete()})}get currentAlert(){return this._currentAlert}showAlert(e){let t=this._currentAlert.get(e.key);t&&t.dispose.dispose(),t?t.dispose.dispose():(t={alert:e,dispose:{dispose(){}}},this._currentAlert.set(e.key,t));let{location:i}=e,{row:n,col:r,unitId:o}=i;if(!this._renderManagerService.getRenderById(o))return;let s=this._canvasPopManagerService.attachPopupToCell(n,r,{componentKey:ux,direction:"horizontal",offset:[2,0],extraProps:{alert:e}});s&&(t.dispose=s),this._currentAlert$.next(Array.from(this._currentAlert.entries()))}removeAlert(e){let t=this._currentAlert.get(e);t&&(this._currentAlert.delete(e),null==t||t.dispose.dispose(),this._currentAlert$.next(Array.from(this._currentAlert.entries())))}clearAlert(){this._currentAlert.forEach(e=>{e.dispose.dispose()}),this._currentAlert.clear(),this._currentAlert$.next(Array.from(this._currentAlert.entries()))}},"CellAlertManagerService"),u_);uP=uT([uE(0,x.IRenderManagerService),uE(1,(0,O.Inject)(uI))],uP);let uM={cellAlert:"univer-cell-alert",cellAlertTitle:"univer-cell-alert-title",cellAlertIcon:"univer-cell-alert-icon",cellAlertIconError:"univer-cell-alert-icon-error",cellAlertIconInfo:"univer-cell-alert-icon-info",cellAlertIconWarning:"univer-cell-alert-icon-warning",cellAlertContent:"univer-cell-alert-content"};function uO({popup:e}){var t;let i=null==(t=e.extraProps)?void 0:t.alert;if(!i)return null;let{type:n,title:r,message:o}=i,s={[uw.ERROR]:/* @__PURE__ */o$.jsx(nB,{className:sg(uM.cellAlertIcon,uM.cellAlertIconError)}),[uw.INFO]:/* @__PURE__ */o$.jsx(n7,{className:sg(uM.cellAlertIcon,uM.cellAlertIconInfo)}),[uw.WARNING]:/* @__PURE__ */o$.jsx(n7,{className:sg(uM.cellAlertIcon,uM.cellAlertIconWarning)})};return /* @__PURE__ */o$.jsxs("div",{className:uM.cellAlert,children:[/* @__PURE__ */o$.jsxs("div",{className:uM.cellAlertTitle,children:[n?s[n]:null,r]}),/* @__PURE__ */o$.jsx("div",{className:uM.cellAlertContent,children:o})]})}el(uO,"CellAlert");let ux="univer.sheet.cell-alert";var uA,uk=Object.defineProperty,uN=Object.getOwnPropertyDescriptor,uD=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?uN(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&uk(t,i,o),o},"__decorateClass$B"),uV=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$B");let uW=(el(uA=class extends O.Disposable{constructor(e,t){super(),this._context=e,this._componentManager=t,this._initComponent()}_initComponent(){this._componentManager.register(ux,uO)}},"CellAlertRenderController"),uA);uW=uD([uV(1,(0,O.Inject)(J.ComponentManager))],uW);var uH,uU=Object.defineProperty,uL=Object.getOwnPropertyDescriptor,uB=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?uL(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&uU(t,i,o),o},"__decorateClass$A"),uF=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$A");let uj=(el(uH=class extends O.Disposable{constructor(e,t){super(),ea(this,"_currentCell$",new k.BehaviorSubject(null)),ea(this,"_currentRichText$",new k.BehaviorSubject(null)),ea(this,"_currentClickedCell$",new Y.Subject),ea(this,"currentCell$",this._currentCell$.asObservable().pipe((0,W.distinctUntilChanged)((e,t)=>{var i,n,r,o,s,l,a,d;return(null==(i=null==e?void 0:e.location)?void 0:i.unitId)===(null==(n=null==t?void 0:t.location)?void 0:n.unitId)&&(null==(r=null==e?void 0:e.location)?void 0:r.subUnitId)===(null==(o=null==t?void 0:t.location)?void 0:o.subUnitId)&&(null==(s=null==e?void 0:e.location)?void 0:s.row)===(null==(l=null==t?void 0:t.location)?void 0:l.row)&&(null==(a=null==e?void 0:e.location)?void 0:a.col)===(null==(d=null==t?void 0:t.location)?void 0:d.col)}))),ea(this,"currentRichText$",this._currentRichText$.pipe((0,W.distinctUntilChanged)((e,t)=>{var i,n,r,o,s,l,a,d,c,u,h,m;return(null==(i=null==e?void 0:e.location)?void 0:i.unitId)===(null==(n=null==t?void 0:t.location)?void 0:n.unitId)&&(null==(r=null==e?void 0:e.location)?void 0:r.subUnitId)===(null==(o=null==t?void 0:t.location)?void 0:o.subUnitId)&&(null==(s=null==e?void 0:e.location)?void 0:s.row)===(null==(l=null==t?void 0:t.location)?void 0:l.row)&&(null==(a=null==e?void 0:e.location)?void 0:a.col)===(null==(d=null==t?void 0:t.location)?void 0:d.col)&&(null==(c=null==e?void 0:e.customRange)?void 0:c.rangeId)===(null==(u=null==t?void 0:t.customRange)?void 0:u.rangeId)&&(null==(h=null==e?void 0:e.bullet)?void 0:h.startIndex)===(null==(m=null==t?void 0:t.bullet)?void 0:m.startIndex)}),(0,L.map)(e=>e&&{unitId:e.location.unitId,subUnitId:e.location.subUnitId,row:e.location.row,col:e.location.col,customRange:e.customRange,bullet:e.bullet,rect:e.rect}))),ea(this,"currentPosition$",this._currentCell$.asObservable()),ea(this,"currentClickedCell$",this._currentClickedCell$.asObservable()),this._univerInstanceService=e,this._renderManagerService=t,this._initCellDisposableListener()}dispose(){super.dispose(),this._currentCell$.complete(),this._currentClickedCell$.complete()}_initCellDisposableListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{e||this._currentCell$.next(null)}))}_calcActiveCell(e,t,i){var n,r;let o=this._univerInstanceService.getUnit(e,O.UniverInstanceType.UNIVER_SHEET);if(!o)return null;let s=o.getActiveSheet();if(!s)return null;let l=this._renderManagerService.getRenderById(o.getUnitId());if(!l)return null;let a=l.with(ev).getWorksheetSkeleton(s.getSheetId());if(!a)return null;let d=l.with(eR),c=null==d?void 0:d.getCurrentScrollState(),u=null==a?void 0:a.skeleton;if(!u||!c||!l)return;let h=rc(l,o,s,a,t,i);if(!h)return null;let{position:m,overflowLocation:g,location:p}=h,v=u.getFont(g.row,g.col),S=null,f=null,C=u.getCellByIndex(g.row,g.col),I=s.getCell(g.row,g.col),{topOffset:b=0,leftOffset:_=0}=null!=(n=null==I?void 0:I.fontRenderExtension)?n:{};if(v){let{paddingLeft:e,paddingTop:n}=t1(C,v),r=t0(v.documentSkeleton,e,n),o=t-m.startX-_,s=i-m.startY-b;S=r.links.find(e=>e.rects.some(e=>e.left<=o&&o<=e.right&&e.top<=s&&s<=e.bottom)),f=r.checkLists.find(e=>e.rect.left<=o&&o<=e.rect.right&&e.rect.top<=s&&s<=e.rect.bottom)}let R=null!=(r=null==S?void 0:S.rects.pop())?r:null==f?void 0:f.rect;return{location:p,position:m,overflowLocation:g,customRange:null==S?void 0:S.range,bullet:null==f?void 0:f.paragraph,rect:R&&{top:R.top+C.mergeInfo.startY+b,bottom:R.bottom+C.mergeInfo.startY+b,left:R.left+C.mergeInfo.startX+_,right:R.right+C.mergeInfo.startX+_}}}triggerMouseMove(e,t,i){let n=this._calcActiveCell(e,t,i);this._currentCell$.next(n&&{location:n.location,position:n.position}),this._currentRichText$.next(n&&{...n,location:n.overflowLocation})}triggerClick(e,t,i){let n=this._calcActiveCell(e,t,i);n&&this._currentClickedCell$.next(n)}triggerScroll(){this._currentCell$.next(null)}},"HoverManagerService"),uH);uj=uB([uF(0,O.IUniverInstanceService),uF(1,x.IRenderManagerService)],uj);var uz,uX=Object.defineProperty,uY=Object.getOwnPropertyDescriptor,uG=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?uY(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&uX(t,i,o),o},"__decorateClass$z"),uZ=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$z");let uK=(el(uz=class extends O.Disposable{constructor(e,t,i){super(),ea(this,"_isPointer",!1),this._hoverManagerService=e,this._commandService=t,this._renderManagerService=i,this._initPointerEvent(),this._initHover()}get _mainComponent(){var e;return null==(e=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_SHEET))?void 0:e.mainComponent}_initHover(){this.disposeWithMe(this._hoverManagerService.currentRichText$.subscribe(e=>{var t,i;null!=e&&e.bullet?(this._isPointer||null==(t=this._mainComponent)||t.setCursor(x.CURSOR_TYPE.POINTER),this._isPointer=!0):(this._isPointer&&(null==(i=this._mainComponent)||i.setCursor(x.CURSOR_TYPE.AUTO)),this._isPointer=!1)}))}_initPointerEvent(){this.disposeWithMe(this._hoverManagerService.currentClickedCell$.subscribe(e=>{let{location:t,bullet:i}=e;i&&this._commandService.executeCommand(A.ToggleCellCheckboxCommand.id,{unitId:t.unitId,subUnitId:t.subUnitId,row:t.row,col:t.col,paragraphIndex:i.startIndex})}))}},"SheetCheckboxController"),uz);function uq(e,t,i,n,r){let o=[],s=[];if(n.copyType===lO.CUT){let{undos:i,redos:n}=uQ(e,t,r);o.push(...n),s.push(...i)}else{let{undos:n,redos:l}=u1(t,i,r);o.push(...l),s.push(...n);let{undos:a,redos:d}=uJ(t,e,i,r);o.push(...d),s.push(...a);let{undos:c,redos:u}=u0(t,i,r,!0);o.push(...u),s.push(...c);let{undos:h,redos:m}=u$(t,e,i,r);o.push(...m),s.push(...h);let{undos:g,redos:p}=u2(t,i,r);o.push(...p),s.push(...g)}return{undos:s,redos:o}}function uQ(e,t,i){let n=[],r=[],{range:o,subUnitId:s,unitId:l}=e,{range:a,subUnitId:d}=t,c=a?it(a):null,u=o?it(o):null;if(u&&c){let e=i.get(O.IUniverInstanceService),t=i.get(A.SheetInterceptorService),o=e.getUniverSheetInstance(l),a=null==o?void 0:o.getSheetBySheetId(s),h=null==o?void 0:o.getSheetBySheetId(d);if(a&&h){let e=new O.ObjectMatrix,i=new O.ObjectMatrix,o=a.getCellMatrix(),m=h.getCellMatrix();(0,O.Range).foreach(u,(t,n)=>{e.setValue(t,n,(0,O.Tools).deepClone(o.getValue(t,n))),i.setValue(t,n,null)});let g=new O.ObjectMatrix;(0,O.Range).foreach(c,(e,t)=>{g.setValue(e,t,(0,O.Tools).deepClone(m.getValue(e,t)))});let p=new O.ObjectMatrix;(0,O.Range).foreach(u,(e,t)=>{let i=(0,O.cellToRange)(e,t),n=(0,O.Rectangle).getRelativeRange(i,u),r=(0,O.Rectangle).getPositionRange(n,c);p.setValue(r.startRow,r.startColumn,o.getValue(e,t))});let v={fromRange:u,toRange:c,from:{value:i.getMatrix(),subUnitId:s},to:{value:p.getMatrix(),subUnitId:d},unitId:l},S={fromRange:c,toRange:u,from:{value:e.getMatrix(),subUnitId:s},to:{value:g.getMatrix(),subUnitId:d},unitId:l},f=t.onCommandExecute({id:A.MoveRangeCommand.id,params:{toRange:c,fromRange:u}}),C=a.getMergeData(),I=h.getMergeData(),b=C.filter(e=>(0,O.Rectangle).intersects(e,u)),_=I.filter(e=>(0,O.Rectangle).intersects(e,c)),R=b.map(e=>(0,O.Rectangle).getRelativeRange(e,u)).map(e=>(0,O.Rectangle).getPositionRange(e,c)),y=(0,A.getAddMergeMutationRangeByType)(R).filter(e=>!I.some(t=>(0,O.Rectangle).equals(e,t))),T=[{id:A.RemoveWorksheetMergeMutation.id,params:{unitId:l,subUnitId:s,ranges:b}},{id:A.RemoveWorksheetMergeMutation.id,params:{unitId:l,subUnitId:s,ranges:_}},{id:A.AddWorksheetMergeMutation.id,params:{unitId:l,subUnitId:d,ranges:y}}],E=[{id:A.RemoveWorksheetMergeMutation.id,params:{unitId:l,subUnitId:d,ranges:y}},{id:A.AddWorksheetMergeMutation.id,params:{unitId:l,subUnitId:d,ranges:_}},{id:A.AddWorksheetMergeMutation.id,params:{unitId:l,subUnitId:s,ranges:b}}];n=[{id:A.MoveRangeMutation.id,params:v},...f.redos,...T,{id:A.SetSelectionsOperation.id,params:{unitId:l,subUnitId:d,selections:[{range:c}]}}],r=[{id:A.MoveRangeMutation.id,params:S},...f.undos,...E,{id:A.SetSelectionsOperation.id,params:{unitId:l,sheetId:s,selections:[{range:u}]}}]}}return{undos:r,redos:n}}function uJ(e,t,i,n){let{unitId:r,subUnitId:o,range:s}=e,l=[],a=[],{mapFunc:d}=ii([s]),c=new O.ObjectMatrix;i.forValue((e,i,n)=>{var r;let o;if(!n.p&&n.v&&!t){let e=String(n.v),t=(0,O.numfmt).parseValue(e);(null==t?void 0:t.v)!==void 0&&"number"==typeof t.v&&(o=t.v)}let{row:s,col:l}=d(e,i);null!=(r=n.p)&&r.body?c.setValue(s,l,(0,O.Tools).deepClone({p:n.p,v:null!=o?o:n.v})):c.setValue(s,l,(0,O.Tools).deepClone({v:null!=o?o:n.v,t:n.t}))});let u={unitId:r,subUnitId:o,cellValue:(0,O.Tools).deepClone(c.getMatrix())};l.push({id:A.SetRangeValuesMutation.id,params:u});let h=(0,A.SetRangeValuesUndoMutationFactory)(n,u);return a.push({id:A.SetRangeValuesMutation.id,params:h}),{undos:a,redos:l}}function u$(e,t,i,n){let{unitId:r,subUnitId:o,range:s}=e,l=[],a=[],{mapFunc:d}=ii([s]),c=new O.ObjectMatrix;i.forValue((e,t,i)=>{let{row:n,col:r}=d(e,t);i.custom&&c.setValue(n,r,(0,O.Tools).deepClone({custom:i.custom}))});let u={unitId:r,subUnitId:o,cellValue:(0,O.Tools).deepClone(c.getMatrix())};l.push({id:A.SetRangeValuesMutation.id,params:u});let h=(0,A.SetRangeValuesUndoMutationFactory)(n,u);return a.push({id:A.SetRangeValuesMutation.id,params:h}),{undos:a,redos:l}}function u0(e,t,i,n=!1){let r=[],o=[],{unitId:s,subUnitId:l,range:a}=e,d=new O.ObjectMatrix,{mapFunc:c}=ii([a]);t.forValue((e,t,i)=>{var r,o;let s={s:Object.assign({},{...O.DEFAULT_STYLES,pd:x.DEFAULT_PADDING_DATA,bg:null,cl:null},i.s)};n&&null!=(r=i.p)&&r.body&&(s.p=i.p);let l=String(i.v),a=(0,O.numfmt).parseValue(l);null!=a&&a.z&&(s.s||(s.s={}),"object"==typeof s.s&&(null!=(o=s.s)&&o.n?s.s.n.pattern=a.z:s.s.n={pattern:a.z}));let{row:u,col:h}=c(e,t);d.setValue(u,h,s)});let u={unitId:s,subUnitId:l,cellValue:(0,O.Tools).deepClone(d.getMatrix())};r.push({id:A.SetRangeValuesMutation.id,params:u});let h=(0,A.SetRangeValuesUndoMutationFactory)(i,u);return o.push({id:A.SetRangeValuesMutation.id,params:h}),{undos:o,redos:r}}function u1(e,t,i){let n=[],r=[],o=new O.ObjectMatrix,{unitId:s,subUnitId:l,range:a}=e,{mapFunc:d}=ii([a]);if(t.forValue((e,t,i)=>{if(i.s){let{row:i,col:n}=d(e,t);o.setValue(i,n,{s:null})}}),o.getLength()>0){let e={subUnitId:l,unitId:s,cellValue:(0,O.Tools).deepClone(o.getMatrix())};n.push({id:A.SetRangeValuesMutation.id,params:e});let t=(0,A.SetRangeValuesUndoMutationFactory)(i,e);r.push({id:A.SetRangeValuesMutation.id,params:t})}return{undos:r,redos:n}}function u2(e,t,i){let n=[],r=[],{unitId:o,subUnitId:s,range:l}=e,{startColumn:a,startRow:d,endColumn:c,endRow:u}=it(l),h=[];t.forValue((e,t,i)=>{if(i.rowSpan&&i.rowSpan>1){let n=i.colSpan||1,r={startRow:d+e,endRow:d+e+i.rowSpan-1,startColumn:a+t,endColumn:a+t+n-1};h.push(r)}else if(i.colSpan&&i.colSpan>1){let n={startRow:d+e,endRow:d+e+(i.rowSpan||1)-1,startColumn:a+t,endColumn:a+t+i.colSpan-1};h.push(n)}});let m=i.get(O.IUniverInstanceService).getUniverSheetInstance(o),g=null==m?void 0:m.getSheetBySheetId(s);if(m&&g){let e={unitId:o,subUnitId:s,ranges:g.getMergeData().filter(e=>(0,O.Rectangle).intersects({startRow:d,startColumn:a,endRow:u,endColumn:c},e))};n.push({id:A.RemoveWorksheetMergeMutation.id,params:e});let t=(0,A.RemoveMergeUndoMutationFactory)(i,e);r.push({id:A.AddWorksheetMergeMutation.id,params:t})}let p={unitId:o,subUnitId:s,ranges:h};h.length>0&&n.push({id:A.AddWorksheetMergeMutation.id,params:p});let v=(0,A.AddMergeUndoMutationFactory)(i,p);return h.length>0&&r.push({id:A.RemoveWorksheetMergeMutation.id,params:v}),{undos:r,redos:n}}function u5(e){if(!e.includes("\r")&&(0,O.Tools).isLegalUrl(e)){let t=(0,O.generateRandomId)(),i=`${O.DataStreamTreeTokenType.CUSTOM_RANGE_START}${e}${O.DataStreamTreeTokenType.CUSTOM_RANGE_END}`,n={startIndex:0,endIndex:i.length-1,rangeId:t,rangeType:O.CustomRangeType.HYPERLINK,properties:{url:e}};return{dataStream:`${i}\r
`,customRanges:[n]}}let t=e.replace(/(\r\n|\n)/g,"\r");t.endsWith(`\r
`)||(t+=`\r
`);let i=[];for(let e=0;e<t.length;e++)"\r"===t[e]&&i.push({startIndex:e});return{dataStream:t,paragraphs:i,sectionBreaks:[{startIndex:t.indexOf(`
`)}]}}uK=uG([uZ(0,(0,O.Inject)(uj)),uZ(1,O.ICommandService),uZ(2,x.IRenderManagerService)],uK),el(uq,"getDefaultOnPasteCellMutations"),el(uQ,"getMoveRangeMutations"),el(uJ,"getSetCellValueMutations"),el(u$,"getSetCellCustomMutations"),el(u0,"getSetCellStyleMutations"),el(u1,"getClearCellStyleMutations"),el(u2,"getClearAndSetMergeMutations"),el(u5,"generateBody");var u9,u6=Object.defineProperty,u3=Object.getOwnPropertyDescriptor,u7=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?u3(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&u6(t,i,o),o},"__decorateClass$y"),u4=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$y");let u8=(u9=class extends O.RxDisposable{constructor(e,t,i,n,r,o,s,l,a){var d;super(),this._injector=e,this._currentUniverSheet=t,this._renderManagerService=i,this._commandService=n,this._contextService=r,this._configService=o,this._sheetClipboardService=s,this._messageService=l,this._localService=a,this._init(),this._initCommandListener();let c=null==(d=this._renderManagerService.getRenderById(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY))?void 0:d.with(M.DocSelectionRenderService);c&&c.onPaste$.pipe((0,K.takeUntil)(this.dispose$)).subscribe(e=>{var t,i;if(!lr(this._contextService))return;e.event.preventDefault();let n=e.event,r=null==(t=n.clipboardData)?void 0:t.getData("text/html"),o=null==(i=n.clipboardData)?void 0:i.getData("text/plain");this._commandService.executeCommand(l7.id,{htmlContent:r,textContent:o})})}_init(){[l9,l6,l3].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e))),[l4,l8,ae,at,l7].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e))),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initCopyingHooks())),this.disposeWithMe(this._sheetClipboardService.addClipboardHook(this._initPastingHook()));let e=this._initSpecialPasteHooks().map(e=>this._sheetClipboardService.addClipboardHook(e));this.disposeWithMe({dispose:/* @__PURE__ */el(()=>e.forEach(e=>e.dispose()),"dispose")})}_initCopyingHooks(){let e=this,t=null;return{id:lK.DEFAULT_COPY,isDefaultHook:!0,onBeforeCopy(i,n){t=e._getWorksheet(i,n)},onCopyCellContent(e,i){var n,r,o,s;let l=t.getCell(e,i);return null!=(r=null==(n=null==l?void 0:l.p)?void 0:n.body)&&r.paragraphs||null!=(s=null==(o=null==l?void 0:l.p)?void 0:o.body)&&s.textRuns?(0,O.convertBodyToHtml)(l.p.body):l?(0,O.extractPureTextFromCell)(l):""},onCopyCellStyle:/* @__PURE__ */el((e,i,n,r)=>{let o={};(n||r)&&(o.rowspan=`${n||1}`,o.colspan=`${r||1}`);let s=t.getRange(e,i),l=t.getMergedCell(e,i),a=s.getTextStyle(),d="";if(a&&(d=(0,O.handleStyleToString)(a)),l){let e=l.endRow,i=l.endColumn,n=t.getRange(e,i).getTextStyle();if(n){let e=(0,O.handleStyleToString)(n);d?d+=e?`;${e}`:"":d=e}}return d&&(o.style=d),o},"onCopyCellStyle"),onCopyColumn:e=>({width:`${t.getColumnWidth(e)}`}),onCopyRow:e=>({style:`height: ${t.getRowHeight(e)}px;`}),onAfterCopy(){t=null},getFilteredOutRows(t){var i;let{startRow:n,endRow:r}=t,o=null==(i=e._currentUniverSheet.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET))?void 0:i.getActiveSheet(),s=[];if(!o)return s;for(let e=n;e<=r;e++)o.getRowFiltered(e)&&s.push(e);return s}}}_initPastingHook(){let e=this,t=null,i=null,n=null;return{id:lK.DEFAULT_PASTE,isDefaultHook:!0,onBeforePaste({unitId:r,subUnitId:o,range:s}){n=e._getWorksheet(r,o),t=r,i=o;let l=e._configService.getConfig(A.MAX_CELL_PER_SHEET_KEY),a=s.rows[s.rows.length-1],d=s.cols[s.cols.length-1];return!l||!(a*d>l)||(e._messageService.show({type:et.MessageType.Error,content:e._localService.t("clipboard.paste.exceedMaxCells")}),!1)},onPasteRows(e,r){let{range:o}=e,s=[],l=[],a=n.getMaxRows(),d=a-1,c=o.rows[o.rows.length-1]-d,u=r.length-c,h=n.getRowManager();if(c>0){let e={};r.slice(u).forEach((t,i)=>{let{height:n}=t||{};n&&(e[i]={h:Number.parseFloat(n),hd:O.BooleanNumber.FALSE})});let n={startColumn:o.cols[0],endColumn:o.cols[o.cols.length-1],endRow:o.rows[o.rows.length-1],startRow:a},d={unitId:t,subUnitId:i,range:n,rowInfo:e};s.push({id:A.InsertRowMutation.id,params:d}),l.push({id:A.RemoveRowMutation.id,params:{unitId:t,subUnitId:i,range:n}})}let m={},g={};if(r.slice(0,u).forEach((e,t)=>{var i,n;let{height:r}=e;if(r){let e=h.getRow(o.rows[0]+t),s=Number.parseFloat(r);if(e){let{h:i=O.DEFAULT_WORKSHEET_ROW_HEIGHT,ah:n=0}=e,r=Math.max(i,n);s>r?m[t+o.rows[0]]=s:m[t+o.rows[0]]=r,g[t+o.rows[0]]=r}else m[t+o.rows[0]]=s,g[t+o.rows[0]]=null!=(n=null==(i=h.getRow(o.rows[0]+t))?void 0:i.h)?n:O.DEFAULT_WORKSHEET_ROW_HEIGHT}}),Object.keys(m).length){let e={unitId:t,subUnitId:i,ranges:[{startRow:o.rows[0],endRow:Math.min(o.rows[o.rows.length-1],a),startColumn:o.cols[0],endColumn:o.cols[o.cols.length-1]}],rowHeight:m};s.push({id:A.SetWorksheetRowHeightMutation.id,params:e}),l.push({id:A.SetWorksheetRowHeightMutation.id,params:{...e,rowHeight:g}})}return{redos:s,undos:l}},onPasteColumns(r,o,s){var l;let{range:a}=r,d=[],c=[],u=n.getMaxColumns(),h=u-1,m=a.cols[a.cols.length-1]-h,g=o.length-m,p=null!=(l=e._configService.getConfig(O.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY))?l:O.DEFAULT_WORKSHEET_COLUMN_WIDTH,v=a.cols,S=v[0];if(m>0){let e={startRow:a.rows[0],endRow:a.rows[a.rows.length-1],endColumn:a.cols[a.cols.length-1],startColumn:u},r={unitId:t,subUnitId:i,range:e,colInfo:o.slice(g).map((e,t)=>({w:e.width?Math.max(+e.width,n.getColumnWidth(v[t])):p,hd:O.BooleanNumber.FALSE}))};d.push({id:A.InsertColMutation.id,params:r}),c.push({id:A.RemoveColMutation.id,params:{unitId:t,subUnitId:i,range:e}})}let f={unitId:t,subUnitId:i,ranges:[{startRow:a.rows[0],endRow:a.rows[a.rows.length-1],startColumn:a.cols[0],endColumn:Math.min(a.cols[a.cols.length-1],u)}]};if(o.length>0){let e={...f,colWidth:o.slice(0,g).reduce((e,t,i)=>{var r;return e[i+S]=t.width?Math.max(+t.width,null!=(r=n.getColumnWidth(v[i]))?r:p):p,e},{})},t={...f,colWidth:o.slice(0,g).reduce((e,t,i)=>{var r;return e[i+S]=null!=(r=n.getColumnWidth(v[i]))?r:p,e},{})};d.push({id:A.SetWorksheetColWidthMutation.id,params:e}),c.push({id:A.SetWorksheetColWidthMutation.id,params:t})}return{redos:d,undos:c}},onPastePlainText:(t,i,n)=>e._onPastePlainText(t,i,n),onPasteCells:(t,i,n,r)=>e._onPasteCells(t,i,n,r),onAfterPaste(e){n=null}}}_generateDocumentDataModelSnapshot(e){var t,i;let n=null==(t=this._renderManagerService.withCurrentTypeOfUnit(O.UniverInstanceType.UNIVER_SHEET,ev))?void 0:t.getCurrent();if(null==n)return null;let{skeleton:r}=n,o=null==(i=r.getBlankCellDocumentModel())?void 0:i.documentModel,s={...null==o?void 0:o.getSnapshot(),...e};return null==o||o.reset(s),null==o?void 0:o.getSnapshot()}_onPastePlainText(e,t,i){let n;let{range:r,unitId:o,subUnitId:s}=e;if(/\r|\n/.test(t)||(0,O.Tools).isLegalUrl(t)){let e=u5(t),i=this._generateDocumentDataModelSnapshot({body:e});n={[r.rows[0]]:{[r.cols[0]]:{p:i}}}}else n=(0,O.isFormulaString)(t)?{[r.rows[0]]:{[r.cols[0]]:{f:t}}}:{[r.rows[0]]:{[r.cols[0]]:{v:t}}};let l={unitId:o,subUnitId:s,cellValue:n};return{redos:[{id:A.SetRangeValuesMutation.id,params:l}],undos:[{id:A.SetRangeValuesMutation.id,params:(0,A.SetRangeValuesUndoMutationFactory)(this._injector,l)}]}}_onPasteCells(e,t,i,n){return this._injector.invoke(r=>uq(e,t,i,n,r))}_initSpecialPasteHooks(){let e=this,t={id:lK.SPECIAL_PASTE_VALUE,specialPasteInfo:{label:"specialPaste.value"},onPasteCells:/* @__PURE__ */el((e,t,i)=>this._injector.invoke(n=>uJ(t,e,i,n)),"onPasteCells")};return[t,{id:lK.SPECIAL_PASTE_FORMAT,specialPasteInfo:{label:"specialPaste.format"},onPasteCells:/* @__PURE__ */el((e,t,i)=>{let n=[],r=[],{undos:o,redos:s}=this._injector.invoke(e=>u1(t,i,e));n.push(...s),r.push(...o);let{undos:l,redos:a}=this._injector.invoke(e=>u2(t,i,e));n.push(...a),r.push(...l);let{undos:d,redos:c}=this._injector.invoke(e=>u0(t,i,e));return n.push(...c),r.push(...d),{undos:r,redos:n}},"onPasteCells")},{id:lK.SPECIAL_PASTE_COL_WIDTH,specialPasteInfo:{label:"specialPaste.colWidth"},onPasteCells:()=>({undos:[],redos:[]}),onPasteColumns(t,i,n){var r,o;let s=e._currentUniverSheet.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),l=s.getUnitId(),a=null==(r=s.getActiveSheet())?void 0:r.getSheetId();if(!l||!a)throw Error("Cannot find unitId or subUnitId");let d=[],c=[],u=e._getWorksheet(l,a),{range:h}=t,m=h.cols,g=m[0],p=u.getMaxColumns(),v=h.cols[h.cols.length-1]-p,S=i.length-v,f=null!=(o=e._configService.getConfig(O.DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY))?o:O.DEFAULT_WORKSHEET_COLUMN_WIDTH,C={unitId:l,subUnitId:a,ranges:[{startRow:h.rows[0],endRow:Math.min(h.cols[h.cols.length-1],p),startColumn:h.cols[0],endColumn:h.cols[h.cols.length-1]}],colWidth:i.slice(0,S).reduce((e,t,i)=>{var n;return e[i+g]=t.width?Math.max(+t.width,null!=(n=u.getColumnWidth(m[i]))?n:f):f,e},{})},I={unitId:l,subUnitId:a,ranges:[{startRow:h.rows[0],endRow:Math.min(h.cols[h.cols.length-1],p),startColumn:h.cols[0],endColumn:h.cols[h.cols.length-1]}],colWidth:i.slice(0,S).reduce((e,t,i)=>{var n;return e[i+g]=null!=(n=u.getColumnWidth(m[i]))?n:f,e},{})};return d.push({id:A.SetWorksheetColWidthMutation.id,params:C}),c.push({id:A.SetWorksheetColWidthMutation.id,params:I}),{redos:d,undos:c}}},{id:lK.SPECIAL_PASTE_BESIDES_BORDER,specialPasteInfo:{label:"specialPaste.besidesBorder"},onPasteCells:/* @__PURE__ */el((t,i,n,r)=>{e._currentUniverSheet.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);let o=[],s=[],{range:l,unitId:a,subUnitId:d}=i,c=new O.ObjectMatrix;n.forValue((e,t,i)=>{let n=i.s;"object"==typeof n&&c.setValue(l.rows[e],l.cols[t],{s:{...n,bd:void 0},v:i.v})});let u={unitId:a,subUnitId:d,cellValue:c.getData()};o.push({id:A.SetRangeValuesMutation.id,params:u});let h=this._injector.invoke(A.SetRangeValuesUndoMutationFactory,u);s.push({id:A.SetRangeValuesMutation.id,params:h});let{undos:m,redos:g}=this._injector.invoke(e=>u2(i,n,e));return s.push(...m),o.push(...g),{redos:o,undos:s}},"onPasteCells")}]}_getWorksheet(e,t){var i;let n=null==(i=this._currentUniverSheet.getUniverSheetInstance(e))?void 0:i.getSheetBySheetId(t);if(!n)throw Error(`[SheetClipboardController]: cannot find a worksheet with unitId ${e} and subUnitId ${t}.`);return n}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{e.id===ru.id&&this._sheetClipboardService.removeMarkSelection()}))}},el(u9,"SheetClipboardController"),u9);u8=u7([u4(0,(0,O.Inject)(O.Injector)),u4(1,O.IUniverInstanceService),u4(2,x.IRenderManagerService),u4(3,O.ICommandService),u4(4,O.IContextService),u4(5,O.IConfigService),u4(6,lq),u4(7,J.IMessageService),u4(8,(0,O.Inject)(O.LocaleService))],u8);var he,ht=Object.defineProperty,hi=Object.getOwnPropertyDescriptor,hn=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hi(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&ht(t,i,o),o},"__decorateClass$x"),hr=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$x");let ho=(el(he=class extends O.Disposable{constructor(e,t,i,n,r){super(),this._selectionManagerService=e,this._themeService=t,this._instanceSrv=i,this._cmdSrv=n,this._definedNamesService=r,this._init()}_init(){this.disposeWithMe((0,B.merge)(this._selectionManagerService.selectionMoveStart$,this._selectionManagerService.selectionMoving$,this._selectionManagerService.selectionMoveEnd$).pipe((0,U.filter)(e=>!!e)).subscribe(e=>{this._syncDefinedNameRange(e)})),this.disposeWithMe(this._definedNamesService.focusRange$.subscribe(async e=>{if(null==e)return;let{unitId:t}=e,{formulaOrRefString:i}=e;if(i.substring(0,1)===ei.operatorToken.EQUALS&&(i=i.substring(1)),!(0,ei.isReferenceStrings)(i))return;let n=this._instanceSrv.getUnit(t),r=await this._getSelections(n,t,i);this._selectionManagerService.setSelections(r),this._cmdSrv.executeCommand(A.ScrollToCellOperation.id,r[0].range)}))}_syncDefinedNameRange(e){if(0===e.length)return;let t=e[e.length-1],i=this._instanceSrv.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),n=null==i?void 0:i.getActiveSheet();n&&this._definedNamesService.setCurrentRange({range:t.range,unitId:i.getUnitId(),sheetId:n.getSheetId()})}async _getSelections(e,t,i){let n=i.split(","),r=e.getActiveSheet();if(!r)return[];let o=[];for(let i=0;i<n.length;i++){let s=n[i].trim(),l=(0,ei.deserializeRangeWithSheet)(s.trim());if(0===i){let i=e.getSheetBySheetName(l.sheetName);i&&r.getSheetId()!==i.getSheetId()&&(r=i,await this._cmdSrv.executeCommand(A.SetWorksheetActivateCommand.id,{subUnitId:r.getSheetId(),unitId:t}))}if(r.getName()!==l.sheetName)continue;let a=null;if(i===n.length-1){let{startRow:e,startColumn:t,endRow:i,endColumn:n}=l.range;a=(0,A.getPrimaryForRange)({startRow:e,startColumn:t,endRow:i,endColumn:n},r)}o.push({range:l.range,style:(0,A.getNormalSelectionStyle)(this._themeService),primary:a})}return o}},"SheetsDefinedNameController"),he);ho=hn([hr(0,(0,O.Inject)(A.SheetsSelectionsService)),hr(1,(0,O.Inject)(O.ThemeService)),hr(2,O.IUniverInstanceService),hr(3,O.ICommandService),hr(4,ei.IDefinedNamesService)],ho);var hs,hl=Object.defineProperty,ha=Object.getOwnPropertyDescriptor,hd=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?ha(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hl(t,i,o),o},"__decorateClass$w"),hc=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$w");let hu=(el(hs=class extends O.Disposable{constructor(e,t){super(),ea(this,"_currentCell$",new Y.Subject),ea(this,"currentCell$",this._currentCell$.asObservable().pipe((0,W.distinctUntilChanged)((e,t)=>{var i,n,r,o,s,l,a,d;return(null==(i=null==e?void 0:e.location)?void 0:i.unitId)===(null==(n=null==t?void 0:t.location)?void 0:n.unitId)&&(null==(r=null==e?void 0:e.location)?void 0:r.subUnitId)===(null==(o=null==t?void 0:t.location)?void 0:o.subUnitId)&&(null==(s=null==e?void 0:e.location)?void 0:s.row)===(null==(l=null==t?void 0:t.location)?void 0:l.row)&&(null==(a=null==e?void 0:e.location)?void 0:a.col)===(null==(d=null==t?void 0:t.location)?void 0:d.col)}))),ea(this,"_endCell$",new Y.Subject),ea(this,"endCell$",this._endCell$.asObservable()),this._univerInstanceService=e,this._renderManagerService=t,this._initCellDisposableListener()}dispose(){super.dispose(),this._currentCell$.complete(),this._endCell$.complete()}_initCellDisposableListener(){this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{e||(this._currentCell$.next(null),this._endCell$.next(null))}))}_calcActiveCell(e,t){let i=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!i)return null;let n=i.getActiveSheet();if(!n)return;let r=this._renderManagerService.getRenderById(i.getUnitId());if(!r)return;let o=r.with(ev).getCurrent(),s=r.with(eR).getCurrentScrollState();if(!(!o||!s||!r))return rc(r,i,n,o,e,t)}onDragOver(e){let{offsetX:t,offsetY:i,dataTransfer:n}=e,r=this._calcActiveCell(t,i);if(!r){this._currentCell$.next(null);return}let{location:o,position:s}=r;this._currentCell$.next({location:o,position:s,dataTransfer:n})}onDrop(e){let{offsetX:t,offsetY:i,dataTransfer:n}=e,r=this._calcActiveCell(t,i);if(!r){this._endCell$.next(null);return}let{location:o,position:s}=r;this._endCell$.next({location:o,position:s,dataTransfer:n})}},"DragManagerService"),hs);hu=hd([hc(0,O.IUniverInstanceService),hc(1,x.IRenderManagerService)],hu);var hh,hm=Object.defineProperty,hg=Object.getOwnPropertyDescriptor,hp=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hg(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hm(t,i,o),o},"__decorateClass$v"),hv=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$v");let hS=(hh=class extends O.Disposable{constructor(e,t,i,n){super(),this._context=e,this._renderManagerService=t,this._dragManagerService=i,this._sheetSkeletonManagerService=n,this._initDragEvent()}_initDragEvent(){let e=new O.DisposableCollection,t=/* @__PURE__ */el(t=>{if(e.dispose(),!t)return;let{scene:i}=this._context,n=i.onDragOver$.subscribeEvent(e=>{this._dragManagerService.onDragOver(e)}),r=i.onDrop$.subscribeEvent(e=>{this._dragManagerService.onDrop(e)});e.add({dispose(){n.unsubscribe(),r.unsubscribe()}})},"handleSkeletonChange");t(this._sheetSkeletonManagerService.getCurrent()),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{t(e)}))}},el(hh,"DragRenderController"),hh);hS=hp([hv(1,x.IRenderManagerService),hv(2,(0,O.Inject)(hu)),hv(3,(0,O.Inject)(ev))],hS);var hf,hC=Object.defineProperty,hI=Object.getOwnPropertyDescriptor,hb=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hI(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hC(t,i,o),o},"__decorateClass$u"),h_=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$u");let hR=(el(hf=class extends O.RxDisposable{constructor(e,t,i,n,r,o,s,l){super(),ea(this,"_loadedMap",/* @__PURE__ */new WeakSet),ea(this,"_scheduledCallback",-1),this._univerInstanceService=e,this._renderManagerService=t,this._editorBridgeService=i,this._commandService=n,this._contextService=r,this._formulaEditorManagerService=o,this._undoRedoService=s,this._textSelectionManagerService=l,this._initialize()}_initialize(){this._syncEditorSize(),this._listenFxBtnClick(),this._handleContentChange(),this._renderManagerService.currentRender$.pipe((0,K.takeUntil)(this.dispose$)).subscribe(e=>{this._create(e)}),this._create(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),this._textSelectionManagerService.textSelection$.pipe((0,K.takeUntil)(this.dispose$)).subscribe(e=>{if(null==e)return;let{unitId:t}=e;t!==O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&(this._contextService.setContextValue(O.FOCUSING_FX_BAR_EDITOR,!1),this._undoRedoService.clearUndoRedo(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY))})}_handleContentChange(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(e.id===$.RichTextEditingMutation.id){let{unitId:t}=e.params;t===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&this.autoScroll()}}))}_create(e){if(e!==O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)return;let t=this._renderManagerService.getRenderById(e);if(null==t)return;let{mainComponent:i}=t;null!=i&&(this._loadedMap.has(i)||(this._initialMain(e),this._loadedMap.add(i)))}_listenFxBtnClick(){this._formulaEditorManagerService.fxBtnClick$.pipe((0,K.takeUntil)(this.dispose$)).subscribe(()=>{var e,t;if(this._contextService.getContextValue(O.FOCUSING_EDITOR_BUT_HIDDEN)&&!this._contextService.getContextValue(O.EDITOR_ACTIVATED)){this._univerInstanceService.setCurrentUnitForType(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),this._contextService.setContextValue(O.FOCUSING_FX_BAR_EDITOR,!0);let i=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),n=this._univerInstanceService.getUniverDocInstance(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);!1===this._editorBridgeService.isVisible().visible&&this._editorBridgeService.changeVisible({visible:!0,eventType:x.DeviceInputEventType.PointerDown,unitId:null!=(e=null==i?void 0:i.getUnitId())?e:""});let r=null==(t=null==n?void 0:n.getBody())?void 0:t.dataStream;if(null==r)return;let o=r.startsWith("=")?r:`=${r}`,s=[{startOffset:(o=o.replace(/\r\n$/,"")).length,endOffset:o.length}],l={unitId:O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,body:{dataStream:o},segmentId:""};this._commandService.executeCommand(M.CoverContentCommand.id,l),this._textSelectionManagerService.replaceDocRanges(s)}})}_initialMain(e){let t=this._renderManagerService.getRenderById(e);if(null==t)return;let{mainComponent:i}=t;null!=i&&this.disposeWithMe(i.onPointerDown$.subscribeEvent(()=>{!1===this._editorBridgeService.isVisible().visible&&(this._editorBridgeService.changeVisible({visible:!0,eventType:x.DeviceInputEventType.Dblclick,unitId:e}),this._undoRedoService.clearUndoRedo(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)),this._contextService.setContextValue(O.FOCUSING_FX_BAR_EDITOR,!0)}))}_syncEditorSize(){this._formulaEditorManagerService.position$.pipe((0,K.takeUntil)(this.dispose$)).subscribe(e=>{if(!e)return this._clearScheduledCallback();let t=ec(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,this._renderManagerService),i=this._univerInstanceService.getUniverDocInstance(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);if(null==t||null==i)return this._clearScheduledCallback();let{width:n,height:r}=e;if(0===n||0===r)return this._clearScheduledCallback();let{engine:o}=t;i.updateDocumentDataPageSize(n),this.autoScroll(),this._scheduledCallback=requestIdleCallback(()=>o.resizeBySize(n,r))})}_clearScheduledCallback(){-1!==this._scheduledCallback&&cancelIdleCallback(this._scheduledCallback),this._scheduledCallback=-1}autoScroll(){var e,t;let i=this._formulaEditorManagerService.getPosition(),n=null==(e=this._renderManagerService.getRenderById(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY))?void 0:e.with($.DocSkeletonManagerService).getSkeleton(),r=this._renderManagerService.getRenderById(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY),o=this._univerInstanceService.getUniverDocInstance(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY);if(null==n||null==i||null==r||null==o)return;let{marginTop:s=0,marginBottom:l=0}=o.getSnapshot().documentStyle,{scene:a,mainComponent:d}=r,{actualHeight:c}=n.getActualSize();c+=s+l;let{width:u,height:h}=i,m=a.getViewport(M.VIEWPORT_KEY.VIEW_MAIN),g=null==m?void 0:m.getScrollBar();a.transformByState({width:u,height:c}),null==d||d.resize(u,c),c>h?null==g?m&&new x.ScrollBar(m,{enableHorizontal:!1,barSize:8}):null==m||m.resetCanvasSizeAndUpdateScroll():(g=null,null==m||m.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0}),null==(t=null==m?void 0:m.getScrollBar())||t.dispose())}},"FormulaEditorController"),hf);hR=hb([h_(0,O.IUniverInstanceService),h_(1,x.IRenderManagerService),h_(2,tA),h_(3,O.ICommandService),h_(4,O.IContextService),h_(5,sP),h_(6,O.IUndoRedoService),h_(7,(0,O.Inject)($.DocSelectionManagerService))],hR);var hy,hT=Object.defineProperty,hE=Object.getOwnPropertyDescriptor,hw=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hE(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hT(t,i,o),o},"__decorateClass$t"),hP=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$t");let hM=(el(hy=class extends O.Disposable{constructor(e,t,i,n,r,o,s){super(),this._univerInstanceService=e,this._renderManagerService=t,this._editorBridgeService=i,this._commandService=n,this._rangeProtectionRuleModel=r,this._worksheetProtectionRuleModel=o,this._formulaEditorController=s,this._initialize()}_initialize(){this._syncFormulaEditorContent(),this._commandExecutedListener()}_getEditorViewModel(e){var t;return null==(t=this._renderManagerService.getRenderById(e))?void 0:t.with($.DocSkeletonManagerService).getViewModel()}_syncFormulaEditorContent(){this.disposeWithMe(this._editorBridgeService.currentEditCellState$.subscribe(e=>{null==e||this._editorBridgeService.isForceKeepVisible()||!this._rangeProtectionRuleModel.getRangeRuleInitState()||!this._worksheetProtectionRuleModel.getSheetRuleInitState()||this._editorSyncHandler(e)}))}_editorSyncHandler(e){var t;let i=(0,O.Tools).deepClone(null==(t=e.documentLayoutObject.documentModel)?void 0:t.getBody());i&&(!0!==e.isInArrayFormulaRange||this._editorBridgeService.isVisible().eventType!==x.DeviceInputEventType.Dblclick)||(i={dataStream:`\r
`,paragraphs:[{startIndex:0}],textRuns:[]}),this._syncContentAndRender(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,i)}_commandExecutedListener(){let e=[O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id===$.RichTextEditingMutation.id||t.id===J.SetEditorResizeOperation.id){let i=t.params,{unitId:n}=i;if(!i.isSync&&e.includes(n)){let e=this._univerInstanceService.getUnit(n,O.UniverInstanceType.UNIVER_DOC),t=n===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY?O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY:O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY;this._checkAndSetRenderStyleConfig(e),this._syncActionsAndRender(t,i)}}}));let t=[A.SetRangeValuesMutation.id,A.MoveRangeMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var i,n,r,o,s;if(t.includes(e.id)){let t=this._editorBridgeService.getLatestEditCellState();if(null==t)return;let l=!1,{row:a,column:d}=t;if(e.id===A.SetRangeValuesMutation.id&&e.params?null!=(n=null==(i=e.params.cellValue)?void 0:i[a])&&n[d]&&(l=!0):e.id===A.MoveRangeMutation.id&&e.params&&null!=(o=null==(r=e.params.to.value)?void 0:r[a])&&o[d]&&(l=!0),l){let e=null==(s=t.documentLayoutObject.documentModel)?void 0:s.getBody();if(null==e)return;this._syncContentAndRender(O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,(0,O.Tools).deepClone(e))}}}))}_syncActionsAndRender(e,t){var i;let n=[O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY],r=this._renderManagerService.getRenderById(e);if(null==r)return;let o=r.with($.DocSkeletonManagerService).getSkeleton(),s=this._univerInstanceService.getUniverDocInstance(e),l=this._getEditorViewModel(e);null==s||null==l||(this._commandService.syncExecuteCommand($.RichTextEditingMutation.id,{...t,isSync:!0,unitId:e,syncer:t.unitId}),l.reset(s),o.calculate(),n.includes(e)&&(null==(i=r.mainComponent)||i.makeDirty()))}_syncContentAndRender(e,t){var i,n;e===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&t.paragraphs&&(t.paragraphs=this._clearParagraph(t.paragraphs));let r=[O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY],o=null==(i=this._renderManagerService.getRenderById(e))?void 0:i.with($.DocSkeletonManagerService).getSkeleton(),s=this._univerInstanceService.getUniverDocInstance(e),l=this._getEditorViewModel(e);if(null==s||null==l||null==o)return;s.getSnapshot().body=t,this._checkAndSetRenderStyleConfig(s),l.reset(s);let a=this._renderManagerService.getRenderById(e);null!=a&&(o.calculate(),r.includes(e)&&(null==(n=a.mainComponent)||n.makeDirty()),e===O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY&&this._formulaEditorController.autoScroll())}_checkAndSetRenderStyleConfig(e){var t;let i=e.getSnapshot(),{body:n}=i;if(i.id!==O.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY)return;let r=i.documentStyle.renderConfig;null==r&&(r={},i.documentStyle.renderConfig=r),(null!=(t=null==n?void 0:n.dataStream)?t:"").startsWith("=")?r.isRenderStyle=O.BooleanNumber.TRUE:r.isRenderStyle=O.BooleanNumber.FALSE}_clearParagraph(e){let t=(0,O.Tools).deepClone(e);for(let e of t)e.paragraphStyle&&(e.paragraphStyle.horizontalAlign=O.HorizontalAlign.UNSPECIFIED);return t}},"EditorDataSyncController"),hy);hM=hw([hP(0,O.IUniverInstanceService),hP(1,x.IRenderManagerService),hP(2,tA),hP(3,O.ICommandService),hP(4,(0,O.Inject)(A.RangeProtectionRuleModel)),hP(5,(0,O.Inject)(A.WorksheetProtectionRuleModel)),hP(6,(0,O.Inject)(hR))],hM);var hO=Object.defineProperty,hx=Object.getOwnPropertyDescriptor,hA=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hx(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hO(t,i,o),o},"__decorateClass$s"),hk=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$s");let hN="SHEET_FORCE_STRING_ALERT",hD=(el(hV=class extends O.Disposable{constructor(e,t,i,n){super(),this._context=e,this._hoverManagerService=t,this._cellAlertManagerService=i,this._localeService=n,this._init()}_init(){this._initCellAlertPopup()}_initCellAlertPopup(){this.disposeWithMe(this._hoverManagerService.currentCell$.subscribe(e=>{var t;if(e){let i=this._context.unit.getActiveSheet();if(!i)return;let n=i.getCell(e.location.row,e.location.col);if((null==n?void 0:n.t)===O.CellValueType.FORCE_STRING&&n.v&&(0,O.isRealNum)(n.v)){let i=this._cellAlertManagerService.currentAlert.get(hN),n=null==(t=null==i?void 0:i.alert)?void 0:t.location;if(n&&n.row===e.location.row&&n.col===e.location.col&&n.subUnitId===e.location.subUnitId&&n.unitId===e.location.unitId)return;this._cellAlertManagerService.showAlert({type:uw.ERROR,title:this._localeService.t("info.error"),message:this._localeService.t("info.forceStringInfo"),location:e.location,width:200,height:74,key:hN});return}}this._cellAlertManagerService.removeAlert(hN)}))}},"ForceStringAlertRenderController"),hV);hD=hA([hk(1,(0,O.Inject)(uj)),hk(2,(0,O.Inject)(uP)),hk(3,(0,O.Inject)(O.LocaleService))],hD);var hV,hW,hH=Object.defineProperty,hU=Object.getOwnPropertyDescriptor,hL=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hU(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hH(t,i,o),o},"__decorateClass$r"),hB=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$r");let hF=(hW=class extends O.RxDisposable{constructor(e,t,i){super(),this._context=e,this._sheetSkeletonManagerService=t,this._sheetInterceptorService=i,this._initViewModelIntercept()}_initViewModelIntercept(){let e={tl:{size:6,color:"#409f11"}};this.disposeWithMe(this._sheetInterceptorService.intercept(A.INTERCEPTOR_POINT.CELL_CONTENT,{priority:10,effect:O.InterceptorEffectEnum.Style,handler:/* @__PURE__ */el((t,i,n)=>{var r;if(!(null==(r=this._sheetSkeletonManagerService.getCurrent())?void 0:r.skeleton))return n(t);let o=i.worksheet.getCellRaw(i.row,i.col);return n(o&&null!==o.v&&void 0!==o.v&&(null==t?void 0:t.t)===O.CellValueType.FORCE_STRING&&(0,O.isRealNum)(o.v)?{...t,markers:{...null==t?void 0:t.markers,...e}}:t)},"handler")}))}},el(hW,"ForceStringRenderController"),hW);hF=hL([hB(1,(0,O.Inject)(ev)),hB(2,(0,O.Inject)(A.SheetInterceptorService))],hF);var hj,hz=Object.defineProperty,hX=Object.getOwnPropertyDescriptor,hY=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hX(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hz(t,i,o),o},"__decorateClass$q"),hG=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$q");let hZ=(hj=class extends O.Disposable{constructor(e,t,i,n,r,o,s){super(),this._commandService=e,this._formatPainterService=t,this._univerInstanceService=i,this._renderManagerService=n,this._selectionManagerService=r,this._sheetInterceptorService=o,this._injector=s,this._initialize()}_initialize(){this._commandExecutedListener(),this._addDefaultHook()}_commandExecutedListener(){let e=this._renderManagerService.getCurrentTypeOfRenderer(O.UniverInstanceType.UNIVER_SHEET).with(ez);this.disposeWithMe(e.selectionMoveEnd$.subscribe(e=>{var t,i;if(this._formatPainterService.getStatus()!==ov.OFF){let{rangeWithCoord:n}=e[e.length-1];this._commandService.executeCommand(o_.id,{unitId:(null==(t=this._univerInstanceService.getFocusedUnit())?void 0:t.getUnitId())||"",subUnitId:(null==(i=this._univerInstanceService.getFocusedUnit().getActiveSheet())?void 0:i.getSheetId())||"",range:{startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn}}),this._formatPainterService.getStatus()===ov.ONCE&&this._commandService.executeCommand(ob.id)}}))}_addDefaultHook(){let e={id:"default-format-painter",priority:0,isDefaultHook:!0,onStatusChange:/* @__PURE__ */el(e=>{if(e!==ov.OFF){let e=this._collectSelectionRangeFormat();e&&this._formatPainterService.setSelectionFormat(e)}},"onStatusChange"),onApply:/* @__PURE__ */el((e,t,i,n)=>this._getUndoRedoMutationInfo(e,t,i,n),"onApply")};this._formatPainterService.addHook(e)}_collectSelectionRangeFormat(){let e=this._selectionManagerService.getCurrentLastSelection(),t=null==e?void 0:e.range;if(!t)return null;let{startRow:i,endRow:n,startColumn:r,endColumn:o}=t,s=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),l=null==s?void 0:s.getActiveSheet();if(!l)return null;let a=l.getCellMatrix(),d=s.getStyles(),c=new O.ObjectMatrix,u=[];for(let e=i;e<=n;e++)for(let t=r;t<=o;t++){let i=a.getValue(e,t);c.setValue(e,t,d.getStyleByCell(i)||{});let{isMergedMainCell:n,...r}=l.getCellInfoInMergeData(e,t);n&&u.push({startRow:r.startRow,startColumn:r.startColumn,endRow:r.endRow,endColumn:r.endColumn})}return{styles:c,merges:u}}_getUndoRedoMutationInfo(e,t,i,n){let r=this._sheetInterceptorService,o=this._univerInstanceService,{merges:s,styles:l}=n;if(!l)return{undos:[],redos:[]};let{startRow:a,startColumn:d,endRow:c,endColumn:u}=l.getDataRange(),h=c-a+1,m=u-d+1,g=i.startRow===i.endRow&&i.startColumn===i.endColumn?{startRow:i.startRow,startColumn:i.startColumn,endRow:i.startRow+h-1,endColumn:i.startColumn+m-1}:i,p=Array.from({length:g.endRow-g.startRow+1},()=>Array.from({length:g.endColumn-g.startColumn+1},()=>({}))),v=[];p.forEach((e,t)=>{e.forEach((e,i)=>{let n=l.getValue(t%h+a,i%m+d);n&&(p[t][i].s=Object.keys(n).length>0?n:null)})}),s.forEach(e=>{let t={startRow:e.startRow-a,startColumn:e.startColumn-d,endRow:e.endRow-a,endColumn:e.endColumn-d},i=Math.max(1,Math.floor((g.endRow-g.startRow+1)/h)),n=Math.max(1,Math.floor((g.endColumn-g.startColumn+1)/m));for(let e=0;e<i;e++)for(let i=0;i<n;i++)v.push({startRow:t.startRow+e*h+g.startRow,startColumn:t.startColumn+i*m+g.startColumn,endRow:t.endRow+e*h+g.startRow,endColumn:t.endColumn+i*m+g.startColumn})});let S=[g],f=new O.ObjectMatrix,C=new O.ObjectMatrix;if((0,O.Tools).isArray(p))for(let e=0;e<S.length;e++){let{startRow:t,startColumn:i,endRow:n,endColumn:r}=S[e];for(let e=0;e<=n-t;e++)for(let n=0;n<=r-i;n++)f.setValue(e+t,n+i,{s:null}),C.setValue(e+t,n+i,p[e][n])}let I={subUnitId:t,unitId:e,cellValue:f.getMatrix()},b={subUnitId:t,unitId:e,cellValue:C.getMatrix()},_=this._injector.invoke(A.SetRangeValuesUndoMutationFactory,I),{undos:R,redos:y}=r.onCommandExecute({id:A.SetRangeValuesCommand.id,params:{...b,range:S}}),T=(0,A.getAddMergeMutationRangeByType)(v),E=[],w=[],P=o.getUnit(e).getSheetBySheetId(t),M=rt(P,T),x={unitId:e,subUnitId:t,ranges:T},k={unitId:e,subUnitId:t,ranges:T};E.push({id:A.RemoveWorksheetMergeMutation.id,params:x}),E.push({id:A.AddWorksheetMergeMutation.id,params:k});let N=this._injector.invoke(A.RemoveMergeUndoMutationFactory,x),D=this._injector.invoke(A.AddMergeUndoMutationFactory,k);if(w.push({id:A.RemoveWorksheetMergeMutation.id,params:D}),w.push({id:A.AddWorksheetMergeMutation.id,params:N}),M){let t=this._injector.invoke(t=>rn(t,e,P,T));E.unshift(...t.redos),w.push(...t.undos)}return{undos:[{id:A.SetRangeValuesMutation.id,params:I},{id:A.SetRangeValuesMutation.id,params:_},...R,...w],redos:[{id:A.SetRangeValuesMutation.id,params:I},{id:A.SetRangeValuesMutation.id,params:b},...y,...E]}}},el(hj,"FormatPainterController"),hj);hZ=hY([hG(0,O.ICommandService),hG(1,oS),hG(2,O.IUniverInstanceService),hG(3,x.IRenderManagerService),hG(4,(0,O.Inject)(A.SheetsSelectionsService)),hG(5,(0,O.Inject)(A.SheetInterceptorService)),hG(6,(0,O.Inject)(O.Injector))],hZ);var hK,hq=Object.defineProperty,hQ=Object.getOwnPropertyDescriptor,hJ=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?hQ(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&hq(t,i,o),o},"__decorateClass$p"),h$=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$p");let h0=(hK=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_active",!1),this._context=e,this._hoverManagerService=t,this._sheetSkeletonManagerService=i,this._scrollManagerService=n,this._initPointerEvent(),this._initScrollEvent()}get active(){return this._active}_initPointerEvent(){let e=new O.DisposableCollection,t=/* @__PURE__ */el(t=>{if(e.dispose(),!t)return;let{mainComponent:i,unitId:n}=this._context;i&&(e.add(i.onPointerEnter$.subscribeEvent(e=>{this._active=!0})),e.add((0,O.fromEventSubject)(i.onPointerMove$).pipe((0,q.throttleTime)(30)).subscribe(e=>{this._active=!0,this._hoverManagerService.triggerMouseMove(n,e.offsetX,e.offsetY)})),e.add(i.onPointerUp$.subscribeEvent(e=>{this._hoverManagerService.triggerClick(n,e.offsetX,e.offsetY)})),e.add(i.onPointerLeave$.subscribeEvent(()=>{this._active=!1})))},"handleSkeletonChange");t(this._sheetSkeletonManagerService.getCurrent()),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{t(e)}))}_initScrollEvent(){this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe(()=>this._hoverManagerService.triggerScroll()))}},el(hK,"HoverRenderController"),hK);h0=hJ([h$(1,(0,O.Inject)(uj)),h$(2,(0,O.Inject)(ev)),h$(3,(0,O.Inject)(eR))],h0);var h1,h2=Object.defineProperty,h5=Object.getOwnPropertyDescriptor,h9=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?h5(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&h2(t,i,o),o},"__decorateClass$o"),h6=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$o");let h3=(el(h1=class extends O.Disposable{constructor(e,t,i,n){super(),this._context=e,this._markSelectionService=t,this._commandService=i,this._sheetSkeletonManagerService=n,this._initListeners()}_initListeners(){this._addRemoveListener(),this._addRefreshListener()}_addRemoveListener(){let e=[i7.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{e.includes(t.id)?this._markSelectionService.removeAllShapes():this._markSelectionService.getShapeMap().forEach((e,i)=>{e.exits.includes(t.id)&&this._markSelectionService.removeShape(i)})}))}_addRefreshListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{e&&this._markSelectionService.refreshShapes()}))}},"MarkSelectionRenderController"),h1);h3=h9([h6(1,(0,O.Inject)(od)),h6(2,O.ICommandService),h6(3,(0,O.Inject)(ev))],h3);var h7,h4=Object.defineProperty,h8=Object.getOwnPropertyDescriptor,me=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?h8(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&h4(t,i,o),o},"__decorateClass$n"),mt=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$n");let mi=(h7=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_initialize",/* @__PURE__ */el(()=>{let e=new O.DisposableCollection;this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe(()=>{e.dispose(),this._selectionRenderService.getSelectionControls().forEach(t=>{e.add((0,O.toDisposable)(t.selectionMoved$.subscribe(e=>{if(!e)return;let i=t.model.getRange(),n={startRow:i.startRow,startColumn:i.startColumn,endRow:i.endRow,endColumn:i.endColumn,rangeType:i.rangeType},r={startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:i.rangeType};n.startRow===r.startRow&&n.startColumn===r.startColumn||r.startRow<0||r.startColumn<0||this._commandService.executeCommand(A.MoveRangeCommand.id,{fromRange:n,toRange:r})})))})}))},"_initialize")),this._context=e,this._selectionRenderService=t,this._selectionManagerService=i,this._commandService=n,this._initialize()}},el(h7,"MoveRangeRenderController"),h7);mi=me([mt(1,(0,O.Inject)(ez)),mt(2,(0,O.Inject)(A.SheetsSelectionsService)),mt(3,(0,O.Inject)(O.ICommandService))],mi);var mn,mr=Object.defineProperty,mo=Object.getOwnPropertyDescriptor,ms=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?mo(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mr(t,i,o),o},"__decorateClass$m"),ml=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$m");let ma=(mn=class extends O.Disposable{constructor(e,t,i,n,r,o,s,l,a,d,c){super(),this._univerInstanceService=e,this._permissionService=t,this._authzIoService=i,this._rangeProtectionRuleModel=n,this._worksheetProtectionRuleModel=r,this._userManagerService=o,this._worksheetProtectionPointRuleModel=s,this._sheetInterceptorService=l,this._undoRedoService=a,this._commandService=d,this._rangeProtectionCache=c,this._initRangePermissionFromSnapshot(),this._initRangePermissionChange(),this._initWorksheetPermissionFromSnapshot(),this._initWorksheetPermissionChange(),this._initWorksheetPermissionPointsChange(),this._initWorkbookPermissionFromSnapshot(),this._initUserChange(),this._refreshPermissionByCollaCreate()}async _initRangePermissionFromSnapshot(){let e=/* @__PURE__ */el(async e=>{let t=[],i=e.getUnitId(),n=e.getSheets(),r=/* @__PURE__ */new Map;if(n.forEach(e=>{let n=e.getSheetId();this._rangeProtectionRuleModel.getSubunitRuleList(i,n).forEach(e=>{r.set(e.permissionId,e),t.push({objectID:e.permissionId,unitID:i,objectType:rN.SelectRange,actions:A.baseProtectionActions})})}),!t.length){this._rangeProtectionRuleModel.changeRuleInitState(!0);return}this._authzIoService.batchAllowed(t).then(e=>{e.forEach(e=>{let t=r.get(e.objectID);t&&(0,A.getAllRangePermissionPoint)().forEach(n=>{let r=new n(i,t.subUnitId,e.objectID),o=r.subType,s=e.actions.find(e=>e.action===o);(null==s?void 0:s.allowed)!==void 0&&this._permissionService.updatePermissionPoint(r.id,s.allowed)})}),this._rangeProtectionRuleModel.changeRuleInitState(!0)})},"initRangePermissionFunc");await Promise.all(this._univerInstanceService.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET).map(t=>e(t))),this._rangeProtectionRuleModel.changeRuleInitState(!0)}_initRangePermissionChange(){this.disposeWithMe(this._rangeProtectionRuleModel.ruleChange$.subscribe(e=>{"delete"!==e.type?this._authzIoService.allowed({objectID:e.rule.permissionId,unitID:e.unitId,objectType:rN.SelectRange,actions:A.baseProtectionActions}).then(t=>{(0,A.getAllRangePermissionPoint)().forEach(i=>{if("set"===e.type){let{rule:t,oldRule:i}=e;if(t.permissionId===(null==i?void 0:i.permissionId))return}let n=e.rule,r=new i(n.unitId,n.subUnitId,n.permissionId),o=r.subType,s=t.find(e=>e.action===o);s&&this._permissionService.updatePermissionPoint(r.id,s.allowed)})}):0===this._rangeProtectionRuleModel.getSubunitRuleList(e.unitId,e.subUnitId).length&&(this._worksheetProtectionPointRuleModel.deleteRule(e.unitId,e.subUnitId),[...(0,A.getAllWorksheetPermissionPointByPointPanel)()].forEach(t=>{let i=new t(e.unitId,e.subUnitId);this._permissionService.updatePermissionPoint(i.id,i.value)}))}))}async initWorkbookPermissionChange(e){var t;let i=e||(null==(t=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET))?void 0:t.getUnitId());i&&this._authzIoService.allowed({objectID:i,objectType:rN.Workbook,unitID:i,actions:A.defaultWorkbookPermissionPoints}).then(e=>{(0,A.getAllWorkbookPermissionPoint)().forEach(t=>{let n=new t(i),r=n.subType,o=e.find(e=>e.action===r);o&&this._permissionService.updatePermissionPoint(n.id,o.allowed)})})}async _initWorkbookPermissionFromSnapshot(){await Promise.all(this._univerInstanceService.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET).map(e=>this.initWorkbookPermissionChange(e.getUnitId())))}_initWorksheetPermissionChange(){this.disposeWithMe(this._worksheetProtectionRuleModel.ruleChange$.subscribe(e=>{"delete"!==e.type?this._authzIoService.allowed({objectID:e.rule.permissionId,unitID:e.unitId,objectType:rN.Worksheet,actions:A.baseProtectionActions}).then(t=>{(0,A.getAllWorksheetPermissionPoint)().forEach(i=>{let n=new i(e.unitId,e.subUnitId),r=n.subType,o=t.find(e=>e.action===r);o&&this._permissionService.updatePermissionPoint(n.id,o.allowed)})}):([...(0,A.getAllWorksheetPermissionPoint)(),...(0,A.getAllWorksheetPermissionPointByPointPanel)()].forEach(t=>{let i=new t(e.unitId,e.subUnitId);this._permissionService.updatePermissionPoint(i.id,!0)}),this._worksheetProtectionPointRuleModel.deleteRule(e.unitId,e.subUnitId))}))}_initWorksheetPermissionPointsChange(){this.disposeWithMe(this._worksheetProtectionPointRuleModel.pointChange$.subscribe(e=>{this._authzIoService.allowed({objectID:e.permissionId,unitID:e.unitId,objectType:rN.Worksheet,actions:A.defaultWorksheetPermissionPoint}).then(t=>{(0,A.getAllWorksheetPermissionPointByPointPanel)().forEach(i=>{let n=new i(e.unitId,e.subUnitId),r=n.subType,o=t.find(e=>e.action===r);o&&this._permissionService.updatePermissionPoint(n.id,o.allowed)})})}))}async _initWorksheetPermissionFromSnapshot(){let e=/* @__PURE__ */el(async e=>{let t=[],i=e.getUnitId(),n=e.getSheets(),r=/* @__PURE__ */new Map;if(n.forEach(e=>{let n=e.getSheetId(),o=this._worksheetProtectionRuleModel.getRule(i,n);o&&(r.set(o.permissionId,o),t.push({objectID:o.permissionId,unitID:i,objectType:rN.Worksheet,actions:A.baseProtectionActions}));let s=this._worksheetProtectionPointRuleModel.getRule(i,n);s&&(r.set(s.permissionId,s),t.push({objectID:s.permissionId,unitID:i,objectType:rN.Worksheet,actions:A.defaultWorksheetPermissionPoint}))}),!t.length){this._worksheetProtectionRuleModel.changeRuleInitState(!0);return}this._authzIoService.batchAllowed(t).then(e=>{e.forEach(e=>{let t=r.get(e.objectID);t&&[...(0,A.getAllWorksheetPermissionPoint)(),...(0,A.getAllWorksheetPermissionPointByPointPanel)()].forEach(n=>{let r=new n(i,t.subUnitId),o=r.subType,s=e.actions.find(e=>e.action===o);(null==s?void 0:s.allowed)!==void 0&&this._permissionService.updatePermissionPoint(r.id,s.allowed)})}),this._worksheetProtectionRuleModel.changeRuleInitState(!0)})},"initSheetPermissionFunc");await Promise.all(this._univerInstanceService.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET).map(t=>e(t))),this._worksheetProtectionRuleModel.changeRuleInitState(!0)}_initUserChange(){this.disposeWithMe(this._userManagerService.currentUser$.pipe((0,z.skip)(1)).subscribe(()=>{let e=this._permissionService.getAllPermissionPoint();this._permissionService.clearPermissionMap(),this._worksheetProtectionRuleModel.changeRuleInitState(!1),this._univerInstanceService.getAllUnitsForType(O.UniverInstanceType.UNIVER_SHEET).forEach(t=>{let i=t.getUnitId();(0,A.getAllWorkbookPermissionPoint)().forEach(t=>{let n=new t(i);e.has(n.id)&&(n=e.get(n.id)),this._permissionService.addPermissionPoint(n)}),t.getSheets().forEach(t=>{let n=t.getSheetId();[...(0,A.getAllWorksheetPermissionPoint)(),...(0,A.getAllWorksheetPermissionPointByPointPanel)()].forEach(t=>{let r=new t(i,n);e.has(r.id)&&(r=e.get(r.id)),this._permissionService.addPermissionPoint(r)}),this._rangeProtectionRuleModel.getSubunitRuleList(i,n).forEach(t=>{(0,A.getAllRangePermissionPoint)().forEach(r=>{let o=new r(i,n,t.permissionId);e.has(o.id)&&(o=e.get(o.id)),this._permissionService.addPermissionPoint(o)})})}),this._initWorkbookPermissionFromSnapshot(),this._initWorksheetPermissionFromSnapshot(),this._initRangePermissionFromSnapshot()})}))}refreshPermission(e,t){let i=this._worksheetProtectionRuleModel.getTargetByPermissionId(e,t),n=!1;if(i){let[r,o]=i;this._authzIoService.allowed({objectID:t,unitID:e,objectType:rN.Worksheet,actions:A.baseProtectionActions}).then(i=>{let r="";(0,A.getAllWorksheetPermissionPoint)().forEach(t=>{var s;let l=new t(e,o),a=l.subType,d=i.find(e=>e.action===a);d&&((null==(s=this._permissionService.getPermissionPoint(l.id))?void 0:s.value)!==d.allowed&&(n=!0),this._permissionService.updatePermissionPoint(l.id,d.allowed),r+=`${d.action}_${d.allowed}`)}),this._worksheetProtectionRuleModel.ruleRefresh(`${t}_${r}`),n&&this._undoRedoService.clearUndoRedo(e)})}let r=this._worksheetProtectionPointRuleModel.getTargetByPermissionId(e,t);if(r){let[i,o]=r;this._authzIoService.allowed({objectID:t,unitID:e,objectType:rN.Worksheet,actions:A.defaultWorksheetPermissionPoint}).then(t=>{(0,A.getAllWorksheetPermissionPointByPointPanel)().forEach(i=>{var r;let s=new i(e,o),l=s.subType,a=t.find(e=>e.action===l);a&&((null==(r=this._permissionService.getPermissionPoint(s.id))?void 0:r.value)!==a.allowed&&(n=!0),this._permissionService.updatePermissionPoint(s.id,a.allowed))}),n&&this._undoRedoService.clearUndoRedo(e)})}let o=this._rangeProtectionRuleModel.getTargetByPermissionId(e,t);if(o){let[i,r]=o;this._authzIoService.allowed({objectID:t,unitID:e,objectType:rN.SelectRange,actions:A.baseProtectionActions}).then(i=>{let o="";(0,A.getAllRangePermissionPoint)().forEach(s=>{var l;let a=new s(e,r,t),d=a.subType,c=i.find(e=>e.action===d);c&&((null==(l=this._permissionService.getPermissionPoint(a.id))?void 0:l.value)!==c.allowed&&(n=!0),this._permissionService.updatePermissionPoint(a.id,c.allowed),o+=`${c.action}_${c.allowed}`)}),this._rangeProtectionRuleModel.ruleRefresh(`${t}_${o}`),n&&this._undoRedoService.clearUndoRedo(e)})}}_refreshPermissionByCollaCreate(){this.disposeWithMe(this._commandService.onCommandExecuted((e,t)=>{if(null!=t&&t.fromCollab&&(e.id===A.AddRangeProtectionMutation.id||e.id===A.AddWorksheetProtectionMutation.id||e.id===A.SetWorksheetPermissionPointsMutation.id)){let t=e.params;this._undoRedoService.clearUndoRedo(t.unitId)}}))}},el(mn,"SheetPermissionInitController"),mn);ma=ms([ml(0,O.IUniverInstanceService),ml(1,O.IPermissionService),ml(2,O.IAuthzIoService),ml(3,(0,O.Inject)(A.RangeProtectionRuleModel)),ml(4,(0,O.Inject)(A.WorksheetProtectionRuleModel)),ml(5,(0,O.Inject)(O.UserManagerService)),ml(6,(0,O.Inject)(A.WorksheetProtectionPointModel)),ml(7,(0,O.Inject)(A.SheetInterceptorService)),ml(8,(0,O.Inject)(O.IUndoRedoService)),ml(9,(0,O.Inject)(O.ICommandService)),ml(10,(0,O.Inject)(A.RangeProtectionCache))],ma);let md="UNIVER_SHEET_PERMISSION_ALERT_DIALOG_ID",mc="UNIVER_SHEET_PERMISSION_ALERT_DIALOG";var mu,mh=Object.defineProperty,mm=Object.getOwnPropertyDescriptor,mg=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?mm(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mh(t,i,o),o},"__decorateClass$l"),mp=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$l");let mv=(mu=class extends O.Disposable{constructor(e,t,i,n,r,o,s,l,a,d,c,u){super(),ea(this,"disposableCollection",new O.DisposableCollection),this._commandService=e,this._univerInstanceService=t,this._permissionService=i,this._selectionManagerService=n,this._dialogService=r,this._rangeProtectionRuleModel=o,this._worksheetProtectionRuleModel=s,this._autoFillService=l,this._localeService=a,this._lexerTreeBuilder=d,this._contextService=c,this._definedNamesService=u,this._initialize()}haveNotPermissionHandle(e){let t={id:md,title:{title:""},children:{label:mc,errorMsg:e},width:320,destroyOnClose:!0,onClose:/* @__PURE__ */el(()=>this._dialogService.close(md),"onClose"),className:"sheet-permission-user-dialog"};throw this._permissionService.getShowComponents()&&this._dialogService.open(t),new O.CustomCommandExecutionError("have not permission")}_getPermissionCheck(e,t){var i,n,r;let o=!0,s="";switch(e){case M.InsertCommand.id:case M.IMEInputCommand.id:if(!0===this._contextService.getContextValue(O.FOCUSING_EDITOR_STANDALONE))break;o=this.permissionCheckWithoutRange({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellValuePermission,A.WorksheetEditPermission]}),s=this._localeService.t("permission.dialog.editErr");break;case i7.id:if(!1===t.visible)break;o=this.permissionCheckWithoutRange({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellValuePermission,A.WorksheetEditPermission]}),s=this._localeService.t("permission.dialog.editErr");break;case A.SetRangeValuesCommand.id:(0,O.isICellData)(t.value)&&t.value.f?(o=this._permissionCheckWithFormula(t),s=this._localeService.t("permission.dialog.formulaErr")):o=this._permissionCheckBySetRangeValue({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellValuePermission,A.WorksheetEditPermission]},t);break;case A.ClearSelectionContentCommand.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellValuePermission,A.WorksheetEditPermission]}),s=this._localeService.t("permission.dialog.editErr");break;case ae.id:o=this.permissionCheckWithoutRange({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetColumnStylePermission]}),s=this._localeService.t("permission.dialog.pasteErr");break;case l7.id:o=this._permissionCheckByPaste(t),s=this._localeService.t("permission.dialog.pasteErr");break;case o_.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetCellValuePermission,A.WorksheetSetCellStylePermission]}),s=this._localeService.t("permission.dialog.commonErr");break;case A.SetBackgroundColorCommand.id:case rC.id:case rI.id:case rb.id:case r_.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellStylePermission,A.WorksheetEditPermission]}),s=this._localeService.t("permission.dialog.setStyleErr");break;case l9.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookCopyPermission],rangeTypes:[A.RangeProtectionPermissionViewPoint],worksheetTypes:[A.WorksheetCopyPermission]}),s=this._localeService.t("permission.dialog.copyErr"),null!=(i=this._permissionService.getPermissionPoint(new A.WorkbookCopyPermission(this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId()).id))&&i.value||(s=this._localeService.t("permission.dialog.workbookCopyErr"));break;case l6.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookCopyPermission,A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionViewPoint,A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetCopyPermission,A.WorksheetEditPermission]}),s=this._localeService.t("permission.dialog.copyErr"),null!=(n=this._permissionService.getPermissionPoint(new A.WorkbookCopyPermission(this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getUnitId()).id))&&n.value||(s=this._localeService.t("permission.dialog.workbookCopyErr"));break;case A.DeltaColumnWidthCommand.id:case A.SetColWidthCommand.id:o=this.permissionCheckWithoutRange({worksheetTypes:[A.WorksheetSetColumnStylePermission]}),s=this._localeService.t("permission.dialog.setRowColStyleErr");break;case A.DeltaRowHeightCommand.id:case A.SetRowHeightCommand.id:case A.SetWorksheetRowIsAutoHeightCommand.id:o=this.permissionCheckWithoutRange({worksheetTypes:[A.WorksheetSetRowStylePermission]}),s=this._localeService.t("permission.dialog.setRowColStyleErr");break;case A.MoveColsCommand.id:case A.MoveRowsCommand.id:o=this._permissionCheckByMoveCommand(t),s=this._localeService.t("permission.dialog.moveRowColErr");break;case A.MoveRangeCommand.id:o=this._permissionCheckByMoveRangeCommand(t),s=this._localeService.t("permission.dialog.moveRangeErr");break;case i6.id:o=this._permissionCheckByAutoFillCommand(null==(r=this._autoFillService.autoFillLocation)?void 0:r.target),s=this._localeService.t("permission.dialog.autoFillErr");break;case A.SetWorksheetOrderCommand.id:o=this._permissionCheckByWorksheetCommand([A.WorkbookEditablePermission,A.WorkbookMoveSheetPermission]),s=this._localeService.t("permission.dialog.operatorSheetErr"),!1===o&&this._worksheetProtectionRuleModel.resetOrder();break;case A.SetWorksheetNameCommand.id:o=this._permissionCheckByWorksheetCommand([A.WorkbookEditablePermission,A.WorkbookRenameSheetPermission]),s=this._localeService.t("permission.dialog.operatorSheetErr"),!1===o&&this._worksheetProtectionRuleModel.resetOrder();break;case A.SetWorksheetShowCommand.id:{let{unitId:e,subUnitId:i}=t;o=this._permissionCheckByWorksheetCommand([A.WorkbookEditablePermission,A.WorkbookHideSheetPermission],e,i),s=this._localeService.t("permission.dialog.operatorSheetErr"),!1===o&&this._worksheetProtectionRuleModel.resetOrder()}break;case A.SetSpecificColsVisibleCommand.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetColumnStylePermission]},t.ranges),s=this._localeService.t("permission.dialog.setRowColStyleErr");break;case A.SetSpecificRowsVisibleCommand.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetRowStylePermission]},t.ranges),s=this._localeService.t("permission.dialog.setRowColStyleErr");break;case A.SetSelectedColsVisibleCommand.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetColumnStylePermission]}),s=this._localeService.t("permission.dialog.setRowColStyleErr");break;case A.SetSelectedRowsVisibleCommand.id:o=this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetEditPermission,A.WorksheetSetRowStylePermission]}),s=this._localeService.t("permission.dialog.setRowColStyleErr");break;case A.InsertRangeMoveRightCommand.id:o=this._permissionCheckWithInsertRangeMove("right"),s=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break;case A.InsertRangeMoveDownCommand.id:o=this._permissionCheckWithInsertRangeMove("bottom"),s=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break;case A.DeleteRangeMoveLeftCommand.id:o=this._permissionCheckWithInsertRangeMove("left"),s=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr");break;case A.DeleteRangeMoveUpCommand.id:o=this._permissionCheckWithInsertRangeMove("top"),s=this._localeService.t("permission.dialog.insertOrDeleteMoveRangeErr")}o||this.haveNotPermissionHandle(s)}_initialize(){this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{this._getPermissionCheck(e.id,null==e?void 0:e.params)})),this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var t;if(e.id===A.SetWorksheetNameMutation.id){let{unitId:i=null==(t=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET))?void 0:t.getUnitId(),subUnitId:n}=e.params;if(!i||!n)return;let r=this._worksheetProtectionRuleModel.getRule(i,n),o=this._rangeProtectionRuleModel.getSubunitRuleList(i,n);r&&this._worksheetProtectionRuleModel.ruleRefresh(r.permissionId),o.length&&this._rangeProtectionRuleModel.ruleRefresh(n)}}))}_permissionCheckWithInsertRangeMove(e){var t;let i=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!i)return!1;let{worksheet:n,unitId:r,subUnitId:o}=i,s=(0,O.Tools).deepClone(null==(t=this._selectionManagerService.getCurrentLastSelection())?void 0:t.range);return!(!s||("top"===e||"bottom"===e?s.endRow=n.getRowCount()-1:("left"===e||"right"===e)&&(s.endColumn=n.getColumnCount()-1),this._rangeProtectionRuleModel.getSubunitRuleList(r,o).map(e=>e.ranges).flat().some(e=>(0,O.Rectangle).getIntersects(s,e))))}_permissionCheckByWorksheetCommand(e,t,i){var n,r;let o=(0,A.getSheetCommandTarget)(this._univerInstanceService,{unitId:t,subUnitId:i});if(!o)return!1;let{unitId:s,subUnitId:l}=o,a=this._worksheetProtectionRuleModel.getRule(s,l),d=this._rangeProtectionRuleModel.getSubunitRuleList(s,l).length>0;return a||d?null!=(r=null==(n=this._permissionService.getPermissionPoint(new A.WorkbookManageCollaboratorPermission(s).id))?void 0:n.value)&&r:this._permissionService.composePermission(e.map(e=>new e(s).id)).every(e=>e.value)}permissionCheckWithoutRange(e){var t,i,n,r;let o=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!o)return!1;let{worksheet:s,unitId:l,subUnitId:a}=o,d=this._selectionManagerService.getCurrentLastSelection();if(!d)return!0;let c=null!=(i=null==(t=null==d?void 0:d.primary)?void 0:t.actualRow)?i:0,u=null!=(r=null==(n=null==d?void 0:d.primary)?void 0:n.actualColumn)?r:0,{workbookTypes:h,worksheetTypes:m,rangeTypes:g}=e;return!(h&&!0===h.some(e=>{var t,i;let n=new e(l);return(null!=(i=null==(t=this._permissionService.getPermissionPoint(n.id))?void 0:t.value)&&i)===!1})||m&&!0===m.some(e=>{var t,i;let n=new e(l,a);return(null!=(i=null==(t=this._permissionService.getPermissionPoint(n.id))?void 0:t.value)&&i)===!1})||g&&!0===g.some(e=>{var t,i,n,r,o;let d=null==(i=null==(t=s.getCell(c,u))?void 0:t.selectionProtection)?void 0:i[0];if(!(null!=d&&d.ruleId))return!1;let h=null==(n=this._rangeProtectionRuleModel.getRule(l,a,d.ruleId))?void 0:n.permissionId;if(!h)return!1;let m=new e(l,a,h);return(null!=(o=null==(r=this._permissionService.getPermissionPoint(m.id))?void 0:r.value)&&o)===!1}))}permissionCheckWithRanges(e,t,i,n){var r;let o=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!o)return!1;let{workbook:s,worksheet:l}=o;i||(i=s.getUnitId()),n||(n=l.getSheetId());let a=null!=t?t:null==(r=this._selectionManagerService.getCurrentSelections())?void 0:r.map(e=>e.range);if(!a)return!1;let{workbookTypes:d,worksheetTypes:c,rangeTypes:u}=e,h=[];return d&&h.push(...d.map(e=>new e(i).id)),c&&h.push(...c.map(e=>new e(i,n).id)),u&&this._rangeProtectionRuleModel.getSubunitRuleList(i,n).forEach(e=>{a.some(t=>e.ranges.some(e=>(0,O.Rectangle).intersects(e,t)))&&h.push(...u.map(t=>new t(i,n,e.permissionId).id))}),!h.length||this._permissionService.composePermission(h).every(e=>e.value)}_permissionCheckByPaste(e){return e.value===lK.SPECIAL_PASTE_VALUE||e.value===lK.SPECIAL_PASTE_FORMULA?this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellStylePermission,A.WorksheetEditPermission]}):e.value===lK.SPECIAL_PASTE_FORMAT?this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellStylePermission,A.WorksheetEditPermission]}):this.permissionCheckWithRanges({workbookTypes:[A.WorkbookEditablePermission],rangeTypes:[A.RangeProtectionPermissionEditPoint],worksheetTypes:[A.WorksheetSetCellValuePermission,A.WorksheetSetCellStylePermission,A.WorksheetEditPermission]})}_permissionCheckByMoveCommand(e){let t=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!t)return!1;let{worksheet:i,unitId:n,subUnitId:r}=t,o=e.toRange;o.endRow===i.getRowCount()-1?o.endColumn=o.startColumn:o.endRow=o.startRow;let s=this._rangeProtectionRuleModel.getSubunitRuleList(n,r).reduce((e,t)=>[...e,...t.ranges],[]).filter(e=>(0,O.Rectangle).intersects(e,o));return!(s.length>0)&&(s.forEach(e=>{var t,n;for(let r=e.startRow;r<=e.endRow;r++)for(let o=e.startColumn;o<=e.endColumn;o++){let e=null==(n=null==(t=i.getCell(r,o))?void 0:t.selectionProtection)?void 0:n[0];if((null==e?void 0:e[rA.Edit])===!1)return!1}}),!0)}_permissionCheckByAutoFillCommand(e){if(!e)return!1;let{rows:t,cols:i}=e,n=t[0],r={startRow:n,endRow:t[t.length-1],startColumn:i[0],endColumn:i[i.length-1]},o=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!o)return!1;let{worksheet:s,unitId:l,subUnitId:a}=o;return!this._rangeProtectionRuleModel.getSubunitRuleList(l,a).reduce((e,t)=>[...e,...t.ranges],[]).filter(e=>(0,O.Rectangle).intersects(e,r)).some(e=>{var t,i;for(let n=e.startRow;n<=e.endRow;n++)for(let r=e.startColumn;r<=e.endColumn;r++){let e=null==(i=null==(t=s.getCell(n,r))?void 0:t.selectionProtection)?void 0:i[0];if((null==e?void 0:e[rA.Edit])===!1)return!0}return!1})}_permissionCheckByMoveRangeCommand(e){let t=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!t)return!1;let{worksheet:i,unitId:n,subUnitId:r}=t,o=e.toRange,s=this._rangeProtectionRuleModel.getSubunitRuleList(n,r).reduce((e,t)=>[...e,...t.ranges],[]).filter(e=>(0,O.Rectangle).intersects(e,o));return!(s.length>0)&&(s.forEach(e=>{var t,n;for(let r=e.startRow;r<=e.endRow;r++)for(let o=e.startColumn;o<=e.endColumn;o++){let e=null==(n=null==(t=i.getCell(r,o))?void 0:t.selectionProtection)?void 0:n[0];if((null==e?void 0:e[rA.Edit])===!1)return!1}}),!0)}_permissionCheckBySetRangeValue(e,t){let i=[];i=t.range?[t.range]:[new(0,O.ObjectMatrix)(t.value).getDataRange()];let{unitId:n,subUnitId:r}=t;return this.permissionCheckWithRanges(e,i,n,r)}_permissionCheckWithFormula(e){var t,i,n,r,o;let s=e.value,l=e.range,a=s.f;if(a){let s=a.substring(1),l=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),d=null!=(t=e.unitId)?t:l.getUnitId(),c=this._definedNamesService.getValueByName(d,s);if(c){let e=c.formulaOrRefString;e.startsWith(ei.operatorToken.EQUALS)&&(e=e.slice(1));let t=e.split(",");for(let e=0;e<t.length;e++){let r=t[e],o=(0,ei.deserializeRangeWithSheet)(r);if(o.sheetName){let e=l.getSheetBySheetName(o.sheetName);if(!e)return!0;let{startRow:t,endRow:r,startColumn:s,endColumn:a}=o.range;for(let o=t;o<=r;o++)for(let t=s;t<=a;t++){let r=null==(n=null==(i=e.getCell(o,t))?void 0:i.selectionProtection)?void 0:n[0];if((null==r?void 0:r[rA.View])===!1)return!1}}}return!0}{let e=this._lexerTreeBuilder.sequenceNodesBuilder(a);if(!e)return!0;for(let t=0;t<e.length;t++){let i=e[t];if("string"==typeof i||i.nodeType!==ei.sequenceNodeType.REFERENCE)continue;let{token:n}=i,s=(0,ei.deserializeRangeWithSheetWithCache)(n),l=s.unitId?this._univerInstanceService.getUnit(s.unitId):this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!l)break;let a=s.sheetName?l.getSheetBySheetName(s.sheetName):l.getActiveSheet(),d=l.getUnitId();if(s.sheetName){if(!(a=l.getSheetBySheetName(s.sheetName)))return!0;let e=null==a?void 0:a.getSheetId();if(!this._permissionService.getPermissionPoint(new A.WorksheetViewPermission(d,e).id))return!1}if(!a)break;let{startRow:c,endRow:u,startColumn:h,endColumn:m}=s.range;for(let e=c;e<=u;e++)for(let t=h;t<=m;t++){let i=null==(o=null==(r=a.getCell(e,t))?void 0:r.selectionProtection)?void 0:o[0];if((null==i?void 0:i[rA.View])===!1)return!1}}return!0}}if(l){let t=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!t)return!1;let i=e.unitId||t.unitId,n=e.subUnitId||t.subUnitId,r=this._rangeProtectionRuleModel.getSubunitRuleList(i,n).filter(e=>e.ranges.some(e=>(0,O.Rectangle).intersects(e,l))).map(e=>new A.RangeProtectionPermissionEditPoint(i,n,e.permissionId).id);if(!this._permissionService.composePermission(r).every(e=>e.value))return!1}return!0}},el(mu,"SheetPermissionInterceptorBaseController"),mu);mv=mg([mp(0,O.ICommandService),mp(1,O.IUniverInstanceService),mp(2,O.IPermissionService),mp(3,(0,O.Inject)(A.SheetsSelectionsService)),mp(4,J.IDialogService),mp(5,(0,O.Inject)(A.RangeProtectionRuleModel)),mp(6,(0,O.Inject)(A.WorksheetProtectionRuleModel)),mp(7,i9),mp(8,(0,O.Inject)(O.LocaleService)),mp(9,(0,O.Inject)(ei.LexerTreeBuilder)),mp(10,O.IContextService),mp(11,ei.IDefinedNamesService)],mv);var mS=Object.defineProperty,mf=Object.getOwnPropertyDescriptor,mC=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?mf(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mS(t,i,o),o},"__decorateClass$k"),mI=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$k");let mb=(0,O.createInterceptorKey)("freezePermissionCheck"),m_=(mL=class extends O.Disposable{constructor(e,t,i,n,r,o,s,l){super(),ea(this,"_rowFreezeHeaderRect"),ea(this,"_rowFreezeMainRect"),ea(this,"_columnFreezeHeaderRect"),ea(this,"_columnFreezeMainRect"),ea(this,"_freezeDownSubs"),ea(this,"_freezePointerEnterSubs"),ea(this,"_freezePointerLeaveSubs"),ea(this,"_scenePointerMoveSub"),ea(this,"_scenePointerUpSub"),ea(this,"_changeToRow",-1),ea(this,"_changeToColumn",-1),ea(this,"_changeToOffsetX",0),ea(this,"_changeToOffsetY",0),ea(this,"_activeViewport",null),ea(this,"_freezeNormalHeaderColor",""),ea(this,"_freezeNormalMainColor",""),ea(this,"_freezeActiveColor",""),ea(this,"_freezeHoverColor",""),ea(this,"_lastFreeze"),ea(this,"interceptor",new O.InterceptorManager({FREEZE_PERMISSION_CHECK:mb})),this._context=e,this._sheetSkeletonManagerService=t,this._commandService=i,this._selectionManagerService=n,this._scrollManagerService=r,this._themeService=o,this._sheetInterceptorService=s,this._injector=l,this._initialize()}dispose(){super.dispose()}_initialize(){this._skeletonListener(),this._commandExecutedListener(),this._themeChangeListener(),this._interceptorCommands(),this._bindViewportScroll(),this._zoomRefresh()}_createFreeze(e=0,t){var i;let n=null!=t?t:this._getFreeze();if(null==n)return null;let r=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton,{startRow:o,startColumn:s}=n,l=this._getPositionByIndex(o,s);if(null==l||null==r)return null;let a=this._getSheetObject(),d=a.engine,c=(null==d?void 0:d.width)||0,u=(null==d?void 0:d.height)||0,h=a.scene,{startX:m,startY:g}=l,{rowTotalHeight:p,columnTotalWidth:v,rowHeaderWidthAndMarginLeft:S,columnHeaderHeightAndMarginTop:f}=r,C=c>v+S?c:v+f,I=u>p+f?u:p+f;this._changeToRow=o,this._changeToColumn=s,this._changeToOffsetX=m,this._changeToOffsetY=g;let b=Math.max(h.scaleX,h.scaleY),_=2/(b<1?1:b);if(0===e){(-1===o||0===o)&&(_*=2);let e=_;this._rowFreezeHeaderRect=new x.Rect("__SpreadsheetFreezeRowHeaderName__",{fill:this._freezeNormalHeaderColor,width:S,height:_,left:0,top:g-e,zIndex:3});let t=this._freezeNormalHeaderColor;(-1===o||0===o)&&(t=this._freezeNormalMainColor),this._rowFreezeMainRect=new x.Rect("__SpreadsheetFreezeRowMainName__",{fill:t,width:2*C/b,height:_,left:S,top:g-e,zIndex:3}),h.addObjects([this._rowFreezeHeaderRect,this._rowFreezeMainRect],10)}else{(-1===s||0===s)&&(_*=2);let e=_;this._columnFreezeHeaderRect=new x.Rect("__SpreadsheetFreezeColumnHeaderName__",{fill:this._freezeNormalHeaderColor,width:_,height:f,left:m-e,top:0,zIndex:3});let t=this._freezeNormalHeaderColor;(-1===s||0===s)&&(t=this._freezeNormalMainColor),this._columnFreezeMainRect=new x.Rect("__SpreadsheetFreezeColumnMainName__",{fill:t,width:_,height:2*I/b,left:m-e,top:f,zIndex:3}),h.addObjects([this._columnFreezeHeaderRect,this._columnFreezeMainRect],10)}this._eventBinding(e)}_eventBinding(e=0){let t=this._rowFreezeHeaderRect,i=this._rowFreezeMainRect;1===e&&(t=this._columnFreezeHeaderRect,i=this._columnFreezeMainRect);let n=this._getSheetObject();if(null==n)return;let{scene:r}=n;if(this._freezePointerEnterSubs=new G.Subscription,this._freezePointerLeaveSubs=new G.Subscription,this._freezeDownSubs=new G.Subscription,i){let e=i.onPointerEnter$.subscribeEvent(()=>{if(!this.interceptor.fetchThroughInterceptors(mb)(!0,null))return!1;null==t||t.setProps({fill:this._freezeHoverColor,zIndex:4}),r.setCursor(x.CURSOR_TYPE.GRAB)});this._freezePointerEnterSubs.add(e);let n=i.onPointerLeave$.subscribeEvent(()=>{null==t||t.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),r.resetCursor()});this._freezePointerLeaveSubs.add(n)}if(t){let e=t.onPointerEnter$.subscribeEvent(()=>{if(!this.interceptor.fetchThroughInterceptors(mb)(!0,null))return!1;null==t||t.setProps({fill:this._freezeHoverColor,zIndex:4}),r.setCursor(x.CURSOR_TYPE.GRAB)});this._freezePointerEnterSubs.add(e);let i=t.onPointerLeave$.subscribeEvent(()=>{null==t||t.setProps({fill:this._freezeNormalHeaderColor,zIndex:3}),r.resetCursor()});this._freezePointerLeaveSubs.add(i)}let o=null==t?void 0:t.onPointerDown$.subscribeEvent(n=>{this._freezeDown(n,t,i,e)});o&&this._freezeDownSubs.add(o);let s=null==i?void 0:i.onPointerDown$.subscribeEvent(n=>{this._freezeDown(n,t,i,e)});s&&this._freezeDownSubs.add(s)}_getCurrentLastVisible(){var e,t,i,n,r,o,s;let l=this._getSheetObject();if(null==l)return;let a=null==(e=this._sheetSkeletonManagerService.getCurrent())?void 0:e.skeleton;if(null==a)return;let d=l.scene,c=Math.max(d.scaleX,d.scaleY),u=this._scrollManagerService.getCurrentScrollState(),h=(l.engine.height-a.columnHeaderHeight)/c,m=(l.engine.width-a.rowHeaderWidth)/c,g=null!=(t=null==u?void 0:u.sheetViewStartRow)?t:0,p=0===g?-(null!=(i=null==u?void 0:u.offsetY)?i:0):a.rowHeightAccumulation[g-1]-(null!=(n=null==u?void 0:u.offsetY)?n:0),v=0,S=!1;for(let e=g,t=a.rowHeightAccumulation.length;e<t;e++)if(a.rowHeightAccumulation[e]-p>h){v=e,S=!0;break}S||(v=a.rowHeightAccumulation.length-1);let f=null!=(r=null==u?void 0:u.sheetViewStartColumn)?r:0,C=0===f?-(null!=(o=null==u?void 0:u.offsetX)?o:0):a.columnWidthAccumulation[f-1]-(null!=(s=null==u?void 0:u.offsetX)?s:0),I=0,b=!1;for(let e=f,t=a.columnWidthAccumulation.length;e<t;e++)if(a.columnWidthAccumulation[e]-C>m){I=e,b=!0;break}return b||(I=a.columnWidthAccumulation.length-1),{lastRow:v,lastColumn:I}}_getActiveViewport(e){var t;let i=null==(t=this._getSheetObject())?void 0:t.scene.getViewports();return i&&i.find(t=>t.isHit(new x.Vector2(e.offsetX,e.offsetY)))||null}_freezeDown(e,t,i,n=0){var r;let o=null==(r=this._sheetSkeletonManagerService.getCurrent())?void 0:r.skeleton;if(null==o)return;let s=this._getSheetObject();if(null==s)return;if(!this.interceptor.fetchThroughInterceptors(mb)(!0,null))return!1;let{scene:l}=s;l.setCursor(x.CURSOR_TYPE.GRABBING),l.disableObjectsEvent();let a=this._getCurrentLastVisible(),d=void 0===a?Number.POSITIVE_INFINITY:o.rowHeightAccumulation[a.lastRow],c=void 0===a?Number.POSITIVE_INFINITY:o.columnWidthAccumulation[a.lastColumn-1]+o.rowHeaderWidth;this._activeViewport=null;let u=this._getFreeze();u&&(this._changeToColumn=u.startColumn,this._changeToRow=u.startRow),this._scenePointerMoveSub=l.onPointerMove$.subscribeEvent(e=>{var r,s,u,h;let m=this._getActiveViewport(e),{startX:g,startY:p,row:v,column:S}=tv(e.offsetX,e.offsetY,l,o,m||void 0,!0);if(!this.interceptor.fetchThroughInterceptors(mb)(!0,null))return!1;l.setCursor(x.CURSOR_TYPE.GRABBING);let f=2/Math.max(l.scaleX,l.scaleY);0===n?(null==(r=t.transformByState({top:Math.min(p,d)-f/2}))||r.setProps({fill:this._freezeActiveColor}),null==(s=i.transformByState({top:Math.min(p,d)-f/2}))||s.setProps({fill:this._freezeNormalHeaderColor}),this._changeToRow=void 0===a?v:Math.min(v,a.lastRow),this._changeToOffsetY=Math.min(p,d)):(null==(u=t.transformByState({left:Math.min(g,c)-f/2}))||u.setProps({fill:this._freezeActiveColor}),null==(h=i.transformByState({left:Math.min(g,c)-f/2}))||h.setProps({fill:this._freezeNormalHeaderColor}),this._changeToColumn=void 0===a?S:Math.min(S,a.lastColumn),this._changeToOffsetX=g),this._activeViewport=m}),this._scenePointerUpSub=l.onPointerUp$.subscribeEvent(()=>{var e,r;l.resetCursor(),l.enableObjectsEvent(),this._clearObserverEvent();let{rowHeaderWidthAndMarginLeft:s,columnHeaderHeightAndMarginTop:a}=o;0===n&&(0===this._changeToRow||-1===this._changeToRow)||1===n&&(0===this._changeToColumn||-1===this._changeToColumn)?(t.setProps({fill:this._freezeNormalHeaderColor}),i.setProps({fill:this._freezeNormalMainColor})):(null==t||t.setProps({fill:this._freezeNormalHeaderColor}),null==i||i.setProps({fill:this._freezeNormalHeaderColor}));let d=2/Math.max(l.scaleX,l.scaleY);0===n?(0===this._changeToRow||-1===this._changeToRow)&&(t.transformByState({top:a-d}),i.transformByState({top:a-d})):(0===this._changeToColumn||-1===this._changeToColumn)&&(t.transformByState({left:s-d}),i.transformByState({left:s-d}));let{sheetViewStartRow:c,sheetViewStartColumn:u}=this._scrollManagerService.getCurrentScrollState()||{sheetViewStartRow:0,sheetViewStartColumn:0};if(null==u||null==c)return;let h=this._context.unit,m=h.getActiveSheet();if(!m)return;let g=null==(e=m.getConfig())?void 0:e.freeze,p=(null==g?void 0:g.xSplit)||0,v=(null==g?void 0:g.ySplit)||0,S=null==(r=this._activeViewport)?void 0:r.viewportKey;0===n&&(v=(v=S&&S!==x.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP&&S!==x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&S!==x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP&&S!==x.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP?this._changeToRow-c:this._changeToRow-(g.startRow-g.ySplit))<0?0:v),1===n&&(p=(p=S&&S!==x.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP&&S!==x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP&&S!==x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT&&S!==x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT?this._changeToColumn-u:this._changeToColumn-(g.startColumn-g.xSplit))<0?0:p),this._commandService.executeCommand(A.SetFrozenCommand.id,{startRow:0===v?-1:this._changeToRow,startColumn:0===p?-1:this._changeToColumn,ySplit:v,xSplit:p,unitId:h.getUnitId(),subUnitId:m.getSheetId()})})}_getViewports(){let e=this._getSheetObject();if(null==e)return;let{scene:t}=e,i=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT),n=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT),r=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP),o=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM),s=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP),l=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),a=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP),d=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT),c=t.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP);if(!(null==i||null==n||null==r||null==o||null==s||null==l||null==a||null==d||null==c))return{viewMain:l,viewMainLeftTop:a,viewMainLeft:d,viewMainTop:c,viewColumnLeft:i,viewColumnRight:n,viewRowTop:r,viewRowBottom:o,viewLeftTop:s}}_bindViewportScroll(){let e=this._getViewports();if(!e)return;let{viewRowBottom:t,viewColumnRight:i,viewMainLeft:n,viewMainTop:r}=e;this.disposeWithMe(this._scrollManagerService.validViewportScrollInfo$.subscribe(e=>{if(!e)return;let{scrollX:o,scrollY:s,viewportScrollX:l,viewportScrollY:a}=e;t.isActive&&t.updateScrollVal({scrollY:s,viewportScrollY:a}),i.isActive&&i.updateScrollVal({scrollX:o,viewportScrollX:l}),n.isActive&&n.updateScrollVal({scrollY:s,viewportScrollY:a}),r.isActive&&r.updateScrollVal({scrollX:o,viewportScrollX:l})}))}_updateViewport(e=-1,t=-1,i=0,n=0,r=3){var o;let s=null==(o=this._sheetSkeletonManagerService.getCurrent())?void 0:o.skeleton;if(null==s)return;let{rowHeaderWidthAndMarginLeft:l,columnHeaderHeightAndMarginTop:a}=s,d=this._getViewports();if(!d)return;let{viewMain:c,viewMainLeftTop:u,viewMainLeft:h,viewMainTop:m,viewColumnLeft:g,viewColumnRight:p,viewRowTop:v,viewRowBottom:S,viewLeftTop:f}=d;p.resizeWhenFreezeChange({left:l,top:0,height:a,right:0}),S.resizeWhenFreezeChange({left:0,top:a,bottom:0,width:l}),f.resizeWhenFreezeChange({left:0,top:0,width:l,height:a});let C=!0,I=!0;u.enable(),(-1===e||0===e)&&(C=!1),(-1===t||0===t)&&(I=!1);let b=s.getNoMergeCellPositionByIndexWithNoHeader(e-i,t-n),_=s.getNoMergeCellPositionByIndexWithNoHeader(e,t);if(u.disable(),m.disable(),h.disable(),v.disable(),g.disable(),u.resetPadding(),m.resetPadding(),h.resetPadding(),v.resetPadding(),g.resetPadding(),!1===C&&!1===I)c.resizeWhenFreezeChange({left:l,top:a,bottom:0,right:0}),c.resetPadding();else if(!0===C&&!1===I){let e=_.startY-b.startY;c.resizeWhenFreezeChange({left:l,top:a+e,bottom:0,right:0}),c.setPadding({startY:b.startY,endY:_.startY,startX:0,endX:0}),2&r&&this._commandService.executeCommand(eE.id,{sheetViewStartRow:0,offsetY:0}),m.resizeWhenFreezeChange({left:l,top:a,height:e,right:0}),m.updateScrollVal({viewportScrollY:b.startY,rawScrollX:c.scrollX,viewportScrollX:c.viewportScrollX}),v.resizeWhenFreezeChange({left:0,top:a,width:l,height:e}),v.updateScrollVal({viewportScrollY:b.startY}),S.resizeWhenFreezeChange({left:0,top:a+e,bottom:0,width:l}),m.enable(),v.enable()}else if(!1===C&&!0===I){let e=_.startX-b.startX;c.resizeWhenFreezeChange({left:l+e,top:a,bottom:0,right:0}),c.setPadding({startX:b.startX,endX:_.startX,startY:0,endY:0}),1&r&&this._commandService.executeCommand(eE.id,{sheetViewStartColumn:0,offsetX:0}),h.resizeWhenFreezeChange({left:l,top:a,width:e,bottom:0,right:0}),h.updateScrollVal({viewportScrollX:b.startX,rawScrollY:c.scrollY,viewportScrollY:c.viewportScrollY}),g.resizeWhenFreezeChange({left:l,top:0,width:e,height:a}),g.updateScrollVal({viewportScrollX:b.startX}),p.resizeWhenFreezeChange({left:l+e,top:0,height:a,right:0}),h.enable(),g.enable()}else{let e=_.startX-b.startX,t=_.startY-b.startY;c.resizeWhenFreezeChange({left:l+e,top:a+t,bottom:0,right:0}),c.setPadding({startY:b.startY,endY:_.startY,startX:b.startX,endX:_.startX}),r&&this._commandService.executeCommand(eE.id,{...1&r?{sheetViewStartColumn:0,offsetX:0}:null,...2&r?{sheetViewStartRow:0,offsetY:0}:null}),h.resizeWhenFreezeChange({left:l,top:a+t,width:e,bottom:0}),h.updateScrollVal({viewportScrollX:b.startX,rawScrollY:c.scrollY,viewportScrollY:c.viewportScrollY}),m.resizeWhenFreezeChange({left:l+e,top:a,height:t,right:0}),m.updateScrollVal({viewportScrollY:b.startY,rawScrollX:c.scrollX,viewportScrollX:c.viewportScrollX}),u.resizeWhenFreezeChange({left:l,top:a,width:e,height:t}),u.updateScrollVal({viewportScrollX:b.startX,viewportScrollY:b.startY}),v.resizeWhenFreezeChange({left:0,top:a,width:l,height:t}),v.updateScrollVal({viewportScrollY:b.startY}),S.resizeWhenFreezeChange({left:0,top:a+t,bottom:0,width:l}),g.resizeWhenFreezeChange({left:l,top:0,width:e,height:a}),g.updateScrollVal({viewportScrollX:b.startX}),p.resizeWhenFreezeChange({left:l+e,top:0,height:a,right:0}),u.enable(),m.enable(),h.enable(),v.enable(),g.enable()}}_skeletonListener(){this.disposeWithMe((0,O.toDisposable)(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{[(0,A.SetWorksheetActiveOperation).id,(0,A.InsertRangeMoveDownCommand).id,(0,A.InsertRangeMoveRightCommand).id].includes((null==e?void 0:e.commandId)||"")&&this._refreshCurrent()})))}_refreshCurrent(){let e=this._context.unit.getActiveSheet();if(!e)return;let{startRow:t=-1,startColumn:i=-1,ySplit:n=0,xSplit:r=0}=e.getConfig().freeze;this._refreshFreeze(t,i,n,r,0)}_themeChangeListener(){this._themeChange(this._themeService.getCurrentTheme()),this.disposeWithMe(this._themeService.currentTheme$.subscribe(e=>{this._clearFreeze(),this._themeChange(e),this._refreshCurrent()}))}_themeChange(e){this._freezeNormalHeaderColor=e.grey400,this._freezeNormalMainColor=new(0,O.ColorKit)(e.grey400).setAlpha(.01).toRgbString(),this._freezeActiveColor=e.primaryColor,this._freezeHoverColor=e.grey500}_interceptorCommands(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:/* @__PURE__ */el(e=>{let t={redos:[],undos:[]},i=this._getFreeze();if(!i)return t;let n=/* @__PURE__ */el(e=>{let i=this._context.unit,n=i.getUnitId(),r=i.getActiveSheet();if(!r)return t;let o=r.getSheetId();this._refreshFreeze(e.startRow,e.startColumn,e.ySplit,e.xSplit,0);let s={...e,unitId:n,subUnitId:o,resetScroll:!1},l=(0,A.SetFrozenMutationFactory)(this._injector,s);return{undos:[{id:A.SetFrozenMutation.id,params:l}],redos:[{id:A.SetFrozenMutation.id,params:s}]}},"createFreezeMutationAndRefresh");if(e.id===A.InsertRowCommand.id){let{range:t,direction:r}=e.params,o=t.endRow-t.startRow+1;if(t.startRow+1<i.startRow||t.startRow+1===i.startRow&&r===O.Direction.UP)return n({...i,startRow:Math.max(1,i.startRow+o),ySplit:Math.max(1,i.ySplit+o)})}if(e.id===A.InsertColCommand.id){let{range:t,direction:r}=e.params,o=t.endColumn-t.startColumn+1;if(t.startColumn+1<i.startColumn||t.startColumn+1===i.startColumn&&r===O.Direction.LEFT)return n({...i,startColumn:Math.max(1,i.startColumn+o),xSplit:Math.max(1,i.xSplit+o)})}if(e.id===A.MoveColsCommand.id){let r,o;let s=this._selectionManagerService.getCurrentSelections(),{fromRange:{startColumn:l},toRange:{startColumn:a}}=e.params,d=null==s?void 0:s.filter(e=>e.range.rangeType===O.RANGE_TYPE.COLUMN&&e.range.startColumn<=l&&l<=e.range.endColumn);if(!(null!=d&&d.length))return t;let c=d[0].range,u={...c,startColumn:a,endColumn:a+c.endColumn-c.startColumn};if(!i||i.startColumn<=0||c.startColumn>=i.startColumn&&u.startColumn>=i.startColumn||c.startColumn===u.startColumn||c.endColumn<i.startColumn&&u.startColumn<i.startColumn)return t;let h=c.endColumn-c.startColumn+1,m=Math.max(Math.min(i.startColumn,c.endColumn+1)-c.startColumn,0);return u.startColumn>=i.startColumn?(r=Math.max(i.startColumn-m,1),o=Math.max(i.xSplit-m,1)):(r=i.startColumn+h-m,o=i.xSplit+h-m),n({...i,startColumn:r,xSplit:o})}if(e.id===A.MoveRowsCommand.id){let r,o;let s=this._selectionManagerService.getCurrentSelections(),{fromRange:{startRow:l},toRange:{startRow:a}}=e.params,d=null==s?void 0:s.filter(e=>e.range.rangeType===O.RANGE_TYPE.ROW&&e.range.startRow<=l&&l<=e.range.endRow);if(!(null!=d&&d.length))return t;let c=d[0].range,u={...c,startRow:a,endRow:a+c.endRow-c.startRow};if(!i||i.startRow<=0||c.startRow>=i.startRow&&u.startRow>=i.startRow||c.startRow===u.startRow||c.endRow<i.startRow&&u.startRow<i.startRow)return t;let h=c.endRow-c.startRow+1,m=Math.max(Math.min(i.startRow,c.endRow+1)-c.startRow,0);return u.startRow>=i.startRow?(r=Math.max(i.startRow-m,1),o=Math.max(i.ySplit-m,1)):(r=i.startRow+h-m,o=i.ySplit+h-m),n({...i,startRow:r,ySplit:o})}if(e.id===A.RemoveColCommand.id||e.id===A.RemoveRowCommand.id){let t=e.params,r=t.range;if(r.rangeType===O.RANGE_TYPE.COLUMN&&r.startColumn<i.startColumn){let e=Math.min(i.startColumn,r.endColumn+1)-r.startColumn;return n({...i,startColumn:Math.max(1,i.startColumn-e),xSplit:Math.max(1,i.xSplit-e)})}if(t.range.rangeType===O.RANGE_TYPE.ROW&&r.startRow<i.startRow){let e=Math.min(i.startRow,r.endRow+1)-r.startRow;return n({...i,startRow:Math.max(1,i.startRow-e),ySplit:Math.max(1,i.ySplit-e)})}}return t},"getMutations")}))}_commandExecutedListener(){let e=[A.SetFrozenMutation.id,na.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){let e=this._lastFreeze,i=this._context.unit,n=i.getActiveSheet(),r=t.params,{unitId:o,subUnitId:s}=r;if(!(o===i.getUnitId()&&s===(null==n?void 0:n.getSheetId())))return;let l=n.getConfig().freeze;if(this._lastFreeze=l,null==l)return;let a=0,{startRow:d=-1,startColumn:c=-1,ySplit:u=0,xSplit:h=0}=l;e&&e.startRow===d&&e.ySplit===u||(a|=2),e&&e.startColumn===c&&e.xSplit===h||(a|=1),!1===r.resetScroll&&(a=0),this._refreshFreeze(d,c,u,h,a)}else if(t.id===A.SetWorksheetRowHeightMutation.id){let e=this._getFreeze(),i=e&&t.params.ranges.some(t=>t.startRow<e.startRow);t.params&&i&&this._refreshCurrent()}else if(t.id===A.SetWorksheetColWidthMutation.id){let e=this._getFreeze();t.params&&e&&t.params.ranges.some(t=>t.startColumn<e.startColumn)&&this._refreshCurrent()}else if(t.id===A.SetWorksheetRowAutoHeightMutation.id){let e=t.params,i=this._getFreeze();if(i&&i.startRow>-1&&e.rowsAutoHeightInfo.some(e=>e.row<i.startRow)){let e=this._sheetSkeletonManagerService.currentSkeleton$.subscribe(()=>{this._refreshCurrent(),setTimeout(()=>{e.unsubscribe()})})}}else if(t.id===A.SetColHiddenMutation.id||t.id===A.SetColVisibleMutation.id){let e=t.params,i=this._getFreeze(),n=e.ranges;i&&i.startColumn>-1&&n.some(e=>e.startColumn<i.startColumn)&&this._refreshCurrent()}else if(t.id===A.SetRowHiddenMutation.id||t.id===A.SetRowVisibleMutation.id){let e=t.params,i=this._getFreeze(),n=e.ranges;i&&i.startRow>-1&&n.some(e=>e.startRow<i.startRow)&&this._refreshCurrent()}}))}_zoomRefresh(){let e=this._getSheetObject();if(null==e)return;let{scene:t}=e;t.onTransformChange$.subscribeEvent(e=>{e.type===x.TRANSFORM_CHANGE_OBSERVABLE_TYPE.scale&&this._refreshCurrent()})}_clearObserverEvent(){var e,t;null!=this._getSheetObject()&&(null==(e=this._scenePointerMoveSub)||e.unsubscribe(),null==(t=this._scenePointerUpSub)||t.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null)}_clearFreeze(){var e,t,i,n,r,o;null==(e=this._rowFreezeHeaderRect)||e.dispose(),null==(t=this._rowFreezeMainRect)||t.dispose(),null==(i=this._columnFreezeHeaderRect)||i.dispose(),null==(n=this._columnFreezeMainRect)||n.dispose(),null!=this._getSheetObject()&&([this._freezeDownSubs,this._freezePointerEnterSubs,this._freezePointerLeaveSubs].forEach(e=>{null==e||e.unsubscribe()}),this._freezeDownSubs=null,this._freezePointerEnterSubs=null,this._freezePointerLeaveSubs=null,null==(r=this._scenePointerMoveSub)||r.unsubscribe(),null==(o=this._scenePointerUpSub)||o.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null)}_getPositionByIndex(e,t){var i;if(null==this._getSheetObject())return;let n=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton,r=null==n?void 0:n.getNoMergeCellPositionByIndex(e,t);if(null==n)return;if(null!=r&&(!isNaN(r.endX)||!isNaN(r.endY)))return r;let{rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:s}=n;return{startX:o,endX:o,startY:s,endY:s}}_getFreeze(){var e;let t=null==(e=this._sheetSkeletonManagerService.getCurrent())?void 0:e.skeleton.getWorksheetConfig();if(null!=t)return t.freeze}_getSheetObject(){return tg(this._context.unit,this._context)}_refreshFreeze(e,t,i,n,r){var o;let s={startRow:e,startColumn:t,ySplit:i,xSplit:n};this._clearFreeze(),this._createFreeze(0,s),this._createFreeze(1,s),this._updateViewport(e,t,i,n,r),null==(o=this._getSheetObject())||o.spreadsheet.makeForceDirty()}},el(mL,"HeaderFreezeRenderController"),mL);m_=mC([mI(1,(0,O.Inject)(ev)),mI(2,O.ICommandService),mI(3,(0,O.Inject)(A.SheetsSelectionsService)),mI(4,(0,O.Inject)(eR)),mI(5,(0,O.Inject)(O.ThemeService)),mI(6,(0,O.Inject)(A.SheetInterceptorService)),mI(7,(0,O.Inject)(O.Injector))],m_);var mR=Object.defineProperty,my=Object.getOwnPropertyDescriptor,mT=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?my(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mR(t,i,o),o},"__decorateClass$j"),mE=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$j");let mw=(0,O.createInterceptorKey)("headerMovePermissionCheck"),mP=(mB=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_startOffsetX",Number.NEGATIVE_INFINITY),ea(this,"_startOffsetY",Number.NEGATIVE_INFINITY),ea(this,"_moveHelperBackgroundShape"),ea(this,"_moveHelperLineShape"),ea(this,"_headerPointerDownSubs"),ea(this,"_headerPointerMoveSubs"),ea(this,"_headerPointerLeaveSubs"),ea(this,"_dragHeaderMoveSub"),ea(this,"_scenePointerUpSub"),ea(this,"_scrollTimer"),ea(this,"_changeFromColumn",-1),ea(this,"_changeFromRow",-1),ea(this,"_changeToColumn",-1),ea(this,"_changeToRow",-1),ea(this,"interceptor",new O.InterceptorManager({HEADER_MOVE_PERMISSION_CHECK:mw})),ea(this,"_workbookSelections"),this._context=e,this._sheetSkeletonManagerService=i,this._commandService=n,this._workbookSelections=t.getWorkbookSelections(this._context.unitId),this._init()}dispose(){var e,t,i,n,r,o,s,l;null==(e=this._moveHelperBackgroundShape)||e.dispose(),null==(t=this._moveHelperLineShape)||t.dispose(),null==(i=this._headerPointerMoveSubs)||i.unsubscribe(),null==(n=this._headerPointerLeaveSubs)||n.unsubscribe(),null==(r=this._headerPointerDownSubs)||r.unsubscribe(),this._headerPointerMoveSubs=null,this._headerPointerLeaveSubs=null,this._headerPointerDownSubs=null,null==(o=this._dragHeaderMoveSub)||o.unsubscribe(),null==(s=this._scenePointerUpSub)||s.unsubscribe(),this._dragHeaderMoveSub=null,this._scenePointerUpSub=null,null==(l=this._scrollTimer)||l.dispose()}_init(){this._initialRowOrColumn(O.RANGE_TYPE.ROW),this._initialRowOrColumn(O.RANGE_TYPE.COLUMN)}_initialRowOrColumn(e=O.RANGE_TYPE.ROW){let t=this._context.components.get(eO.COLUMN),i=this._context.components.get(eO.ROW),n=this._context.scene,r=e===O.RANGE_TYPE.ROW?i:t,o=/* @__PURE__ */el(t=>{var i,r;let o=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton;if(null==o)return;let s=null==(r=this._workbookSelections.getCurrentLastSelection())?void 0:r.range;if(!s||!this.interceptor.fetchThroughInterceptors(mw)(!1,s))return;let l=this._workbookSelections.getCurrentSelections(),{row:a,column:d}=tv(t.offsetX,t.offsetY,n,o);if(!dm(l,e===O.RANGE_TYPE.ROW?a:d,e)){n.resetCursor();return}n.setCursor(x.CURSOR_TYPE.GRAB)},"pointerMoveHandler"),s=/* @__PURE__ */el(()=>{var e,t;null==(e=this._moveHelperBackgroundShape)||e.hide(),null==(t=this._moveHelperLineShape)||t.hide(),n.resetCursor()},"pointerLeaveHandler"),l=/* @__PURE__ */el((t,i)=>{var r,o;let s;if(i.isStopPropagation)return;let l=null==(r=this._sheetSkeletonManagerService.getCurrent())?void 0:r.skeleton;if(null==l)return;let a=null==(o=this._workbookSelections.getCurrentLastSelection())?void 0:o.range;if(!a||!this.interceptor.fetchThroughInterceptors(mw)(!1,a))return;let{offsetX:d,offsetY:c}=t,{x:u,y:h}=n.getRelativeToViewportCoord((0,x.Vector2).FromArray([d,c]));this._startOffsetX=u,this._startOffsetY=h;let{row:m,column:g}=tv(t.offsetX,t.offsetY,n,l);e===O.RANGE_TYPE.ROW?(this._changeFromRow=m,s=x.ScrollTimerType.Y):(this._changeFromColumn=g,s=x.ScrollTimerType.X);let p=dm(this._workbookSelections.getCurrentSelections(),e===O.RANGE_TYPE.ROW?m:g,e);if(!p)return;let v=n.getVpScrollXYInfoByPosToVp((0,x.Vector2).FromArray([this._startOffsetX,this._startOffsetY]));this._newBackgroundAndLine(),n.setCursor(x.CURSOR_TYPE.GRABBING),n.disableObjectsEvent();let S=!1,f,C=/* @__PURE__ */el(()=>{if(S)return;f=(0,x.ScrollTimer).create(n,s),this._scrollTimer=f;let e=n.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);f.startScroll(u,h,e),S=!0},"initScrollTimer");this._dragHeaderMoveSub=n.onPointerMove$.subscribeEvent(t=>{C();let{offsetX:i,offsetY:r}=t,{x:o,y:s}=n.getRelativeToViewportCoord((0,x.Vector2).FromArray([i,r]));this._rowColumnMoving(o,s,p,v,e),f.scrolling(o,s,()=>{this._rowColumnMoving(o,s,p,v,e)})}),this._scenePointerUpSub=n.onPointerUp$.subscribeEvent(()=>{var t,i,r;this._disposeBackgroundAndLine(),n.resetCursor(),n.enableObjectsEvent(),this._clearObserverEvent(),null==(t=this._scrollTimer)||t.dispose();let o=this._workbookSelections.getCurrentSelections();if(e===O.RANGE_TYPE.ROW){if(this._changeFromRow!==this._changeToRow&&-1!==this._changeToRow){let e=null==(i=((null==o?void 0:o.filter(e=>e.range.rangeType===O.RANGE_TYPE.ROW&&e.range.startRow<=this._changeFromRow&&this._changeFromRow<=e.range.endRow))||[])[0])?void 0:i.range;e&&this._commandService.executeCommand(A.MoveRowsCommand.id,{fromRange:e,toRange:{...e,startRow:this._changeToRow,endRow:this._changeToRow+e.endRow-e.startRow}})}this._changeToRow=this._changeFromRow=-1}else{if(this._changeFromColumn!==this._changeToColumn&&-1!==this._changeToColumn){let e=null==(r=((null==o?void 0:o.filter(e=>e.range.rangeType===O.RANGE_TYPE.COLUMN&&e.range.startColumn<=this._changeFromColumn&&this._changeFromColumn<=e.range.endColumn))||[])[0])?void 0:r.range;e&&this._commandService.executeCommand(A.MoveColsCommand.id,{fromRange:e,toRange:{...e,startColumn:this._changeToColumn,endColumn:this._changeToColumn+e.endColumn-e.startColumn}})}this._changeToColumn=this._changeFromColumn=-1}})},"pointerDownHandler");this._headerPointerMoveSubs=new G.Subscription,this._headerPointerMoveSubs.add(r.onPointerMove$.subscribeEvent(o)),this._headerPointerLeaveSubs=new G.Subscription,this._headerPointerLeaveSubs.add(null==r?void 0:r.onPointerLeave$.subscribeEvent(s)),this._headerPointerDownSubs=new G.Subscription,this._headerPointerDownSubs.add(null==r?void 0:r.onPointerDown$.subscribeEvent(l))}_rowColumnMoving(e,t,i,n,r){var o,s,l,a,d,c,u;let h=this._context.scene,m=null==(o=this._sheetSkeletonManagerService.getCurrent())?void 0:o.skeleton;if(null==m)return;let{rowHeaderWidth:g,columnHeaderHeight:p,rowTotalHeight:v,columnTotalWidth:S}=m,f=h.getViewportScrollXY(h.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN)),{scaleX:C,scaleY:I}=h.getAncestorScale(),{row:b,column:_}=m.getCellPositionByOffset(e,t,C,I,f),{startX:R,startY:y,endX:T,endY:E}=m.getNoMergeCellPositionByIndex(b,_),w=this._sheetSkeletonManagerService.attachRangeWithCoord(i.range);if(null==w)return;let P=Math.max(C,C),{startX:M,endX:A,startY:k,endY:N,startRow:D,startColumn:V,endRow:W,endColumn:H}=w;r===O.RANGE_TYPE.ROW?null==(s=this._moveHelperBackgroundShape)||s.transformByState({height:N-k,width:S+g,left:0,top:k+(t-this._startOffsetY)/P+f.y-n.y}):null==(l=this._moveHelperBackgroundShape)||l.transformByState({height:v+p,width:A-M,left:M+(e-this._startOffsetX)/P+f.x-n.x,top:0}),null==(a=this._moveHelperBackgroundShape)||a.show();let U=4/P;if(r===O.RANGE_TYPE.ROW){let e=0;if(b<=D)e=y-U/2,this._changeToRow=b;else{if(!(b>W))return;e=E-U/2,this._changeToRow=b+1}null==(d=this._moveHelperLineShape)||d.transformByState({height:U,width:S,left:g,top:e})}else{let e=0;if(_<=V)e=R-U/2,this._changeToColumn=_;else{if(!(_>H))return;e=T-U/2,this._changeToColumn=_+1}null==(c=this._moveHelperLineShape)||c.transformByState({height:v,width:U,left:e,top:p})}null==(u=this._moveHelperLineShape)||u.show()}_clearObserverEvent(){var e,t;null==(e=this._dragHeaderMoveSub)||e.unsubscribe(),null==(t=this._scenePointerUpSub)||t.unsubscribe(),this._dragHeaderMoveSub=null,this._scenePointerUpSub=null}_newBackgroundAndLine(){let e=this._context.scene;this._moveHelperBackgroundShape=new x.Rect("__SpreadsheetHeaderMoveControllerBackground__",{fill:"rgba(0, 0, 0, 0.1)",evented:!1,zIndex:100}),this._moveHelperLineShape=new x.Rect("__SpreadsheetHeaderMoveControllerShapeLine__",{fill:"rgb(119, 119, 119)",evented:!1,zIndex:100}),e.addObjects([this._moveHelperBackgroundShape,this._moveHelperLineShape],10)}_disposeBackgroundAndLine(){var e,t;null==(e=this._moveHelperBackgroundShape)||e.dispose(),null==(t=this._moveHelperLineShape)||t.dispose()}},el(mB,"HeaderMoveRenderController"),mB);mP=mT([mE(1,(0,O.Inject)(A.SheetsSelectionsService)),mE(2,(0,O.Inject)(ev)),mE(3,O.ICommandService)],mP);var mM=((E=mM||{})[E.VERTICAL=0]="VERTICAL",E[E.HORIZONTAL=1]="HORIZONTAL",E);let mO="rgb(68, 71, 70)",mx=class extends x.Shape{constructor(e,t){super(e,t),ea(this,"_size",12),ea(this,"_color",mO),ea(this,"_mode",0),this.setShapeProps(t)}get size(){return this._size}get mode(){return this._mode}get color(){return this._color}_draw(e){let t=this.getScene();if(!t)return;let{scaleX:i,scaleY:n}=t.getAncestorScale(),r=Math.max(i,n),o=12/r,s=4/r,{width:l,height:a}=this,d=0,c=0;0===this.mode?(l=s,d=o-s):(a=s,c=o-s),(0,x.Rect).drawWith(e,{width:this.width,height:this.height,left:0,top:0,fill:"rgba(120, 120, 120, 0.01)"}),(0,x.Rect).drawWith(e,{width:l,height:a,fill:mO,radius:s}),e.save(),e.transform(1,0,0,1,d,c),(0,x.Rect).drawWith(e,{width:l,height:a,fill:mO,radius:s}),e.restore()}setShapeProps(e){return null!=e&&e.size&&(this._size=e.size),null!=e&&e.mode&&(this._mode=e.mode),null!=e&&e.color&&(this._color=e.color),0===this.mode?this.transformByState({width:12,height:this.size}):this.transformByState({width:this.size,height:12}),this}};el(mx,"HeaderMenuResizeShape");var mA=Object.defineProperty,mk=Object.getOwnPropertyDescriptor,mN=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?mk(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mA(t,i,o),o},"__decorateClass$i"),mD=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$i");let mV="__SpreadsheetHeaderResizeControllerShapeHelper__",mW="rgb(199, 199, 199)",mH=(0,O.createInterceptorKey)("headerResizePermissionCheck"),mU=(mF=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_currentRow",0),ea(this,"_currentColumn",0),ea(this,"_rowResizeRect"),ea(this,"_columnResizeRect"),ea(this,"_headerPointerSubs"),ea(this,"_scenePointerMoveSub"),ea(this,"_scenePointerUpSub"),ea(this,"_resizeHelperShape"),ea(this,"_startOffsetX",Number.POSITIVE_INFINITY),ea(this,"_startOffsetY",Number.POSITIVE_INFINITY),ea(this,"interceptor",new O.InterceptorManager({HEADER_RESIZE_PERMISSION_CHECK:mH})),this._context=e,this._sheetSkeletonManagerService=t,this._selectionManagerService=i,this._commandService=n,this._init()}dispose(){var e,t,i;null==(e=this._rowResizeRect)||e.dispose(),this._rowResizeRect=null,null==(t=this._columnResizeRect)||t.dispose(),this._columnResizeRect=null,null==(i=this._headerPointerSubs)||i.unsubscribe(),this._headerPointerSubs=null}_init(){let e=this._context.scene;this._rowResizeRect=new mx("__SpreadsheetHeaderResizeControllerShapeRow__",{visible:!1,mode:mM.HORIZONTAL,zIndex:100}),this._columnResizeRect=new mx("__SpreadsheetHeaderResizeControllerShapeColumn__",{visible:!1,mode:mM.VERTICAL,zIndex:100}),e.addObjects([this._rowResizeRect,this._columnResizeRect],10),this._initialHover(0),this._initialHover(1),this._initialHoverResize(0),this._initialHoverResize(1)}_initialHover(e=0){let t=this._context.components.get(eO.COLUMN),i=this._context.components.get(eO.ROW),n=this._context.scene,r=0===e?i:t,o=/* @__PURE__ */el((e,t)=>{var i,n;null==(i=this._rowResizeRect)||i.hide(),null==(n=this._columnResizeRect)||n.hide()},"pointerLeaveEvent"),s=/* @__PURE__ */el((t,i)=>{var r;let o=null==(r=this._sheetSkeletonManagerService.getCurrent())?void 0:r.skeleton;if(null==o||null==this._rowResizeRect||null==this._columnResizeRect)return;let{rowHeaderWidth:s,columnHeaderHeight:l}=o,{startX:a,startY:d,endX:c,endY:u,row:h,column:m}=tv(t.offsetX,t.offsetY,n,o),g=tS(t.offsetX,t.offsetY,n),{scaleX:p,scaleY:v}=n.getAncestorScale(),S=12/Math.max(p,v);if(0===e){let e=d-S/2;if(g.y<=d+S/2&&g.y>=d)this._currentRow=h-1;else if(g.y>=u-S/2&&g.y<=u)this._currentRow=h,e=u-S/2;else{this._rowResizeRect.hide();return}if(-1===this._currentRow)return;if(!this.interceptor.fetchThroughInterceptors(mH)(null,{row:this._currentRow}))return!1;let t=Math.min(44,s/3);this._rowResizeRect.transformByState({left:s/2-t/2,top:e}),this._rowResizeRect.setShapeProps({size:t}),this._rowResizeRect.show()}else{let e=a-S/2;if(g.x<=a+S/2&&g.x>=a)this._currentColumn=m-1;else if(g.x>=c-S/2&&g.x<=c)this._currentColumn=m,e=c-S/2;else{this._columnResizeRect.hide();return}if(-1===this._currentColumn)return;if(!this.interceptor.fetchThroughInterceptors(mH)(null,{col:this._currentColumn}))return!1;let t=.7*l;this._columnResizeRect.transformByState({left:e,top:l/2-t/2}),this._columnResizeRect.setShapeProps({size:t}),this._columnResizeRect.show()}},"pointerMoveEvent");this._headerPointerSubs=new G.Subscription,this._headerPointerSubs.add(null==r?void 0:r.onPointerMove$.subscribeEvent(s)),this._headerPointerSubs.add(null==r?void 0:r.onPointerLeave$.subscribeEvent(o))}_initialHoverResize(e=0){let t=this._context.scene,i=0===e?this._rowResizeRect:this._columnResizeRect;null!=i&&(this.disposeWithMe(i.onPointerEnter$.subscribeEvent(()=>{null!=i&&(i.show(),t.setCursor(0===e?x.CURSOR_TYPE.ROW_RESIZE:x.CURSOR_TYPE.COLUMN_RESIZE))})),this.disposeWithMe(i.onPointerLeave$.subscribeEvent(()=>{null!=i&&(i.hide(),t.resetCursor())})),this.disposeWithMe(i.onPointerDown$.subscribeEvent(t=>{var i,n,r,o,s,l,a;let d=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton;if(null==d)return;let c=this._context.scene,u=c.getEngine(),h=(null==u?void 0:u.height)||0,m=(null==u?void 0:u.width)||0,g=c.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),p=((null==(r=null==(n=null==g?void 0:g.getScrollBar())?void 0:n.horizonScrollTrack)?void 0:r.height)||0)+10,v=((null==(s=null==(o=null==g?void 0:g.getScrollBar())?void 0:o.verticalScrollTrack)?void 0:s.width)||0)+10,S=tS(t.offsetX,t.offsetY,c),{scaleX:f,scaleY:C}=c.getAncestorScale();this._startOffsetX=S.x,this._startOffsetY=S.y;let I=d.getOffsetByPositionX(this._currentColumn),b=d.getOffsetByPositionY(this._currentRow),_=d.getNoMergeCellPositionByIndex(this._currentRow,this._currentColumn),R=!1,y=0,T=0,{columnTotalWidth:E,rowHeaderWidth:w,rowTotalHeight:P,columnHeaderHeight:M}=d,O=4/Math.max(f,C);0===e?this._resizeHelperShape=new x.Rect(mV,{width:m>E+w?m:E+w,height:O,fill:mW,left:0,top:b-O/2}):this._resizeHelperShape=new x.Rect(mV,{width:O,height:h>P+M?h:P+M,fill:mW,left:I-O/2,top:0});let k=(null==(l=this._columnResizeRect)?void 0:l.left)||0,N=(null==(a=this._rowResizeRect)?void 0:a.top)||0;c.addObject(this._resizeHelperShape,10),c.disableObjectsEvent(),this._scenePointerMoveSub=c.onPointerMove$.subscribeEvent(t=>{var i,n,r,o,s,l;let a=c.getRelativeToViewportCoord((0,x.Vector2).FromArray([this._startOffsetX,this._startOffsetY])),d=c.getVpScrollXYInfoByPosToVp(a,g),{x:u,y:S}=tS(t.offsetX,t.offsetY,c),{scaleX:f,scaleY:C}=c.getAncestorScale(),E=4/Math.max(f,C);y=u-this._startOffsetX-E/2,T=S-this._startOffsetY-E/2,Math.abs(0===e?T:y)>=2&&(R=!0),0===e?(T>h-p+d.y-_.startY&&(T=h-p+d.y-_.startY),T<-(_.endY-_.startY)+2&&(T=-(_.endY-_.startY)+2),R&&(null==(i=this._resizeHelperShape)||i.transformByState({top:b+T}),null==(n=this._rowResizeRect)||n.transformByState({top:N+T+E/2}),null==(r=this._rowResizeRect)||r.show(),c.setCursor(x.CURSOR_TYPE.ROW_RESIZE))):(y>m-v+d.x-_.startX&&(y=m-v+d.x-_.startX),y<-(_.endX-_.startX)+2&&(y=-(_.endX-_.startX)+2),R&&(null==(o=this._resizeHelperShape)||o.transformByState({left:I+y}),null==(s=this._columnResizeRect)||s.transformByState({left:k+y+E/2}),null==(l=this._columnResizeRect)||l.show(),c.setCursor(x.CURSOR_TYPE.COLUMN_RESIZE)))}),this._scenePointerUpSub=c.onPointerUp$.subscribeEvent(t=>{var i,n,r;let o=this._context.scene;this._clearObserverEvent(),null==(i=this._resizeHelperShape)||i.dispose(),this._resizeHelperShape=null,o.enableObjectsEvent(),R&&(o.resetCursor(),null==(n=this._rowResizeRect)||n.hide(),null==(r=this._columnResizeRect)||r.hide(),0===e?this._commandService.executeCommand(A.DeltaRowHeightCommand.id,{deltaY:T,anchorRow:this._currentRow}):this._commandService.executeCommand(A.DeltaColumnWidthCommand.id,{deltaX:y,anchorCol:this._currentColumn}))})})),this.disposeWithMe(i.onDblclick$.subscribeEvent(()=>{var t,i,n;this._context.scene.resetCursor();let r=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(!r)return;let o=r.worksheet.getRowCount()-1||0,s=r.worksheet.getColumnCount()-1||0;switch(e){case 1:{let e=this._selectionManagerService.getCurrentSelections(),t=[];for(let i=0;i<e.length;i++){let n=e[i];n.range.rangeType===O.RANGE_TYPE.COLUMN&&this._currentColumn<=n.range.endColumn&&this._currentColumn>=n.range.startColumn&&t.push({startColumn:n.range.startColumn,endColumn:n.range.endColumn,startRow:0,endRow:o})}0===t.length&&t.push({startColumn:this._currentColumn,endColumn:this._currentColumn,startRow:0,endRow:o}),this._commandService.executeCommand(ok.id,{ranges:t}),null==(i=this._columnResizeRect)||i.hide();break}case 0:this._commandService.executeCommand(A.SetWorksheetRowIsAutoHeightCommand.id,{ranges:[{startRow:this._currentRow,endRow:this._currentRow,startColumn:0,endColumn:s}]}),null==(n=this._rowResizeRect)||n.hide()}})))}_clearObserverEvent(){var e,t;null==(e=this._scenePointerMoveSub)||e.unsubscribe(),null==(t=this._scenePointerUpSub)||t.unsubscribe(),this._scenePointerMoveSub=null,this._scenePointerUpSub=null}},el(mF,"HeaderResizeRenderController"),mF);mU=mN([mD(1,(0,O.Inject)(ev)),mD(2,(0,O.Inject)(A.SheetsSelectionsService)),mD(3,O.ICommandService)],mU);var mL,mB,mF,mj,mz=Object.defineProperty,mX=Object.getOwnPropertyDescriptor,mY=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?mX(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mz(t,i,o),o},"__decorateClass$h"),mG=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$h");let mZ=(mj=class extends O.RxDisposable{constructor(e,t,i,n,r,o,s,l,a,d){super(),ea(this,"disposableCollection",new O.DisposableCollection),this._context=e,this._univerInstanceService=t,this._permissionService=i,this._selectionManagerService=n,this._rangeProtectionRuleModel=r,this._headerMoveRenderController=o,this._selectionRenderService=s,this._headerFreezeRenderController=l,this._rangeProtectionCache=a,this._headerResizeRenderController=d,this._initHeaderMovePermissionInterceptor(),this._initHeaderResizePermissionInterceptor(),this._initRangeFillPermissionInterceptor(),this._initRangeMovePermissionInterceptor()}_initHeaderMovePermissionInterceptor(){let e=this._headerMoveRenderController.interceptor.getInterceptPoints().HEADER_MOVE_PERMISSION_CHECK;this.disposeWithMe(this._headerMoveRenderController.interceptor.intercept(e,{handler:/* @__PURE__ */el((e,t)=>{let i=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!i)return!1;let{unitId:n,subUnitId:r}=i;if(!this._permissionService.composePermission([new A.WorkbookEditablePermission(n).id,new A.WorksheetEditPermission(n,r).id]).every(e=>e.value))return!1;if(!t)return!0;if(t.rangeType!==O.RANGE_TYPE.ROW&&t.rangeType!==O.RANGE_TYPE.COLUMN)return e;if(t.rangeType===O.RANGE_TYPE.ROW){for(let e=t.startRow;e<=t.endRow;e++)if(!1===this._rangeProtectionCache.getRowPermissionInfo(n,r,e,[rA.Edit]))return!1}else for(let e=t.startColumn;e<=t.endColumn;e++)if(!1===this._rangeProtectionCache.getColPermissionInfo(n,r,e,[rA.Edit]))return!1;return!0},"handler")}))}_initHeaderResizePermissionInterceptor(){this._headerResizeRenderController&&this.disposeWithMe(this._headerResizeRenderController.interceptor.intercept(this._headerResizeRenderController.interceptor.getInterceptPoints().HEADER_RESIZE_PERMISSION_CHECK,{handler:/* @__PURE__ */el((e,t)=>{var i,n,r,o;let s=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!s)return!1;let{unitId:l,subUnitId:a}=s;if(t.row){if((null!=(n=null==(i=this._permissionService.getPermissionPoint(new A.WorksheetSetRowStylePermission(l,a).id))?void 0:i.value)&&n)===!1)return!1}else if(t.col&&(null!=(o=null==(r=this._permissionService.getPermissionPoint(new A.WorksheetSetColumnStylePermission(l,a).id))?void 0:r.value)&&o)===!1)return!1;return!0},"handler")}))}_initRangeFillPermissionInterceptor(){this.disposeWithMe(this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_FILL_PERMISSION_CHECK,{handler:/* @__PURE__ */el((e,t)=>{var i,n,r;let o=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!o)return!1;let{worksheet:s,unitId:l,subUnitId:a}=o;if(!this._permissionService.composePermission([new A.WorkbookEditablePermission(l).id,new A.WorksheetEditPermission(l,a).id,new A.WorksheetSetCellValuePermission(l,a).id,new A.WorksheetSetCellStylePermission(l,a).id]).every(e=>e.value))return!1;let d=null==(i=this._selectionManagerService.getCurrentSelections())?void 0:i.map(e=>e.range),c=null==d?void 0:d.find(e=>{let i=tS(t.x,t.y,t.scene,t.skeleton),n=t.skeleton.getCellByIndex(e.endRow,e.endColumn),r=Math.abs(n.endX-i.x),o=Math.abs(n.endY-i.y);return r<=5&&o<=5});if(!c)return!0;let{startRow:u,endRow:h,startColumn:m,endColumn:g}=c;for(let e=u;e<=h;e++)for(let t=m;t<=g;t++){let i=null==(r=null==(n=s.getCell(e,t))?void 0:n.selectionProtection)?void 0:r[0];if((null==i?void 0:i[rA.Edit])===!1||(null==i?void 0:i[rA.View])===!1)return!1}return!0},"handler")}))}_initRangeMovePermissionInterceptor(){this.disposeWithMe(this._selectionRenderService.interceptor.intercept(this._selectionRenderService.interceptor.getInterceptPoints().RANGE_MOVE_PERMISSION_CHECK,{handler:/* @__PURE__ */el((e,t)=>{var i;let n=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!n)return!1;let{worksheet:r,unitId:o,subUnitId:s}=n;if(!this._permissionService.composePermission([new A.WorkbookEditablePermission(o).id,new A.WorksheetEditPermission(o,s).id]).every(e=>e.value))return!1;let l=null==(i=this._selectionManagerService.getCurrentSelections())?void 0:i.map(e=>e.range),a=this._rangeProtectionRuleModel.getSubunitRuleList(o,s).reduce((e,t)=>[...e,...t.ranges],[]),d=null==l?void 0:l.filter(e=>a.some(t=>(0,O.Rectangle).intersects(t,e)));return!(null==d?void 0:d.some(e=>{var t,i;let{startRow:n,startColumn:o,endRow:s,endColumn:l}=e;for(let e=n;e<=s;e++)for(let n=o;n<=l;n++){let o=null==(i=null==(t=r.getCell(e,n))?void 0:t.selectionProtection)?void 0:i[0];if((null==o?void 0:o[rA.Edit])===!1)return!0}return!1}))},"handler")}))}_initFreezePermissionInterceptor(){this.disposeWithMe(this._headerFreezeRenderController.interceptor.intercept(this._headerFreezeRenderController.interceptor.getInterceptPoints().FREEZE_PERMISSION_CHECK,{handler:/* @__PURE__ */el((e,t)=>{var i,n;let r=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);return null!=r&&!!r.getActiveSheet()&&!!r&&null!=(n=null==(i=this._permissionService.getPermissionPoint(new A.WorkbookEditablePermission(r.getUnitId()).id))?void 0:i.value)&&n},"handler")}))}},el(mj,"SheetPermissionInterceptorCanvasRenderController"),mj);mZ=mY([mG(1,O.IUniverInstanceService),mG(2,O.IPermissionService),mG(3,(0,O.Inject)(A.SheetsSelectionsService)),mG(4,(0,O.Inject)(A.RangeProtectionRuleModel)),mG(5,(0,O.Inject)(mP)),mG(6,ez),mG(7,(0,O.Inject)(m_)),mG(8,(0,O.Inject)(A.RangeProtectionCache)),mG(9,(0,O.Optional)(mU))],mZ);var mK=Object.defineProperty,mq=Object.getOwnPropertyDescriptor,mQ=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?mq(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&mK(t,i,o),o},"__decorateClass$g"),mJ=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$g");let m$=(m4=class extends O.Disposable{constructor(e,t,i,n,r){super(),ea(this,"disposableCollection",new O.DisposableCollection),this._univerInstanceService=e,this._selectionManagerService=t,this._localService=i,this._sheetClipboardService=n,this._sheetPermissionInterceptorBaseController=r,this._initClipboardHook()}_initClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook({id:"SHEET_PERMISSION_PASTE_PLUGIN",onBeforePaste:/* @__PURE__ */el(e=>{var t,i,n;let[r]=ii([e.range]).ranges,o=null==(t=this._selectionManagerService.getCurrentLastSelection())?void 0:t.range;if(!o)return!1;let s={startRow:o.startRow+r.startRow,endRow:o.startRow+r.endRow,startColumn:o.startColumn+r.startColumn,endColumn:o.startColumn+r.endColumn},l=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getActiveSheet();if(!l)return!1;let{startRow:a,endRow:d,startColumn:c,endColumn:u}=s,h=!0;for(let e=a;e<=d;e++)for(let t=c;t<=u;t++){let r=null==(n=null==(i=l.getCell(e,t))?void 0:i.selectionProtection)?void 0:n[0];if((null==r?void 0:r[rA.Edit])===!1){h=!1;break}}return h||this._sheetPermissionInterceptorBaseController.haveNotPermissionHandle(this._localService.t("permission.dialog.pasteErr")),h},"onBeforePaste")}))}},el(m4,"SheetPermissionInterceptorClipboardController"),m4);m$=mQ([mJ(0,O.IUniverInstanceService),mJ(1,(0,O.Inject)(A.SheetsSelectionsService)),mJ(2,(0,O.Inject)(O.LocaleService)),mJ(3,(0,O.Inject)(lq)),mJ(4,(0,O.Inject)(mv))],m$);var m0=Object.defineProperty,m1=Object.getOwnPropertyDescriptor,m2=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?m1(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&m0(t,i,o),o},"__decorateClass$f"),m5=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$f");let m9=(0,O.createInterceptorKey)("statusBarPermissionCorrect"),m6=class{constructor(){ea(this,"_sum",0),ea(this,"_count",0),ea(this,"_countNumber",0),ea(this,"_min",Number.POSITIVE_INFINITY),ea(this,"_max",Number.NEGATIVE_INFINITY)}add(e){let t=null==e?void 0:e.v,i=null==e?void 0:e.t;null!=t&&("number"==typeof t&&i!==O.CellValueType.STRING&&(this._sum+=t,this._countNumber++,this._min=Math.min(this._min,t),this._max=Math.max(this._max,t)),this._count++)}getResults(){return{sum:this._sum,count:this._countNumber,countA:this._count,min:this._min,max:this._max}}};function m3(e){let{sum:t,count:i,countA:n,min:r,max:o}=e.getResults();return[{func:ei.FUNCTION_NAMES_STATISTICAL.MAX,value:o},{func:ei.FUNCTION_NAMES_STATISTICAL.MIN,value:r},{func:ei.FUNCTION_NAMES_MATH.SUM,value:t},{func:ei.FUNCTION_NAMES_STATISTICAL.COUNTA,value:n},{func:ei.FUNCTION_NAMES_STATISTICAL.COUNT,value:i},{func:ei.FUNCTION_NAMES_STATISTICAL.AVERAGE,value:t/i}]}el(m6,"CalculateValueSet"),el(m3,"calculateValues");let m7=(el(m8=class extends O.Disposable{constructor(e,t,i,n,r){super(),ea(this,"interceptor",new O.InterceptorManager({STATUS_BAR_PERMISSION_CORRECT:m9})),this._univerInstanceService=e,this._selectionManagerService=t,this._statusBarService=i,this._commandService=n,this._numfmtService=r,this._init()}_init(){this._registerSelectionListener()}_registerSelectionListener(){let e=(0,O.debounce)(e=>{var t;let i=null==(t=e[e.length-1])?void 0:t.primary;this._calculateSelection(e.map(e=>e.range),i)},100);this.disposeWithMe((0,O.toDisposable)(this._selectionManagerService.selectionMoving$.subscribe(t=>{t&&e(t)}))),this.disposeWithMe((0,O.toDisposable)(this._selectionManagerService.selectionMoveEnd$.subscribe(t=>{t&&e(t)}))),this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(t.id===A.SetRangeValuesMutation.id){let t=this._selectionManagerService.getCurrentSelections();t&&e(t)}}))}_clearResult(){this._statusBarService.setState(null)}getRangeStartEndInfo(e,t){return e.rangeType===O.RANGE_TYPE.ALL?{startRow:0,startColumn:0,endRow:t.getRowCount()-1,endColumn:t.getColumnCount()-1}:e.rangeType===O.RANGE_TYPE.COLUMN?{startRow:0,startColumn:e.startColumn,endRow:t.getRowCount()-1,endColumn:e.endColumn}:e.rangeType===O.RANGE_TYPE.ROW?{startRow:e.startRow,startColumn:0,endRow:e.endRow,endColumn:t.getColumnCount()-1}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}_calculateSelection(e,t){var i;let n=this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!n)return this._clearResult();let r=n.getUnitId(),o=n.getActiveSheet(),s=null==o?void 0:o.getSheetId();if(!s)return this._clearResult();let l={};if(this._univerInstanceService.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET).getSheets().forEach(e=>{let t=e.getConfig();l[e.getSheetId()]={cellData:new O.ObjectMatrix(t.cellData),rowCount:t.rowCount,columnCount:t.columnCount,rowData:t.rowData,columnData:t.columnData}}),null!=e&&e.length){let n=[];e.forEach(e=>{let{startRow:t,endRow:i}=e,r=null;for(let s=t;s<=i;s++)o.getRowVisible(s)?null===r&&(r=s):null!==r&&(n.push({...e,startRow:r,endRow:s-1}),r=null);null!==r&&n.push({...e,startRow:r,endRow:i})});let l=(0,O.splitIntoGrid)(n),a=new m6;for(let e of l){let{startRow:t,startColumn:i,endColumn:n,endRow:r}=this.getRangeStartEndInfo(e,o);for(let e=t;e<=r;e++)for(let t=i;t<=n;t++){let i=o.getCell(e,t);a.add(i)}}let d=m3(a);if(d.every(e=>void 0===e))return;let c=null;if(t){let{actualRow:e,actualColumn:n}=t;c=null==(i=this._numfmtService.getValue(r,s,e,n))?void 0:i.pattern}let u={values:d.filter(e=>void 0!==e),pattern:c};this._statusBarService.setState(u)}else this._clearResult()}},"StatusBarController"),m8);m7=m2([m5(0,O.IUniverInstanceService),m5(1,(0,O.Inject)(A.SheetsSelectionsService)),m5(2,s$),m5(3,O.ICommandService),m5(4,(0,O.Inject)(A.INumfmtService))],m7);var m4,m8,ge,gt=Object.defineProperty,gi=Object.getOwnPropertyDescriptor,gn=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?gi(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&gt(t,i,o),o},"__decorateClass$e"),gr=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$e");let go=(ge=class extends O.RxDisposable{constructor(e,t,i,n,r){super(),ea(this,"disposableCollection",new O.DisposableCollection),this._context=e,this._univerInstanceService=t,this._permissionService=i,this._statusBarController=n,this._rangeProtectionCache=r,this._initStatusBarPermissionInterceptor()}_initStatusBarPermissionInterceptor(){this.disposeWithMe(this._statusBarController.interceptor.intercept(this._statusBarController.interceptor.getInterceptPoints().STATUS_BAR_PERMISSION_CORRECT,{priority:100,handler:/* @__PURE__ */el((e,t)=>{var i;let n=(0,A.getSheetCommandTarget)(this._univerInstanceService);if(!n)return null!=e?e:[];let{worksheet:r,unitId:o,subUnitId:s}=n;return(null==(i=this._permissionService.getPermissionPoint(new A.WorksheetViewPermission(o,s).id))?void 0:i.value)===!1?t.forEach(e=>{let t=e.getArrayValue();t.forEach((e,i)=>{e.forEach((e,n)=>{t[i][n]=(0,ei.NullValueObject).create()})})}):t.forEach(e=>{let t=e.getArrayValue(),i=e.getCurrentRow(),n=e.getCurrentColumn();t.forEach((e,l)=>{e.forEach((e,a)=>{var d;if((null==(d=r.getCellRaw(l+i,a+n))?void 0:d.v)===void 0)return;let c=this._rangeProtectionCache.getCellInfo(o,s,l+i,a+n);(null==c?void 0:c[rA.View])===!1&&(t[l][a]=(0,ei.NullValueObject).create())})})}),t},"handler")}))}},el(ge,"SheetPermissionInterceptorFormulaRenderController"),ge);go=gn([gr(1,O.IUniverInstanceService),gr(2,O.IPermissionService),gr(3,(0,O.Inject)(m7)),gr(4,(0,O.Inject)(A.RangeProtectionCache))],go);let gs={sheetPermissionPanelFooter:"univer-sheet-permission-panel-footer",sheetPermissionPanelFooterCancel:"univer-sheet-permission-panel-footer-cancel",sheetPermissionPanelAddButton:"univer-sheet-permission-panel-add-button"},gl=/* @__PURE__ */el(()=>{var e,t;let i=(0,O.useDependency)(J.ISidebarService),n=(0,O.useDependency)(O.LocaleService),r=(0,O.useDependency)(O.IUniverInstanceService),o=(0,O.useDependency)(O.IPermissionService),s=r.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),l=s.getUnitId(),a=(0,J.useObservable)(s.activeSheet$),d=null!=(t=null==(e=o.getPermissionPoint(new A.WorkbookCreateProtectPermission(l).id))?void 0:e.value)&&t,c=(0,O.useDependency)(rU),u=(0,O.useDependency)(A.WorksheetProtectionRuleModel),h=null==a?void 0:a.getSheetId();if(!h)return null;let m=u.getRule(l,h);return!d||m?null:/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsxs(et.Button,{className:gs.sheetPermissionPanelAddButton,type:"primary",onClick:/* @__PURE__ */el(()=>{c.resetRule();let e={header:{title:`${n.t("permission.panel.title")}`},children:{label:rB,showDetail:!0},width:330,footer:{label:rF,showDetail:!0}};i.open(e)},"onClick"),children:[/* @__PURE__ */o$.jsx("div",{children:"+ "}),n.t("permission.button.addNewPermission")]})})},"SheetPermissionPanelAddFooter"),ga=/* @__PURE__ */el(()=>{let e=(0,O.useDependency)(rU),t=(0,J.useObservable)(e.rule$,e.rule),i=(0,O.useDependency)(J.ISidebarService),n=(0,O.useDependency)(O.IAuthzIoService),r=(0,O.useDependency)(O.LocaleService),o=(0,O.useDependency)(O.ICommandService),s=(0,O.useDependency)(rL),l=(0,J.useObservable)(e.rangeErrorMsg$);return /* @__PURE__ */o$.jsxs("div",{className:gs.sheetPermissionPanelFooter,children:[/* @__PURE__ */o$.jsx(et.Button,{type:"primary",onClick:/* @__PURE__ */el(async()=>{if(l)return;let a=s.selectUserList;t.editStatus===rH.onlyMe&&(a=[],s.setSelectUserList([]));let d={read:t.viewStatus===rW.othersCanView?rD.AllCollaborator:rD.SomeCollaborator,edit:t.editStatus===rH.designedUserCanEdit?rD.SomeCollaborator:rD.OneSelf};if(t.editStatus===rH.designedUserCanEdit&&0===a.length&&(a=[],d.edit=rD.OneSelf),t.permissionId){let i=e.oldRule,r=re(a.filter(e=>e.role===rk.Editor),s.oldCollaboratorList.filter(e=>e.role===rk.Editor)),l=(null==i?void 0:i.viewStatus)===t.viewStatus,c=(null==i?void 0:i.editStatus)===t.editStatus,u=t.unitType===(null==i?void 0:i.unitType)&&t.name===i.name&&t.description===i.description&&t.ranges===i.ranges,h=!r||!l||!c;if(u&&h)await n.update({objectType:t.unitType,objectID:t.permissionId,unitID:t.unitId,share:void 0,name:"",strategies:[],scope:d,collaborators:{collaborators:a}});else{let e=t.permissionId;h&&(e=t.unitType===rN.Worksheet?await n.create({worksheetObject:{collaborators:a,unitID:t.unitId,name:t.name,strategies:[{role:rk.Editor,action:rA.Edit},{role:rk.Reader,action:rA.View}],scope:d},objectType:rN.Worksheet}):await n.create({selectRangeObject:{collaborators:a,unitID:t.unitId,name:t.name,scope:d},objectType:rN.SelectRange})),o.executeCommand(r8.id,{rule:{...t,permissionId:e}})}}else if(t.unitType===rN.Worksheet){let e=await n.create({worksheetObject:{collaborators:a,unitID:t.unitId,name:t.name,strategies:[{role:rk.Editor,action:rA.Edit},{role:rk.Reader,action:rA.View}],scope:d},objectType:rN.Worksheet}),{ranges:i=[],...r}=t;r.permissionId=e,o.executeCommand(rQ.id,{rule:r,unitId:t.unitId})}else if(t.unitType===rN.SelectRange){let e=await n.create({selectRangeObject:{collaborators:a,unitID:t.unitId,name:t.name,scope:d},objectType:rN.SelectRange});o.executeCommand(A.AddRangeProtectionCommand.id,{rule:t,permissionId:e})}e.resetRule(),s.reset();let c={header:{title:`${r.t("permission.panel.title")}`},children:{label:rB,showDetail:!1},width:330,footer:{label:rF,showDetail:!1}};i.open(c)},"onClick"),children:r.t("permission.button.confirm")}),/* @__PURE__ */o$.jsx(et.Button,{className:gs.sheetPermissionPanelFooterCancel,onClick:/* @__PURE__ */el(()=>{e.reset(),s.reset(),i.close()},"onClick"),children:r.t("permission.button.cancel")})]})},"SheetPermissionPanelDetailFooter"),gd=/* @__PURE__ */el(({showDetail:e})=>e?/* @__PURE__ */o$.jsx(ga,{}):/* @__PURE__ */o$.jsx(gl,{}),"SheetPermissionPanelFooter"),gc=/* @__PURE__ */el((e=[])=>{let t=(0,O.useDependency)(od);(0,ee.useEffect)(()=>{let i=e.map(e=>t.addShape({range:e,style:{hasAutoFill:!1,fill:"rgba(73, 184, 17, 0.05)",strokeWidth:1,stroke:"#49B811",widgets:{}},primary:{startColumn:e.startColumn,endColumn:e.endColumn,startRow:e.startRow,endRow:e.endRow,actualRow:e.startRow,actualColumn:e.startColumn,isMerged:!1,isMergedMainCell:!1}}));return()=>{i.forEach(e=>{e&&t.removeShape(e)})}},[e])},"useHighlightRange"),gu={sheetPermissionListPanelWrapper:"univer-sheet-permission-list-panel-wrapper",sheetPermissionListPanelHeader:"univer-sheet-permission-list-panel-header",sheetPermissionListPanelHeaderType:"univer-sheet-permission-list-panel-header-type",sheetPermissionListPanelHeaderTypeBottom:"univer-sheet-permission-list-panel-header-type-bottom",sheetPermissionListPanelHeaderSelect:"univer-sheet-permission-list-panel-header-select",sheetPermissionListItemHeaderIcon:"univer-sheet-permission-list-item-header-icon",sheetPermissionListItem:"univer-sheet-permission-list-item",sheetPermissionListItemHeader:"univer-sheet-permission-list-item-header",sheetPermissionListItemHeaderName:"univer-sheet-permission-list-item-header-name",sheetPermissionListItemHeaderOperator:"univer-sheet-permission-list-item-header-operator",sheetPermissionListItemSplit:"univer-sheet-permission-list-item-split",sheetPermissionListItemContentEdit:"univer-sheet-permission-list-item-content-edit",sheetPermissionListItemContentView:"univer-sheet-permission-list-item-content-view",sheetPermissionListItemContentDesc:"univer-sheet-permission-list-item-content-desc",sheetPermissionListEmpty:"univer-sheet-permission-list-empty",sheetPermissionListEmptyText:"univer-sheet-permission-list-empty-text",sheetPermissionListItemContentTitle:"univer-sheet-permission-list-item-content-title",sheetPermissionListItemContentSub:"univer-sheet-permission-list-item-content-sub"},gh=/* @__PURE__ */el(()=>{let[e,t]=(0,ee.useState)(!0),[i,n]=(0,ee.useState)(!1),r=(0,O.useDependency)(rU),o=(0,O.useDependency)(O.LocaleService),s=(0,O.useDependency)(A.RangeProtectionRuleModel),l=(0,O.useDependency)(A.WorksheetProtectionRuleModel),a=(0,O.useDependency)(O.IUniverInstanceService).getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),d=a.getUnitId(),c=(0,O.useDependency)(O.ICommandService),u=(0,O.useDependency)(J.ISidebarService),h=(0,O.useDependency)(O.IAuthzIoService);(0,O.useDependency)(O.IPermissionService);let m=(0,O.useDependency)(O.UserManagerService).getCurrentUser(),[g,p]=(0,ee.useState)([]),v=(0,J.useObservable)(l.ruleRefresh$,""),S=(0,J.useObservable)(s.ruleRefresh$,""),f=(0,ee.useCallback)(async e=>{var t;let i=a.getActiveSheet(),n=a.getUnitId(),r=i.getSheetId(),o=[],d=[];a.getSheets().forEach(e=>{let t=e.getSheetId();s.getSubunitRuleList(n,t).forEach(e=>{e.permissionId&&o.push(e.permissionId)});let i=l.getRule(n,t);null!=i&&i.permissionId&&d.push(i.permissionId)});let c=[...o,...d],u=await h.list({objectIDs:c,unitID:n,actions:A.baseProtectionActions}),m=s.getSubunitRuleList(n,r).map(e=>e.permissionId),g=null==(t=l.getRule(n,r))?void 0:t.permissionId;g&&m.push(g);let p=u.filter(e=>{var t;return m.includes(e.objectID)||e.objectID===(null==(t=l.getRule(n,r))?void 0:t.permissionId)});return e?p:u},[]),[C,I]=(0,ee.useState)([]);(0,ee.useEffect)(()=>{let t=(0,B.merge)(s.ruleChange$,l.ruleChange$).subscribe(async()=>{I(await f(e))});return()=>{t.unsubscribe()}},[e]),(0,ee.useEffect)(()=>{let t=a.activeSheet$.subscribe(async()=>{I(await f(e))});return()=>{t.unsubscribe()}},[e]),(0,ee.useEffect)(()=>{},[v,S]);let b=/* @__PURE__ */el(e=>{let t;let{unitId:r,subUnitId:o,unitType:s}=e;s===rN.Worksheet?t=c.executeCommand(rJ.id,{unitId:r,subUnitId:o,rule:e}):s===rN.SelectRange&&(t=c.executeCommand(A.DeleteRangeProtectionCommand.id,{unitId:r,subUnitId:o,rule:e})),t&&(n(!i),e.ranges===g&&p([]))},"handleDelete");gc(g);let _=/* @__PURE__ */new Map;a.getSheets().forEach(e=>{let t=e.getSheetId();s.getSubunitRuleList(d,t).forEach(e=>{_.set(e.permissionId,e)});let i=l.getRule(d,t);i&&_.set(null==i?void 0:i.permissionId,i)});let R=/* @__PURE__ */el(e=>{r.setRule(e),r.setOldRule(e),e.subUnitId!==a.getActiveSheet().getSheetId()&&c.executeCommand(A.SetWorksheetActiveOperation.id,{unitId:e.unitId,subUnitId:e.subUnitId}),u.open({header:{title:"permission.panel.title"},children:{label:rB,showDetail:!0},width:330,footer:{label:rF,showDetail:!0}})},"handleEdit"),y=/* @__PURE__ */el(async e=>{t(e),I(await f(e))},"handleChangeHeaderType");return /* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListPanelWrapper,children:[/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListPanelHeader,children:[/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListPanelHeaderType,onClick:/* @__PURE__ */el(()=>y(!0),"onClick"),children:[/* @__PURE__ */o$.jsx("div",{className:sg({[gu.sheetPermissionListPanelHeaderSelect]:e}),children:o.t("permission.panel.currentSheet")}),e&&/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListPanelHeaderTypeBottom})]}),/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListPanelHeaderType,onClick:/* @__PURE__ */el(()=>y(!1),"onClick"),children:[/* @__PURE__ */o$.jsx("div",{className:sg({[gu.sheetPermissionListPanelHeaderSelect]:!e}),children:o.t("permission.panel.allSheet")}),!e&&/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListPanelHeaderTypeBottom})]})]}),(null==C?void 0:C.length)>0?/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListPanelContent,children:null==C?void 0:C.map(e=>{var t,i,n,r;let s=_.get(e.objectID);if(!s)return null;let l=e.actions.find(e=>e.action===rA.Edit),d=null==l?void 0:l.allowed,c=e.actions.find(e=>e.action===rA.View),u=null==c?void 0:c.allowed,h=e.actions.find(e=>e.action===rA.ManageCollaborator),v=e.actions.find(e=>e.action===rA.Delete),S=(null==h?void 0:h.allowed)||m.userID===(null==(t=e.creator)?void 0:t.userID),f=(null==v?void 0:v.allowed)||m.userID===(null==(i=e.creator)?void 0:i.userID),C="",I=a.getSheetBySheetId(s.subUnitId),y=null==I?void 0:I.getName();if(s.unitType===rN.SelectRange){let e=s.ranges,t=null!=e&&e.length?e.map(e=>{let t=(0,ei.serializeRange)(e);return"NaN"===t?"":t}).filter(e=>!!e).join(","):"";C=`${y}(${t})`}else s.unitType===rN.Worksheet&&(C=y||"");return /* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListItem,onMouseMove:/* @__PURE__ */el(()=>{let{subUnitId:e,unitType:t}=s,i=a.getActiveSheet();if(!i||e!==i.getSheetId())return!1;if(t===rN.SelectRange){let e=s.ranges||[];e!==g&&p(e)}else if(t===rN.Worksheet){let e=[{startRow:0,endRow:i.getRowCount()-1,startColumn:0,endColumn:i.getColumnCount()-1}];e!==g&&p(e)}},"onMouseMove"),onMouseLeave:/* @__PURE__ */el(()=>p([]),"onMouseLeave"),children:[/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListItemHeader,children:[/* @__PURE__ */o$.jsx(et.Tooltip,{title:C,children:/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListItemHeaderName,children:C})}),(S||f)&&/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListItemHeaderOperator,children:[S&&/* @__PURE__ */o$.jsx(et.Tooltip,{title:o.t("permission.panel.edit"),children:/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListItemHeaderIcon,onClick:/* @__PURE__ */el(()=>R(s),"onClick"),children:/* @__PURE__ */o$.jsx(n8,{})})}),f&&/* @__PURE__ */o$.jsx(et.Tooltip,{title:o.t("permission.panel.delete"),children:/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListItemHeaderIcon,onClick:/* @__PURE__ */el(()=>b(s),"onClick"),children:/* @__PURE__ */o$.jsx(nW,{})})})]})]}),/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListItemSplit}),/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListItemContent,children:[/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListItemContentEdit,children:[/* @__PURE__ */o$.jsx(et.Tooltip,{title:null==(n=e.creator)?void 0:n.name,children:/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(et.Avatar,{src:null==(r=e.creator)?void 0:r.avatar,style:{marginRight:6},size:24})})}),/* @__PURE__ */o$.jsx("span",{className:gu.sheetPermissionListItemContentTitle,children:o.t("permission.panel.created")}),/* @__PURE__ */o$.jsx("span",{className:gu.sheetPermissionListItemContentSub,children:d?`${o.t("permission.panel.iCanEdit")}`:`${o.t("permission.panel.iCanNotEdit")}`})]}),/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListItemContentView,children:[/* @__PURE__ */o$.jsx("span",{className:gu.sheetPermissionListItemContentTitle,children:o.t("permission.panel.viewPermission")}),/* @__PURE__ */o$.jsx("span",{className:gu.sheetPermissionListItemContentSub,children:u?`${o.t("permission.panel.iCanView")}`:`${o.t("permission.panel.iCanNotView")}`})]}),s.description&&/* @__PURE__ */o$.jsx(et.Tooltip,{title:s.description,children:/* @__PURE__ */o$.jsx("div",{className:gu.sheetPermissionListItemContentDesc,children:s.description})})]})]},e.objectID)})}):/* @__PURE__ */o$.jsxs("div",{className:gu.sheetPermissionListEmpty,children:[/* @__PURE__ */o$.jsx("img",{width:240,height:120,src:"data:image/png;base64,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",alt:""}),/* @__PURE__ */o$.jsx("p",{className:gu.sheetPermissionListEmptyText,children:o.t("permission.dialog.listEmpty")})]})]})},"SheetPermissionPanelList"),gm={spinContainer:"univer-spin-container",spinOverlay:"univer-spin-overlay",spinner:"univer-spinner",contentBlur:"univer-content-blur"},gg=/* @__PURE__ */el(({loading:e,children:t})=>/* @__PURE__ */o$.jsxs("div",{className:gm.spinContainer,children:[e&&/* @__PURE__ */o$.jsx("div",{className:gm.spinOverlay,children:/* @__PURE__ */o$.jsx("div",{className:gm.spinner})}),/* @__PURE__ */o$.jsx("div",{className:e?gm.contentBlur:"",children:t})]}),"Spin"),gp="data:image/png;base64,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",gv={permissionPanelDetailWrapper:"univer-permission-panel-detail-wrapper",radioGroupVertical:"univer-radio-group-vertical",sheetPermissionDesignPersonPanel:"univer-sheet-permission-design-person-panel",sheetPermissionDesignPersonPanelHeader:"univer-sheet-permission-design-person-panel-header",sheetPermissionDesignPersonPanelHeaderAdd:"univer-sheet-permission-design-person-panel-header-add",sheetPermissionDesignPersonPanelSplit:"univer-sheet-permission-design-person-panel-split",sheetPermissionDesignPersonPanelContentItem:"univer-sheet-permission-design-person-panel-content-item",sheetPermissionDesignPersonPanelContentItemName:"univer-sheet-permission-design-person-panel-content-item-name",sheetPermissionDesignPersonPanelContentItemSelect:"univer-sheet-permission-design-person-panel-content-item-select",sheetPermissionDesignPersonPanelContent:"univer-sheet-permission-design-person-panel-content",sheetPermissionUserListEmpty:"univer-sheet-permission-user-list-empty",sheetPermissionUserListEmptyText:"univer-sheet-permission-user-list-empty-text",sheetPermissionPanelTitle:"univer-sheet-permission-panel-title",permissionRangeSelector:"univer-permission-range-selector",permissionRangeSelectorError:"univer-permission-range-selector-error",sheetPermissionPanelNameInputError:"univer-sheet-permission-panel-name-input-error",permissionRangeSelectorErrorText:"univer-permission-range-selector-error-text",sheetPermissionPanelNameInputErrorText:"univer-sheet-permission-panel-name-input-error-text"},gS=/* @__PURE__ */el(({fromSheetBar:t})=>{var i,n;let r=(0,O.useDependency)(O.LocaleService),o=(0,O.useDependency)(J.IDialogService),s=(0,O.useDependency)(O.IUniverInstanceService),l=(0,O.useDependency)(A.SheetsSelectionsService),a=(0,O.useDependency)(rU),d=(0,J.useObservable)(a.rule$,a.rule),c=(0,O.useDependency)(O.UserManagerService),u=(0,O.useDependency)(rL),h=(0,O.useDependency)(O.IAuthzIoService),m=(0,O.useDependency)(J.ISidebarService),g=(0,O.useDependency)(A.RangeProtectionRuleModel),p=(0,O.useDependency)(A.WorksheetProtectionRuleModel),v=(0,O.useDependency)(J.ComponentManager),S=(0,ee.useMemo)(()=>v.get(eM),[]),f=(0,J.useObservable)(a.rangeErrorMsg$),C=(0,ee.useRef)({}),[I,b]=(0,ee.useState)(!1),_=s.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),R=_.getActiveSheet(),y=_.getUnitId(),T=R.getSheetId(),E=(0,J.useObservable)(u.selectUserList$,u.selectUserList),[w,P]=/*@__PURE__*/e(ee).useState(E.length?rH.designedUserCanEdit:rH.onlyMe),[M,x]=/*@__PURE__*/e(ee).useState(rW.othersCanView),[k,N]=(0,ee.useState)(!!(null!=d&&d.permissionId)),[D,V]=(0,ee.useState)(!1),W=/* @__PURE__ */el(async()=>{let e=await h.listCollaborators({objectID:y,unitID:y});e.forEach(e=>{null!=e&&e.subject&&c.addUser(e.subject)});let t=c.getCurrentUser();u.setUserList(e.filter(e=>{var i;return(null==(i=e.subject)?void 0:i.userID)!==t.userID})),o.open({id:rX,title:{title:""},children:{label:rj},width:280,destroyOnClose:!0,onClose:/* @__PURE__ */el(()=>o.close(rX),"onClose"),className:"sheet-permission-user-dialog"})},"handleAddPerson"),H=/* @__PURE__ */el(e=>{let t="";if(0===e.length)t=r.t("permission.panel.emptyRangeError");else if(e.length>1){let i=!1;for(let t=0;t<e.length;t++){for(let n=t+1;n<e.length;n++)if((0,O.Rectangle).intersects(e[t],e[n])){i=!0;break}if(i)break}i&&(t=r.t("permission.panel.rangeOverlapError"))}if(!t){if(p.getRule(y,T)&&!(null!=d&&d.permissionId))return r.t("permission.panel.rangeOverlapOverPermissionError");let i=g.getSubunitRuleList(y,T).filter(e=>e.permissionId!==(null==d?void 0:d.permissionId)).find(t=>t.ranges.some(t=>e.some(e=>(0,O.Rectangle).intersects(t,e))));(null==i?void 0:i.ranges.find(t=>e.some(e=>(0,O.Rectangle).intersects(t,e))))&&(t=r.t("permission.panel.rangeOverlapOverPermissionError"))}return""===t?void 0:t},"checkRangeValid");(0,ee.useEffect)(()=>{var e,i;let n=null==d?void 0:d.permissionId;if(V(!0),n){d.unitType===rN.Worksheet&&a.setRule({ranges:[{startRow:0,startColumn:0,endRow:R.getRowCount()-1,endColumn:R.getColumnCount()-1,rangeType:O.RANGE_TYPE.ALL}]});return}t&&(l.clearCurrentSelections(),l.addSelections([{primary:null,style:null,range:{startRow:0,startColumn:0,endRow:R.getRowCount()-1,endColumn:R.getColumnCount()-1,rangeType:O.RANGE_TYPE.ALL}}]));let r=null!=(i=null==(e=l.getCurrentSelections())?void 0:e.map(e=>e.range))?i:[],o=H(r);a.setRangeErrorMsg(o);let s=null!=r&&r.length?r.map(e=>{let t=(0,ei.serializeRange)(e);return"NaN"===t?"":t}).filter(e=>!!e).join(","):"",c=R.getName();a.setRule({ranges:r,name:t?`${c}`:`${c}(${s})`,unitId:y,subUnitId:T,unitType:t?rN.Worksheet:rN.SelectRange})},[null==d?void 0:d.permissionId,t,l,a,T,y,R]),(0,ee.useEffect)(()=>{let e=/* @__PURE__ */el(async()=>{let e=null==d?void 0:d.permissionId,t=(await h.listCollaborators({objectID:e,unitID:y})).filter(e=>e.role===rk.Editor);u.setSelectUserList(t),u.setOldCollaboratorList(t)},"getSelectUserList");null!=d&&d.permissionId?e():(u.setSelectUserList([]),u.setOldCollaboratorList([]))},[null==d?void 0:d.permissionId]),(0,ee.useEffect)(()=>{if(!d.permissionId){a.setRule({viewStatus:rW.othersCanView});return}},[d.permissionId]),(0,ee.useEffect)(()=>{},[]),(0,ee.useEffect)(()=>{let e=s.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET);if(!e)return;let t=e.activeSheet$.subscribe(e=>{(null==e?void 0:e.getSheetId())!==T&&m.close()});return()=>{t.unsubscribe()}},[m,T,s]);let U=/* @__PURE__ */el(e=>{let t=e.split(",").map(ei.deserializeRangeWithSheet).map(e=>e.range);if(t.some(e=>!(0,O.isValidRange)(e)||e.endColumn<e.startColumn||e.endRow<e.startRow))return;let i=s.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),n=i.getActiveSheet(),r=i.getUnitId(),o=n.getSheetId(),l=t.map(e=>{let t=n.getRowCount(),i=n.getColumnCount();return(0,A.setEndForRange)(e,t,i),e}),d=H(l);if(a.setRangeErrorMsg(d),d)return;let c=n.getName(),u=l.map(e=>{let t=(0,ei.serializeRange)(e);return"NaN"===t?"":t}).filter(e=>!!e).join(","),h={ranges:l,unitId:r,subUnitId:o,unitType:rN.SelectRange,name:`${c}(${u})`};if(1===h.ranges.length){let{startRow:e,endRow:t,startColumn:i,endColumn:r}=h.ranges[0];0===e&&t===n.getRowCount()-1&&0===i&&n.getColumnCount()-1===r&&(h.unitType=rN.Worksheet,h.name=`${c}`)}a.setRule(h)},"handleRangeChange"),L=/* @__PURE__ */el(e=>{var t;let i=null==(t=C.current)?void 0:t.handleOutClick;i&&i(e,b)},"handlePanelClick"),B=null==(i=null==d?void 0:d.ranges)?void 0:i.map(e=>(0,ei.serializeRange)(e)).join(",");return /* @__PURE__ */o$.jsx("div",{className:gv.permissionPanelDetailWrapper,onClick:L,children:/* @__PURE__ */o$.jsxs(gg,{loading:k,children:[/* @__PURE__ */o$.jsx(et.FormLayout,{className:gv.sheetPermissionPanelTitle,label:r.t("permission.panel.protectedRange"),children:S&&D&&/* @__PURE__ */o$.jsx(S,{unitId:y,errorText:f,subUnitId:T,initValue:B,onChange:U,isFocus:I,actions:C.current})}),/* @__PURE__ */o$.jsx(et.FormLayout,{className:gv.sheetPermissionPanelTitle,label:r.t("permission.panel.permissionDirection"),children:/* @__PURE__ */o$.jsx(et.Input,{value:null!=(n=null==d?void 0:d.description)?n:"",onChange:/* @__PURE__ */el(e=>a.setRule({description:e}),"onChange"),placeholder:r.t("permission.panel.permissionDirectionPlaceholder")})}),/* @__PURE__ */o$.jsx(et.FormLayout,{className:gv.sheetPermissionPanelTitle,label:r.t("permission.panel.editPermission"),children:/* @__PURE__ */o$.jsxs(et.RadioGroup,{value:w,onChange:/* @__PURE__ */el(e=>{P(e),a.setRule({editStatus:e})},"onChange"),className:gv.radioGroupVertical,children:[/* @__PURE__ */o$.jsx(et.Radio,{value:rH.onlyMe,children:/* @__PURE__ */o$.jsx("span",{className:gv.text,children:r.t("permission.panel.onlyICanEdit")})}),/* @__PURE__ */o$.jsx(et.Radio,{value:rH.designedUserCanEdit,children:/* @__PURE__ */o$.jsx("span",{className:gv.text,children:r.t("permission.panel.designedUserCanEdit")})})]})}),"designedUserCanEdit"===w&&/* @__PURE__ */o$.jsxs("div",{className:gv.sheetPermissionDesignPersonPanel,children:[/* @__PURE__ */o$.jsxs("div",{className:gv.sheetPermissionDesignPersonPanelHeader,children:[/* @__PURE__ */o$.jsx("span",{children:r.t("permission.panel.designedPerson")}),/* @__PURE__ */o$.jsx("span",{className:gv.sheetPermissionDesignPersonPanelHeaderAdd,onClick:W,children:r.t("permission.panel.addPerson")})]}),/* @__PURE__ */o$.jsx("div",{className:gv.sheetPermissionDesignPersonPanelSplit}),/* @__PURE__ */o$.jsx("div",{className:gv.sheetPermissionDesignPersonPanelContent,children:(null==E?void 0:E.length)>0?E.map(e=>{var t,i,n;return /* @__PURE__ */o$.jsxs("div",{className:gv.sheetPermissionDesignPersonPanelContentItem,children:[/* @__PURE__ */o$.jsx(et.Avatar,{size:24,src:null==(t=e.subject)?void 0:t.avatar}),/* @__PURE__ */o$.jsx("span",{className:gv.sheetPermissionDesignPersonPanelContentItemName,children:null==(i=e.subject)?void 0:i.name}),/* @__PURE__ */o$.jsx(et.Select,{className:gv.sheetPermissionDesignPersonPanelContentItemSelect,value:"edit",onChange:/* @__PURE__ */el(t=>{"delete"===t&&u.setSelectUserList(E.filter(t=>{var i,n;return(null==(i=t.subject)?void 0:i.userID)!==(null==(n=e.subject)?void 0:n.userID)}))},"onChange"),options:[{label:`${r.t("permission.panel.canEdit")}`,value:"edit"},{label:`${r.t("permission.panel.delete")}`,value:"delete"}]})]},null==(n=e.subject)?void 0:n.userID)}):/* @__PURE__ */o$.jsxs("div",{className:gv.sheetPermissionUserListEmpty,children:[/* @__PURE__ */o$.jsx("img",{width:240,height:120,src:gp,alt:""}),/* @__PURE__ */o$.jsx("p",{className:gv.sheetPermissionUserListEmptyText,children:r.t("permission.dialog.userEmpty")})]})})]}),/* @__PURE__ */o$.jsx(et.FormLayout,{className:gv.sheetPermissionPanelTitle,label:r.t("permission.panel.viewPermission"),children:/* @__PURE__ */o$.jsxs(et.RadioGroup,{value:M,onChange:/* @__PURE__ */el(e=>{x(e),a.setRule({viewStatus:e})},"onChange"),className:gv.radioGroupVertical,children:[/* @__PURE__ */o$.jsx(et.Radio,{value:rW.othersCanView,children:/* @__PURE__ */o$.jsx("span",{className:gv.text,children:r.t("permission.panel.othersCanView")})}),/* @__PURE__ */o$.jsx(et.Radio,{value:rW.noOneElseCanView,children:/* @__PURE__ */o$.jsx("span",{className:gv.text,children:r.t("permission.panel.noOneElseCanView")})})]})})]})})},"SheetPermissionPanelDetail"),gf=/* @__PURE__ */el(({showDetail:e,fromSheetBar:t})=>{var i;let n=(0,O.useDependency)(O.IUniverInstanceService),r=(0,O.useDependency)(A.SheetsSelectionsService);if(!(0,O.useDependency)(rU).getVisible())return null;let o=(0,A.getSheetCommandTarget)(n);if(!o)return null;let{worksheet:s}=o,l=(null==(i=r.getCurrentSelections())?void 0:i.map(e=>e.range)).reduce((e,t)=>e+(0,ei.serializeRangeWithSheet)(s.getName(),t),"");return e?/* @__PURE__ */o$.jsx(gS,{fromSheetBar:t},l):/* @__PURE__ */o$.jsx(gh,{},l)},"SheetPermissionPanel"),gC="univer-sheet-permission-dialog-split",gI="univer-sheet-permission-user-dialog-button",gb=/* @__PURE__ */el(()=>{let e=(0,O.useDependency)(O.LocaleService),t=(0,O.useDependency)(O.IUniverInstanceService),i=(0,O.useDependency)(O.IAuthzIoService),n=(0,O.useDependency)(A.WorksheetProtectionPointModel),r=(0,O.useDependency)(J.IDialogService),o=(0,O.useDependency)(O.IPermissionService),s=t.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),l=s.getActiveSheet();if(!l)throw Error("No active sheet found");let[a,d]=(0,ee.useState)([]),c=(0,O.useDependency)(O.ICommandService),[u,h]=(0,ee.useState)(()=>!!n.getRule(s.getUnitId(),l.getSheetId())),[m,g]=(0,ee.useState)(()=>Object.keys(rG).reduce((t,i)=>(t[i]={text:e.t(`permission.panel.${rG[Number(i)]}`),allowed:!0},t),{}));(0,ee.useEffect)(()=>{},[]),(0,ee.useEffect)(()=>{},[]);let p=/* @__PURE__ */el(async()=>{let e=t.getCurrentUnitForType(O.UniverInstanceType.UNIVER_SHEET),r=null==e?void 0:e.getActiveSheet();if(!r)throw Error("No active sheet found");let s=e.getUnitId(),l=r.getSheetId(),d=n.getRule(s,l),u=Object.keys(m).map(e=>({action:Number(e),role:m[e].allowed?rk.Editor:rk.Owner})),h=null==d?void 0:d.permissionId;h?i.update({objectType:rN.Worksheet,objectID:h,unitID:s,strategies:u,share:void 0,name:"",scope:{read:rD.AllCollaborator,edit:rD.AllCollaborator},collaborators:void 0}).then(()=>{(0,A.getAllWorksheetPermissionPoint)().forEach(e=>{let t=new e(s,l),i=t.subType,n=u.find(e=>e.action===i);n&&o.updatePermissionPoint(t.id,n.role===rk.Editor)})}):(h=await i.create({objectType:rN.Worksheet,worksheetObject:{unitID:s,collaborators:a,name:"",strategies:u,scope:{read:rD.AllCollaborator,edit:rD.AllCollaborator}}}),c.executeCommand(A.SetWorksheetPermissionPointsCommand.id,{rule:{permissionId:h,unitId:s,subUnitId:l}}))},"handleChangeActionPermission");return /* @__PURE__ */o$.jsx(gg,{loading:u,children:/* @__PURE__ */o$.jsxs("div",{className:"univer-sheet-permission-dialog-wrapper",children:[/* @__PURE__ */o$.jsx("div",{className:gC}),Object.keys(m).map(e=>{let t=m[e],{text:i,allowed:n}=t;return /* @__PURE__ */o$.jsxs("div",{className:"univer-sheet-permission-dialog-item",children:[/* @__PURE__ */o$.jsx("div",{children:i}),/* @__PURE__ */o$.jsx(et.Switch,{defaultChecked:n,onChange:/* @__PURE__ */el(()=>{g({...m,[e]:{...t,allowed:!n}})},"onChange")})]},i)}),/* @__PURE__ */o$.jsx("div",{className:gC}),/* @__PURE__ */o$.jsxs("div",{className:"univer-sheet-permission-user-dialog-footer",children:[/* @__PURE__ */o$.jsx(et.Button,{className:gI,onClick:/* @__PURE__ */el(()=>{r.close(rY)},"onClick"),children:e.t("permission.button.cancel")}),/* @__PURE__ */o$.jsx(et.Button,{type:"primary",onClick:/* @__PURE__ */el(()=>{p(),r.close(rY)},"onClick"),className:sg("univer-sheet-permission-user-dialog-footer-confirm",gI),children:e.t("permission.button.confirm")})]})]})})},"SheetPermissionDialog"),g_={sheetPermissionUserDialogWrapper:"univer-sheet-permission-user-dialog-wrapper",sheetPermissionUserDialogSearchInput:"univer-sheet-permission-user-dialog-search-input",sheetPermissionUserList:"univer-sheet-permission-user-list",sheetPermissionUserListEmpty:"univer-sheet-permission-user-list-empty",sheetPermissionUserListEmptyText:"univer-sheet-permission-user-list-empty-text",sheetPermissionUserItem:"univer-sheet-permission-user-item",sheetPermissionUserItemName:"univer-sheet-permission-user-item-name",sheetPermissionSplit:"univer-sheet-permission-split",sheetPermissionUserDialogFooter:"univer-sheet-permission-user-dialog-footer",sheetPermissionUserDialogFooterConfirm:"univer-sheet-permission-user-dialog-footer-confirm",sheetPermissionUserDialogButton:"univer-sheet-permission-user-dialog-button"},gR=/* @__PURE__ */el(()=>{let[t,i]=/*@__PURE__*/e(ee).useState(""),n=(0,O.useDependency)(O.LocaleService),r=(0,O.useDependency)(J.IDialogService),o=(0,O.useDependency)(rL),s=o.userList.filter(e=>{var i;return(null==(i=e.subject)?void 0:i.name.toLocaleLowerCase().includes(t.toLocaleLowerCase()))&&e.role===rk.Editor}),[l,a]=(0,ee.useState)(o.selectUserList),d=/* @__PURE__ */el(e=>{(null==l?void 0:l.findIndex(t=>{var i,n;return(null==(i=t.subject)?void 0:i.userID)===(null==(n=e.subject)?void 0:n.userID)}))===-1?a([...l,{...e}]):a(l.filter(t=>{var i,n;return(null==(i=t.subject)?void 0:i.userID)!==(null==(n=e.subject)?void 0:n.userID)}))},"handleChangeUser");return /* @__PURE__ */o$.jsxs("div",{className:g_.sheetPermissionUserDialogWrapper,children:[/* @__PURE__ */o$.jsx("div",{className:g_.sheetPermissionUserDialogSearch,children:/* @__PURE__ */o$.jsx(et.Input,{placeholder:"search",className:g_.sheetPermissionUserDialogSearchInput,value:t,onChange:/* @__PURE__ */el(e=>i(e),"onChange")})}),/* @__PURE__ */o$.jsx("div",{className:g_.sheetPermissionUserList,children:(null==s?void 0:s.length)>0?/* @__PURE__ */o$.jsx(o$.Fragment,{children:null==s?void 0:s.map(e=>{var t,i,n;return /* @__PURE__ */o$.jsxs("div",{className:g_.sheetPermissionUserItem,onClick:/* @__PURE__ */el(()=>d(e),"onClick"),children:[/* @__PURE__ */o$.jsx(et.Avatar,{src:null==(t=e.subject)?void 0:t.avatar,size:24}),/* @__PURE__ */o$.jsx("div",{className:g_.sheetPermissionUserItemName,children:null==(i=e.subject)?void 0:i.name}),(null==l?void 0:l.findIndex(t=>{var i,n;return(null==(i=t.subject)?void 0:i.userID)===(null==(n=e.subject)?void 0:n.userID)}))!==-1&&/* @__PURE__ */o$.jsx("div",{children:/* @__PURE__ */o$.jsx(nx,{})})]},null==(n=e.subject)?void 0:n.userID)})}):/* @__PURE__ */o$.jsxs("div",{className:g_.sheetPermissionUserListEmpty,children:[/* @__PURE__ */o$.jsx("img",{width:240,height:120,src:gp,alt:""}),/* @__PURE__ */o$.jsx("p",{className:g_.sheetPermissionUserListEmptyText,children:n.t("permission.dialog.userEmpty")})]})}),/* @__PURE__ */o$.jsx("div",{className:g_.sheetPermissionSplit}),/* @__PURE__ */o$.jsxs("div",{className:g_.sheetPermissionUserDialogFooter,children:[/* @__PURE__ */o$.jsx(et.Button,{className:g_.sheetPermissionUserDialogButton,onClick:/* @__PURE__ */el(()=>r.close(rX),"onClick"),children:n.t("permission.button.cancel")}),/* @__PURE__ */o$.jsx(et.Button,{type:"primary",onClick:/* @__PURE__ */el(()=>{o.setSelectUserList(l),r.close(rX)},"onClick"),className:sg(g_.sheetPermissionUserDialogFooterConfirm,g_.sheetPermissionUserDialogButton),children:n.t("permission.button.confirm")})]})]})},"SheetPermissionUserDialog"),gy=/* @__PURE__ */el(({errorMsg:e})=>{let t=(0,O.useDependency)(O.LocaleService),i=(0,O.useDependency)(J.IDialogService);return /* @__PURE__ */o$.jsxs("div",{className:"univer-sheet-permission-alert-dialog",children:[/* @__PURE__ */o$.jsx("h1",{className:"univer-sheet-permission-alert-dialog-title",children:t.t("permission.dialog.alert")}),/* @__PURE__ */o$.jsx("p",{children:e||t.t("permission.dialog.alertContent")}),/* @__PURE__ */o$.jsx("div",{className:"univer-sheet-permission-alert-dialog-button",children:/* @__PURE__ */o$.jsx(et.Button,{type:"primary",onClick:/* @__PURE__ */el(()=>{i.close(md)},"onClick"),children:t.t("permission.button.confirm")})})]})},"AlertDialog"),gT="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNCIgaGVpZ2h0PSI0IiB2aWV3Qm94PSIwIDAgNCA0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWFzayBpZD0ibWFzazBfNzU5XzExMDgiIHN0eWxlPSJtYXNrLXR5cGU6YWxwaGEiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHg9IjAiIHk9IjAiIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjRDZEOEQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF83NTlfMTEwOCkiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTS0zLjY0MDAyIDMuNDQxNDFMMi4wNzM5NyAtMi4yNzI1OEwyLjc4MTA4IC0xLjU2NTQ4TC0yLjkzMjkxIDQuMTQ4NTJMLTMuNjQwMDIgMy40NDE0MVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0tMS41MTg2OCA1LjU2Mjc1TDQuMTk1MzEgLTAuMTUxMjQ1TDQuOTAyNDIgMC41NTU4NjJMLTAuODExNTc1IDYuMjY5ODZMLTEuNTE4NjggNS41NjI3NVoiIGZpbGw9IiNENkQ4REIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0wLjYwMjY1NiA3LjY4NDAzTDYuMzE2NjUgMS45NzAwM0w3LjAyMzc2IDIuNjc3MTRMMS4zMDk3NiA4LjM5MTEzTDAuNjAyNjU2IDcuNjg0MDNaIiBmaWxsPSIjRDZEOERCIi8+CjwvZz4KPC9zdmc+",gE="RANGE_PROTECTION_CAN_VIEW_RENDER_EXTENSION_KEY",gw="RANGE_PROTECTION_CAN_NOT_VIEW_RENDER_EXTENSION_KEY",gP=class extends x.SheetExtension{constructor(){super(),ea(this,"_pattern",null),ea(this,"_img",new Image),ea(this,"renderCache",/* @__PURE__ */new Set),this._img.src=gT}clearCache(){this.renderCache.clear()}draw(e,t,i){let{worksheet:n}=i;n&&(e.save(),this._pattern||(this._pattern=e.createPattern(this._img,"repeat")),this.renderCache.clear(),(0,O.Range).foreach(i.rowColumnSegment,(t,r)=>{if(!n.getRowVisible(t)||!n.getColVisible(r))return;let{selectionProtection:o=[]}=n.getCell(t,r)||{};this._pattern&&(e.fillStyle=this._pattern,o.forEach(t=>{t.ruleId&&this.shouldRender(t)&&!this.renderCache.has(t.ruleId)&&(this.renderCache.add(t.ruleId),t.ranges.forEach(t=>{let n=i.getCellByIndexWithNoHeader(t.startRow,t.startColumn),r=i.getCellByIndexWithNoHeader(t.endRow,t.endColumn);e.fillRect(n.startX,n.startY,r.endX-n.startX,r.endY-n.startY)}))}))}),e.restore())}};el(gP,"RangeProtectionRenderExtension");let gM=gP,gO=class extends gM{constructor(){super(),ea(this,"uKey",gE),ea(this,"Z_INDEX",25)}shouldRender(e){return(null==e?void 0:e[rA.View])!==!1}};el(gO,"RangeProtectionCanViewRenderExtension");let gx=class extends gM{constructor(){super(),ea(this,"uKey",gw),ea(this,"Z_INDEX",80)}shouldRender(e){return(null==e?void 0:e[rA.View])===!1}};el(gx,"RangeProtectionCanNotViewRenderExtension");let gA="worksheet-protection",gk=class extends x.SheetExtension{constructor(){super(),ea(this,"uKey",gA),ea(this,"Z_INDEX",25),ea(this,"_pattern"),ea(this,"_img",new Image),this._img.src=gT}draw(e,t,i){let{worksheet:n}=i;if(!n)return!1;e.save(),this._pattern||(this._pattern=e.createPattern(this._img,"repeat"));let{startRow:r,startColumn:o,endRow:s,endColumn:l}=i.rowColumnSegment,a=i.getCellByIndexWithNoHeader(r,o),d=i.getCellByIndexWithNoHeader(s,l),{hasWorksheetRule:c=!1,selectionProtection:u=[]}=n.getCell(r,o)||{};if(this._pattern){if(u.length>0){let e=u[0];(null==e?void 0:e[rA.View])?this.setZIndex(25):this.setZIndex(80)}e.fillStyle=this._pattern,c&&e.fillRect(a.startX,a.startY,d.endX-a.startX,d.endY-a.startY),e.restore()}}setZIndex(e){this.Z_INDEX=e}};el(gk,"WorksheetProtectionRenderExtension");var gN,gD=Object.defineProperty,gV=Object.getOwnPropertyDescriptor,gW=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?gV(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&gD(t,i,o),o},"__decorateClass$d"),gH=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$d");let gU=(el(gN=class extends O.Disposable{constructor(e){super(),this._componentManager=e,this._init()}_init(){this._initComponents()}_initComponents(){[[rZ,n6],["sheet-permission-delete-icon",nW],["sheet-permission-edit-icon",n8],["sheet-permission-check-icon",nx],[rK,nQ],[rB,gf],[rF,gd],[rj,gR],[rz,gb],[mc,gy]].forEach(([e,t])=>{this.disposeWithMe(this._componentManager.register(e,t))})}},"SheetPermissionRenderManagerController"),gN);gU=gW([gH(0,(0,O.Inject)(J.ComponentManager))],gU);let gL=(gF=class extends O.Disposable{constructor(e,t,i,n){super(),ea(this,"_rangeProtectionCanViewRenderExtension",new gO),ea(this,"_rangeProtectionCanNotViewRenderExtension",new gx),this._context=e,this._rangeProtectionRuleModel=t,this._sheetSkeletonManagerService=i,this._permissionService=n,this._initRender(),this._initSkeleton(),this._rangeProtectionRuleModel.ruleChange$.subscribe(e=>{var t,i;(null!=(t=e.oldRule)&&t.id&&this._rangeProtectionCanViewRenderExtension.renderCache.has(e.oldRule.id)||this._rangeProtectionCanViewRenderExtension.renderCache.has(e.rule.id))&&this._rangeProtectionCanViewRenderExtension.clearCache(),(null!=(i=e.oldRule)&&i.id&&this._rangeProtectionCanNotViewRenderExtension.renderCache.has(e.oldRule.id)||this._rangeProtectionCanNotViewRenderExtension.renderCache.has(e.rule.id))&&this._rangeProtectionCanNotViewRenderExtension.clearCache()})}_initRender(){let e=this._context.mainComponent;e&&(e.getExtensionByKey(gE)||e.register(this._rangeProtectionCanViewRenderExtension),e.getExtensionByKey(gw)||e.register(this._rangeProtectionCanNotViewRenderExtension))}_initSkeleton(){let e=/* @__PURE__ */el(()=>{var e;this._sheetSkeletonManagerService.reCalculate(),null==(e=this._context.mainComponent)||e.makeDirty()},"markDirtySkeleton");this.disposeWithMe((0,B.merge)(this._permissionService.permissionPointUpdate$.pipe((0,q.throttleTime)(300,void 0,{trailing:!0})),this._rangeProtectionRuleModel.rangeRuleInitStateChange$,this._rangeProtectionRuleModel.ruleChange$).pipe().subscribe(e))}},el(gF,"SheetPermissionRenderController"),gF);gL=gW([gH(1,(0,O.Inject)(A.RangeProtectionRuleModel)),gH(2,(0,O.Inject)(ev)),gH(3,O.IPermissionService)],gL);let gB=(gj=class extends O.Disposable{constructor(e,t,i,n,r){super(),ea(this,"_worksheetProtectionRenderExtension",new gk),this._context=e,this._renderManagerService=t,this._univerInstanceService=i,this._sheetSkeletonManagerService=n,this._worksheetProtectionRuleModel=r,this._initRender(),this._initSkeleton()}_initRender(){let e=this._context.unitId,t=e&&this._renderManagerService.getRenderById(e),i=t&&t.mainComponent;i&&(i.getExtensionByKey(gA)||i.register(this._worksheetProtectionRenderExtension))}_initSkeleton(){let e=/* @__PURE__ */el(()=>{var e;this._sheetSkeletonManagerService.reCalculate(),null==(e=this._context.mainComponent)||e.makeDirty()},"markDirtySkeleton");this.disposeWithMe((0,B.merge)(this._worksheetProtectionRuleModel.worksheetRuleInitStateChange$).pipe().subscribe(e))}},el(gj,"WorksheetProtectionRenderController"),gj);gB=gW([gH(1,(0,O.Inject)(x.IRenderManagerService)),gH(2,(0,O.Inject)(O.IUniverInstanceService)),gH(3,(0,O.Inject)(ev)),gH(4,(0,O.Inject)(A.WorksheetProtectionRuleModel))],gB);var gF,gj,gz,gX=Object.defineProperty,gY=Object.getOwnPropertyDescriptor,gG=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?gY(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&gX(t,i,o),o},"__decorateClass$c"),gZ=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$c");let gK=(gz=class extends O.Disposable{constructor(e,t,i,n){super(),this._permissionService=e,this._worksheetProtectionRuleModel=t,this._sheetInterceptorService=i,this._rangeProtectionCache=n,this._initViewModelByRangeInterceptor(),this._initViewModelBySheetInterceptor()}_initViewModelByRangeInterceptor(){this.disposeWithMe(this._sheetInterceptorService.intercept(A.INTERCEPTOR_POINT.CELL_CONTENT,{priority:999,effect:O.InterceptorEffectEnum.Value|O.InterceptorEffectEnum.Style,handler:/* @__PURE__ */el((e={},t,i)=>{let{unitId:n,subUnitId:r,row:o,col:s}=t,l=this._rangeProtectionCache.getCellInfo(n,r,o,s);if(l){let t=!1===l[rA.View],n={...e,selectionProtection:[l]};return t?(delete n.s,delete n.v,delete n.p,n):i(n)}return i(e)},"handler")}))}_initViewModelBySheetInterceptor(){this.disposeWithMe(this._sheetInterceptorService.intercept(A.INTERCEPTOR_POINT.CELL_CONTENT,{priority:999,effect:O.InterceptorEffectEnum.Value|O.InterceptorEffectEnum.Style,handler:/* @__PURE__ */el((e={},t,i)=>{var n,r,o,s,l;let{unitId:a,subUnitId:d}=t,c=this._worksheetProtectionRuleModel.getRule(a,d);if(null!=c&&c.permissionId){let t=[{[rA.View]:null!=(r=null==(n=this._permissionService.getPermissionPoint(new A.WorksheetViewPermission(a,d).id))?void 0:n.value)&&r,[rA.Edit]:null!=(s=null==(o=this._permissionService.getPermissionPoint(new A.WorksheetEditPermission(a,d).id))?void 0:o.value)&&s}],c=!(null!=(l=t[0])&&l[rA.View]),u={...e,hasWorksheetRule:!0,selectionProtection:t};return c?(delete u.s,delete u.v,delete u.p,u):i(u)}return i(e)},"handler")}))}},el(gz,"SheetPermissionViewModelController"),gz);gK=gG([gZ(0,O.IPermissionService),gZ(1,(0,O.Inject)(A.WorksheetProtectionRuleModel)),gZ(2,(0,O.Inject)(A.SheetInterceptorService)),gZ(3,(0,O.Inject)(A.RangeProtectionCache))],gK);var gq,gQ=Object.defineProperty,gJ=Object.getOwnPropertyDescriptor,g$=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?gJ(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&gQ(t,i,o),o},"__decorateClass$b"),g0=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$b");let g1=(gq=class extends O.Disposable{constructor(e,t,i,n){super(),this._context=e,this._contextMenuService=t,this._selectionManagerService=i,this._selectionRenderService=n,this._init()}_init(){var e,t;let i=(null==(t=null==(e=this._context)?void 0:e.mainComponent)?void 0:t.onPointerDown$).subscribeEvent(e=>{if(2===e.button){let t=this._selectionManagerService.getCurrentSelections(),i=null==t?void 0:t[0];if(!i)return;let n=i.range.rangeType,r=eF(i,this._selectionRenderService.getSkeleton()).rangeWithCoord,o=/* @__PURE__ */el(()=>{if(!r)return!1;let t=e.offsetX,i=e.offsetY;switch(n){case O.RANGE_TYPE.ROW:return r.startY<=i&&r.endY>=i;case O.RANGE_TYPE.COLUMN:return r.startX<=t&&r.endX>=t;default:return r.startX<=t&&r.endX>=t&&r.startY<=i&&r.endY>=i}},"isPointerInRange");/* @__PURE__ */el(t=>{this._contextMenuService.triggerContextMenu(e,t)},"triggerMenu")(o()?n===O.RANGE_TYPE.COLUMN?J.ContextMenuPosition.COL_HEADER:n===O.RANGE_TYPE.ROW?J.ContextMenuPosition.ROW_HEADER:J.ContextMenuPosition.MAIN_AREA:J.ContextMenuPosition.MAIN_AREA)}});this.disposeWithMe(i);let n=this._context.components.get(eO.COLUMN),r=this._context.components.get(eO.ROW).onPointerDown$.subscribeEvent(e=>{2===e.button&&this._contextMenuService.triggerContextMenu(e,J.ContextMenuPosition.ROW_HEADER)});this.disposeWithMe(r);let o=n.onPointerDown$.subscribeEvent(e=>{2===e.button&&this._contextMenuService.triggerContextMenu(e,J.ContextMenuPosition.COL_HEADER)});this.disposeWithMe(o)}},el(gq,"SheetContextMenuRenderController"),gq);g1=g$([g0(1,J.IContextMenuService),g0(2,(0,O.Inject)(A.SheetsSelectionsService)),g0(3,ez)],g1);var g2,g5=Object.defineProperty,g9=Object.getOwnPropertyDescriptor,g6=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?g9(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&g5(t,i,o),o},"__decorateClass$a"),g3=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$a");let g7=(g2=class extends O.RxDisposable{constructor(e,t,i,n,r,o,s,l,a,d){super(),ea(this,"_d"),this._context=e,this._instanceSrv=t,this._commandService=i,this._editorBridgeService=n,this._selectionManagerService=r,this._rangeSelectorService=o,this._contextService=s,this._renderManagerService=l,this._editorService=a,this._sheetSkeletonManagerService=d,this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).subscribe(e=>{e&&e.getUnitId()===this._context.unitId?this._d=this._init():this._disposeCurrent()})),this._initialRangeSelector()}_init(){let e=new O.DisposableCollection;return this._initSelectionChangeListener(e),this._initEventListener(e),this._commandExecutedListener(e),this._initialKeyboardListener(e),e}_disposeCurrent(){var e;null==(e=this._d)||e.dispose(),this._d=null}_initSelectionChangeListener(e){e.add((0,B.merge)(this._selectionManagerService.selectionMoveEnd$,this._selectionManagerService.selectionMoveStart$).subscribe(e=>this._updateEditorPosition(e)))}_updateEditorPosition(e){var t,i,n;if(this._editorBridgeService.isVisible().visible||this._rangeSelectorService.selectorModalVisible)return;let r=null==(t=null==e?void 0:e[e.length-1])?void 0:t.primary;if(r){let{scene:e,engine:t}=this._getSheetObject(),o=this._context.unitId,s=null==(i=this._context.unit.getActiveSheet())?void 0:i.getSheetId();if(!s)return;let l=null==(n=this._sheetSkeletonManagerService.getWorksheetSkeleton(s))?void 0:n.skeleton.getCellByIndex(r.actualRow,r.actualColumn),a=l?{actualRow:l.actualRow,actualColumn:l.actualColumn,isMerged:l.isMerged,startRow:l.mergeInfo.startRow,startColumn:l.mergeInfo.startColumn,endRow:l.mergeInfo.endRow,endColumn:l.mergeInfo.endColumn,isMergedMainCell:l.isMergedMainCell}:r;this._commandService.executeCommand(oW.id,{scene:e,engine:t,primary:a,unitId:o,sheetId:s})}}_initEventListener(e){let{spreadsheet:t,spreadsheetColumnHeader:i,spreadsheetLeftTopPlaceholder:n,spreadsheetRowHeader:r}=this._getSheetObject();e.add(t.onDblclick$.subscribeEvent(e=>{2!==e.button&&this._commandService.executeCommand(i7.id,{visible:!0,eventType:x.DeviceInputEventType.Dblclick,unitId:this._context.unitId})})),e.add(t.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),e.add(i.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),e.add(n.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1})),e.add(r.onPointerDown$.subscribeEvent({next:this._tryHideEditor.bind(this),priority:-1}))}_initialKeyboardListener(e){let t=null,i=/* @__PURE__ */el(i=>{let n=i.with(M.DocSelectionRenderService);n&&(t=(0,O.toDisposable)(n.onInputBefore$.subscribe(e=>{if(!this._isCurrentSheetFocused())return;let t=this._contextService.getContextValue(O.FOCUSING_FX_BAR_EDITOR),n=this._contextService.getContextValue(O.FOCUSING_SHEET),r=i.unitId;this._editorBridgeService.isVisible().visible||r&&n&&!t&&this._editorService.isSheetEditor(r)&&this._showEditorByKeyboard(e)})),e.add(t))},"addEvent"),n=this._renderManagerService.getRenderById(O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY);n?i(n):this.disposeWithMe(this._renderManagerService.created$.pipe((0,U.filter)(e=>e.unitId===O.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)).subscribe(e=>{null==t||t.dispose(),i(e)}))}_commandExecutedListener(e){let t=/* @__PURE__ */new Set([A.ClearSelectionFormatCommand.id,A.SetRangeValuesMutation.id,nt.id]);e.add(this._commandService.onCommandExecuted(e=>{t.has(e.id)&&!this._editorBridgeService.isVisible().visible&&this._editorBridgeService.refreshEditCellState()})),e.add(this._commandService.beforeCommandExecuted((e,t)=>{null!=t&&t.fromCollab||e.id===A.SetWorksheetActiveOperation.id&&this._tryHideEditor()}))}_showEditorByKeyboard(e){if(null==e)return;let t=e.event;this._commandService.executeCommand(i7.id,{visible:!0,eventType:x.DeviceInputEventType.Keyboard,keycode:t.which,unitId:this._context.unitId})}_tryHideEditor(){this._editorBridgeService.isForceKeepVisible()||this._hideEditor()}_hideEditor(){!0===this._editorBridgeService.isVisible().visible&&this._commandService.syncExecuteCommand(i7.id,{visible:!1,eventType:x.DeviceInputEventType.PointerDown,unitId:this._context.unitId})}_initialRangeSelector(){this.disposeWithMe(this._selectionManagerService.selectionMoving$.subscribe(this._rangeSelector.bind(this))),this.disposeWithMe(this._selectionManagerService.selectionMoveStart$.subscribe(this._rangeSelector.bind(this))),this.disposeWithMe(this._rangeSelectorService.openSelector$.subscribe(()=>{let{unitId:e,sheetId:t,sheetName:i}=this._getCurrentUnitIdAndSheetId();if(!t||!i)return;let n=this._selectionManagerService.getCurrentSelections(),r=null==n?void 0:n.map(n=>({range:n.range,unitId:e,sheetId:t,sheetName:i}));r&&this._rangeSelectorService.selectionChange(r)}))}_rangeSelector(e){if(!e)return;let{unitId:t,sheetId:i,sheetName:n}=this._getCurrentUnitIdAndSheetId();if(!i||!n)return;let r=e.map(e=>({range:e.range,unitId:t,sheetId:i,sheetName:n}));this._rangeSelectorService.selectionChange(r)}_getCurrentUnitIdAndSheetId(){let e=this._context.unit,t=e.getActiveSheet();return{unitId:e.getUnitId(),sheetId:null==t?void 0:t.getSheetId(),sheetName:null==t?void 0:t.getName()}}_getSheetObject(){return tg(this._context.unit,this._context)}_isCurrentSheetFocused(){var e;return(null==(e=this._instanceSrv.getFocusedUnit())?void 0:e.getUnitId())===this._context.unitId}},el(g2,"EditorBridgeRenderController"),g2);g7=g6([g3(1,O.IUniverInstanceService),g3(2,O.ICommandService),g3(3,tA),g3(4,(0,O.Inject)(A.SheetsSelectionsService)),g3(5,M.IRangeSelectorService),g3(6,O.IContextService),g3(7,x.IRenderManagerService),g3(8,M.IEditorService),g3(9,(0,O.Inject)(ev))],g7);var g4,g8=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,pt=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?pe(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&g8(t,i,o),o},"__decorateClass$9"),pi=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$9");let pn=(el(g4=class extends O.Disposable{constructor(e,t){super(),this._context=e,this._formatPainterService=t,this._initialize()}_initialize(){this._bindFormatPainterStatus()}_bindFormatPainterStatus(){this.disposeWithMe((0,O.toDisposable)(this._formatPainterService.status$.subscribe(e=>{let t=this._context.scene;t&&(e!==ov.OFF?t.setDefaultCursor(x.CURSOR_TYPE.CELL):t.setDefaultCursor(x.CURSOR_TYPE.DEFAULT))})))}},"FormatPainterRenderController"),g4);pn=pt([pi(1,oS)],pn);var pr=((w=pr||{})[w.NORMAL=0]="NORMAL",w[w.HIGHLIGHT=1]="HIGHLIGHT",w);let po="rgb(0, 0, 0)",ps="rgb(255, 255, 255, 1)",pl=class extends x.Shape{constructor(e,t){super(e,t),ea(this,"_size",12),ea(this,"_iconRatio",.4),ea(this,"_mode",0),this.setShapeProps(t)}setShapeProps(e){null!=e&&e.size&&(this._size=e.size),null!=e&&e.mode&&(this._mode=e.mode),this.transformByState({width:this._size,height:this._size})}_draw(e){1===this._mode&&(0,x.Rect).drawWith(e,{width:this._size,height:this._size,radius:this._size,fill:"rgba(0, 0, 0, 0.15)"});let t=.5*this._size*this._iconRatio,i=Math.PI/180*60,n=t*Math.sin(i),r=t*Math.cos(i);(0,x.RegularPolygon).drawWith(e,{pointsGroup:[[{x:-n+this._size/2,y:-r+this._size/2},{x:n+this._size/2,y:-r+this._size/2},{x:this._size/2,y:t+this._size/2}]],fill:po})}};el(pl,"HeaderMenuShape");var pa=Object.defineProperty,pd=Object.getOwnPropertyDescriptor,pc=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?pd(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&pa(t,i,o),o},"__decorateClass$8"),pu=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$8");let ph=(pO=class extends O.Disposable{constructor(e,t,i,n,r){super(),ea(this,"_hoverRect"),ea(this,"_hoverMenu"),ea(this,"_currentColumn",Number.POSITIVE_INFINITY),ea(this,"_headerPointerSubs"),ea(this,"_colHeaderPointerSubs"),this._context=e,this._sheetSkeletonManagerService=t,this._contextMenuService=i,this._commandService=n,this._selectionManagerService=r,this._initialize()}dispose(){var e,t,i;null==(e=this._hoverRect)||e.dispose(),null==(t=this._hoverMenu)||t.dispose(),null==(i=this._headerPointerSubs)||i.unsubscribe(),this._headerPointerSubs=null}_initialize(){let e=this._context.scene;this._hoverRect=new x.Rect("__SpreadsheetHeaderMenuSHAPEControllerShape__",{fill:"rgba(0, 0, 0, 0.1)",evented:!1}),this._hoverMenu=new pl("__SpreadsheetHeaderMenuMAINControllerShape__",{zIndex:100,visible:!1}),e.addObjects([this._hoverRect,this._hoverMenu],10),this._initialHover(0),this._initialHover(1),this._initialHoverMenu()}_initialHover(e=0){var t,i,n;let r=this._context.components.get(eO.COLUMN),o=this._context.components.get(eO.ROW),s=0===e?o:r,l=/* @__PURE__ */el(t=>{var i,n,r;let o=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton;if(null==o)return;let{rowHeaderWidth:s,columnHeaderHeight:l}=o,{startX:a,startY:d,endX:c,endY:u,column:h}=tv(t.offsetX,t.offsetY,this._context.scene,o);if(0===e)null==(n=this._hoverRect)||n.transformByState({width:s,height:u-d,left:0,top:d});else{if(this._currentColumn=h,null==(r=this._hoverRect)||r.transformByState({width:c-a,height:l,left:a,top:0}),null==this._hoverMenu)return;if(c-a<2*l){this._hoverMenu.hide();return}let e=.8*l;this._hoverMenu.transformByState({left:c-l,top:l/2-e/2}),this._hoverMenu.setShapeProps({size:e}),this._hoverMenu.show()}},"pointerMoveHandler"),a=/* @__PURE__ */el(()=>{var e;null==(e=this._hoverRect)||e.show()},"pointerEnterHandler"),d=/* @__PURE__ */el(()=>{var e,t;null==(e=this._hoverRect)||e.hide(),null==(t=this._hoverMenu)||t.hide()},"pointerLeaveHandler");this._headerPointerSubs=new G.Subscription;let c=s.onPointerMove$.subscribeEvent(l),u=s.onPointerEnter$.subscribeEvent(a),h=s.onPointerLeave$.subscribeEvent(d);null==(t=this._headerPointerSubs)||t.add(c),null==(i=this._headerPointerSubs)||i.add(u),null==(n=this._headerPointerSubs)||n.add(h)}_initialHoverMenu(){null!=this._hoverMenu&&(this._hoverMenu.onPointerEnter$.subscribeEvent(()=>{null!=this._hoverMenu&&(this._hoverMenu.setProps({mode:pr.HIGHLIGHT,visible:!0}),this._context.scene.setCursor(x.CURSOR_TYPE.POINTER))}),this._hoverMenu.onPointerLeave$.subscribeEvent(()=>{null!=this._hoverMenu&&(this._hoverMenu.setProps({mode:pr.NORMAL,visible:!1}),this._context.scene.resetCursor())}),this._hoverMenu.onPointerDown$.subscribeEvent(e=>{var t;let i=this._currentColumn,n=null==(t=this._selectionManagerService.getCurrentSelections())?void 0:t.map(e=>e.range);if(!(null!=n&&n.filter(e=>e.rangeType===O.RANGE_TYPE.COLUMN).find(e=>{let{startColumn:t,endColumn:n}=e;return i>=t&&i<=n}))){let e=this._getSelectionOnColumn(i);this._commandService.syncExecuteCommand(A.SetSelectionsOperation.id,e)}e.stopPropagation(),e.preventDefault(),this._contextMenuService.triggerContextMenu(e,J.ContextMenuPosition.COL_HEADER)}))}_getSelectionOnColumn(e){let t=this._context.unit,i=t.getActiveSheet();if(!i)throw Error("No active worksheet");return{unitId:t.getUnitId(),subUnitId:i.getSheetId(),selections:[{range:{startRow:0,startColumn:e,endRow:i.getRowCount()-1,endColumn:e,rangeType:O.RANGE_TYPE.COLUMN},primary:{startRow:0,startColumn:e,endRow:0,endColumn:e,actualRow:0,actualColumn:e,isMerged:!1,isMergedMainCell:!1},style:null}]}}},el(pO,"HeaderMenuRenderController"),pO);ph=pc([pu(1,(0,O.Inject)(ev)),pu(2,J.IContextMenuService),pu(3,O.ICommandService),pu(4,(0,O.Inject)(A.SheetsSelectionsService))],ph);var pm=((P=pm||{})[P.ROW=0]="ROW",P[P.COLUMN=1]="COLUMN",P);let pg=class extends x.Shape{constructor(e,t,i){super(e,t),ea(this,"_size",12),ea(this,"_iconRatio",.4),ea(this,"_hovered",!0),ea(this,"_hasPrevious",!0),ea(this,"_hasNext",!0),ea(this,"_unhideType"),t&&this.setShapeProps(t),this.onPointerEnter$.subscribeEvent(()=>this.setShapeProps({hovered:!0})),this.onPointerLeave$.subscribeEvent(()=>this.setShapeProps({hovered:!1})),this.onPointerDown$.subscribeEvent(()=>null==i?void 0:i())}setShapeProps(e){void 0!==e.type&&(this._unhideType=e.type),void 0!==e.hovered&&(this._hovered=e.hovered),void 0!==e.hasPrevious&&(this._hasPrevious=e.hasPrevious),void 0!==e.hasNext&&(this._hasNext=e.hasNext),this.transformByState({width:this._size*(1===this._unhideType?2:1),height:this._size*(0===this._unhideType?2:1)})}_draw(e){0===this._unhideType?this._drawOnRow(e):this._drawOnCol(e)}_drawOnRow(e){this._hovered&&(this._hasNext&&this._hasPrevious?(0,x.Rect).drawWith(e,{width:this._size,height:2*this._size,stroke:po,fill:ps}):(0,x.Rect).drawWith(e,{width:this._size,height:this._size,stroke:po,fill:ps}));let t=.5*this._size*this._iconRatio,i=Math.PI/3,n=t*Math.cos(i),r=t*Math.sin(i);if(this._hasPrevious&&(0,x.RegularPolygon).drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size/2-r},{x:this._size/2-r,y:this._size/2+n},{x:this._size/2+r,y:this._size/2+n}]],fill:po}),this._hasNext){let t=this._hasPrevious?3:1;(0,x.RegularPolygon).drawWith(e,{pointsGroup:[[{x:this._size/2,y:this._size*t/2+r},{x:this._size/2-r,y:this._size*t/2-n},{x:this._size/2+r,y:this._size*t/2-n}]],fill:po})}}_drawOnCol(e){this._hovered&&(this._hasNext&&this._hasPrevious?(0,x.Rect).drawWith(e,{width:2*this._size,height:this._size,stroke:po,fill:ps}):(0,x.Rect).drawWith(e,{width:this._size,height:this._size,stroke:po,fill:ps}));let t=.5*this._size*this._iconRatio,i=Math.PI/3,n=t*Math.cos(i),r=t*Math.sin(i);if(this._hasPrevious&&(0,x.RegularPolygon).drawWith(e,{pointsGroup:[[{x:-n+this._size/2,y:this._size/2},{x:this._size/2+r,y:this._size/2-r},{x:this._size/2+r,y:this._size/2+r}]],fill:po}),this._hasNext){let t=this._hasPrevious?3:1;(0,x.RegularPolygon).drawWith(e,{pointsGroup:[[{x:n+this._size*t/2,y:this._size/2},{x:-r+this._size*t/2,y:this._size/2-r},{x:-r+this._size*t/2,y:this._size/2+r}]],fill:po})}}};el(pg,"HeaderUnhideShape");var pp=Object.defineProperty,pv=Object.getOwnPropertyDescriptor,pS=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?pv(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&pp(t,i,o),o},"__decorateClass$7"),pf=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$7");let pC="__SpreadsheetHeaderUnhideSHAPEControllerShape__";A.InsertColMutation.id,A.InsertRowMutation.id,A.RemoveColMutation.id,A.RemoveRowMutation.id,A.MoveColsMutation.id,A.MoveRowsMutation.id,A.SetWorksheetColWidthMutation.id,A.SetWorksheetRowIsAutoHeightMutation.id,A.SetRowHiddenMutation.id,A.SetRowVisibleMutation.id,A.SetColHiddenMutation.id,A.SetColVisibleMutation.id;let pI=(el(px=class extends O.RxDisposable{constructor(e,t,i){super(),ea(this,"_shapes",{cols:[],rows:[]}),this._context=e,this._sheetSkeletonManagerService=t,this._commandService=i,this._init()}get _workbook(){return this._context.unit}dispose(){super.dispose(),this._clearShapes()}_init(){let e="";this._context.unit.activeSheet$.pipe((0,K.takeUntil)(this.dispose$)).subscribe(t=>{if(this._clearShapes(),!t){e="";return}e=t.getSheetId(),this._update(this._workbook,t)}),this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(t){let{unitId:i,sheetId:n}=t;if(i===this._workbook.getUnitId()&&n===e){let e=this._workbook.getSheetBySheetId(n);e&&this._update(this._workbook,e)}}}))}_update(e,t){var i;let n=null==(i=this._sheetSkeletonManagerService.getWorksheetSkeleton(t.getSheetId()))?void 0:i.skeleton;if(!n)return;let r=t.getHiddenRows(),o=t.getHiddenCols(),{scene:s}=this._getSheetObject(),l=t.getRowCount(),a=r.map(i=>{let{startRow:r,endRow:o}=i,a=tp(r,0,s,n),d=0!==r;return new pg(pC,{type:pm.ROW,hovered:!1,hasPrevious:d,hasNext:o!==l-1,top:a.startY-(d?12:0),left:a.startX-12},()=>this._commandService.executeCommand(A.SetSpecificRowsVisibleCommand.id,{unitId:e.getUnitId(),subUnitId:t.getSheetId(),ranges:[i]}))}),d=t.getColumnCount(),c=o.map(i=>{let{startColumn:r,endColumn:o}=i,l=tp(0,r,s,n),a=0!==r;return new pg(pC,{type:pm.COLUMN,hovered:!1,hasPrevious:a,hasNext:o!==d-1,top:8,left:l.startX-(a?12:0)},()=>this._commandService.executeCommand(A.SetSpecificColsVisibleCommand.id,{unitId:e.getUnitId(),subUnitId:t.getSheetId(),ranges:[i]}))});s.addObjects(c,12),s.addObjects(a,12),this._clearShapes(),this._shapes={cols:c,rows:a}}_clearShapes(){this._shapes.cols.forEach(e=>e.dispose()),this._shapes.rows.forEach(e=>e.dispose()),this._shapes={cols:[],rows:[]}}_getSheetObject(){return tg(this._workbook,this._context)}},"HeaderUnhideRenderController"),px);pI=pS([pf(1,(0,O.Inject)(ev)),pf(2,O.ICommandService)],pI);var pb=Object.defineProperty,p_=Object.getOwnPropertyDescriptor,pR=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?p_(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&pb(t,i,o),o},"__decorateClass$6"),py=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$6");let pT=(pA=class extends O.RxDisposable{constructor(e,t,i,n,r){super(),ea(this,"_renderFrameTimeMetric",null),ea(this,"_renderFrameTags",{}),ea(this,"_afterRenderMetric$",new Y.Subject),this._context=e,this._sheetSkeletonManagerService=t,this._sheetRenderService=i,this._commandService=n,this._telemetryService=r,this._addNewRender(),this._initRenderMetricSubscriber()}_addNewRender(){let{scene:e,engine:t,unit:i}=this._context;this._addComponent(i),this._initRerenderScheduler(),this._initCommandListener();let n=this._context.unit.getActiveSheet();if(!n)throw Error("No active sheet found");let r=n.getSheetId();this._sheetSkeletonManagerService.setCurrent({sheetId:r}),t.runRenderLoop(()=>e.render())}_initRenderMetricSubscriber(){if(!this._telemetryService)return;let{engine:e}=this._context;e.beginFrame$.subscribe(()=>{this._renderFrameTimeMetric=null,this._renderFrameTags={}}),e.endFrame$.subscribe(()=>{this._renderFrameTimeMetric&&Object.keys(this._renderFrameTimeMetric).filter(e=>e.startsWith(x.SHEET_EXTENSION_PREFIX)).length>0&&this._afterRenderMetric$.next({frameTimeMetric:this._renderFrameTimeMetric,tags:this._renderFrameTags})}),e.renderFrameTimeMetric$.subscribe(([e,t])=>{this._renderFrameTimeMetric||(this._renderFrameTimeMetric={}),this._renderFrameTimeMetric[e]||(this._renderFrameTimeMetric[e]=[]),this._renderFrameTimeMetric[e].push(Math.round(100*t)/100)}),e.renderFrameTags$.subscribe(([e,t])=>{this._renderFrameTags[e]=t});let t=[];this._afterRenderMetric$.pipe((0,Q.withLatestFrom)(e.endFrame$)).subscribe(([e,i])=>{t.push({FPS:i.FPS,elapsedTime:i.elapsedTime,frameTime:Math.round(100*i.frameTime)/100,...e.frameTimeMetric,...e.tags}),t.length>60&&(this._renderMetricCapture(t),t.length=0)})}_renderMetricCapture(e){if(0===e.length)return;let t=/* @__PURE__ */el(e=>{let t=0,i=Object.entries(e).filter(([e,t])=>Array.isArray(t)).map(([e])=>e).reduce((t,i)=>{let n=e[i].reduce((e,t)=>e+t,0);return t[i]=n,t},{});return Object.keys(e).filter(e=>e.startsWith(x.SHEET_EXTENSION_PREFIX)).forEach(e=>{t+=i[e]}),{...i,extensionTotal:t}},"sumValueForNumListFields"),i=e.map(e=>({...e,...t(e)})),n=/* @__PURE__ */el(e=>Object.entries(e[0]).filter(([e,t])=>!["elapsedTime"].includes(e)).filter(([e,t])=>"number"==typeof t).map(([e])=>e).reduce((t,i)=>{let n=e.map(e=>e[i]),r=Math.max(...n),o=Math.min(...n),s=n.reduce((e,t)=>e+t,0)/n.length;return t[i]={max:Math.round(100*r)/100,min:Math.round(100*o)/100,avg:Math.round(100*s)/100},t},{}),"getSummaryStats")(i),r=e[e.length-1].elapsedTime,o={sheetId:this._context.unit.getActiveSheet().getSheetId(),unitId:this._context.unit.getUnitId(),elapsedTimeToStart:r,...n};this._telemetryService.capture("sheet_render_cost",o)}_addComponent(e){let{scene:t,components:i}=this._context,n=e.getActiveSheet(),r=new x.Spreadsheet(eO.MAIN);this._addViewport(n);let o=new x.SpreadsheetRowHeader(eO.ROW),s=new x.SpreadsheetColumnHeader(eO.COLUMN),l=new x.Rect(eO.LEFT_TOP,{zIndex:2,left:-1,top:-1,fill:"rgb(248, 249, 250)",stroke:"rgb(217, 217, 217)",strokeWidth:1});this._context.mainComponent=r,i.set(eO.MAIN,r),i.set(eO.ROW,o),i.set(eO.COLUMN,s),i.set(eO.LEFT_TOP,l),t.addObjects([r],0),t.addObjects([o,s,l],10),t.enableLayerCache(0,10)}_initViewports(e,t,i){let n=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN,e,{left:t.width,top:i.height,bottom:0,right:0,isWheelPreventDefaultX:!0,allowCache:!0,bufferEdgeX:100,bufferEdgeY:100}),r=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT_TOP,e,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:0,bufferEdgeY:0}),o=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_LEFT,e,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:0,bufferEdgeY:100}),s=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN_TOP,e,{isWheelPreventDefaultX:!0,active:!1,allowCache:!0,bufferEdgeX:100,bufferEdgeY:0}),l=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_ROW_TOP,e,{active:!1,isWheelPreventDefaultX:!0}),a=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_ROW_BOTTOM,e,{left:0,top:i.height,bottom:0,width:t.width,isWheelPreventDefaultX:!0}),d=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_LEFT,e,{active:!1,isWheelPreventDefaultX:!0}),c=new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_COLUMN_RIGHT,e,{left:t.width,top:0,height:i.height,right:0,isWheelPreventDefaultX:!0});return{viewMain:n,viewLeftTop:new x.Viewport(x.SHEET_VIEWPORT_KEY.VIEW_LEFT_TOP,e,{left:0,top:0,width:t.width,height:i.height,isWheelPreventDefaultX:!0}),viewMainLeftTop:r,viewMainLeft:o,viewMainTop:s,viewColumnLeft:d,viewRowTop:l,viewRowBottom:a,viewColumnRight:c}}_addViewport(e){let t=this._context.scene,{rowHeader:i,columnHeader:n}=e.getConfig(),{viewMain:r}=this._initViewports(t,i,n);return new x.ScrollBar(r),t.attachControl(),r}_initRerenderScheduler(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(!e)return null;let{skeleton:t,sheetId:i}=e,n=this._context.unit,r=null==n?void 0:n.getSheetBySheetId(i);if(null==n||null==r)return;let{mainComponent:o,components:s}=this._context,l=s.get(eO.ROW),a=s.get(eO.COLUMN),d=s.get(eO.LEFT_TOP),{rowHeaderWidth:c,columnHeaderHeight:u}=t;null==o||o.updateSkeleton(t),null==l||l.updateSkeleton(t),null==a||a.updateSkeleton(t),null==d||d.transformByState({width:c,height:u})}))}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{let{unit:t}=this._context,{id:i}=e;if((0,A.COMMAND_LISTENER_SKELETON_CHANGE).includes(i)||this._sheetRenderService.checkMutationShouldTriggerRerender(i)){let n=t.getActiveSheet();if(!n)return;let r=this._context.unitId,o=n.getSheetId(),{unitId:s,subUnitId:l}=e.params;if(s!==r||l!==o)return;i!==A.SetWorksheetActiveOperation.id&&this._sheetSkeletonManagerService.makeDirty({sheetId:o,commandId:i},!0),this._sheetSkeletonManagerService.setCurrent({sheetId:o,commandId:i})}else(0,A.COMMAND_LISTENER_VALUE_CHANGE).includes(i)&&this._sheetSkeletonManagerService.reCalculate();e.type===O.CommandType.MUTATION&&this._markUnitDirty(e)}))}_markUnitDirty(e){let{mainComponent:t,scene:i}=this._context;if(e.id===ei.SetFormulaCalculationNotificationMutation.id&&null!=e.params.stageInfo||(t&&t.makeDirty(),i.makeDirty(),!e.params))return;let n=e.params,r=this._spreadsheetViewports(i);if(e.id===A.SetRangeValuesMutation.id&&n.cellValue){let e=this._cellValueToRange(n.cellValue),i=this._rangeToBounds([e]);this._markViewportDirty(r,i),t.setDirtyArea(i)}if(e.id===A.MoveRangeMutation.id&&n.from&&n.to){let e=n.fromRange||this._cellValueToRange(n.from.value),i=n.toRange||this._cellValueToRange(n.to.value),o=this._rangeToBounds([e,i]);this._markViewportDirty(r,o),t.setDirtyArea(o)}}_cellValueToRange(e){let t=0,i=0,n=0,r=0;for(let[o,s]of Object.entries(e)){for(let e in s)t>Number(e)&&(t=Number(e)),i<Number(e)&&(i=Number(e));n>Number(o)&&(n=Number(o)),r<Number(o)&&(r=Number(o))}return{startRow:n,endRow:r,startColumn:t,endColumn:i}}_rangeToBounds(e){let{rowHeightAccumulation:t,columnWidthAccumulation:i,rowHeaderWidth:n,columnHeaderHeight:r}=this._sheetSkeletonManagerService.getCurrent().skeleton,o=[];for(let s of e){let{startRow:e,endRow:l,startColumn:a,endColumn:d}=s,c=0===e?0:t[e-1]+r,u=t[l]+r,h=0===a?0:i[a-1]+n,m=i[d]+n;o.push({top:c,left:h,bottom:u,right:m,width:m-h,height:u-c})}return o}_markViewportDirty(e,t){for(let i of e.filter(e=>e.isActive&&e.cacheBound))for(let e of t)(0,O.Rectangle).hasIntersectionBetweenTwoRect(i.cacheBound,e)&&i.markDirty(!0)}_spreadsheetViewports(e){return e.getViewports().filter(e=>["viewMain","viewMainLeftTop","viewMainTop","viewMainLeft"].includes(e.viewportKey))}},el(pA,"SheetRenderController"),pA);pT=pR([py(1,(0,O.Inject)(ev)),py(2,(0,O.Inject)(tK)),py(3,O.ICommandService),py(4,(0,O.Optional)(er.ITelemetryService))],pT);let pE=(0,O.createInterceptorKey)("PRINTING_RANGE"),pw=(0,O.createInterceptorKey)("PRINTING_COMPONENT_COLLECT"),pP=class extends O.Disposable{constructor(){super(),ea(this,"interceptor",new O.InterceptorManager({PRINTING_RANGE:pE,PRINTING_COMPONENT_COLLECT:pw})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_RANGE,{priority:-1,handler:/* @__PURE__ */el(e=>e,"handler")})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:/* @__PURE__ */el(e=>e,"handler")}))}};el(pP,"SheetPrintInterceptorService");let pM=pP;var pO,px,pA,pk,pN=Object.defineProperty,pD=Object.getOwnPropertyDescriptor,pV=/* @__PURE__ */el((e,t,i)=>t in e?pN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,"__defNormalProp$1"),pW=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?pD(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&pN(t,i,o),o},"__decorateClass$5"),pH=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$5"),pU=/* @__PURE__ */el((e,t,i)=>pV(e,"symbol"!=typeof t?t+"":t,i),"__publicField$1");let pL=(el(pk=class extends O.Plugin{constructor(e=li,t,i,n,r){super(),this._config=e,this._injector=t,this._renderManagerService=i,this._configService=n,this._univerInstanceService=r;let{menu:o,...s}=this._config;o&&this._configService.setConfig("menu",o,{merge:!0}),this._configService.setConfig(lt,s)}onStarting(){(0,O.registerDependencies)(this._injector,(0,O.mergeOverrideWithDependencies)([[e0],[tA,{useClass:tx}],[lq,{useClass:lQ}],[oN,{useClass:oD}],[oS,{useClass:of}],[sy,{useClass:sR}],[sP,{useClass:sw}],[A.IRefSelectionsService,{useClass:A.RefSelectionsService}],[i9,{useClass:i5}],[pM],[s$,{useClass:sJ}],[od,{useClass:oc}],[uj],[hu],[uI],[uP],[eP],[um],[t8],[oA],[hR],[u8],[tK],[cV],[m7],[ng],[hZ],[ho],[hM],[uK],[rU],[rL],[m$],[mv],[ma],[gK],[gU]],this._config.override)),(0,O.touchDependencies)(this._injector,[[gK],[rU]])}onReady(){this._config.disableAutoFocus||this._initAutoFocus(),this._registerRenderBasics(),(0,O.touchDependencies)(this._injector,[[cV],[tK],[um],[mv]])}onRendered(){this._registerRenderModules(),(0,O.touchDependencies)(this._injector,[[ma],[gU],[u8],[hR],[ho],[m7],[t8],[oA],[hM],[uK]])}onSteady(){(0,O.touchDependencies)(this._injector,[[hZ],[ng],[m$]])}_registerRenderBasics(){[[ev],[pT],[ez,{useClass:ul}]].forEach(e=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(O.UniverInstanceType.UNIVER_SHEET,e))})}_registerRenderModules(){var e;let t=[[mP],[pI],[mU],[eR],[tR],[m_],[nl],[cB],[pn],[uW],[hD],[h3],[h0],[hS],[hF],[nI],[g1],[mi],[g7],[c6],[mZ],[go],[gL],[gB]],i=this._configService.getConfig(J.PLUGIN_CONFIG_KEY);(null==(e=null==i?void 0:i.contextMenu)||e)&&t.push([ph]),t.forEach(e=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(O.UniverInstanceType.UNIVER_SHEET,e))})}_initAutoFocus(){let e=this._univerInstanceService;this.disposeWithMe(e.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).pipe((0,U.filter)(e=>!!e)).subscribe(t=>e.focusUnit(t.getUnitId())))}},"UniverSheetsUIPlugin"),pk);pU(pL,"pluginName","SHEET_UI_PLUGIN"),pU(pL,"type",O.UniverInstanceType.UNIVER_SHEET),pL=pW([(0,O.DependentOn)(A.UniverSheetsPlugin),pH(1,(0,O.Inject)(O.Injector)),pH(2,x.IRenderManagerService),pH(3,O.IConfigService),pH(4,O.IUniverInstanceService)],pL);var pB=Object.defineProperty,pF=Object.getOwnPropertyDescriptor,pj=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?pF(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&pB(t,i,o),o},"__decorateClass$4"),pz=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$4");let pX=[td.id,tc.id],pY=(pq=class extends O.Disposable{constructor(e,t,i,n,r,o,s){super(),this._context=e,this._sheetSkeletonManagerService=t,this._commandService=i,this._renderManagerService=n,this._selectionManagerService=r,this._scrollManagerService=o,this._univerInstanceService=s,this._init()}scrollToRange(e){let{endRow:t,endColumn:i,startColumn:n,startRow:r}=e,o=this._getViewportBounding();if(e.rangeType===O.RANGE_TYPE.ROW?(n=0,i=0):e.rangeType===O.RANGE_TYPE.COLUMN&&(r=0,t=0),!o)return this._scrollToCell(r,n);{let e=o.startRow>t?r:t,s=o.startColumn>i?n:i;return this._scrollToCell(e,s)}}_init(){this._initCommandListener(),this._initScrollEventListener(),this._initPointerScrollEvent(),this._initSkeletonListener()}_initCommandListener(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(pX.includes(e.id))this._scrollToSelection();else if(e.id===A.ScrollToCellOperation.id){let t=e.params;this.scrollToRange(t)}else if(e.id===tu.id){let t=e.params;this._scrollToSelectionForExpand(t)}}))}_scrollToSelectionForExpand(e){setTimeout(()=>{let t=this._selectionManagerService.getCurrentLastSelection();if(null==t)return;let{startRow:i,startColumn:n,endRow:r,endColumn:o}=t.range,s=this._getViewportBounding();if(null==s)return;let{startRow:l,startColumn:a,endRow:d,endColumn:c}=s,u=0,h=0;u=i>l?r:r<d?i:l,h=n>a?o:o<c?n:a,e.direction===O.Direction.DOWN?u=r:e.direction===O.Direction.UP?u=i:e.direction===O.Direction.RIGHT?h=o:e.direction===O.Direction.LEFT&&(h=n),this._scrollToCell(u,h)},0)}_getFreeze(){var e;let t=null==(e=this._sheetSkeletonManagerService.getCurrent())?void 0:e.skeleton.getWorksheetConfig();if(null!=t)return t.freeze}_initScrollEventListener(){let{scene:e}=this._context;if(null==e)return;let t=e.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);t&&(this.disposeWithMe((0,O.toDisposable)(this._scrollManagerService.rawScrollInfo$.subscribe(e=>{var i;if(null==e){t.scrollToViewportPos({viewportScrollX:0,viewportScrollY:0});return}let n=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton;if(!n)return;let{sheetViewStartRow:r,sheetViewStartColumn:o,offsetX:s,offsetY:l}=e,{startX:a,startY:d}=n.getCellByIndexWithNoHeader(r,o);t.scrollToViewportPos({viewportScrollX:a+s,viewportScrollY:d+l})}))),this.disposeWithMe(t.onScrollAfter$.subscribeEvent(e=>{var t;if(!e)return;let i=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(null==i)return;let n=this._getSheetObject();if(null==i||null==n)return;let{viewportScrollX:r,viewportScrollY:o,scrollX:s,scrollY:l}=e,{row:a,column:d,rowOffset:c,columnOffset:u}=i.getDecomposedOffset(r,o),h={sheetViewStartRow:a,sheetViewStartColumn:d,offsetX:u,offsetY:c};this._scrollManagerService.setScrollStateToCurrSheet(h),this._scrollManagerService.validViewportScrollInfo$.next({...h,scrollX:s,scrollY:l,viewportScrollX:r,viewportScrollY:o})})),this.disposeWithMe(t.onScrollByBar$.subscribeEvent(e=>{var t;let i=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(null==i||!1===e.isTrigger)return;let n=this._getSheetObject();if(null==i||null==n)return;let{viewportScrollX:r=0,viewportScrollY:o=0}=e,s=this._getFreeze(),{row:l,column:a,rowOffset:d,columnOffset:c}=i.getDecomposedOffset(r,o);this._commandService.executeCommand(eE.id,{sheetViewStartRow:l+((null==s?void 0:s.ySplit)||0),sheetViewStartColumn:a+((null==s?void 0:s.xSplit)||0),offsetX:c,offsetY:d})})))}_initSkeletonListener(){this.disposeWithMe((0,O.toDisposable)(this._sheetSkeletonManagerService.currentSkeletonBefore$.subscribe(e=>{if(null==e)return;let t={unitId:e.unitId,sheetId:e.sheetId};this._scrollManagerService.setSearchParam(t);let i=this._getSheetObject();if(!i)return;let n=i.scene.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),r=this._scrollManagerService.getScrollStateByParam(t),{viewportScrollX:o,viewportScrollY:s}=this._scrollManagerService.calcViewportScrollFromRowColOffset(r);n&&(r?(n.viewportScrollX=o,n.viewportScrollY=s):(n.viewportScrollX=0,n.viewportScrollY=0),this._updateSceneSize(e))})))}_initPointerScrollEvent(){let e=this._getSheetObject();if(!e)return;let t=this._scrollManagerService,i=e.scene,n=e.spreadsheet,r=i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),o={x:0,y:0},s=!1,l={x:0,y:0},a=null,d=/* @__PURE__ */el(()=>{if(!r)return;l.x*=.95,l.y*=.95,o.x+=l.x,o.y+=l.y;let e=l.x,t=l.y;(0!==t||0!==e)&&this._commandService.executeCommand(eT.id,{offsetY:t,offsetX:e}),a=Math.abs(l.x)>1||Math.abs(l.y)>1?requestAnimationFrame(d):null},"pointerScrollInertia"),c=/* @__PURE__ */el(()=>{cancelAnimationFrame(a),a=null},"cancelInertiaAnimation");n.onPointerDown$.subscribeEvent((e,t)=>{c(),r&&(o.x=e.offsetX,o.y=e.offsetY,s=!0,t.stopPropagation())}),n.onPointerMove$.subscribeEvent((e,i)=>{if(!s||!r)return;let n=-(e.offsetX-o.x),a=-(e.offsetY-o.y);l.x=-(e.offsetX-o.x),l.y=-(e.offsetY-o.y),(0!==n||0!==a)&&(0!==a||0!==n)&&this._commandService.executeCommand(eT.id,{offsetY:a,offsetX:n}),t.getCurrentScrollState(),o.x=e.offsetX,o.y=e.offsetY,i.stopPropagation()}),n.onPointerUp$.subscribeEvent(e=>{s=!1,a=requestAnimationFrame(d)}),n.onPointerLeave$.subscribeEvent(()=>{s=!1}),n.onPointerOut$.subscribeEvent(()=>{s=!1}),i.onPointerOut$.subscribeEvent(()=>{s=!1}),i.onPointerCancel$.subscribeEvent(()=>{s=!1})}_updateSceneSize(e){var t;if(null==e)return;let{unitId:i}=this._context,{skeleton:n}=e,r=null==(t=this._renderManagerService.getRenderById(i))?void 0:t.scene;if(null==n||null==r)return;let{rowTotalHeight:o,columnTotalWidth:s,rowHeaderWidthAndMarginLeft:l,columnHeaderHeightAndMarginTop:a}=n,d=this._context.unit.getActiveSheet();if(!d)return;let c=d.getZoomRatio()||1;null==r||r.setScaleValue(c,c),null==r||r.transformByState({width:l+s,height:a+o})}_getSheetObject(){return tg(this._context.unit,this._context)}_scrollToSelectionByDirection(e){let t=this._getViewportBounding();if(null==t)return!1;let{startRow:i,startColumn:n,endRow:r,endColumn:o}=t,s=0,l=0,{startRow:a,startColumn:d,endRow:c,endColumn:u}=e;a>=i&&(s=c),c<=r&&(s=a),d>=n&&(l=u),u<=o&&(l=d),this._scrollToCell(s,l)}_scrollToSelection(e=!0){let t=this._selectionManagerService.getCurrentLastSelection();if(null==t)return;let{startRow:i,startColumn:n,actualRow:r,actualColumn:o}=t.primary;this._scrollToCell(e?r:i,e?o:n)}_getViewportBounding(){var e,t;let i=null==(e=this._getSheetObject())?void 0:e.scene;if(null==i)return;let n=i.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(null==n)return;let r=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton;if(null==r)return;let o=n.getBounding();return r.getRowColumnSegment(o)}_scrollToCell(e,t){var i,n,r,o;let s,l;let{rowHeightAccumulation:a,columnWidthAccumulation:d}=null!=(n=null==(i=this._sheetSkeletonManagerService.getCurrent())?void 0:i.skeleton)?n:{};if(null==a||null==d)return!1;let c=null==(r=this._getSheetObject())?void 0:r.scene;if(null==c)return!1;let u=c.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);if(null==u||(null==(o=this._sheetSkeletonManagerService.getCurrent())?void 0:o.skeleton)==null)return!1;let h=this._context.unit.getActiveSheet();if(!h)return!1;let{startColumn:m,startRow:g,ySplit:p,xSplit:v}=h.getFreeze(),S=this._getViewportBounding();if(null==S)return!1;let{startRow:f,startColumn:C,endRow:I,endColumn:b}=S;if(e>=g&&t>=m-v&&(e<=f&&(s=e),e>=I)){let t=a[e]-u.height;for(let i=f;i<=e;i++)if(a[i]>=t){s=i+1;break}}if(t>=m&&e>=g-p&&(t<=C&&(l=t),t>=b)){let e=d[t]-u.width;for(let i=C;i<=t;i++)if(d[i]>=e){l=i+1;break}}if(void 0===s&&void 0===l)return!1;let{offsetX:_,offsetY:R}=this._scrollManagerService.getCurrentScrollState()||{};return this._commandService.syncExecuteCommand(eE.id,{sheetViewStartRow:s,sheetViewStartColumn:l,offsetX:void 0===l?_:0,offsetY:void 0===s?R:0})}},el(pq,"MobileSheetsScrollRenderController"),pq);function pG(){let e=sC();return e?/* @__PURE__ */o$.jsx(pZ,{workbook:e}):null}function pZ(t){let{workbook:i}=t,[n,r]=(0,ee.useState)([]),[o,s]=(0,ee.useState)(""),l=/*@__PURE__*/e(ee).useRef(/* @__PURE__ */new Map),a=(0,O.useDependency)(O.ICommandService),d=(0,ee.useCallback)(()=>{let e=i.getActiveSheet().getSheetId(),t=i.getSheets(),n=i.getActiveSheet();if(r(t.filter(e=>!e.isSheetHidden()).map((e,t)=>{var i;return{sheetId:e.getSheetId(),label:e.getName(),index:t,selected:n===e,color:null!=(i=e.getTabColor())?i:void 0}})),s(e),l.current.has(e)){let t=l.current.get(e);t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}l.current.clear()},[i]);(0,ee.useEffect)(()=>d(),[d]);let c=(0,ee.useCallback)(e=>{a.executeCommand(A.SetWorksheetActiveOperation.id,{unitId:i.getUnitId(),subUnitId:e})},[a,i]);return(0,ee.useEffect)(()=>{let e=a.onCommandExecuted(e=>{switch(e.id){case A.SetWorksheetHideMutation.id:case A.RemoveSheetMutation.id:case A.SetWorksheetNameMutation.id:case A.InsertSheetMutation.id:case A.SetWorksheetOrderMutation.id:case A.SetWorksheetActiveOperation.id:d()}});return()=>e.dispose()},[a,d]),/* @__PURE__ */o$.jsx("div",{className:"univer-mobile-sheet-bar-container",children:/* @__PURE__ */o$.jsx("div",{className:"univer-mobile-sheet-bar-slider",children:n.map(e=>/* @__PURE__ */o$.jsx("div",{className:sg("univer-mobile-sheet-bar-item",{"univer-mobile-sheet-bar-item-activated":e.sheetId===o}),onClick:/* @__PURE__ */el(()=>c(e.sheetId),"onClick"),ref:/* @__PURE__ */el(t=>l.current.set(e.sheetId,t),"ref"),children:e.label},e.sheetId))})})}pY=pj([pz(1,(0,O.Inject)(ev)),pz(2,O.ICommandService),pz(3,x.IRenderManagerService),pz(4,(0,O.Inject)(A.SheetsSelectionsService)),pz(5,(0,O.Inject)(eR)),pz(6,O.IUniverInstanceService)],pY),el(pG,"MobileSheetBar"),el(pZ,"MobileSheetBarImpl");let pK={[J.ContextMenuPosition.MAIN_AREA]:{[J.ContextMenuGroup.FORMAT]:{[l9.name]:{order:0,menuItemFactory:aZ}},[J.ContextMenuGroup.DATA]:{order:2},[J.ContextMenuGroup.OTHERS]:{order:3}},[J.ContextMenuPosition.COL_HEADER]:{[J.ContextMenuGroup.FORMAT]:{[l9.name]:{order:0,menuItemFactory:aZ}},[J.ContextMenuGroup.LAYOUT]:{order:1},[J.ContextMenuGroup.DATA]:{order:2},[J.ContextMenuGroup.OTHERS]:{order:3}},[J.ContextMenuPosition.ROW_HEADER]:{[J.ContextMenuGroup.FORMAT]:{[l9.name]:{order:0,menuItemFactory:aZ}},[J.ContextMenuGroup.LAYOUT]:{order:1},[J.ContextMenuGroup.DATA]:{order:2},[J.ContextMenuGroup.OTHERS]:{order:3}}};var pq,pQ,pJ=Object.defineProperty,p$=Object.getOwnPropertyDescriptor,p0=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?p$(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&pJ(t,i,o),o},"__decorateClass$3"),p1=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$3");let p2=(el(pQ=class extends O.Disposable{constructor(e,t,i,n,r,o,s){super(),this._injector=e,this._componentManager=t,this._layoutService=i,this._commandService=n,this._shortcutService=r,this._menuManagerService=o,this._uiPartsService=s,this._init()}_init(){this._initCustomComponents(),this._initCommands(),this._initMenus(),this._initShortcuts(),this._initWorkbenchParts(),this._initFocusHandler()}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(su,sh)),this.disposeWithMe(e.register(sn,ss)),this.disposeWithMe(e.register(sl,et.ColorPicker)),this.disposeWithMe(e.register(sa,J.FontFamily)),this.disposeWithMe(e.register(sd,J.FontFamilyItem)),this.disposeWithMe(e.register(sc,J.FontSize)),this.disposeWithMe(e.register(oB,sf))}_initCommands(){[rh,ru,rg,rm,ne,tu,td,tc,oH,on,ot,oi,rS,rf,eE,ew,th,oW,(0,A.SetBoldCommand),i8,i7,i4,rC,rI,rb,r_,rR,ry,rT,rE,rw,(0,A.SetItalicCommand),(0,A.SetStrikeThroughCommand),(0,A.SetFontFamilyCommand),(0,A.SetFontSizeCommand),oC,oI,ob,o_,ey,eT,oR,oy,oT,oE,(0,A.SetUnderlineCommand),nt,na,oV,oe,rM,rv,rO,rp,oj,i6,i3,rq,oL,r2,r5,r9,r6,r3,r1,r7,r4,rQ,rJ,r$,r0,r8].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))})}_initMenus(){this._menuManagerService.mergeMenu(pK)}_initShortcuts(){[d6,d3,d7,d4,d8,ce,ct,ci,cn,cr,co,cs,cl,ca,cd,cc,cu,ch,cm,cg,cp,cb,cR,cT,cE,c_,cy,cv,cS,cf,cC,cI,...dK(),dQ,dq,dJ,d0,d1,d2,d$,d5,d9].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_initWorkbenchParts(){this._uiPartsService.registerComponent(J.BuiltInUIPart.HEADER,()=>(0,O.connectInjector)(pG,this._injector))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(O.UniverInstanceType.UNIVER_SHEET,e=>{}))}},"SheetUIMobileController"),pQ);p2=p0([p1(0,(0,O.Inject)(O.Injector)),p1(1,(0,O.Inject)(J.ComponentManager)),p1(2,J.ILayoutService),p1(3,O.ICommandService),p1(4,J.IShortcutService),p1(5,J.IMenuManagerService),p1(6,J.IUIPartsService)],p2);var p5,p9=Object.defineProperty,p6=Object.getOwnPropertyDescriptor,p3=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?p6(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&p9(t,i,o),o},"__decorateClass$2"),p7=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$2");let p4=(p5=class extends O.Disposable{constructor(e,t,i,n,r,o){super(),this._context=e,this._layoutService=t,this._contextMenuService=i,this._selectionManagerService=n,this._selectionRenderService=r,this._sheetSkeletonManagerService=o,this._init()}_init(){let e=!1;this.disposeWithMe(this._selectionManagerService.selectionMoveStart$.subscribe(()=>e=!0)),this.disposeWithMe(this._selectionManagerService.selectionMoveEnd$.subscribe(t=>{if(!t||!1===e)return;e=!1;let i=t[0];if(!i.primary)return;let n=this._layoutService.getContentElement().getBoundingClientRect(),r=this._selectionRenderService.attachSelectionWithCoord(i),o=i.range.rangeType,{scene:s}=this._context,l=s.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),a=(null==l?void 0:l.viewportScrollX)||0,d=(null==l?void 0:l.viewportScrollY)||0,c=0,u=0,h=this._sheetSkeletonManagerService.getCurrent().skeleton.rowHeaderWidth;switch(o){case O.RANGE_TYPE.NORMAL:c=r.rangeWithCoord.startX+n.left-a,u=r.rangeWithCoord.endY+n.top-d;break;case O.RANGE_TYPE.COLUMN:c=r.rangeWithCoord.startX+n.left-a,u=Math.min(n.height/2,r.rangeWithCoord.endY)+40;break;case O.RANGE_TYPE.ROW:c=(n.width-h)/2+20,u=r.rangeWithCoord.endY+n.top-d;break;case O.RANGE_TYPE.ALL:c=r.rangeWithCoord.startX+n.left,u=r.rangeWithCoord.startY+n.top;break;default:c=r.rangeWithCoord.startX+n.left-a,u=r.rangeWithCoord.endY+n.top-d}c=(0,O.Tools).clamp(c,h,n.width),u=(0,O.Tools).clamp(u,n.top,n.height),this._contextMenuService.triggerContextMenu({clientX:c,clientY:u,preventDefault:/* @__PURE__ */el(()=>{},"preventDefault"),stopPropagation:/* @__PURE__ */el(()=>{},"stopPropagation")},J.ContextMenuPosition.MAIN_AREA)}))}},el(p5,"SheetContextMenuMobileRenderController"),p5);p4=p3([p7(1,J.ILayoutService),p7(2,J.IContextMenuService),p7(3,(0,O.Inject)(A.SheetsSelectionsService)),p7(4,ez),p7(5,(0,O.Inject)(ev))],p4);let p8=class extends eH{constructor(e,t,i=!0,n,r=O.RANGE_TYPE.NORMAL){super(e,t,n,i),ea(this,"_fillControlTopLeft"),ea(this,"_fillControlBottomRight"),this._scene=e,this._zIndex=t,this._highlightHeader=i,this._themeService=n,this._rangeType=r,this.initControlPoints()}initControlPoints(){let e=this.defaultStyle,t=e.expandCornerSize||0,i=(e.expandCornerSize||0)/4,n=e.AutofillStrokeWidth||0,r=e.stroke,o=e.AutofillStroke,s=this.zIndex;this._fillControlTopLeft=new x.Rect(eV.fillTopLeft+s,{zIndex:s+2,width:t,height:t,radius:t/2,visualWidth:i,visualHeight:i,strokeWidth:n}),this._fillControlBottomRight=new x.Rect(eV.fillBottomRight+s,{zIndex:s+2,width:t,height:t,radius:t/2,visualHeight:i,visualWidth:i,strokeWidth:n});let l={fill:r,stroke:o,strokeScaleEnabled:!1};this._fillControlTopLeft.setProps({...l}),this._fillControlBottomRight.setProps({...l});let a=[this._fillControlTopLeft,this._fillControlBottomRight];switch(this._rangeType){case O.RANGE_TYPE.ROW:this.rowHeaderGroup.addObjects(...a);break;case O.RANGE_TYPE.COLUMN:this.columnHeaderGroup.addObjects(...a);break;case O.RANGE_TYPE.NORMAL:this.selectionShapeGroup.addObjects(...a)}this.getScene().addObjects(a,1)}get fillControlTopLeft(){return this._fillControlTopLeft}set fillControlTopLeft(e){this._fillControlTopLeft=e}get fillControlBottomRight(){return this._fillControlBottomRight}set fillControlBottomRight(e){this._fillControlBottomRight=e}get rangeType(){return this._rangeType}set rangeType(e){this._rangeType=e}dispose(){var e,t;null==(e=this._fillControlBottomRight)||e.dispose(),null==(t=this._fillControlTopLeft)||t.dispose(),super.dispose()}_setSizeAndStyleForSelectionControl(e){var t,i;super._setSizeAndStyleForSelectionControl(e);let n=this.defaultStyle;null==e&&(e=n);let{widgets:r=n.widgets,hasAutoFill:o=n.hasAutoFill}=e;if(this.currentStyle=e,!0!==o||super._hasWidgets(r))null==(t=this.fillControlTopLeft)||t.hide(),null==(i=this.fillControlBottomRight)||i.hide();else{let{viewportScrollX:e,viewportScrollY:t}=this.getViewportMainScrollInfo(),{endX:i,endY:n}=this.selectionModel;this.transformControlPoint(e,t,i,n),this.fillControlTopLeft.show(),this.fillControlBottomRight.show()}}getViewportMainScrollInfo(){let e=this.getScene().getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);return{viewportScrollX:(null==e?void 0:e.viewportScrollX)||0,viewportScrollY:(null==e?void 0:e.viewportScrollY)||0,width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}}transformControlPoint(e=0,t=0,i=0,n=0){let r=this.currentStyle,o=this.selectionModel.rangeType,s=r.expandCornerSize,{startX:l,startY:a,endX:d,endY:c}=this.selectionModel,u=this.getViewportMainScrollInfo(),h=u.width,m=u.height;switch(o){case O.RANGE_TYPE.NORMAL:this.fillControlTopLeft.transformByState({left:-s/2,top:-s/2}),this.fillControlBottomRight.transformByState({left:d-l-s/2,top:c-a-s/2});break;case O.RANGE_TYPE.ROW:{let t=-s/2+Math.min(h/2+e,i);this.fillControlTopLeft.transformByState({left:t,top:-s/2}),this.fillControlBottomRight.transformByState({left:t,top:-s/2+c-a})}break;case O.RANGE_TYPE.COLUMN:{let e=-s/2+Math.min(+m/2+t,n);this.fillControlTopLeft.transformByState({left:-s/2,top:e}),this.fillControlBottomRight.transformByState({left:-s/2+d-l,top:e})}break;default:console.error("unknown range type")}}};el(p8,"MobileSelectionControl");var ve,vt=Object.defineProperty,vi=Object.getOwnPropertyDescriptor,vn=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?vi(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&vt(t,i,o),o},"__decorateClass$1"),vr=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam$1");let vo=(ve=class extends eY{constructor(e,t,i,n,r,o,s,l,a,d){super(t,i,n,o),ea(this,"_workbookSelections"),ea(this,"_renderDisposable",null),ea(this,"_expandingSelection",!1),ea(this,"_selectionControls",[]),ea(this,"expandingControlMode","bottom-right"),this._context=e,this._logService=s,this._commandService=l,this._contextService=a,this._scrollManagerService=d,this._workbookSelections=r.getWorkbookSelections(this._context.unitId),this._init()}_init(){let e=this._getSheetObject();this._initEventListeners(e),this._initSelectionChangeListener(),this._initSkeletonChangeListener(),this._initUserActionSyncListener(),this._updateControlPointWhenScrolling()}_initSkeletonChangeListener(){this.disposeWithMe(this._sheetSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(null==e){this._logService.error("[SelectionRenderService]: should not receive null!");return}let t=this._context.unitId,{sheetId:i,skeleton:n}=e,{scene:r}=this._context,o=r.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN);this._changeRuntime(n,r,o),this._workbookSelections.getCurrentLastSelection()||this._commandService.syncExecuteCommand(A.SetSelectionsOperation.id,{unitId:t,subUnitId:i,selections:[eZ(n)]})}))}_initSelectionChangeListener(){this.disposeWithMe(this._workbookSelections.selectionMoveEnd$.subscribe(e=>{for(let t of(this._reset(),e)){let e=eF(t,this._skeleton);this._addSelectionControlBySelectionData(e)}}))}_initEventListeners(e){let{spreadsheetRowHeader:t,spreadsheetColumnHeader:i,spreadsheet:n,spreadsheetLeftTopPlaceholder:r}=e,{scene:o}=this._context;this._initSpreadsheetEvent(e),this.disposeWithMe(null==t?void 0:t.onPointerUp$.subscribeEvent((e,t)=>{if(this._normalSelectionDisabled())return;let i=this._sheetSkeletonManagerService.getCurrent().skeleton,{row:r}=tv(e.offsetX,e.offsetY,o,i);du(this._workbookSelections.getCurrentSelections(),r)||(this.createNewSelection(e,(n.zIndex||1)+1,O.RANGE_TYPE.ROW,this._getActiveViewport(e)),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()))})),this.disposeWithMe(null==i?void 0:i.onPointerUp$.subscribeEvent((e,t)=>{if(this._normalSelectionDisabled())return;let i=this._sheetSkeletonManagerService.getCurrent().skeleton,{column:r}=tv(e.offsetX,e.offsetY,o,i);dh(this._workbookSelections.getCurrentSelections(),r)||(this.createNewSelection(e,(n.zIndex||1)+1,O.RANGE_TYPE.COLUMN,this._getActiveViewport(e)),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()))})),this.disposeWithMe(null==r?void 0:r.onPointerUp$.subscribeEvent((e,t)=>{if(this._normalSelectionDisabled())return;this._reset();let i=this._sheetSkeletonManagerService.getCurrent().skeleton,n=eF(eG(i),i);this._addSelectionControlBySelectionData(n),this.refreshSelectionMoveStart(),t.stopPropagation(),this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())}))}_initSpreadsheetEvent(e){let t;let{spreadsheet:i}=e,n={x:0,y:0},r=/* @__PURE__ */el(()=>{clearTimeout(t)},"clearLongPressTimer"),o=/* @__PURE__ */el((e,t)=>{this.createNewSelection(e,i.zIndex+1,O.RANGE_TYPE.NORMAL,this._getActiveViewport(e)),t&&this._selectionMoveEnd$.next(this.getSelectionDataWithStyle())},"createNewSelection");null==i||i.onPointerMove$.subscribeEvent((e,t)=>{(Math.abs(e.offsetX-n.x)>10||Math.abs(e.offsetY-n.y)>10)&&r()});let s=null==i?void 0:i.onPointerDown$.subscribeEvent((e,i)=>{n.x=e.offsetX,n.y=e.offsetY,t=setTimeout(()=>{o(e,!0)},500),i.stopPropagation()}),l=null==i?void 0:i.onPointerUp$.subscribeEvent((e,i)=>{!this._normalSelectionDisabled()&&(clearTimeout(t),Math.abs(e.offsetX-n.x)>10||Math.abs(e.offsetY-n.y)>10||(o(e,!1),i.stopPropagation()))});this.disposeWithMe((0,O.toDisposable)(s)),this.disposeWithMe((0,O.toDisposable)(l))}_initUserActionSyncListener(){this.disposeWithMe(this.selectionMoveStart$.subscribe(e=>this._updateSelections(e,A.SelectionMoveType.MOVE_START))),this.disposeWithMe(this.selectionMoving$.subscribe(e=>this._updateSelections(e,A.SelectionMoveType.MOVING))),this.disposeWithMe(this._contextService.subscribeContextValue$(A.DISABLE_NORMAL_SELECTIONS).pipe((0,X.startWith)(!1),(0,W.distinctUntilChanged)()).subscribe(e=>{var t;e?(null==(t=this._renderDisposable)||t.dispose(),this._renderDisposable=null,this._reset()):this._renderDisposable=(0,O.toDisposable)(this.selectionMoveEnd$.subscribe(e=>this._updateSelections(e,A.SelectionMoveType.MOVE_END)))}))}_updateSelections(e,t){let i=this._context.unit,n=i.getUnitId(),r=i.getActiveSheet().getSheetId();0!==e.length&&this._commandService.executeCommand(A.SetSelectionsOperation.id,{unitId:n,subUnitId:r,type:t,selections:e.map(e=>(0,A.convertSelectionDataToRange)(e))})}createNewSelection(e,t=0,i=O.RANGE_TYPE.NORMAL,n){this._shouldDetectMergedCells=i===O.RANGE_TYPE.NORMAL;let r=this._skeleton,o=this._scene;if(!o||!r)return;n&&(this._activeViewport=n);let{offsetX:s,offsetY:l}=e,a=o.getRelativeToViewportCoord((0,x.Vector2).FromArray([s,l])),{x:d,y:c}=a,u=o.getVpScrollXYInfoByPosToVp(a),{scaleX:h,scaleY:m}=o.getAncestorScale(),g=this._getCellRangeByCursorPosition(d,c,h,m,u);if(!g)return!1;let{rangeWithCoord:p,primaryWithCoord:v}=g,S={...p,rangeType:i};this._startRangeWhenPointerDown={...p,rangeType:i};let f=this.getActiveSelectionControl();for(let e of this.getSelectionControls())if(e.model.isEqual(S)){f=e;break}(null==f?void 0:f.model.rangeType)!==i&&(this._clearSelectionControls(),f=this.newSelectionControl(o,i)),this._updateSelectionControlByRange(f,S,v),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._clearUpdatingListeners(),this._expandingSelection=!1,(i===O.RANGE_TYPE.ROW||i===O.RANGE_TYPE.COLUMN)&&(i===O.RANGE_TYPE.ROW?d=0:i===O.RANGE_TYPE.COLUMN&&(c=0),this._movingHandler(d,c,f,i))}newSelectionControl(e,t){let i=new p8(e,this.getSelectionControls().length,this._isHeaderHighlight,this._themeService,t);this._selectionControls.push(i);let{expandingModeForTopLeft:n,expandingModeForBottomRight:r}=(()=>{switch(t){case O.RANGE_TYPE.NORMAL:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"};case O.RANGE_TYPE.ROW:return{expandingModeForTopLeft:"top",expandingModeForBottomRight:"bottom"};case O.RANGE_TYPE.COLUMN:return{expandingModeForTopLeft:"left",expandingModeForBottomRight:"right"};case O.RANGE_TYPE.ALL:default:return{expandingModeForTopLeft:"top-left",expandingModeForBottomRight:"bottom-right"}}})();return i.fillControlTopLeft.onPointerDown$.subscribeEvent(e=>{this._expandingSelection=!0,this.expandingControlMode=n,this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._fillControlPointerDownHandler(e,t,this._activeViewport)}),i.fillControlBottomRight.onPointerDown$.subscribeEvent(e=>{this._expandingSelection=!0,this.expandingControlMode=r,this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._fillControlPointerDownHandler(e,t,this._activeViewport)}),(t===O.RANGE_TYPE.ROW||t===O.RANGE_TYPE.COLUMN)&&e.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),i}_getActiveViewport(e){let t=this._getSheetObject();return null==t?void 0:t.scene.getActiveViewportByCoord((0,x.Vector2).FromArray([e.offsetX,e.offsetY]))}_getSheetObject(){return tg(this._context.unit,this._context)}_normalSelectionDisabled(){return this._contextService.getContextValue(A.DISABLE_NORMAL_SELECTIONS)}getSelectionControls(){return this._selectionControls}_fillControlPointerDownHandler(e,t=O.RANGE_TYPE.NORMAL,i,n=x.ScrollTimerType.ALL){var r,o,s;let l=this._skeleton,a=this._scene;if(!a||!l)return;i&&(this._activeViewport=i);let d=a.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),c=this.getActiveSelectionControl();if(!c)return;this._changeCurrCellWhenControlPointerDown(),this._selectionMoveStart$.next(this.getSelectionDataWithStyle()),this._clearUpdatingListeners(),this._addEndingListeners(),this._scrollTimer=(0,x.ScrollTimer).create(this._scene,n),this._scrollTimer.startScroll(null!=(r=null==d?void 0:d.left)?r:0,null!=(o=null==d?void 0:d.top)?o:0,d),null==(s=a.getTransformer())||s.clearSelectedObjects();let u=a.getRelativeToViewportCoord((0,x.Vector2).FromArray([e.offsetX,e.offsetY]));this._setupPointerMoveListener(d,c,t,n,u.x,u.y);let h=this._shortcutService.forceEscape();this._scenePointerUpSub=a.onPointerUp$.subscribeEvent(e=>{this.endSelection(),this._expandingSelection=!1,this.expandingControlMode="bottom-right",this._selectionMoveEnd$.next(this.getSelectionDataWithStyle()),h.dispose()})}_changeCurrCellWhenControlPointerDown(){let e;let t=this.getActiveSelectionControl(),i=this._skeleton,{startRow:n,startColumn:r,endRow:o,endColumn:s}=t.model;switch(this.expandingControlMode){case"top-left":e=i.getCellByIndex(o,s);break;case"bottom-right":default:e=i.getCellByIndex(n,r);break;case"left":(e=i.getCellByIndex(n,s)).isMerged=!1,e.isMergedMainCell=!1;break;case"right":case"bottom":(e=i.getCellByIndex(n,r)).isMerged=!1,e.isMergedMainCell=!1;break;case"top":(e=i.getCellByIndex(o,r)).isMerged=!1,e.isMergedMainCell=!1}return t.updateCurrCell(e),e}_movingHandler(e,t,i,n){var r,o,s,l,a,d,c,u,h,m,g,p,v;this._shouldDetectMergedCells=n===O.RANGE_TYPE.NORMAL;let S=this._skeleton,f=this._scene,C={startRow:i.model.startRow,endRow:i.model.endRow,startColumn:i.model.startColumn,endColumn:i.model.endColumn},I=f.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN),b=null!=(r=this._getViewportByCell(C.endRow,C.endColumn))?r:I,_=f.getVpScrollXYInfoByPosToVp((0,x.Vector2).FromArray([this._startViewportPosX,this._startViewportPosY]),b),{scaleX:R,scaleY:y}=f.getAncestorScale();n===O.RANGE_TYPE.ROW?e=Number.POSITIVE_INFINITY:n===O.RANGE_TYPE.COLUMN&&(t=Number.POSITIVE_INFINITY);let T=this._getCellRangeByCursorPosition(e,t,R,y,_);if(!T)return!1;let{rangeWithCoord:E}=T,w=i.model.currentCell,P=null!=(o=null==w?void 0:w.mergeInfo.startRow)?o:-1,M=null!=(s=null==w?void 0:w.mergeInfo.endRow)?s:-1,A=null!=(l=null==w?void 0:w.mergeInfo.startColumn)?l:-1,k=null!=(a=null==w?void 0:w.mergeInfo.endColumn)?a:-1,N={startRow:Math.min(E.startRow,P),startColumn:Math.min(E.startColumn,A),endRow:Math.max(E.endRow,M),endColumn:Math.max(E.endColumn,k)};if(n===O.RANGE_TYPE.NORMAL?N=S.getSelectionMergeBounding(N.startRow,N.startColumn,N.endRow,N.endColumn):n===O.RANGE_TYPE.COLUMN?N={startRow:Math.min(E.startRow,null!=(d=null==w?void 0:w.actualRow)?d:-1),startColumn:Math.min(E.startColumn,null!=(c=null==w?void 0:w.actualColumn)?c:-1),endRow:Math.max(E.endRow,null!=(u=null==w?void 0:w.actualRow)?u:-1),endColumn:Math.max(E.endColumn,null!=(h=null==w?void 0:w.actualColumn)?h:-1)}:n===O.RANGE_TYPE.ROW&&(N={startRow:Math.min(E.startRow,null!=(m=null==w?void 0:w.actualRow)?m:-1),startColumn:Math.min(E.startColumn,null!=(g=null==w?void 0:w.actualColumn)?g:-1),endRow:Math.max(E.endRow,null!=(p=null==w?void 0:w.actualRow)?p:-1),endColumn:Math.max(E.endColumn,null!=(v=null==w?void 0:w.actualColumn)?v:-1)}),!N)return!1;let D=S.getNoMergeCellPositionByIndex(N.startRow,N.startColumn),V=S.getNoMergeCellPositionByIndex(N.endRow,N.endColumn),W={startColumn:N.startColumn,startRow:N.startRow,endColumn:N.endColumn,endRow:N.endRow,startY:(null==D?void 0:D.startY)||0,endY:(null==V?void 0:V.endY)||0,startX:(null==D?void 0:D.startX)||0,endX:(null==V?void 0:V.endX)||0};(C.startRow!==N.startRow||C.startColumn!==N.startColumn||C.endRow!==N.endRow||C.endColumn!==N.endColumn)&&i&&(this._updateSelectionControlByRange(i,W),this._selectionMoving$.next(this.getSelectionDataWithStyle()))}_updateControlPointWhenScrolling(){let{scene:e}=this._context;if(!e.getViewport(x.SHEET_VIEWPORT_KEY.VIEW_MAIN))return;let t=this._scrollManagerService.validViewportScrollInfo$.subscribe(e=>{var t;if(null==e)return;let{viewportScrollX:i,viewportScrollY:n}=e,r=this.getActiveSelectionControl();if(null==r)return;let o=null==(t=this._sheetSkeletonManagerService.getCurrent())?void 0:t.skeleton,s=null==o?void 0:o.rowTotalHeight,l=null==o?void 0:o.columnTotalWidth,a=r.rangeType;a===O.RANGE_TYPE.COLUMN?r.transformControlPoint(0,n,l,s):a===O.RANGE_TYPE.ROW&&r.transformControlPoint(i,0,l,s)});this.disposeWithMe((0,O.toDisposable)(t))}},el(ve,"MobileSheetsSelectionRenderService"),ve);vo=vn([vr(1,(0,O.Inject)(O.Injector)),vr(2,(0,O.Inject)(O.ThemeService)),vr(3,J.IShortcutService),vr(4,(0,O.Inject)(A.SheetsSelectionsService)),vr(5,(0,O.Inject)(ev)),vr(6,O.ILogService),vr(7,O.ICommandService),vr(8,O.IContextService),vr(9,(0,O.Inject)(eR))],vo);var vs,vl=Object.defineProperty,va=Object.getOwnPropertyDescriptor,vd=/* @__PURE__ */el((e,t,i)=>t in e?vl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,"__defNormalProp"),vc=/* @__PURE__ */el((e,t,i,n)=>{for(var r,o=n>1?void 0:n?va(t,i):t,s=e.length-1;s>=0;s--)(r=e[s])&&(o=(n?r(t,i,o):r(o))||o);return n&&o&&vl(t,i,o),o},"__decorateClass"),vu=/* @__PURE__ */el((e,t)=>(i,n)=>t(i,n,e),"__decorateParam"),vh=/* @__PURE__ */el((e,t,i)=>vd(e,"symbol"!=typeof t?t+"":t,i),"__publicField");let vm=(el(vs=class extends O.Plugin{constructor(e=li,t,i,n){super(),this._config=e,this._injector=t,this._renderManagerService=i,this._univerInstanceService=n}onStarting(){[[e0],[lq,{useClass:lQ}],[oN,{useClass:oD}],[oS,{useClass:of}],[i9,{useClass:i5}],[pM],[ez,{useClass:vo}],[s$,{useClass:sJ}],[od,{useClass:oc}],[uj],[hu],[uI],[uP],[eP],[um],[t8],[u8],[tK],[p2],[m7],[rU],[rL],[gB],[m$],[mv],[ma],[gU]].forEach(e=>this._injector.add(e))}onReady(){this._markSheetAsFocused(),this._registerRenderBasics(),this._injector.get(p2)}onRendered(){this._registerRenderModules()}_registerRenderBasics(){[[ev],[pT],[ez,{useClass:vo}],[eR]].forEach(e=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(O.UniverInstanceType.UNIVER_SHEET,e))})}_registerRenderModules(){[[mP],[m_],[pY],[nl],[pn],[uW],[hD],[h3],[h0],[hS],[hF],[nI],[p4],[mZ],[go],[gL]].forEach(e=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(O.UniverInstanceType.UNIVER_SHEET,e))})}_markSheetAsFocused(){let e=this._univerInstanceService;this.disposeWithMe(e.getCurrentTypeOfUnit$(O.UniverInstanceType.UNIVER_SHEET).pipe((0,U.filter)(e=>!!e)).subscribe(t=>{e.focusUnit(t.getUnitId())}))}},"UniverSheetsMobileUIPlugin"),vs);vh(vm,"pluginName","SHEET_UI_PLUGIN"),vh(vm,"type",O.UniverInstanceType.UNIVER_SHEET),vc([(0,O.DependentOn)(A.UniverSheetsPlugin,J.UniverMobileUIPlugin),vu(1,(0,O.Inject)(O.Injector)),vu(2,x.IRenderManagerService),vu(3,O.IUniverInstanceService)],vm)}),n("dLBA8",function(e,n){t(e.exports,"combineLatestWith",function(){return s});var r=i("1a7ft"),o=i("1cekC");function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,o.combineLatest).apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e)))}}),n("1cekC",function(e,n){t(e.exports,"combineLatest",function(){return u});var r=i("1a7ft"),o=i("5K4WI"),s=i("jSzwf"),l=i("ec219"),a=i("h319C"),d=i("1hKfX"),c=i("4xvfD");function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=(0,c.popResultSelector)(e);return i?(0,d.pipe)(u.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e))),(0,a.mapOneOrManyArgs)(i)):(0,s.operate)(function(t,i){(0,o.combineLatestInit)((0,r.__spreadArray)([t],(0,r.__read)((0,l.argsOrArgArray)(e))))(i)})}}),n("ec219",function(e,i){t(e.exports,"argsOrArgArray",function(){return r});var n=Array.isArray;function r(e){return 1===e.length&&n(e[0])?e[0]:e}}),n("4T0Xd",function(e,n){t(e.exports,"withLatestFrom",function(){return u});var r=i("1a7ft"),o=i("jSzwf"),s=i("iNetn"),l=i("b7gpN"),a=i("2N6l4"),d=i("f1euv"),c=i("4xvfD");function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=(0,c.popResultSelector)(e);return(0,o.operate)(function(t,n){for(var o=e.length,c=Array(o),u=e.map(function(){return!1}),h=!1,m=function(t){(0,l.innerFrom)(e[t]).subscribe((0,s.createOperatorSubscriber)(n,function(e){c[t]=e,!h&&!u[t]&&(u[t]=!0,(h=u.every(a.identity))&&(u=null))},d.noop))},g=0;g<o;g++)m(g);t.subscribe((0,s.createOperatorSubscriber)(n,function(e){if(h){var t=(0,r.__spreadArray)([e],(0,r.__read)(c));n.next(i?i.apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(t))):t)}}))})}}),n("5zTXZ",function(e,n){t(e.exports,"ITelemetryService",function(){return r});let r=(0,i("7yNYd").createIdentifier)("telemetry.service")});
//# sourceMappingURL=es.dee7d9bb.js.map
