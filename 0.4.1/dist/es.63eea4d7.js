!function(){function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire26fc,n=t.register;n("70MC3",function(n,i){let r,a,o,s,l,A,d,c,u;e(n.exports,"DOCS_VIEW_KEY",function(){return z}),e(n.exports,"VIEWPORT_KEY",function(){return G}),e(n.exports,"DOCS_COMPONENT_MAIN_LAYER_INDEX",function(){return Y}),e(n.exports,"addCustomRangeBySelectionFactory",function(){return $}),e(n.exports,"deleteCustomRangeFactory",function(){return ee}),e(n.exports,"replaceSelectionFactory",function(){return en}),e(n.exports,"ReplaceContentCommand",function(){return ep}),e(n.exports,"CoverContentCommand",function(){return em}),e(n.exports,"NodePositionConvertToCursor",function(){return ex}),e(n.exports,"getLineBounding",function(){return eP}),e(n.exports,"getCanvasOffsetByEngine",function(){return eW}),e(n.exports,"DocSelectionRenderService",function(){return e0}),e(n.exports,"IEditorService",function(){return e5}),e(n.exports,"TextEditor",function(){return tn}),e(n.exports,"IRangeSelectorService",function(){return tD}),e(n.exports,"SetInlineFormatCommand",function(){return nz}),e(n.exports,"SetInlineFormatBoldCommand",function(){return nT}),e(n.exports,"SetInlineFormatItalicCommand",function(){return ny}),e(n.exports,"SetInlineFormatUnderlineCommand",function(){return nx}),e(n.exports,"SetInlineFormatStrikethroughCommand",function(){return nB}),e(n.exports,"SetInlineFormatSubscriptCommand",function(){return nD}),e(n.exports,"SetInlineFormatSuperscriptCommand",function(){return n_}),e(n.exports,"SetInlineFormatFontSizeCommand",function(){return nP}),e(n.exports,"SetInlineFormatFontFamilyCommand",function(){return nw}),e(n.exports,"SetInlineFormatTextColorCommand",function(){return nL}),e(n.exports,"InsertCommand",function(){return iX}),e(n.exports,"DeleteLeftCommand",function(){return i3}),e(n.exports,"BreakLineCommand",function(){return rQ}),e(n.exports,"DocBackScrollRenderController",function(){return a5}),e(n.exports,"IMEInputCommand",function(){return os}),e(n.exports,"MoveCursorOperation",function(){return od}),e(n.exports,"MoveSelectionOperation",function(){return oc}),e(n.exports,"DOC_VERTICAL_PADDING",function(){return o3}),e(n.exports,"DocCanvasPopManagerService",function(){return sn}),e(n.exports,"DocEventManagerService",function(){return sA}),e(n.exports,"UniverDocsUIPlugin",function(){return lQ});var h=t("83KcA"),g=t("kB4bq"),p=t("D79YY"),m=t("gQuIR"),f=t("kkAWv"),S=t("9yWhB"),I=t("jv4BO"),v=t("5WWyv"),E=t("eSxk0"),C=t("a9FIH"),T=t("eEihn"),b=t("fElJC"),y=t("d0sRG"),R=t("3KKCW"),x=t("2Ha4T"),O=t("bTGUS"),B=t("lXa9G"),M=t("cZW0b"),D=t("cmCKE"),N=t("cahIb"),_=t("bbuk8"),C=t("a9FIH"),b=t("fElJC"),U=t("bLx5G"),P=Object.defineProperty,Q=(e,t,n)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>P(e,"name",{value:t,configurable:!0}),F=(e,t,n)=>Q(e,"symbol"!=typeof t?t+"":t,n),L=Object.defineProperty,k=Object.getOwnPropertyDescriptor,H=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?k(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&L(t,n,a),a},"__decorateClass$s"),V=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$s");function j(e,t){var n,i;let{startOffset:r,endOffset:a}=e,o=[],s=-1;for(let e=0;e<t.length;e++){let l=t[e],A=t[e-1],{startIndex:d}=l;r>s&&r<=d||a>s&&a<=d?o.push({...l,paragraphStart:(null!=(n=null==A?void 0:A.startIndex)?n:-1)+1,paragraphEnd:l.startIndex}):d>=r&&d<=a&&o.push({...l,paragraphStart:(null!=(i=null==A?void 0:A.startIndex)?i:-1)+1,paragraphEnd:l.startIndex}),s=d}return o}w(j,"getParagraphsInRange$1");let W=(w(eK=class extends h.Disposable{constructor(e,t){super(),F(this,"_matches",/* @__PURE__ */new Map),this._univerInstanceService=e,this._textSelectionManagerService=t}registerAutoFormat(e){let t=this._matches.get(e.id);return t?(t.push(e),t.sort((e,t)=>{var n,i;return(null!=(n=t.priority)?n:0)-(null!=(i=e.priority)?i:0)})):this._matches.set(e.id,[e]),(0,h.toDisposable)(()=>{let t=this._matches.get(e.id);if(t){let n=t.findIndex(t=>t===e);n>=0&&t.splice(n,1)}})}onAutoFormat(e,t){var n,i,r,a,o,s;let l=null!=(n=this._matches.get(e))?n:[],A=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),d=this._textSelectionManagerService.getActiveTextRange();if(A&&d){let n=A.getSelfOrHeaderFooterModel(d.segmentId),c={unit:n,selection:d,isBody:!d.segmentId,paragraphs:j(d,null!=(r=null==(i=n.getBody())?void 0:i.paragraphs)?r:[]),customRanges:(0,h.BuildTextUtils).customRange.getCustomRangesInterestsWithSelection(d,null!=(o=null==(a=n.getBody())?void 0:a.customRanges)?o:[]),commandId:e,commandParams:t},u=l.find(e=>e.match(c));return null!=(s=null==u?void 0:u.getMutations(c))?s:[]}return[]}},"DocAutoFormatService"),eK);W=H([V(0,h.IUniverInstanceService),V(1,(0,h.Inject)(g.DocSelectionManagerService))],W);var z=((r=z||{}).MAIN="__Document_Render_Main__",r.BACKGROUND="__Document_Render_Background__",r),G=((a=G||{}).VIEW_MAIN="viewMain",a.VIEW_TOP="viewTop",a.VIEW_LEFT="viewLeft",a.VIEW_LEFT_TOP="viewLeftTop",a);let Y=2;function K(e){let{mainComponent:t,scene:n,engine:i,components:r}=e;return{document:t,docBackground:r.get(z.BACKGROUND),scene:n,engine:i}}function q(e,t){let n=e.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if(!n)return null;let i=n.getUnitId(),r=t.getRenderById(i);if(null==r)return;let{mainComponent:a,scene:o,engine:s,components:l}=r;return{document:a,docBackground:l.get(z.BACKGROUND),scene:o,engine:s}}function X(e){let{unitId:t,ranges:n,id:i,type:r,segmentId:a}=e,o={id:g.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0}},s=new h.TextX,l=(0,h.JSONX).getInstance(),A=0;for(let e=0;e<n.length;e++){let{startOffset:t,endOffset:a}=n[e];t>0&&s.push({t:h.TextXActionType.RETAIN,len:t-A}),s.push({t:h.TextXActionType.RETAIN,body:{dataStream:"",customDecorations:[{id:i,type:r,startIndex:0,endIndex:a-t-1}]},len:a-t}),A=a}return o.params.actions=l.editOp(s.serialize()),o}function J(e,t){var n;return null==(n=e.get(p.IRenderManagerService).getRenderById(t))?void 0:n.with(g.DocSkeletonManagerService)}function Z(e,t=""){if(!t)return["body"];let{headers:n,footers:i}=e.getSnapshot();if(null==n&&null==i)throw Error("Document data model must have headers or footers when update by segment id");if((null==n?void 0:n[t])!=null)return["headers",t,"body"];if((null==i?void 0:i[t])!=null)return["footers",t,"body"];throw Error("Segment id not found in headers or footers")}function $(e,t){var n;let{rangeId:i,rangeType:r,wholeEntity:a,properties:o,unitId:s,selection:l}=t,A=e.get(g.DocSelectionManagerService),d=e.get(h.IUniverInstanceService),c=null!=l?l:null==(n=A.getTextRanges({unitId:s,subUnitId:s}))?void 0:n[0],u=null==c?void 0:c.segmentId;if(!c)return!1;let p=d.getUnit(s,h.UniverInstanceType.UNIVER_DOC);if(!p)return!1;let m=p.getSelfOrHeaderFooterModel(c.segmentId).getBody();if(!m)return!1;let{startOffset:f,endOffset:S}=(0,h.BuildTextUtils).selection.normalizeSelection(c),I=(0,h.BuildTextUtils).customRange.add({range:{startOffset:f,endOffset:S,collapsed:f===S},rangeId:i,rangeType:r,segmentId:u,wholeEntity:a,properties:o,body:m});if(!I)return!1;let v=(0,h.JSONX).getInstance(),E={id:g.RichTextEditingMutation.id,params:{unitId:s,actions:[],textRanges:void 0},textX:I},C=Z(p,u);return E.params.actions=v.editOp(I.serialize(),C),E}function ee(e,t){var n;let{unitId:i,segmentId:r,insert:a}=t,o=e.get(h.IUniverInstanceService),s=null==(n=e.get(g.DocSelectionManagerService).getTextRanges({unitId:i,subUnitId:i}))?void 0:n[0],l=o.getUnit(i);if(!l)return!1;let A=null!=s&&s.collapsed?{index:s.startOffset}:void 0,d={id:g.RichTextEditingMutation.id,params:{unitId:t.unitId,actions:[],textRanges:void 0,segmentId:r}},c=(0,h.JSONX).getInstance(),u=(0,h.BuildTextUtils).customRange.delete(e,{documentDataModel:l,rangeId:t.rangeId,insert:a,segmentId:r,textRange:A});if(!u)return!1;let p=Z(l,r);return d.params.actions=c.editOp(u.serialize(),p),d.params.textRanges=A?[{startOffset:A.index,endOffset:A.index,collapsed:!0}]:void 0,d}function et(e,t,n){for(let i=e.length-1;i>=0;i--){let r=e[i],{st:a,ed:o}=r;if(t>a&&t<=o)return{...r,ts:{...r.ts,...n}}}return n?{ts:n}:null}function en(e,t){var n,i,r,a;let{unitId:o,body:s,doc:l}=t,A=l;if(A||(A=e.get(h.IUniverInstanceService).getUnit(o)),!A)return!1;let d=null==(n=t.selection)?void 0:n.segmentId,c=null==(i=A.getSelfOrHeaderFooterModel(d))?void 0:i.getBody();if(!c)return!1;let u=e.get(g.DocSelectionManagerService),p=null!=(r=t.selection)?r:u.getActiveTextRange();if(!p||!c)return!1;let m=null!=(a=t.textRanges)?a:[{startOffset:p.startOffset+s.dataStream.length,endOffset:p.startOffset+s.dataStream.length,collapsed:!0,segmentId:d}],f=(0,h.BuildTextUtils).selection.replace({selection:p,body:s,doc:A});if(!f)return!1;let S={id:g.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:m,debounce:!0,segmentId:d},textX:f},I=(0,h.JSONX).getInstance(),v=Z(A,d);return S.params.actions=I.editOp(f.serialize(),v),S}w(K,"neoGetDocObject"),w(q,"getDocObject"),w(function(e,t){let n=t.getRenderById(e);if(null==n)return;let{mainComponent:i,scene:r,engine:a,components:o}=n;return{document:i,docBackground:o.get(z.BACKGROUND),scene:r,engine:a}},"getDocObjectById"),w(X,"addCustomDecorationFactory"),w(function(e,t){let{segmentId:n,id:i,type:r}=t,a=e.get(g.DocSelectionManagerService),o=e.get(h.IUniverInstanceService).getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if(!o)return!1;let s=o.getUnitId(),l=a.getTextRanges({unitId:s,subUnitId:s});return!!(l&&o.getBody())&&X({unitId:s,ranges:l,id:i,type:r,segmentId:n})},"addCustomDecorationBySelectionFactory"),w(function(e,t){var n,i;let{unitId:r,id:a,segmentId:o}=t,s=e.get(h.IUniverInstanceService).getUnit(r),l=null==s?void 0:s.getBody();if(!s||!l)return!1;let A=null==(i=null==(n=s.getBody())?void 0:n.customDecorations)?void 0:i.filter(e=>e.id===a);if(!(null!=A&&A.length))return!1;let d=A.map(e=>(0,h.getBodySlice)(l,e.startIndex,e.endIndex+1)),c=d.map(e=>{var t;let n=(0,h.Tools).deepClone(e);return n.customDecorations=null==(t=n.customDecorations)?void 0:t.filter(e=>e.id!==a),n}),u={id:g.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:void 0}},p=new h.TextX,m=(0,h.JSONX).getInstance(),f=0;return A.forEach((e,t)=>{let n=c[t],i=d[t];e.startIndex!==f&&p.push({t:h.TextXActionType.RETAIN,len:e.startIndex-f}),f=e.startIndex,p.push({t:h.TextXActionType.RETAIN,len:e.endIndex-e.startIndex+1,body:n,oldBody:i,coverType:h.UpdateDocsAttributeType.REPLACE}),f+=e.endIndex-e.startIndex+1}),u.params.actions=m.editOp(p.serialize()),u},"deleteCustomDecorationFactory"),w(J,"getCommandSkeleton"),w(Z,"getRichTextEditPath"),w(function(e,t,n){let{unitId:i,segmentId:r}=t,a=e.get(h.IUniverInstanceService).getUnit(i);if(!a)return!1;let o={id:g.RichTextEditingMutation.id,params:{unitId:t.unitId,actions:[],textRanges:void 0}},s=(0,h.JSONX).getInstance(),l=(0,h.BuildTextUtils).customRange.add({...t,body:n});if(!l)return!1;let A=Z(a,r);return o.params.actions=s.editOp(l.serialize(),A),o},"addCustomRangeFactory"),w($,"addCustomRangeBySelectionFactory"),w(ee,"deleteCustomRangeFactory"),w(function(e,t){return t.some(t=>e.startIndex>t.startIndex&&e.startIndex<t.endIndex)},"hasParagraphInTable"),w(et,"getTextRunAtPosition"),w(en,"replaceSelectionFactory"),w(function(e){return{left:e.positionH.posOffset,top:e.positionV.posOffset,width:e.size.width,height:e.size.height}},"docDrawingPositionToTransform"),w(function(e,t=0,n=0){return{size:{width:e.width,height:e.height},positionH:{relativeFrom:h.ObjectRelativeFromH.MARGIN,posOffset:(e.left||0)-t},positionV:{relativeFrom:h.ObjectRelativeFromV.PAGE,posOffset:(e.top||0)-n},angle:e.angle||0}},"transformToDocDrawingPosition");var ei={exports:{}},er={},ea=m&&m.__esModule?m.default:m,eo=Symbol.for("react.element"),es=Symbol.for("react.fragment"),el=Object.prototype.hasOwnProperty,eA=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ed={key:!0,ref:!0,__self:!0,__source:!0};function ec(e,t,n){var i,r={},a=null,o=null;for(i in void 0!==n&&(a=""+n),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(o=t.ref),t)el.call(t,i)&&!ed.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:eo,type:e,key:a,ref:o,props:r,_owner:eA.current}}w(ec,"q"),er.Fragment=es,er.jsx=ec,er.jsxs=ec,ei.exports=er;var eu=ei.exports;function eh(e){if(!e)return!1;let t=window.getComputedStyle(e);if("none"===t.display||"hidden"===t.visibility||"0"===t.opacity)return!1;let n=e.getBoundingClientRect();return!(0===n.width||0===n.height||n.bottom<0||n.top>window.innerHeight||n.right<0||n.left>window.innerWidth)}w(eh,"isElementVisible");let eg={id:"doc.command-replace-snapshot",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let{unitId:n,snapshot:i,textRanges:r,segmentId:a="",options:o}=t,s=e.get(h.IUniverInstanceService),l=e.get(h.ICommandService),A=e.get(g.DocSelectionManagerService),d=s.getUnit(n,h.UniverInstanceType.UNIVER_DOC),c=null==d?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot();if(null==d||null==c)return!1;let{body:u,tableSource:p,footers:m,headers:f,lists:S,drawings:I,drawingsOrder:v}=i,{body:E,tableSource:C,footers:T,headers:b,lists:y,drawings:R,drawingsOrder:x}=c;if(null==u||null==E)return!1;if((0,h.Tools).diffValue(u,E)&&r)return A.replaceDocRanges(r,{unitId:n,subUnitId:n},!1),!0;let O={id:g.RichTextEditingMutation.id,params:{unitId:n,actions:[],textRanges:r}};o&&(O.params.options=o);let B=[],M=(0,h.JSONX).getInstance();if(!(0,h.Tools).diffValue(u,E)){let e=M.replaceOp(["body"],E,u);null!=e&&B.push(e)}if(!(0,h.Tools).diffValue(p,C)){let e=M.replaceOp(["tableSource"],C,p);null!=e&&B.push(e)}if(!(0,h.Tools).diffValue(m,T)){let e=M.replaceOp(["footers"],T,m);null!=e&&B.push(e)}if(!(0,h.Tools).diffValue(f,b)){let e=M.replaceOp(["headers"],b,f);null!=e&&B.push(e)}if(!(0,h.Tools).diffValue(S,y)){let e=M.replaceOp(["lists"],y,S);null!=e&&B.push(e)}if(!(0,h.Tools).diffValue(I,R)){let e=M.replaceOp(["drawings"],R,I);null!=e&&B.push(e)}if(!(0,h.Tools).diffValue(v,x)){let e=M.replaceOp(["drawingsOrder"],x,v);null!=e&&B.push(e)}return O.params.actions=B.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!l.syncExecuteCommand(O.id,O.params)},"handler")},ep={id:"doc.command-replace-content",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let{unitId:n,body:i,textRanges:r,segmentId:a="",options:o}=t,s=e.get(h.IUniverInstanceService),l=e.get(h.ICommandService),A=e.get(g.DocSelectionManagerService),d=s.getUnit(n,h.UniverInstanceType.UNIVER_DOC),c=null==d?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(null==d||null==c)return!1;let u=eS(n,a,d,c,i);return u.params.textRanges=r,o&&(u.params.options=o),null==u.params.actions&&r?(A.replaceDocRanges(r,{unitId:n,subUnitId:n},!1),!0):!!l.syncExecuteCommand(u.id,u.params)},"handler")},em={id:"doc.command-cover-content",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let{unitId:n,body:i,segmentId:r=""}=t,a=e.get(h.IUniverInstanceService),o=e.get(h.ICommandService),s=e.get(h.IUndoRedoService),l=a.getUniverDocInstance(n),A=null==l?void 0:l.getSnapshot().body;if(null==l||null==A)return!1;let d=eS(n,r,l,A,i);return d.params.noNeedSetTextRange=!0,d.params.noHistory=!0,o.syncExecuteCommand(d.id,d.params),s.clearUndoRedo(n),!0},"handler")};function ef(e,t,n,i){let r=new h.TextX,a=(0,h.JSONX).getInstance(),o=(null==n?void 0:n.dataStream.length)-2;o>0&&r.push({t:h.TextXActionType.DELETE,len:o}),i.dataStream.length>0&&r.push({t:h.TextXActionType.INSERT,body:i,len:i.dataStream.length});let s=Z(t,e);return a.editOp(r.serialize(),s)}function eS(e,t,n,i,r){let a={id:g.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:[]}},o=ef(t,n,i,r);return a.params.actions=o,a}w(ef,"getMutationActions"),w(eS,"getMutationParams"),h.CommandType.COMMAND;var eI=((o=eI||{})[o.page=0]="page",o[o.section=1]="section",o[o.column=2]="column",o[o.line=3]="line",o[o.divide=4]="divide",o[o.glyph=5]="glyph",o);let ev={page:0,section:1,column:2,line:3,divide:4,glyph:5};function eE(e,t){return!(e.page>t.page)&&(e.page<t.page||!(e.section>t.section)&&(e.section<t.section||!(e.column>t.column)&&(e.column<t.column||!(e.line>t.line)&&(e.line<t.line||!(e.divide>t.divide)&&(e.divide<t.divide||!(e.glyph>t.glyph)&&(e.glyph,t.glyph,!0))))))}function eC(e,t){return eE(e,t)?{start:e,end:t}:{start:t,end:e}}function eT(e){let t=e.length;if(0===t)return;let n=e[0],i=e[t-1],r=1===e.length&&n.collapsed;return{startOffset:n.startOffset,endOffset:i.endOffset,collapsed:r}}function eb(e,t,n,i){let r=i,a=i;for(let i=0;i<e.length;i++){let o=e[i].count;i<t&&(r+=o),i<n&&(a+=o)}return{startOffset:r,endOffset:a}}function ey(e){let{startX:t,startY:n,endX:i,endY:r}=e,a=[];return a.push({x:t,y:n}),a.push({x:i,y:n}),a.push({x:i,y:r}),a.push({x:t,y:r}),a.push({x:t,y:n}),a}w(eE,"compareNodePositionLogic"),w(eC,"compareNodePosition"),w(eT,"getOneTextSelectionRange"),w(eb,"getOffsetInDivide"),w(ey,"pushToPoints");let eR=class{constructor(e,t){F(this,"_liquid",new p.Liquid),F(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0}),F(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0}),this._documentOffsetConfig=e,this._docSkeleton=t}getRangePointData(e,t){let n=[],i=[],r=[];if(null==e||null==t)return{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:r};if(!this._isValidPosition(e,t))throw Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);let{start:a,end:o}=eC(e,t);return this._selectionIterator(a,o,(e,t,s,l,A,d)=>{let c,u;let{lineHeight:h,asc:g,paddingTop:m,marginTop:f,marginBottom:S}=d,{glyphGroup:I,st:v}=A;if(0===I.length)return;let{x:E,y:C}=this._liquid,T=I[e],b=I[t],y=I[e-1],R=(null==T?void 0:T.left)||0,x=(null==T?void 0:T.width)||0,O=(null==b?void 0:b.left)||0,B=(null==b?void 0:b.width)||0,M=(null==T?void 0:T.glyphType)===p.GlyphType.LIST,{startOffset:D,endOffset:N}=eb(I,e,t,v),_=a.glyph!==e||!s||a.isBack,U=o.glyph===t&&!!l&&o.isBack,P=a===o,Q=_&&null!=y?y:T;if(0===e&&t===I.length-1)c={startX:E+R+(M?x:0),startY:C,endX:E+O+(U?0:B),endY:C+h-f-S},u={startX:E+R+(M?x:0),startY:C+m+g-Q.bBox.ba,endX:E+O+(U?0:B),endY:C+m+g+Q.bBox.bd};else{let e=_&&!M;c={startX:E+R+(e?0:x),startY:C,endX:E+O+(U?0:B),endY:C+h-f-S},u={startX:E+R+(e?0:x),startY:C+m+g-Q.bBox.ba,endX:E+O+(U?0:B),endY:C+m+g+Q.bBox.bd}}n.push(ey(c)),i.push(ey(u)),r.push({startOffset:_?D:D+T.count,endOffset:U?N:N+b.count,collapsed:P})}),{borderBoxPointGroup:n,contentBoxPointGroup:i,cursorList:r}}_isValidPosition(e,t){let{segmentPage:n,pageType:i}=e,{segmentPage:r,pageType:a}=t;return i===a&&(i!==p.DocumentSkeletonPageType.HEADER&&i!==p.DocumentSkeletonPageType.FOOTER||n===r)}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(e=0,t,n,i){i===t?this._currentStartState[e]=1:this._currentStartState[e]=0,i===n?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,t=!0){let n=e,i;for(;n>=0;){let e;let r=eI[n];if(void 0===(e=t?this._currentStartState[r]:this._currentEndState[r]))return;if(void 0===i&&(i=e),e!==i)return 0;n--}return i}_getSelectionRuler(e,t,n,i,r){let a=0,o=i,s=eI[e],l=eI[e+1];if(null===l||null===s)return{start_next:a,end_next:o};let A=t[s],d=n[s];this._setNodePositionState(s,A,d,r);let c=this._checkPreviousNodePositionState(e),u=this._checkPreviousNodePositionState(e,!1);return 1===c&&(a=t[l]),2===u&&(o=n[l]),{start_next:a,end_next:o}}_selectionIterator(e,t,n){var i,r;let a=this._docSkeleton;if(!a)return[];let{pageType:o,path:s}=e;this._liquid.reset();let l=a.getSkeletonData();if(null==l)return[];let{pages:A,skeHeaders:d,skeFooters:c}=l,{page:u,segmentPage:h}=e,{page:g,segmentPage:m}=t;if(this._resetCurrentNodePositionState(),null==this._documentOffsetConfig)return[];let{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:I}=this._documentOffsetConfig,v=o===p.DocumentSkeletonPageType.BODY||o===p.DocumentSkeletonPageType.CELL?u:h;for(let e=0;e<v;e++){let t=A[e];this._liquid.translatePage(t,f,S,I)}let E=o===p.DocumentSkeletonPageType.BODY||o===p.DocumentSkeletonPageType.CELL?g:m;for(let a=v;a<=E;a++){let u=A[a],{headerId:h,footerId:g,pageWidth:m}=u,C=u;if(o===p.DocumentSkeletonPageType.HEADER?C=null==(i=d.get(h))?void 0:i.get(m):o===p.DocumentSkeletonPageType.FOOTER?C=null==(r=c.get(g))?void 0:r.get(m):o===p.DocumentSkeletonPageType.CELL&&(C=(0,p.getPageFromPath)(l,s)),null==C){this._liquid.translatePage(u,f,S,I);continue}let T=C.sections,{start_next:b,end_next:y}=this._getSelectionRuler(ev.page,e,t,T.length-1,o===p.DocumentSkeletonPageType.BODY||o===p.DocumentSkeletonPageType.CELL?a:0);switch(this._liquid.translateSave(),o){case p.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...C,marginLeft:u.marginLeft});break;case p.DocumentSkeletonPageType.FOOTER:{let e=u.pageHeight-C.height-C.marginBottom;this._liquid.translate(u.marginLeft,e);break}case p.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(u);let e=C.parent,t=e.parent,{left:n}=C,{top:i,left:r}=t,{top:a}=e;this._liquid.translate(r+n,i+a),this._liquid.translatePagePadding(C);break}default:this._liquid.translatePagePadding(u)}for(let i=b;i<=y;i++){let r=T[i],o=r.columns,{start_next:s,end_next:l}=this._getSelectionRuler(ev.section,e,t,o.length-1,i);this._liquid.translateSection(r);for(let A=s;A<=l;A++){let d=o[A],c=d.lines,{start_next:u,end_next:h}=this._getSelectionRuler(ev.column,e,t,c.length-1,A);this._liquid.translateColumn(d);for(let o=u;o<=h;o++){let g=c[o],{divides:p}=g,{start_next:m,end_next:f}=this._getSelectionRuler(ev.line,e,t,p.length-1,o);this._liquid.translateSave(),this._liquid.translateLine(g,!0,!1);for(let c=m;c<=f;c++){let S=p[c];this._liquid.translateSave(),this._liquid.translateDivide(S);let{glyphGroup:I}=S,{start_next:T,end_next:R}=this._getSelectionRuler(ev.divide,e,t,I.length-1,c),x=!1,O=!1;a===v&&i===b&&A===s&&o===u&&c===m&&(x=!0),a===E&&i===y&&A===l&&o===h&&c===f&&(O=!0),n&&n(T,R,x,O,S,g,d,r,C),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(u,f,S,I)}}};w(eR,"NodePositionConvertToCursor");let ex=eR;function eO(e,t){let{path:n}=e,{path:i}=t;if(n.length!==i.length||-1===n.indexOf("cells"))return!1;let r=n.indexOf("skeTables")+1,a=n.indexOf("rows")+1,o=n.indexOf("cells")+1;if((0,p.getTableIdAndSliceIndex)(n[r]).tableId!==(0,p.getTableIdAndSliceIndex)(i[r]).tableId)return!1;let s=n[a],l=i[a],A=n[o],d=i[o];return!(s===l&&A===d)}function eB(e,t){let{path:n}=e,{path:i}=t;return -1!==n.indexOf("cells")&&-1!==i.indexOf("cells")&&(0,h.Tools).diffValue(n,i)}function eM(e,t){if(eB(e,t))return eE(e,t);let{path:n}=e,{path:i}=t,r=n[n.length-5],a=i[i.length-5];if(r!==a&&"string"==typeof r&&"string"==typeof a)return+r.split("#-#")[1]<+a.split("#-#")[1];let o=n[n.length-3],s=i[i.length-3],l=n[n.length-1],A=i[i.length-1];return o<s||!(o>s)&&l<=A}function eD(e){return e.sections[0].columns[0].lines[0].divides[0].glyphGroup[0]}function eN(e){let{sections:t}=e,n=t[t.length-1],i=n.columns[n.columns.length-1],r=i.lines[i.lines.length-1],a=r.divides[r.divides.length-1].glyphGroup;return a[a.length-2]}w(eO,"isValidRectRange"),w(eB,"isInSameTableCell"),w(eM,"compareNodePositionInTable"),w(eD,"firstGlyphInCellPage"),w(eN,"lastGlyphInCellPage");let e_=class{constructor(e,t){F(this,"_liquid",new p.Liquid),this._documentOffsetConfig=e,this._docSkeleton=t}getRangePointData(e,t){let n=[],i=this._docSkeleton.getSkeletonData();if(null==i)return;let{pages:r}=i,{segmentPage:a,page:o,pageType:s}=e,{segmentPage:l,page:A}=t,d=this._getTableRectRangeInfo(e,t);if(null==d)return;let{tableId:c,startRowIndex:u,startColumnIndex:h,endRowIndex:g,endColumnIndex:m}=d;this._liquid.reset();let{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:I}=this._documentOffsetConfig,v=s===p.DocumentSkeletonPageType.BODY||s===p.DocumentSkeletonPageType.CELL?o:a;for(let e=0;e<v;e++){let t=r[e];this._liquid.translatePage(t,f,S,I)}let E=s===p.DocumentSkeletonPageType.BODY||s===p.DocumentSkeletonPageType.CELL?A:l;for(let e=v;e<=E;e++){let t=r[e];this._liquid.translatePagePadding(t);let{skeTables:i}=t,a=null;for(let[e,t]of i.entries())e.startsWith(c)&&(a=t);if(null==a){this._liquid.restorePagePadding(t),this._liquid.translatePage(t,f,S,I);continue}this._liquid.translateSave(),this._liquid.translate(0,a.top);let{x:o,y:s}=this._liquid;for(let e of a.rows)if(e.index>=u&&e.index<=g){let t=e.cells[h],i=e.cells[m],r={startX:o+t.left,startY:s+e.top,endX:o+i.left+i.pageWidth,endY:s+e.top+e.height};n.push(ey(r))}this._liquid.translateRestore(),this._liquid.restorePagePadding(t),this._liquid.translatePage(t,f,S,I)}return{pointGroup:n,startRow:u,startColumn:h,endRow:g,endColumn:m,tableId:c}}getNodePositionGroup(e,t){let n=[],i=eM(e,t),r=i?e:t,{segmentPage:a}=r,o=this._getTableRectRangeInfo(r,i?t:e);if(null==o)return;let{tableId:s,pages:l,startRowIndex:A,startColumnIndex:d,endRowIndex:c,endColumnIndex:u}=o,h=[];for(let e of l){let{skeTables:t}=e;for(let[e,n]of t.entries())e.startsWith(s)&&h.push(n)}if(0===h.length)return;for(let e of h)this._collectPositionGroup(e,n,A,c,d,u,a,i);let g=h[0].rows[0].cells.length;if(0===d&&u===g-1){let e=n[0],t=n[n.length-1];n.length=0,n.push({anchor:i?e.anchor:t.anchor,focus:i?t.focus:e.focus})}return n}_collectPositionGroup(e,t,n,i,r,a,o,s){for(let l=0;l<e.rows.length;l++){let A=e.rows[l];if(A.index<n)continue;if(A.index>i)break;let d=A.cells[r],c=A.cells[a],u=eD(d),h=eN(c);if(null==u||null==h)continue;let g=this._docSkeleton.findPositionByGlyph(u,o),p=this._docSkeleton.findPositionByGlyph(h,o);if(null==g||null==p)continue;let m=s?g:p,f=s?p:g;t.push({anchor:{...m,isBack:!0},focus:{...f,isBack:!0}})}}_getTableRectRangeInfo(e,t){let n=this._docSkeleton.getSkeletonData();if(null==n)return;let{pages:i}=n,{path:r}=e,{path:a}=t,o=(0,p.getPageFromPath)(n,r),s=(0,p.getPageFromPath)(n,a);if(null==o||null==s)return;let l=o.segmentId,A=o.parent.index,d=o.parent.cells.indexOf(o),c=(null==s?void 0:s.parent).index,u=(null==s?void 0:s.parent).cells.indexOf(s);return{pages:i,tableId:l,startCell:o,endCell:s,startRowIndex:A,startColumnIndex:d,endRowIndex:c,endColumnIndex:u}}};function eU(e){let t=e[0],n=t[0],i=t[2],{x:r,y:a}=n,{x:o,y:s}=i;return{left:r,top:a,width:o-r,height:s-a}}function eP(e){return e.map(e=>{let t=1/0,n=-1/0,i=1/0,r=-1/0;return e.forEach(e=>{t=Math.min(e.x,t),n=Math.max(e.x,n),r=Math.max(e.y,r),i=Math.min(e.y,i)}),{left:t,right:n,top:i,bottom:r}})}w(e_,"NodePositionConvertToRectRange"),w(eU,"getAnchorBounding"),w(eP,"getLineBounding");let eQ=class{constructor(e,t,n,i,r,a=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,o="",s=-1){F(this,"rangeType",h.DOC_RANGE_TYPE.TEXT),F(this,"_current",!1),F(this,"_rangeShape"),F(this,"_anchorShape"),F(this,"_cursorList",[]),F(this,"_anchorBlinkTimer",null),this._scene=e,this._document=t,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=r,this.style=a,this._segmentId=o,this._segmentPage=s,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},500),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},500))},1e3)}get startOffset(){var e;let{startOffset:t}=null!=(e=eT(this._cursorList))?e:{},n=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();return null==t||null==n?t:Math.min(n.dataStream.length-2,t)}get endOffset(){var e;let{endOffset:t}=null!=(e=eT(this._cursorList))?e:{},n=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();return null==t||null==n?t:Math.min(t,n.dataStream.length-2)}get collapsed(){let{startOffset:e,endOffset:t}=this;return null!=e&&e===t}get startNodePosition(){if(null==this.anchorNodePosition)return null;if(null==this.focusNodePosition)return this.anchorNodePosition;let{start:e}=eC(this.anchorNodePosition,this.focusNodePosition);return e}get endNodePosition(){if(null==this.anchorNodePosition)return this.focusNodePosition;if(null==this.focusNodePosition)return null;let{end:e}=eC(this.anchorNodePosition,this.focusNodePosition);return e}get direction(){let{collapsed:e,anchorNodePosition:t,focusNodePosition:n}=this;return e||null==t||null==n?h.RANGE_DIRECTION.NONE:eE(t,n)?h.RANGE_DIRECTION.FORWARD:h.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){let e=this.anchorNodePosition,t=this.focusNodePosition;if(this._isEmpty())return;let n=this._document.getOffsetConfig(),{docsLeft:i,docsTop:r}=n,a=new ex(n,this._docSkeleton);if(this._isCollapsed()){let{contentBoxPointGroup:t,cursorList:n}=a.getRangePointData(e,e);if(this._setCursorList(n),0===t.length)return;let o=eU(t);return{...o,left:o.left+i,top:o.top+r}}let{borderBoxPointGroup:o,cursorList:s}=a.getRangePointData(e,t);if(this._setCursorList(s),0===o.length)return;let l=eU(o);return{...l,left:l.left+i,top:l.top+r}}getAnchor(){return this._anchorShape}activeStatic(){var e,t;null==(t=this._anchorShape)||t.setProps({stroke:(null==(e=this.style)?void 0:e.strokeActive)||(0,p.getColor)(h.COLORS.black,1)})}deactivateStatic(){var e,t;null==(t=this._anchorShape)||t.setProps({stroke:(null==(e=this.style)?void 0:e.stroke)||(0,p.getColor)(h.COLORS.black,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var e,t;null==(e=this._rangeShape)||e.dispose(),this._rangeShape=null,null==(t=this._anchorShape)||t.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(e){let{startOffset:t,endOffset:n}=this,{startOffset:i,endOffset:r}=e;return null!=t&&null!=n&&null!=i&&null!=r&&t<=r&&n>=i}refresh(){var e,t;let{_document:n,_docSkeleton:i}=this,r=this.anchorNodePosition,a=this.focusNodePosition;if(null==(e=this._anchorShape)||e.hide(),null==(t=this._rangeShape)||t.hide(),this._isEmpty())return;let o=n.getOffsetConfig(),{docsLeft:s,docsTop:l}=o,A=new ex(o,i);if(this._isCollapsed()){let{contentBoxPointGroup:e,cursorList:t}=A.getRangePointData(r,r);if(this._setCursorList(t),e.length>0){let t=i.findGlyphByPosition(r);this._createOrUpdateAnchor(e,s,l,t)}return}let{borderBoxPointGroup:d,cursorList:c}=A.getRangePointData(r,a);this._setCursorList(c),d.length>0&&this._createOrUpdateRange(d,s,l)}_isEmpty(){return null==this.anchorNodePosition&&null==this.focusNodePosition}_isCollapsed(){let e=this.anchorNodePosition,t=this.focusNodePosition;if(null!=e&&null==t)return!0;if(null==e||null==t)return!1;for(let n of Object.keys(ev))if(e[n]!==t[n])return!1;return e.isBack===t.isBack}_createOrUpdateRange(e,t,n){var i;if(this._rangeShape){this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}let r=new p.RegularPolygon("__TestSelectionRange__"+(0,h.Tools).generateRandomId(6),{pointsGroup:e,fill:(null==(i=this.style)?void 0:i.fill)||(0,p.getColor)(h.COLORS.black,.3),left:t,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=r,this._scene.addObject(r,3)}_createOrUpdateAnchor(e,t,n,i){var r,a,o;let s=eU(e),{left:l}=s,{top:A,height:d}=s;d<14&&(A-=14-d,d=14);let c=l+t,u=A+n,g=(null==(r=null==i?void 0:i.ts)?void 0:r.it)===h.BooleanNumber.TRUE;if(g&&(c+=d*Math.tan(12*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:c,top:u,height:d}),this._anchorShape.show(),g?this._anchorShape.skew(-12,0):this._anchorShape.skew(0,0);return}let m=new p.Rect("__TestSelectionAnchor__"+(0,h.Tools).generateRandomId(6),{left:c,top:u,height:d,strokeWidth:(null==(a=this.style)?void 0:a.strokeWidth)||1.5,stroke:(null==(o=this.style)?void 0:o.strokeActive)||(0,p.getColor)(h.COLORS.black,1),evented:!1});g&&m.skew(-12,0),this._anchorShape=m,this._scene.addObject(m,3)}_setCursorList(e){0!==e.length&&(this._cursorList=e)}};function ew(e,t,n,i,r,a=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,o="",s=-1){let l=new e_(t.getOffsetConfig(),n).getNodePositionGroup(i,r);return(null!=l?l:[]).map(i=>new eL(e,t,n,i.anchor,i.focus,a,o,s))}w(eQ,"TextRange"),w(ew,"convertPositionsToRectRanges");let eF=class{constructor(e,t,n,i,r,a=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,o="",s=-1){F(this,"rangeType",h.DOC_RANGE_TYPE.RECT),F(this,"_rangeShape"),F(this,"_current",!1),F(this,"_startRow"),F(this,"_startCol"),F(this,"_endRow"),F(this,"_endCol"),F(this,"_tableId"),this._scene=e,this._document=t,this._docSkeleton=n,this.anchorNodePosition=i,this.focusNodePosition=r,this.style=a,this._segmentId=o,this._segmentPage=s,this.refresh()}get startOffset(){let{startNodePosition:e}=this;return this._docSkeleton.findCharIndexByPosition(e)}get endOffset(){let{endNodePosition:e}=this;return this._docSkeleton.findCharIndexByPosition(e)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var e;let t=null==(e=this._docSkeleton.getViewModel().getSnapshot().tableSource)?void 0:e[this._tableId],{_startCol:n,_endCol:i}=this;if(null==t)throw Error("Table is not found.");let{tableColumns:r}=t;return 0===n&&i===r.length-1}get spanEntireColumn(){var e;let t=null==(e=this._docSkeleton.getViewModel().getSnapshot().tableSource)?void 0:e[this._tableId],{_startRow:n,_endRow:i}=this;if(null==t)throw Error("Table is not found.");let{tableRows:r}=t;return 0===n&&i===r.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){let{anchorNodePosition:e,focusNodePosition:t}=this;return eM(e,t)?e:t}get endNodePosition(){let{anchorNodePosition:e,focusNodePosition:t}=this;return eM(e,t)?t:e}get direction(){let{anchorNodePosition:e,focusNodePosition:t}=this;return eM(e,t)?h.RANGE_DIRECTION.FORWARD:h.RANGE_DIRECTION.BACKWARD}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var e;null==(e=this._rangeShape)||e.dispose(),this._rangeShape=null}isIntersection(e){let{startRow:t,startColumn:n,endRow:i,endColumn:r}=this,{startRow:a,startColumn:o,endRow:s,endColumn:l}=e;return(0,h.Rectangle).hasIntersectionBetweenTwoRect({left:n,top:t,right:r,bottom:i},{left:o,top:a,right:l,bottom:s})}refresh(){var e;null==(e=this._rangeShape)||e.hide();let{startNodePosition:t,endNodePosition:n,_document:i,_docSkeleton:r}=this,a=i.getOffsetConfig(),{docsLeft:o,docsTop:s}=a,l=new e_(a,r).getRangePointData(t,n);if(null==l)return;let{pointGroup:A=[],startRow:d,endRow:c,startColumn:u,endColumn:h,tableId:g}=l;(null==A?void 0:A.length)>0&&this._createOrUpdateRange(A,o,s),this._updateTableInfo(d,c,u,h,g)}_updateTableInfo(e,t,n,i,r){this._startRow=e,this._endRow=t,this._startCol=n,this._endCol=i,this._tableId=r}_createOrUpdateRange(e,t,n){var i;if(this._rangeShape){this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}let r=new p.RegularPolygon("__DocTableRectRange__"+(0,h.Tools).generateRandomId(6),{pointsGroup:e,fill:(null==(i=this.style)?void 0:i.fill)||(0,p.getColor)(h.COLORS.black,.3),left:t,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=r,this._scene.addObject(r,3)}};w(eF,"RectRange");let eL=eF;function ek(e,t,n,i,r,a,o,s,l=!0,A=!0){let d=r.findNodePositionByCharIndex(e,l,o,s),c=r.findNodePositionByCharIndex(t,A,o,s);if(!(null==d||null==c))return new eQ(n,i,r,d,c,a,o,s)}function eH(e,t,n,i,r,a,o,s){let l=r.findNodePositionByCharIndex(e,!0,o,s),A=r.findNodePositionByCharIndex(t,!0,o,s);if(!(null==l||null==A))return new eL(n,i,r,l,A,a,o,s)}function eV(e,t,n,i,r,a,o,s){let l=r.findNodePositionByCharIndex(e,!0,o,s),A=r.findNodePositionByCharIndex(t,!0,o,s);if(!(null==l||null==A))return ej(l,A,n,i,r,a,o,s)}function ej(e,t,n,i,r,a,o,s){let l=[],A=[],d=[n,i,r,e,t,a,o,s];if(eB(e,t))return l.push(new eQ(...d)),{textRanges:l,rectRanges:A};if(eO(e,t)){let e=ew(...d);return A.push(...e),{textRanges:l,rectRanges:A}}let c=r.getViewModel().getSelfOrHeaderFooterViewModel(o),u=r.findCharIndexByPosition(e),g=r.findCharIndexByPosition(t);if(null==u||null==g)return;let p=u<=g?h.RANGE_DIRECTION.FORWARD:h.RANGE_DIRECTION.BACKWARD,m=Math.min(u,g),f=Math.max(u,g),S=m,I=f;for(let e of c.children)for(let t of e.children){let{startIndex:e,endIndex:d,children:c}=t,u=c[0],g=!1;if(u){let{startIndex:e,endIndex:t,children:d}=u,c=null,v=null,E=d.find(e=>e.startIndex<=m&&e.endIndex>=m),C=d.find(e=>e.startIndex<=f&&e.endIndex>=f);if(m>e&&m<t)c=r.findNodePositionByCharIndex(E.startIndex+2,!0,o,s),v=r.findNodePositionByCharIndex(t-4,!0,o,s),S=t+1;else if(f>e&&f<t)c=r.findNodePositionByCharIndex(e+3,!0,o,s),v=r.findNodePositionByCharIndex(C.endIndex-3,!0,o,s),I=e-1,g=!0;else if(e>m&&t<f){if(c=r.findNodePositionByCharIndex(e+3,!0,o,s),v=r.findNodePositionByCharIndex(t-4,!0,o,s),S<=e-1){let t=r.findNodePositionByCharIndex(S,!0,o,s),A=r.findNodePositionByCharIndex(e-1,!1,o,s),d=p===h.RANGE_DIRECTION.FORWARD?t:A,c=p===h.RANGE_DIRECTION.FORWARD?A:t;l.push(new eQ(n,i,r,d,c,a,o,s))}S=t+1}if(c&&v){let e=p===h.RANGE_DIRECTION.FORWARD?c:v,t=p===h.RANGE_DIRECTION.FORWARD?v:c;A.push(...ew(n,i,r,e,t,a,o,s))}}if(I>=e&&I<=d||g){let e=r.findNodePositionByCharIndex(S,!0,o,s),t=r.findNodePositionByCharIndex(I,!g,o,s),d=p===h.RANGE_DIRECTION.FORWARD?e:t,c=p===h.RANGE_DIRECTION.FORWARD?t:e;if(A.length&&(0,h.Tools).diffValue(d,c))continue;l.push(new eQ(n,i,r,d,c,a,o,s))}}return{textRanges:l,rectRanges:A}}function eW(e){let t=null==e?void 0:e.getCanvasElement();if(!t)return{left:0,top:0};let{top:n,left:i}=(0,p.getOffsetRectForDom)(t);return{left:i,top:n}}function ez(e){var t;let n=null==(t=e.parent)?void 0:t.parent,i=null==n?void 0:n.parent;if(null==n||null==i)return;let{paragraphIndex:r}=n,a=i.lines.filter(e=>e.paragraphIndex===r),o=-1,s="",l=!1;for(let t of a)for(let n of t.divides)for(let t of n.glyphGroup)l||(o+=t.count),t===e&&(l=!0),s+=t.count>0?t.content:"";return{st:a[0].st,ed:r,content:s,nodeIndex:o}}function eG(e){let{startOffset:t,endOffset:n,collapsed:i,rangeType:r,startNodePosition:a,endNodePosition:o,direction:s,segmentId:l,segmentPage:A}=e;return{startOffset:t,endOffset:n,collapsed:i,rangeType:r,startNodePosition:a,endNodePosition:o,direction:s,segmentId:l,segmentPage:A,isActive:e.isActive()}}function eY(e){let t=eG(e),{startRow:n,startColumn:i,endRow:r,endColumn:a,tableId:o,spanEntireRow:s,spanEntireColumn:l,spanEntireTable:A}=e;return{...t,startRow:n,startColumn:i,endRow:r,endColumn:a,tableId:o,spanEntireRow:s,spanEntireColumn:l,spanEntireTable:A}}w(ek,"getTextRangeFromCharIndex"),w(eH,"getRectRangeFromCharIndex"),w(eV,"getRangeListFromCharIndex"),w(ej,"getRangeListFromSelection"),w(eW,"getCanvasOffsetByEngine"),w(ez,"getParagraphInfoByGlyph"),w(eG,"serializeTextRange"),w(eY,"serializeRectRange");var eK,eq,eX=Object.defineProperty,eJ=Object.getOwnPropertyDescriptor,eZ=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?eJ(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&eX(t,n,a),a},"__decorateClass$r"),e$=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$r");let e0=(w(eq=class extends h.RxDisposable{constructor(e,t,n,i,r){super(),F(this,"_onInputBefore$",new x.Subject),F(this,"onInputBefore$",this._onInputBefore$.asObservable()),F(this,"_onKeydown$",new x.Subject),F(this,"onKeydown$",this._onKeydown$.asObservable()),F(this,"_onInput$",new x.Subject),F(this,"onInput$",this._onInput$.asObservable()),F(this,"_onCompositionstart$",new I.BehaviorSubject(null)),F(this,"onCompositionstart$",this._onCompositionstart$.asObservable()),F(this,"_onCompositionupdate$",new I.BehaviorSubject(null)),F(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable()),F(this,"_onCompositionend$",new I.BehaviorSubject(null)),F(this,"onCompositionend$",this._onCompositionend$.asObservable()),F(this,"_onSelectionStart$",new I.BehaviorSubject(null)),F(this,"onSelectionStart$",this._onSelectionStart$.asObservable()),F(this,"_onPaste$",new x.Subject),F(this,"onPaste$",this._onPaste$.asObservable()),F(this,"_textSelectionInner$",new I.BehaviorSubject(null)),F(this,"textSelectionInner$",this._textSelectionInner$.asObservable()),F(this,"_onFocus$",new x.Subject),F(this,"onFocus$",this._onFocus$.asObservable()),F(this,"_onBlur$",new x.Subject),F(this,"onBlur$",this._onBlur$.asObservable()),F(this,"_onPointerDown$",new x.Subject),F(this,"onPointerDown$",this._onPointerDown$.asObservable()),F(this,"_container"),F(this,"_inputParent"),F(this,"_input"),F(this,"_scrollTimers",[]),F(this,"_rangeList",[]),F(this,"_rangeListCache",[]),F(this,"_rectRangeList",[]),F(this,"_rectRangeListCache",[]),F(this,"_anchorNodePosition",null),F(this,"_focusNodePosition",null),F(this,"_currentSegmentId",""),F(this,"_currentSegmentPage",-1),F(this,"_selectionStyle",p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE),F(this,"_viewPortObserverMap",/* @__PURE__ */new Map),F(this,"_isIMEInputApply",!1),F(this,"_scenePointerMoveSubs",[]),F(this,"_scenePointerUpSubs",[]),F(this,"_editorFocusing",!0),F(this,"_reserveRanges",!1),this._context=e,this._layoutService=t,this._logService=n,this._univerInstanceService=i,this._docSkeletonManagerService=r,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(h.UniverInstanceType.UNIVER_DOC).pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>{null!=e&&(e.getUnitId()===this._context.unitId||this._reserveRanges||this.removeAllRanges())})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=p.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,t=!0,n){let{_currentSegmentId:i,_currentSegmentPage:r,_selectionStyle:a}=this,{scene:o,mainComponent:s}=this._context,l=this._docSkeletonManagerService.getSkeleton();for(let t of e){let{startOffset:e,endOffset:n,rangeType:A,startNodePosition:d,endNodePosition:c}=t;if(A===h.DOC_RANGE_TYPE.RECT){let t=eH(e,n,o,s,l,a,i,r);t&&this._addRectRanges([t])}else if(A===h.DOC_RANGE_TYPE.TEXT){let t=null;(t=d&&c?ek(d.isBack?e:e-1,c.isBack?n:n-1,o,s,l,a,i,r,d.isBack,c.isBack):ek(e,n,o,s,l,a,i,r))&&this._addTextRange(t)}else{let t=eV(e,n,o,s,l,a,i,r);if(null==t)continue;let{textRanges:A,rectRanges:d}=t;for(let e of A)this._addTextRange(e);this._addRectRanges(d)}}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:i,segmentPage:r,style:a,isEditing:t,options:n}),this._updateInputPosition(null==n?void 0:n.forceFocus)}setCursorManually(e,t){let n=this._findNodeByCoord(e,t,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),i=this._getNodePosition(n);if(null==i){this._removeAllRanges();return}(null==n?void 0:n.node.streamType)===h.DataStreamTreeTokenType.PARAGRAPH&&(i.isBack=!0),this._createTextRangeByAnchorPosition(i),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,t,n=!1){let i=this._input===document.activeElement||document.activeElement===document.body||null===document.activeElement;this._container.style.left=`${e}px`,this._container.style.top=`${t}px`,this._container.style.zIndex="1000",(i||n)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._editorFocusing&&this._input.focus()}blur(){this._input.blur()}focusEditor(){this._editorFocusing=!0,this.focus()}blurEditor(){this._editorFocusing=!1,this.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){let{offsetX:t,offsetY:n}=e,i=this._findNodeByCoord(t,n,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(null==i||null==i.node)return;let r=ez(i.node);if(null==r)return;let{content:a,st:o,nodeIndex:s}=r;if(-1===s||null==Intl.Segmenter)return;let l=new Intl.Segmenter(void 0,{granularity:"word"}).segment(a),A=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY;for(let{segment:e,index:t,isWordLike:n}of l)if(t<=s&&s<t+e.length&&n){A=t+o,d=t+o+e.length;break}if(Number.isFinite(A)&&Number.isFinite(d)){this.removeAllRanges();let e=[{startOffset:A,endOffset:d}];this.addDocRanges(e,!1,{forceFocus:!0})}}__handleTripleClick(e){let{offsetX:t,offsetY:n}=e,i=this._findNodeByCoord(t,n,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(null==i||null==i.node)return;let r=ez(i.node);if(null==r)return;this.removeAllRanges();let{st:a,ed:o}=r;this.addDocRanges([{startOffset:a,endOffset:o}],!1,{forceFocus:!0})}__onPointDown(e){var t,n;this._editorFocusing=!0;let{scene:i,mainComponent:r}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{offsetX:o,offsetY:s}=e,l=this._findNodeByCoord(o,s,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(null==A||null==l){this._removeAllRanges();return}(null==l?void 0:l.node.streamType)===h.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);let d=this._textSelectionInner$.value;if(l&&2===e.button&&d){let e=a.findCharIndexByPosition(A);if("number"==typeof e&&d.textRanges.some(t=>t.startOffset<=e&&t.endOffset>e)||"number"==typeof e&&d.rectRanges.some(t=>t.startOffset<=e&&t.endOffset>=e))return}let{segmentId:c,segmentPage:u}=l;c&&this._currentSegmentId&&c!==this._currentSegmentId&&this.setSegment(c),c&&u!==this._currentSegmentPage&&this.setSegmentPage(u),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),i.disableObjectsEvent();let g=(0,p.ScrollTimer).create(i);this._scrollTimers.push(g),g.startScroll(o,s),this._onSelectionStart$.next(null==(t=this._getActiveRangeInstance())?void 0:t.startNodePosition),null==(n=i.getTransformer())||n.clearSelectedObjects();let m=o,f=s;this._scenePointerMoveSubs.push(i.onPointerMove$.subscribeEvent(e=>{let{offsetX:t,offsetY:n}=e;i.setCursor(p.CURSOR_TYPE.TEXT),3>Math.sqrt((t-m)**2+(n-f)**2)||(this._moving(t,n),g.scrolling(t,n,()=>{this._moving(t,n)}),m=t,f=n)})),this._scenePointerUpSubs.push(i.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(e=>{e.unsubscribe()}),i.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}let t=new eQ(i,r,a,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(t)}else if(this._anchorNodePosition&&this._focusNodePosition){for(let t of this._rangeListCache)e.ctrlKey&&t.collapsed?t.dispose():this._addTextRange(t);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;let t={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(t),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{null==e||e.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){let{r:e,g:t,b:n,a:i}=(0,p.getSystemHighlightColor)(),r={strokeWidth:1.5,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${t}, ${n}, ${null!=i?i:.3})`};this._setRangeStyle(r)}_getAllTextRanges(){return this._rangeList.map(eG)}_getAllRectRanges(){return this._rectRangeList.map(eY)}_getActiveRange(){let e=this._rangeList.find(e=>e.isActive());if(null==e)return null;let{startOffset:t,endOffset:n}=e;return null==t||null==n?null:eG(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){let{unitId:e}=this._context,t=document.createElement("div");t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.id=`univer-doc-selection-container-${e}`;let n=document.createElement("div"),i=document.createElement("div");n.appendChild(i),t.appendChild(n),this._container=t,this._inputParent=n,this._input=i,this._initInput(),this._initInputEvents(),document.body.appendChild(t)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.classList.add("univer-editor"),this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(null==e)return;let{node:t,ratioX:n,segmentPage:i}=e,r=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(t,i);if(null!=r)return{...r,isBack:n<.5}}_interactTextRanges(e){let t=[];for(let n of this._rangeList){if(e.some(e=>e.isIntersection(n))){n.dispose();continue}t.push(n)}this._rangeList=t}_interactRectRanges(e){let t=[];for(let n of this._rectRangeList){if(e.some(e=>e.isIntersection(n))){n.dispose();continue}t.push(n)}this._rectRangeList=t}_removeCollapsedTextRange(){let e=this._rangeList;for(let t of(this._rangeList=[],e))t.collapsed?t.dispose():this._rangeList.push(t)}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(let e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){0!==e.length&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();let{scene:t,mainComponent:n}=this._context,i=new eQ(t,n,this._docSkeletonManagerService.getSkeleton(),e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(i)}_updateActiveRangePosition(e){let t=this._getActiveRangeInstance();if(null==t||null==t.anchorNodePosition){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=t.anchorNodePosition,this._focusNodePosition=e;let{scene:n,mainComponent:i}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:a,_focusNodePosition:o,_selectionStyle:s,_currentSegmentId:l,_currentSegmentPage:A}=this;if(null==a||null==o||null==i)return;let d=ej(a,o,n,i,r,s,l,A);if(null==d)return;let{textRanges:c,rectRanges:u}=d;this._addTextRangesToCache(c),this._addRectRangesToCache(u),this.deactivate()}_isEmpty(){return 0===this._rangeList.length&&0===this._rectRangeList.length}_getCanvasOffset(){var e;return eW(null==(e=this._context.scene)?void 0:e.getEngine())}_updateInputPosition(e=!1){let t=this._getActiveRangeInstance(),n=null==t?void 0:t.getAnchor();if(!n||n&&!n.visible||null==this.activeViewPort){this.focus();return}let{left:i,top:r}=n,{x:a,y:o}=this.activeViewPort.getAbsoluteVector((0,p.Vector2).FromArray([i,r])),{left:s,top:l}=this._getCanvasOffset();s+=a,l+=o,this.activate(s,l,e)}_moving(e,t){var n,i;let r=this._findNodeByCoord(e,t,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),a=this._getNodePosition(r);if(!a||null==r)return;let o=null==r?void 0:r.node.parent,s=null==o?void 0:o.glyphGroup[o.glyphGroup.indexOf(r.node)+1];(null==r?void 0:r.node.streamType)===h.DataStreamTreeTokenType.PARAGRAPH&&(null==s?void 0:s.streamType)===h.DataStreamTreeTokenType.SECTION_BREAK&&(a.isBack=!0),this._focusNodePosition=a,this._removeAllCacheRanges();let{_anchorNodePosition:l,_focusNodePosition:A,_selectionStyle:d,_currentSegmentId:c,_currentSegmentPage:u}=this,{scene:g,mainComponent:p}=this._context,m=this._docSkeletonManagerService.getSkeleton();if(null==l||null==A||null==p)return;let f=ej(l,A,g,p,m,d,c,u);if(null==f)return;let{textRanges:S,rectRanges:I}=f;this._rangeList.length>0&&S.length>0&&this._interactTextRanges(S),this._rectRangeList.length>0&&I.length>0&&this._interactRectRanges(I),this._addTextRangesToCache(S),this._addRectRangesToCache(I),this.deactivate(),null==(i=null==(n=this._context.scene)?void 0:n.getEngine())||i.setRemainCapture()}__attachScrollEvent(){let e=this.activeViewPort;if(!e)return;let{unitId:t}=this._context;if(this._viewPortObserverMap.has(t))return;let n=e.onScrollAfter$.subscribeEvent(e=>{if(!e.viewport)return;let t=this._getActiveRangeInstance();null==t||t.activeStatic()}),i=e.onScrollEnd$.subscribeEvent(e=>{let t=e.viewport;if(!t)return;let n=t.getBounding(),i=this._getActiveRangeInstance(),r=null==i?void 0:i.getAnchor();if(!(!r||r&&!r.visible)){if(n){let{left:e,top:t,right:a,bottom:o}=n.viewBound;if(r.left<e||r.left>a||r.top<t||r.top>o){null==i||i.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(t,{scrollBefore:n,scrollStop:i})}_initInputEvents(){this.disposeWithMe((0,T.fromEvent)(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,e=>{this._onKeydown$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"input").subscribe(e=>{if(!("historyUndo"===e.inputType||"historyRedo"===e.inputType)){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,e=>{this._onInputBefore$.next(e),this._onInput$.next(e)})}})),this.disposeWithMe((0,T.fromEvent)(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,e=>{this._onCompositionstart$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,e=>{this._onCompositionend$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,e=>{this._onInputBefore$.next(e),this._onCompositionupdate$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"paste").subscribe(e=>{this._eventHandle(e,e=>{this._onPaste$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"focus").subscribe(e=>{this._eventHandle(e,e=>{this._onFocus$.next(e)})})),this.disposeWithMe((0,T.fromEvent)(this._input,"blur").subscribe(e=>{this._eventHandle(e,e=>{this._onBlur$.next(e)})}))}_eventHandle(e,t){let n=this._input.textContent||"";this._input.innerHTML="",t({event:e,content:n,activeRange:this._getActiveRange(),rangeList:this._getAllTextRanges()})}_getTransformCoordForDocumentOffset(e,t){let{documentTransform:n}=this._context.mainComponent.getOffsetConfig();if(null==this.activeViewPort||null==n)return;let i=this.activeViewPort.transformVector2SceneCoord((0,p.Vector2).FromArray([e,t]));if(i)return n.clone().invert().applyPoint(i)}_findNodeByCoord(e,t,n){let i=this._getTransformCoordForDocumentOffset(e,t);if(null==i)return;let r=this._context.mainComponent,a=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:o=p.PageLayoutType.VERTICAL,pageMarginLeft:s,pageMarginTop:l}=r.getOffsetConfig();return a.findNodeByCoord(i,o,s,l,n)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}},"DocSelectionRenderService"),eq);e0=eZ([e$(1,N.ILayoutService),e$(2,h.ILogService),e$(3,h.IUniverInstanceService),e$(4,(0,h.Inject)(g.DocSkeletonManagerService))],e0);let e1=class extends h.Disposable{constructor(e,t,n,i,r){super(),F(this,"_change$",new x.Subject),F(this,"change$",this._change$.asObservable()),F(this,"_input$",new x.Subject),F(this,"input$",this._input$.asObservable()),F(this,"_paste$",new x.Subject),F(this,"paste$",this._paste$.asObservable()),F(this,"_focus",!1),F(this,"_focus$",new x.Subject),F(this,"focus$",this._focus$.asObservable()),F(this,"_blur$",new x.Subject),F(this,"blur$",this._blur$.asObservable()),F(this,"_selectionChange$",new x.Subject),F(this,"selectionChange$",this._selectionChange$.asObservable()),F(this,"_valueLegality",!0),F(this,"_openForSheetUnitId"),F(this,"_openForSheetSubUnitId"),this._param=e,this._univerInstanceService=t,this._docSelectionManagerService=n,this._commandService=i,this._undoRedoService=r,this._openForSheetUnitId=this._param.openForSheetUnitId,this._openForSheetSubUnitId=this._param.openForSheetSubUnitId,this._listenSelection()}_listenSelection(){let e=this._param.render.with(e0);this.disposeWithMe(e.onBlur$.subscribe(e=>{this._blur$.next(e);let t=this.getDocumentData();this._change$.next({target:this,data:t})})),this.disposeWithMe(e.onFocus$.subscribe(e=>{this._focus$.next(e)})),this.disposeWithMe(e.onPaste$.subscribe(e=>{this._paste$.next(e)})),this.disposeWithMe((0,y.merge)(e.onInput$,e.onKeydown$.pipe((0,C.filter)(e=>{let t=e.event;return t.ctrlKey||t.metaKey?[(0,N.KeyCode).X,(0,N.KeyCode).V].includes(t.keyCode):[(0,N.KeyCode).BACKSPACE].includes(t.keyCode)})),e.onCompositionupdate$,e.onCompositionend$,e.onPaste$).subscribe(e=>{if(null==e)return;let{content:t=""}=e,n=this.getDocumentData();this._input$.next({target:this,content:t,data:n,isComposing:"compositionupdate"===e.event.type})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(e=>{if(null==e)return;let{unitId:t,subUnitId:n,...i}=e;t===this.getEditorId()&&this._selectionChange$.next(i)}))}focus(){let e=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),t=this.getEditorId();(null==e||e.getUnitId()!==t)&&this._univerInstanceService.setCurrentUnitForType(t),this._param.render.with(e0).focus();let n=this._docSelectionManagerService.getDocRanges({unitId:t,subUnitId:t});n&&this._docSelectionManagerService.replaceDocRanges(n,{unitId:t,subUnitId:t},!1),this._focus=!0}blur(){this._param.render.with(e0).blur(),this._focus=!1}select(){let e=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:e.body?e.body.dataStream.length-2:0}])}setSelectionRanges(e){let t=this.getEditorId();return this._docSelectionManagerService.replaceDocRanges(e,{unitId:t,subUnitId:t},!1)}getSelectionRanges(){let e=this.getEditorId();return this._docSelectionManagerService.getDocRanges({unitId:e,subUnitId:e})}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}setDocumentData(e,t){let{id:n}=e;this._commandService.executeCommand(eg.id,{unitId:n,snapshot:e,textRanges:t})}clearUndoRedoHistory(){let e=this.getEditorId();return this._undoRedoService.clearUndoRedo(e)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isSingleChoice(){var e;return null!=(e=this._param.isSingleChoice)&&e}setOpenForSheetUnitId(e){this._openForSheetUnitId=e}getOpenForSheetUnitId(){return this._openForSheetUnitId}setOpenForSheetSubUnitId(e){this._openForSheetSubUnitId=e}getOpenForSheetSubUnitId(){return this._openForSheetSubUnitId}isValueLegality(){return!0===this._valueLegality}setValueLegality(e=!0){this._valueLegality=e}isFocus(){return this._focus}setFocus(e=!1){this._focus=e}isSingle(){return!0===this._param.isSingle||this.onlyInputRange()}isReadOnly(){return!0===this._param.readonly}onlyInputContent(){return!0===this._param.onlyInputContent}onlyInputFormula(){return!0===this._param.onlyInputFormula}onlyInputRange(){return!0===this._param.onlyInputRange}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}isVisible(){return this._param.visible}isSheetEditor(){return!0===this._param.isSheetEditor}isFormulaEditor(){return!0===this._param.isFormulaEditor}getValue(){var e;return((null==(e=this._getDocDataModel().getBody())?void 0:e.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(e){this._param={...this._param,...e}}verticalAlign(){var e;let t=this._getDocDataModel();if(null==t)return;let{width:n,height:i}=this._param.editorDom.getBoundingClientRect();if(0===i||0===n)return;if(!this.isSingle()){t.updateDocumentDataPageSize(n,void 0);return}let r=h.DEFAULT_STYLES.fs;null!=(e=this._param.canvasStyle)&&e.fontSize&&(r=this._param.canvasStyle.fontSize);let a=(i-4*r/3)/2-2;t.updateDocumentDataMargin({t:a<0?0:a}),t.updateDocumentDataPageSize(void 0,void 0)}updateCanvasStyle(){var e;let t=this._getDocDataModel();if(null==t)return;let n={};null!=(e=this._param.canvasStyle)&&e.fontSize&&(null==n.textStyle&&(n.textStyle={}),n.textStyle.fs=this._param.canvasStyle.fontSize),t.updateDocumentStyle(n)}_getDocDataModel(){let e=this._getEditorId();return this._univerInstanceService.getUnit(e,h.UniverInstanceType.UNIVER_DOC)}_getEditorId(){var e;return(null==(e=this._param.initialSnapshot)?void 0:e.id)||this._param.editorUnitId||""}};w(e1,"Editor");var e9=Object.defineProperty,e3=Object.getOwnPropertyDescriptor,e2=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?e3(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&e9(t,n,a),a},"__decorateClass$q"),e4=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$q");let e6=["univer-editor","univer-range-selector","univer-range-selector-editor","univer-render-canvas","univer-text-editor-container-placeholder"],e8=(w(nh=class extends h.Disposable{constructor(e,t,n,i,r,a,o){super(),F(this,"_editors",/* @__PURE__ */new Map),F(this,"_focusEditorUnitId"),F(this,"_state$",new x.Subject),F(this,"state$",this._state$.asObservable()),F(this,"_currentSheetUnitId"),F(this,"_currentSheetSubUnitId"),F(this,"_inputFormula$",new x.Subject),F(this,"inputFormula$",this._inputFormula$.asObservable()),F(this,"_resize$",new x.Subject),F(this,"resize$",this._resize$.asObservable()),F(this,"_closeRangePrompt$",new x.Subject),F(this,"closeRangePrompt$",this._closeRangePrompt$.asObservable()),F(this,"_blur$",new x.Subject),F(this,"blur$",this._blur$.asObservable()),F(this,"_focus$",new x.Subject),F(this,"focus$",this._focus$.asObservable()),F(this,"_setValue$",new x.Subject),F(this,"setValue$",this._setValue$.asObservable()),F(this,"_valueChange$",new x.Subject),F(this,"valueChange$",this._valueChange$.asObservable()),F(this,"_focusStyle$",new x.Subject),F(this,"focusStyle$",this._focusStyle$.asObservable()),F(this,"_singleSelection$",new x.Subject),F(this,"singleSelection$",this._singleSelection$.asObservable()),F(this,"_spreadsheetFocusState",!1),this._univerInstanceService=e,this._renderManagerService=t,this._lexerTreeBuilder=n,this._docSelectionManagerService=i,this._contextService=r,this._commandService=a,this._undoRedoService=o,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe((0,T.fromEvent)(window,"focusin").subscribe(e=>{let t=e.target;this._blurSheetEditor(t)}))}_blurSheetEditor(e){if(e6.some(t=>e.classList.contains(t)))return;let t=this.getFocusEditor();t&&!0!==t.isSheetEditor()&&this.blur()}setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){let t=this._editors.get(e);return!!(t&&t.isSheetEditor())}closeRangePrompt(){let e=this._univerInstanceService.getCurrentUniverDocInstance();if(!e)return;let t=e.getUnitId();this._contextService.setContextValue(h.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(h.FOCUSING_EDITOR_STANDALONE,!1),!this.isEditor(t)||this.isSheetEditor(t)||(this.changeSpreadsheetFocusState(!1),this.blur())}changeSpreadsheetFocusState(e){this._spreadsheetFocusState=e}getSpreadsheetFocusState(){return this._spreadsheetFocusState}focusStyle(e){let t=this.getEditor(e);if(!t)return!1;t.setFocus(!0),this._contextService.setContextValue(h.EDITOR_ACTIVATED,!0),this._contextService.setContextValue(h.FOCUSING_EDITOR_STANDALONE,!0),this._contextService.setContextValue(h.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE,t.isSingle()),this._spreadsheetFocusState||this.singleSelection(!!t.isSingleChoice()),this._focusStyle$.next(e),this.setFocusId(e)}singleSelection(e){this._singleSelection$.next(e)}selectionChangingState(){let e=this.getFocusId();if(null==e)return!0;let t=this.getEditor(e);return!!(!t||t.isSheetEditor()||t.isFormulaEditor())||(!0!==t.onlyInputRange()&&!0!==t.onlyInputFormula()?(this.blur(),!0):!0===t.onlyInputFormula()&&!0!==this._contextService.getContextValue(h.FOCUSING_EDITOR_INPUT_FORMULA)?(this.blur(),!0):!this.getSpreadsheetFocusState())}blur(){this._spreadsheetFocusState||(this._closeRangePrompt$.next(null),this.singleSelection(!1),this.setFocusId(null),this._contextService.setContextValue(h.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(h.FOCUSING_EDITOR_STANDALONE,!1)),this.getAllEditor().forEach(e=>{e.setFocus(!1)}),this._focusStyle$.next(),this._blur$.next(null)}focus(e=(e=>null==(e=this._univerInstanceService.getCurrentUniverDocInstance())?void 0:e.getUnitId())()){if(null==e)return;let t=this.getEditor(e);if(null==t)return;this._univerInstanceService.setCurrentUnitForType(e);let n=t.getValue().length;this.focusStyle(e),this._focus$.next({startOffset:n-2,endOffset:n-2})}setFormula(e,t=this._getCurrentEditorUnitId()){this._inputFormula$.next({formulaString:e,editorUnitId:t})}setValue(e,t=this._getCurrentEditorUnitId()){this.setValueNoRefresh(e,t),this._refreshValueChange(t)}setValueNoRefresh(e,t){this._setValue$.next({body:{dataStream:e},editorUnitId:t}),this.resize(t)}getValue(e){let t=this.getEditor(e);if(null!=t)return t.getValue()}setRichValue(e,t=this._getCurrentEditorUnitId()){this._setValue$.next({body:e,editorUnitId:t}),this._refreshValueChange(t)}getRichValue(e){let t=this.getEditor(e);if(null!=t)return t.getBody()}dispose(){this._state$.complete(),this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}getFirstEditor(){return[...this.getAllEditor().values()][0]}resize(e){let t=this.getEditor(e);null!=t&&(t.verticalAlign(),this._resize$.next(e))}isVisible(e){var t;return null==(t=this.getEditor(e))?void 0:t.isVisible()}setOperationSheetUnitId(e){this._currentSheetUnitId=e}getOperationSheetUnitId(){return this._currentSheetUnitId}setOperationSheetSubUnitId(e){this._currentSheetSubUnitId=e}getOperationSheetSubUnitId(){return this._currentSheetSubUnitId}register(e,t){var n,i,r,a;let{initialSnapshot:o,canvasStyle:s={}}=e,l=o.id;null==this._univerInstanceService.getUnit(l,h.UniverInstanceType.UNIVER_DOC)&&this._univerInstanceService.createUnit(h.UniverInstanceType.UNIVER_DOC,o||this._getBlank(l),{makeCurrent:!1});let A=this._renderManagerService.getRenderById(l);if(null==A&&(this._renderManagerService.create(l),A=this._renderManagerService.getRenderById(l)),A){A.engine.setContainer(t);let o=new e1({...e,render:A,editorDom:t,canvasStyle:s},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService);this._editors.set(l,o),e.scrollBar||null==(a=null==(r=null==(i=null==(n=A.mainComponent)?void 0:n.getScene())?void 0:i.getViewports())?void 0:r[0].getScrollBar())||a.dispose(),o.isSheetEditor()||e.noNeedVerticalAlign||(o.verticalAlign(),o.updateCanvasStyle())}return(0,h.toDisposable)(()=>{this._unRegister(l)})}_unRegister(e){let t=this._editors.get(e);if(null!=t&&(this._renderManagerService.removeRender(e),t.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e),this._contextService.setContextValue(h.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE,!1),this.isSheetEditor(e))&&this._univerInstanceService.getAllUnitsForType(h.UniverInstanceType.UNIVER_SHEET).length>0){let e=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_SHEET);e&&this._univerInstanceService.focusUnit(e.getUnitId())}}refreshValueChange(e){this._refreshValueChange(e)}checkValueLegality(e){let t=this._editors.get(e);if(null==t)return!0;let n=t.getValue();if(t.setValueLegality(),0===(n=n.replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")).length)return!0;if(t.onlyInputFormula()){if(n.substring(0,1)!==f.operatorToken.EQUALS)return t.setValueLegality(!1),!1;let e=this._lexerTreeBuilder.checkIfAddBracket(n);t.setValueLegality(0===e)}else if(t.onlyInputRange()){let e=n.split(",");if(t.isSingleChoice()&&e.length>1)return t.setValueLegality(!1),!1;t.setValueLegality((0,f.isReferenceStrings)(n))}return t.isValueLegality()}_refreshValueChange(e){let t=this.getEditor(e);null!=t&&this._valueChange$.next(t)}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${h.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:h.VerticalAlign.TOP,horizontalAlign:h.HorizontalAlign.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}},"EditorService"),nh);e8=e2([e4(0,h.IUniverInstanceService),e4(1,p.IRenderManagerService),e4(2,(0,h.Inject)(f.LexerTreeBuilder)),e4(3,(0,h.Inject)(g.DocSelectionManagerService)),e4(4,h.IContextService),e4(5,h.ICommandService),e4(6,h.IUndoRedoService)],e8);let e5=(0,h.createIdentifier)("univer.editor.service"),e7={textEditorContainer:"univer-text-editor-container",textEditorContainerActive:"univer-text-editor-container-active",textEditorContainerError:"univer-text-editor-container-error",textEditorContainerDisabled:"univer-text-editor-container-disabled",textEditorContainerPlaceholder:"univer-text-editor-container-placeholder",textEditorValidationError:"univer-text-editor-validation-error"};function te(e="",t=""){let n=`${t}${h.DEFAULT_EMPTY_DOCUMENT_VALUE}`,i=[],r=[];for(let e=0;e<n.length;e++)"\r"===n[e]&&i.push({startIndex:e}),n[e]===`
`&&r.push({startIndex:e});return{id:e,body:{dataStream:n,tables:[],textRuns:[],paragraphs:i,sectionBreaks:r},tableSource:{},documentStyle:{documentFlavor:h.DocumentFlavor.UNSPECIFIED}}}w(te,"genSnapShotByValue");let tt=/* @__PURE__ */new Set(["snapshot","resizeCallBack","cancelDefaultResizeListener","isSheetEditor","canvasStyle","isFormulaEditor","isSingle","isReadonly","onlyInputFormula","onlyInputRange","value","onlyInputContent","isSingleChoice","openForSheetUnitId","openForSheetSubUnitId","onChange","onActive","onValid","placeholder"]);function tn(e){let{id:t,snapshot:n,resizeCallBack:i,cancelDefaultResizeListener:r,isSheetEditor:a=!1,canvasStyle:o={},value:s,isSingle:l=!0,isReadonly:A=!1,isFormulaEditor:d=!1,onlyInputFormula:c=!1,onlyInputRange:u=!1,onlyInputContent:g=!1,isSingleChoice:p=!1,openForSheetUnitId:f,openForSheetSubUnitId:S,onChange:I,onActive:v,onValid:E,isValueValid:C=!0,placeholder:T}=e,b=(0,h.useDependency)(e5),y=(0,h.useDependency)(h.LocaleService),[R,x]=(0,m.useState)(""),[O,B]=(0,m.useState)(""),[M,D]=(0,m.useState)(C),[N,_]=(0,m.useState)([0,0]),U=(0,m.useRef)(null),[P,Q]=(0,m.useState)(!1);if(!(0,h.isInternalEditorID)(t))throw Error("Invalid editor ID");function F(){let e=b.getValue(t);return!(null==e||""===e)}(0,m.useEffect)(()=>{let e=U.current;if(!e)return;let m=new ResizeObserver(()=>{!0!==r&&b.resize(t),i&&i(e)});m.observe(e);let C=null!=n?n:te(t,s);C.id!==t&&(C.id=t);let R=b.register({editorUnitId:t,initialSnapshot:C,cancelDefaultResizeListener:r,isSheetEditor:a,canvasStyle:o,isSingle:l,readonly:A,isSingleChoice:p,onlyInputFormula:c,onlyInputRange:u,onlyInputContent:g,openForSheetUnitId:f,openForSheetSubUnitId:S,isFormulaEditor:d},e);b.setValueNoRefresh(s||"",t),x(T||"");let O=(0,h.debounce)(e=>{Q(e),v&&v(e)},30),M=(0,h.debounce)(e=>{let n=e.getEditorId(),i=b.checkValueLegality(n);setTimeout(()=>{let t=e.getBoundingClientRect();_([t.left,t.top-16]),t.left+t.top>0&&D(i),e.onlyInputFormula()?B(y.t("textEditor.formulaError")):B(y.t("textEditor.rangeError"))},160),b.getValue(n)!==s&&(E&&E(i),I&&I(b.getValue(t)))},30),N=b.focusStyle$.subscribe(n=>{let i=!1;n===t&&(i=!0),O(i),setTimeout(()=>{if(eh(e)){let e=b.getEditor(t);e&&M(e)}else D(!0)},160)}),P=b.valueChange$.subscribe(e=>{if(e.isSheetEditor()||e.getEditorId()!==t)return;let n=b.getFocusEditor();n&&n.getEditorId()!==t||M(e)});return()=>{m.unobserve(e),m.disconnect(),R.dispose(),null==N||N.unsubscribe(),null==P||P.unsubscribe()}},[]),(0,m.useEffect)(()=>{let e=b.getEditor(t);null!=e&&e.update({readonly:A,isSingle:l,isSingleChoice:p,onlyInputContent:g,onlyInputFormula:c,onlyInputRange:u,openForSheetSubUnitId:S,openForSheetUnitId:f})},[A,l,p,g,c,u,S,f]),(0,m.useEffect)(()=>{null!=s&&b.setValueNoRefresh(s,t)},[s]),(0,m.useEffect)(()=>{D(C)},[C]),w(F,"hasValue");let L=Object.fromEntries(Object.entries(e).filter(([e])=>!tt.has(e))),k=e7.textEditorContainer;null!=e.className&&(k=e.className);let H="";return null==e.className&&(A?H=` ${e7.textEditorContainerDisabled}`:M?P&&(H=` ${e7.textEditorContainerActive}`):H=` ${e7.textEditorContainerError}`),/* @__PURE__ */eu.jsx(eu.Fragment,{children:/* @__PURE__ */eu.jsxs("div",{...L,className:k+H,ref:U,children:[/* @__PURE__ */eu.jsx("div",{style:{display:M?"none":"block"},className:e7.textEditorValidationError,children:O}),/* @__PURE__ */eu.jsx("div",{style:{display:F()?"none":"unset"},className:e7.textEditorContainerPlaceholder,children:R})]})})}w(tn,"TextEditor");var ti=function(){return(ti=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},tr=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},ta=(0,m.forwardRef)(function(e,t){var n=e.icon,i=e.id,r=e.className,a=e.extend,o=tr(e,["icon","id","className","extend"]),s="univerjs-icon univerjs-icon-".concat(i," ").concat(r||"").trim(),l=(0,m.useRef)("_".concat(tA()));return to(n,"".concat(i),{defIds:n.defIds,idSuffix:l.current},ti({ref:t,className:s},o),a)});function to(e,t,n,i,r){return(0,m.createElement)(e.tag,ti(ti({key:t},ts(e,n,r)),i),(tl(e,n).children||[]).map(function(i,a){return to(i,"".concat(t,"-").concat(e.tag,"-").concat(a),n,void 0,r)}))}function ts(e,t,n){var i=ti({},e.attrs);null!=n&&n.colorChannel1&&"colorChannel1"===i.fill&&(i.fill=n.colorChannel1);var r=t.defIds;return r&&0!==r.length&&("use"===e.tag&&i["xlink:href"]&&(i["xlink:href"]=i["xlink:href"]+t.idSuffix),Object.entries(i).forEach(function(e){var n=e[0],r=e[1];"string"==typeof r&&(i[n]=r.replace(/url\(#(.*)\)/,"url(#$1".concat(t.idSuffix,")")))})),i}function tl(e,t){var n,i=t.defIds;return i&&0!==i.length&&"defs"===e.tag&&!(null===(n=e.children)||void 0===n)&&n.length?ti(ti({},e),{children:e.children.map(function(e){return"string"==typeof e.attrs.id&&i&&i.indexOf(e.attrs.id)>-1?ti(ti({},e),{attrs:ti(ti({},e.attrs),{id:e.attrs.id+t.idSuffix})}):e})}):e}function tA(){return Math.random().toString(36).substring(2,8)}w(to,"render"),w(ts,"replaceRuntimeIdsAndExtInAttrs"),w(tl,"replaceRuntimeIdsInDefs"),w(tA,"generateShortUuid"),ta.displayName="UniverIcon";var td={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641 14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004 14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999z"}}]},tc=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"align-text-both-single",ref:t,icon:td}))});tc.displayName="AlignTextBothSingle";var tu={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.71274 2.86421C3.47843 2.6299 3.09853 2.6299 2.86421 2.86421C2.6299 3.09853 2.6299 3.47843 2.86421 3.71274L7.15154 8.00007L2.86421 12.2874C2.6299 12.5217 2.6299 12.9016 2.86421 13.1359C3.09853 13.3702 3.47843 13.3702 3.71274 13.1359L8.00007 8.84859L12.2874 13.1359C12.5217 13.3702 12.9016 13.3702 13.1359 13.1359C13.3702 12.9016 13.3702 12.5217 13.1359 12.2874L8.84859 8.00007L13.1359 3.71274C13.3702 3.47843 13.3702 3.09853 13.1359 2.86421C12.9016 2.6299 12.5217 2.6299 12.2874 2.86421L8.00007 7.15154L3.71274 2.86421Z"}}]},th=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"close-single",ref:t,icon:tu}))});th.displayName="CloseSingle";var tg={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993.866699 5.9313.866699H10.069C10.4004.866699 10.669 1.13533 10.669 1.4667 10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667zM1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443 14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443zM6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928 9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171 10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778 9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539 9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263 6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539 5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778 6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},tp=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"delete-single",ref:t,icon:tg}))});tp.displayName="DeleteSingle";var tm={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641 2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641 13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004 2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004 13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315z"}}]},tf=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"horizontally-single",ref:t,icon:tm}))});tf.displayName="HorizontallySingle";var tS={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},tI=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"increase-single",ref:t,icon:tS}))});tI.displayName="IncreaseSingle";var tv={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641 11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004 11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999z"}}]},tE=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"left-justifying-single",ref:t,icon:tv}))});tE.displayName="LeftJustifyingSingle";var tC={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641 4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641 14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004 4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004 14.6 13.169 14.3314 12.9004 14 12.9004H4.66665z"}}]},tT=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"right-justifying-single",ref:t,icon:tC}))});tT.displayName="RightJustifyingSingle";var tb={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M12.6185 12.4423C12.5907 12.2749 12.7773 12.15 12.9343 12.2308L15.4242 13.5126C15.6102 13.6084 15.5544 13.8745 15.3439 13.8955L14.2456 14.184L13.4521 15.1286C13.3495 15.2939 13.085 15.2463 13.0534 15.0568L12.6185 12.4423Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1 3.6C1 2.16406 2.16406 1 3.6 1H12.3C13.7359 1 14.9 2.16406 14.9 3.6V5.81156C14.9003 5.81881 14.9004 5.82609 14.9004 5.8334C14.9004 5.84071 14.9003 5.84799 14.9 5.85524V10.045C14.9003 10.0522 14.9004 10.0595 14.9004 10.0668C14.9004 10.3982 14.6318 10.6668 14.3004 10.6668H11.1668C10.8907 10.6668 10.6668 10.8907 10.6668 11.1668V14.3C10.6668 14.6314 10.3982 14.9 10.0668 14.9L10.05 14.8998L3.6 14.9C2.16406 14.9 1 13.7359 1 12.3V3.6ZM13.2 5.2334C13.4761 5.2334 13.7 5.00954 13.7 4.7334V3.6C13.7 2.8268 13.0732 2.2 12.3 2.2H11.1668C10.8907 2.2 10.6668 2.42386 10.6668 2.7V4.7334C10.6668 5.00954 10.8907 5.2334 11.1668 5.2334H13.2ZM10.6668 6.9334C10.6668 6.65726 10.8907 6.4334 11.1668 6.4334H13.2C13.4761 6.4334 13.7 6.65726 13.7 6.9334V8.9668C13.7 9.24294 13.4761 9.4668 13.2 9.4668H11.1668C10.8907 9.4668 10.6668 9.24294 10.6668 8.9668V6.9334ZM8.9668 5.2334C9.24294 5.2334 9.4668 5.00954 9.4668 4.7334V2.7C9.4668 2.42386 9.24294 2.2 8.9668 2.2H6.9334C6.65726 2.2 6.4334 2.42386 6.4334 2.7V4.7334C6.4334 5.00954 6.65726 5.2334 6.9334 5.2334L8.9668 5.2334ZM6.4334 6.9334C6.4334 6.65726 6.65726 6.4334 6.9334 6.4334L8.9668 6.4334C9.24294 6.4334 9.4668 6.65726 9.4668 6.9334V8.9668C9.4668 9.24294 9.24294 9.4668 8.9668 9.4668L6.9334 9.4668C6.65726 9.4668 6.4334 9.24294 6.4334 8.9668V6.9334ZM4.7334 5.2334C5.00954 5.2334 5.2334 5.00954 5.2334 4.7334V2.7C5.2334 2.42386 5.00954 2.2 4.7334 2.2H3.6C2.8268 2.2 2.2 2.8268 2.2 3.6V4.7334C2.2 5.00954 2.42386 5.2334 2.7 5.2334H4.7334ZM2.2 6.9334C2.2 6.65726 2.42386 6.4334 2.7 6.4334H4.7334C5.00954 6.4334 5.2334 6.65725 5.2334 6.9334V8.9668C5.2334 9.24294 5.00954 9.4668 4.7334 9.4668H2.7C2.42386 9.4668 2.2 9.24294 2.2 8.9668V6.9334ZM5.2334 11.1668C5.2334 10.8907 5.00954 10.6668 4.7334 10.6668H2.7C2.42386 10.6668 2.2 10.8907 2.2 11.1668V12.3C2.2 13.0732 2.8268 13.7 3.6 13.7H4.7334C5.00954 13.7 5.2334 13.4761 5.2334 13.2V11.1668ZM9.4668 11.1668C9.4668 10.8907 9.24294 10.6668 8.9668 10.6668H6.9334C6.65726 10.6668 6.4334 10.8907 6.4334 11.1668V13.2C6.4334 13.4761 6.65726 13.7 6.9334 13.7H8.9668C9.24294 13.7 9.4668 13.4761 9.4668 13.2V11.1668Z",fillRule:"evenodd",clipRule:"evenodd"}}]},ty=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"select-range-single",ref:t,icon:tb}))});ty.displayName="SelectRangeSingle";var tR={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263 4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837 1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263.880874 2.97695.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116zM14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689 6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689 15.0605 2.83552 14.7918 2.56689 14.4605 2.56689zM6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334 6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334 15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981zM6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999 15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999.939453 6.76549.939453 7.83324.939453 8.90099 1.80504 9.76657 2.87279 9.76657 3.94054 9.76657 4.80612 8.90099 4.80612 7.83324 4.80612 6.76549 3.94054 5.8999 2.87279 5.8999zM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999 3.2778 7.0999 3.60612 7.42823 3.60612 7.83324 3.60612 8.23824 3.2778 8.56657 2.87279 8.56657 2.46778 8.56657 2.13945 8.23824 2.13945 7.83324zM.939453 12.5002C.939453 11.4325 1.80504 10.5669 2.87279 10.5669 3.94054 10.5669 4.80612 11.4325 4.80612 12.5002 4.80612 13.568 3.94054 14.4336 2.87279 14.4336 1.80504 14.4336.939453 13.568.939453 12.5002zM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002 2.13945 12.9052 2.46778 13.2336 2.87279 13.2336 3.2778 13.2336 3.60612 12.9052 3.60612 12.5002 3.60612 12.0952 3.2778 11.7669 2.87279 11.7669z",fillRule:"evenodd",clipRule:"evenodd"}}]},tx=(0,m.forwardRef)(function(e,t){return(0,m.createElement)(ta,Object.assign({},e,{id:"todo-list",ref:t,icon:tR}))});function tO(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e){if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=tO(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n)}return i}function tB(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=tO(e))&&(i&&(i+=" "),i+=t);return i}tx.displayName="TodoList",w(tO,"r"),w(tB,"clsx");let tM=class extends h.Disposable{constructor(){super(...arguments),F(this,"_currentSelectorId"),F(this,"_selectionChange$",new x.Subject),F(this,"selectionChange$",this._selectionChange$.asObservable()),F(this,"_openSelector$",new x.Subject),F(this,"openSelector$",this._openSelector$.asObservable()),F(this,"_selectorModalVisible$",new I.BehaviorSubject(!1)),F(this,"selectorModalVisible$",this._selectorModalVisible$.asObservable())}get selectorModalVisible(){return this._selectorModalVisible$.getValue()}setCurrentSelectorId(e){this._currentSelectorId=e}getCurrentSelectorId(){return this._currentSelectorId}selectionChange(e){this._currentSelectorId&&this._selectionChange$.next(e)}openSelector(){this._openSelector$.next(null)}triggerModalVisibleChange(e){this._selectorModalVisible$.next(e)}};w(tM,"RangeSelectorService");let tD=(0,h.createIdentifier)("univer.range-selector.service"),tN={rangeSelector:"univer-range-selector",rangeSelectorEditor:"univer-range-selector-editor",rangeSelectorIcon:"univer-range-selector-icon",rangeSelectorActive:"univer-range-selector-active",rangeSelectorError:"univer-range-selector-error",rangeSelectorDisabled:"univer-range-selector-disabled",rangeSelectorModal:"univer-range-selector-modal",rangeSelectorModalContainer:"univer-range-selector-modal-container",rangeSelectorModalContainerInput:"univer-range-selector-modal-container-input",rangeSelectorModalContainerInputActive:"univer-range-selector-modal-container-input-active",rangeSelectorModalContainerButton:"univer-range-selector-modal-container-button",rangeSelectorModalContainerDeleteButton:"univer-range-selector-modal-container-delete-button",rangeSelectorModalAdd:"univer-range-selector-modal-add",rangeSelectorModalAddButton:"univer-range-selector-modal-add-button"},t_={pointerEvents:"none"};w(function(e){let{dialogOnly:t,onChange:n,id:i,value:r="",width:a=220,placeholder:o="",size:s="middle",onActive:l,onValid:A,isSingleChoice:d=!1,openForSheetUnitId:c,openForSheetSubUnitId:u,isReadonly:g=!1,className:p,textEditorClassName:S,onSelectorVisibleChange:I}=e,v=(0,N.useEvent)(I),[E,C]=(0,m.useState)([""]),T=/* @__PURE__ */w(e=>{C(t=>[...t,e])},"addNewItem"),b=/* @__PURE__ */w(e=>{C(t=>t.filter((t,n)=>n!==e))},"removeItem"),y=/* @__PURE__ */w((e,t)=>{C(n=>n.map((n,i)=>i===e?t:n))},"changeItem"),R=/* @__PURE__ */w(e=>{C(t=>{let n=[...t];return n.length>0&&(n[n.length-1]=e),n})},"changeLastItem"),x=(0,h.useDependency)(e5),O=(0,h.useDependency)(tD),B=(0,h.useDependency)(h.IUniverInstanceService),[M,D]=(0,m.useState)(!1),_=(0,h.useDependency)(h.LocaleService),[P,Q]=(0,m.useState)(!1),[F,L]=(0,m.useState)(!0),[k,H]=(0,m.useState)(r),[V,j]=(0,m.useState)(-1),W=(0,m.useRef)(null),z=(0,m.useRef)(-1),G=(0,m.useRef)(c),Y=(0,m.useRef)(u),K=(0,m.useRef)(d),q=(0,m.useRef)(g);function X(){D(!1),v(!1),O.setCurrentSelectorId(null)}function J(){!0!==q.current&&(x.closeRangePrompt(),O.setCurrentSelectorId(i),D(!0),v(!0),k.length>0?C(F?k.split(","):[""]):O.openSelector())}function Z(e){Q(e),l&&l(e)}function $(e){L(e),A&&A(e)}function ee(){if(!0===q.current){X();return}let e="",t=E.filter(e=>(0,f.isReferenceStringWithEffectiveColumn)(e.trim()));if(1===t.length){let n=t[0];(0,f.isReferenceStringWithEffectiveColumn)(n.trim())&&(e=n.trim())}else e=t.join(",");x.setValue(e,i),ei(e),X()}function et(){T(""),j(-1)}function en(e){var t,n;return(null==(n=null==(t=B.getCurrentUnitForType(h.UniverInstanceType.UNIVER_SHEET))?void 0:t.getSheetBySheetName(e))?void 0:n.getSheetId())||""}function ei(e){if(H(e||""),null==e){n&&n([]);return}let t=(0,f.getRangeWithRefsString)(e,en);n&&n(t||[])}(0,m.useEffect)(()=>{let e=W.current;if(!e)return;let t=new ResizeObserver(()=>{x.resize(i)});t.observe(e);let n=1,r=O.selectionChange$.subscribe(e=>{if(O.getCurrentSelectorId()!==i)return;if(0===e.length){n=0;return}let t=e.length-n;if(n=e.length,t<0)return;let r=e[e.length-1],a="";a=r.unitId===G.current&&r.sheetId===Y.current?(0,f.serializeRange)(r.range):r.unitId===G.current?(0,f.serializeRangeWithSheet)(r.sheetName,r.range):(0,f.serializeRangeWithSpreadsheet)(r.unitId,r.sheetName,r.range),t>=1&&!K.current?(T(a),j(-1)):-1===z.current?R(a):y(z.current,a)});return()=>{r.unsubscribe(),t.unobserve(e)}},[]),(0,m.useEffect)(()=>{O.triggerModalVisibleChange(M)},[v,O,M]),(0,m.useEffect)(()=>()=>{O.triggerModalVisibleChange(!1)},[O]),(0,m.useEffect)(()=>{G.current=c,Y.current=u,K.current=d,q.current=g},[c,u,d,g]),(0,m.useEffect)(()=>{z.current=V},[V]),w(X,"handleCloseModal"),w(J,"handleOpenModal"),w(Z,"onEditorActive"),w($,"onEditorValid"),w(ee,"handleConform"),w(et,"handleAddRange"),w(en,"getSheetIdByName"),w(ei,"handleTextValueChange");let er=tN.rangeSelector;g?er=`${tN.rangeSelector} ${tN.rangeSelectorDisabled}`:F?P&&(er=`${tN.rangeSelector} ${tN.rangeSelectorActive}`):er=`${tN.rangeSelector} ${tN.rangeSelectorError}`,S&&(er=`${er} ${S}`);let ea=28;return"mini"===s?ea=20:"small"===s?ea=24:"large"===s&&(ea=32),/* @__PURE__ */eu.jsxs(eu.Fragment,{children:[/* @__PURE__ */eu.jsxs("div",{className:er,ref:W,style:{width:a,height:ea,cursor:t?"pointer":void 0},onClickCapture:/* @__PURE__ */w(e=>{t&&(e.stopPropagation(),e.preventDefault(),J())},"onClickCapture"),children:[/* @__PURE__ */eu.jsx(tn,{style:t?t_:void 0,placeholder:o,value:r,isReadonly:g,isSingleChoice:d,openForSheetUnitId:c,openForSheetSubUnitId:u,onValid:$,onActive:Z,onChange:ei,id:i,onlyInputRange:!0,canvasStyle:{fontSize:10},className:tN.rangeSelectorEditor}),/* @__PURE__ */eu.jsx(U.Tooltip,{title:_.t("rangeSelector.buttonTooltip"),placement:"bottom",children:/* @__PURE__ */eu.jsx("button",{type:"button",className:tN.rangeSelectorIcon,onClick:J,children:/* @__PURE__ */eu.jsx(ty,{})})})]}),/* @__PURE__ */eu.jsx(U.Dialog,{width:"328px",visible:M,title:_.t("rangeSelector.title"),draggable:!0,closeIcon:/* @__PURE__ */eu.jsx(th,{}),footer:/* @__PURE__ */eu.jsxs("footer",{children:[/* @__PURE__ */eu.jsx(U.Button,{onClick:X,children:_.t("rangeSelector.cancel")}),/* @__PURE__ */eu.jsx(U.Button,{style:{marginLeft:10},onClick:ee,type:"primary",children:_.t("rangeSelector.confirm")})]}),onClose:X,children:/* @__PURE__ */eu.jsxs("div",{className:tB(tN.rangeSelectorModal,p),children:[E.map((e,t)=>/* @__PURE__ */eu.jsxs("div",{className:tN.rangeSelectorModalContainer,children:[/* @__PURE__ */eu.jsx("div",{style:{width:1===E.length?"280px":"252px"},className:tN.rangeSelectorModalContainerInput,children:/* @__PURE__ */eu.jsx(U.Input,{className:V===t||E.length-1===t&&-1===V?tN.rangeSelectorModalContainerInputActive:"",placeholder:_.t("rangeSelector.placeHolder"),affixWrapperStyle:{width:"100%"},onClick:/* @__PURE__ */w(()=>j(t),"onClick"),value:e,onChange:/* @__PURE__ */w(e=>y(t,e),"onChange")},`input${t}`)}),/* @__PURE__ */eu.jsx("div",{style:{display:1===E.length?"none":"inline-block"},className:tN.rangeSelectorModalContainerButton,children:/* @__PURE__ */eu.jsx(tp,{className:tN.rangeSelectorModalContainerDeleteButton,onClick:/* @__PURE__ */w(()=>b(t),"onClick")})})]},t)),/* @__PURE__ */eu.jsx("div",{style:{display:d?"none":"unset"},className:tN.rangeSelectorModalAdd,children:/* @__PURE__ */eu.jsxs(U.Button,{type:"link",size:"small",onClick:et,className:tN.rangeSelectorModalAddButton,children:[/* @__PURE__ */eu.jsx(tI,{}),/* @__PURE__ */eu.jsx("span",{children:_.t("rangeSelector.addAnotherRange")})]})})]})})]})},"RangeSelector");let tU="COMPONENT_DOC_HEADER_FOOTER_PANEL",tP={panel:"univer-panel",optionsSection:"univer-options-section",optionsFormItem:"univer-options-form-item",optionsInput:"univer-options-input",optionsMarginSetting:"univer-options-margin-setting"};function tQ(e,t,n){let{useFirstPageHeaderFooter:i,evenAndOddHeaders:r,defaultHeaderId:a,defaultFooterId:o,firstPageHeaderId:s,firstPageFooterId:l,evenPageHeaderId:A,evenPageFooterId:d}=e;return t===p.DocumentEditArea.HEADER?i===h.BooleanNumber.TRUE&&0===n?s:r===h.BooleanNumber.TRUE&&n%2==1?A:a:i===h.BooleanNumber.TRUE&&0===n?l:r===h.BooleanNumber.TRUE&&n%2==1?d:o}w(tQ,"getSegmentId");let tw=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.LocaleService),n=(0,h.useDependency)(h.IUniverInstanceService),i=(0,h.useDependency)(p.IRenderManagerService),r=(0,h.useDependency)(h.ICommandService),a=(0,h.useDependency)(N.ILayoutService),{unitId:o}=e,s=i.getRenderById(o).with(e0),[l,A]=(0,m.useState)({}),d=/* @__PURE__ */w((e,t)=>{var l;A(n=>({...n,[t]:e?h.BooleanNumber.TRUE:h.BooleanNumber.FALSE}));let d=n.getUniverDocInstance(o),c=null==d?void 0:d.getSnapshot().documentStyle,u=null==(l=i.getRenderById(o))?void 0:l.with(g.DocSkeletonManagerService),m=null==u?void 0:u.getViewModel();if(null==c||null==m)return;let f=m.getEditArea(),S=!1,I=s.getSegmentPage(),v=!1;if("useFirstPageHeaderFooter"===t&&!0===e&&((f!==p.DocumentEditArea.HEADER||c.firstPageHeaderId)&&(f!==p.DocumentEditArea.FOOTER||c.firstPageFooterId)||(S=!0),S&&0===I&&(v=!0)),"evenAndOddHeaders"===t&&!0===e&&((f!==p.DocumentEditArea.HEADER||c.evenPageHeaderId)&&(f!==p.DocumentEditArea.FOOTER||c.evenPageFooterId)||(S=!0),S&&I%2==1&&(v=!0)),S){let n=(0,h.Tools).generateRandomId(6);v&&s.setSegment(n),r.executeCommand(t$,{unitId:o,segmentId:n,headerFooterProps:{[t]:e?h.BooleanNumber.TRUE:h.BooleanNumber.FALSE}})}else{let n=s.getSegmentPage(),i=s.getSegment(),a=tQ({...c,[t]:e?h.BooleanNumber.TRUE:h.BooleanNumber.FALSE},f,n);a&&a!==i&&s.setSegment(a),r.executeCommand(t$,{unitId:o,headerFooterProps:{[t]:e?h.BooleanNumber.TRUE:h.BooleanNumber.FALSE}})}a.focus()},"handleCheckboxChange"),c=/* @__PURE__ */w(async(e,t)=>{A(n=>({...n,[t]:e})),await r.executeCommand(t$,{unitId:o,headerFooterProps:{[t]:e}}),s.removeAllRanges(),s.blur()},"handleMarginChange"),u=/* @__PURE__ */w(()=>{r.executeCommand(t9.id,{unitId:o})},"closeHeaderFooter");return(0,m.useEffect)(()=>{let e=n.getUniverDocInstance(o),t=null==e?void 0:e.getSnapshot().documentStyle;if(t){let{marginHeader:e=0,marginFooter:n=0,useFirstPageHeaderFooter:i=h.BooleanNumber.FALSE,evenAndOddHeaders:r=h.BooleanNumber.FALSE}=t;A({marginHeader:e,marginFooter:n,useFirstPageHeaderFooter:i,evenAndOddHeaders:r})}},[o]),/* @__PURE__ */eu.jsxs("div",{className:tP.options,children:[/* @__PURE__ */eu.jsxs("div",{className:tP.optionsSection,children:[/* @__PURE__ */eu.jsx("div",{className:tP.optionsFormItem,children:/* @__PURE__ */eu.jsx(U.Checkbox,{checked:l.useFirstPageHeaderFooter===h.BooleanNumber.TRUE,onChange:/* @__PURE__ */w(e=>{d(e,"useFirstPageHeaderFooter")},"onChange"),children:t.t("headerFooter.firstPageCheckBox")})}),/* @__PURE__ */eu.jsx("div",{className:tP.optionsFormItem,children:/* @__PURE__ */eu.jsx(U.Checkbox,{checked:l.evenAndOddHeaders===h.BooleanNumber.TRUE,onChange:/* @__PURE__ */w(e=>{d(e,"evenAndOddHeaders")},"onChange"),children:t.t("headerFooter.oddEvenCheckBox")})})]}),/* @__PURE__ */eu.jsxs("div",{className:tB(tP.optionsSection,tP.optionsMarginSetting),children:[/* @__PURE__ */eu.jsxs("div",{className:tP.optionsMarginItem,children:[/* @__PURE__ */eu.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),/* @__PURE__ */eu.jsx(U.InputNumber,{min:0,max:200,precision:1,value:l.marginHeader,onChange:/* @__PURE__ */w(e=>{c(e,"marginHeader")},"onChange"),className:tP.optionsInput})]}),/* @__PURE__ */eu.jsxs("div",{className:tP.optionsMarginItem,children:[/* @__PURE__ */eu.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),/* @__PURE__ */eu.jsx(U.InputNumber,{min:0,max:200,precision:1,value:l.marginFooter,onChange:/* @__PURE__ */w(e=>{c(e,"marginFooter")},"onChange"),className:tP.optionsInput})]})]}),/* @__PURE__ */eu.jsx("div",{className:tP.optionsSection,children:/* @__PURE__ */eu.jsx(U.Button,{onClick:u,children:t.t("headerFooter.closeHeaderFooter")})})]})},"DocHeaderFooterOptions"),tF=/* @__PURE__ */w(()=>{var e;let t=(0,h.useDependency)(h.LocaleService),n=(0,h.useDependency)(p.IRenderManagerService),i=(0,h.useDependency)(h.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),r=(null==(e=n.getRenderById(i))?void 0:e.with(g.DocSkeletonManagerService)).getViewModel(),[a,o]=(0,m.useState)(!0);return(0,m.useEffect)(()=>{o(r.getEditArea()!==p.DocumentEditArea.BODY);let e=r.editAreaChange$.subscribe(e=>{null!=e&&o(e!==p.DocumentEditArea.BODY)});return()=>{e.unsubscribe()}},[]),/* @__PURE__ */eu.jsx("div",{className:tP.panel,children:a?/* @__PURE__ */eu.jsx(tw,{unitId:i}):/* @__PURE__ */eu.jsx("div",{className:tP.panelDisableText,children:t.t("headerFooter.disableText")})})},"DocHeaderFooterPanel");function tL(e,t){let{radius:n,width:i,height:r}=t,a=0;a=Math.min(n=null!=n?n:0,(i=null!=i?i:30)/2,(r=null!=r?r:30)/2),e.beginPath(),e.moveTo(0,0),e.lineTo(i,0),e.lineTo(i,r-a),e.arc(i-a,r-a,a,0,Math.PI/2,!1),e.lineTo(0,r),e.lineTo(0,0),e.closePath(),t.fill&&(e.save(),e.fillStyle=t.fill,"evenodd"===t.fillRule?e.fill("evenodd"):e.fill(),e.restore())}w(tL,"drawBubble");let tk=class e extends p.Shape{constructor(e,t){super(e,t),F(this,"color"),F(this,"text"),this.color=null==t?void 0:t.color,this.text=null==t?void 0:t.text}static drawWith(e,t){let{text:n,color:i}=t;e.save(),e.font="13px Source Han Sans CN";let r=e.measureText(n).width;if(tL(e,{height:18,width:Math.min(r+12,200),radius:4,fill:i,evented:!1}),e.fillStyle="rgba(58, 96, 247, 1)",r>188){let t="",i=0;for(let r of n){let n=e.measureText(r).width;if(i+n<=188-e.measureText("...").width)t+=r,i+=n;else{t+="...";break}}e.fillText(t,6,14)}else e.fillText(n,6,14);e.restore()}_draw(t){e.drawWith(t,this)}};w(tk,"TextBubbleShape");var tH=Object.defineProperty,tV=Object.getOwnPropertyDescriptor,tj=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?tV(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&tH(t,n,a),a},"__decorateClass$p"),tW=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$p");let tz="rgba(58, 96, 247, 1)",tG="rgba(58, 96, 247, 0.08)";var tY=((s=tY||{})[s.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",s[s.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",s[s.DEFAULT_HEADER=2]="DEFAULT_HEADER",s[s.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",s[s.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",s[s.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",s);function tK(e,t,n){let{documentStyle:i}=e.getDataModel().getSnapshot(),{defaultHeaderId:r,defaultFooterId:a,evenPageHeaderId:o,evenPageFooterId:s,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:c}=i;switch(t){case p.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case p.DocumentEditArea.HEADER:return c!==h.BooleanNumber.TRUE||l?d!==h.BooleanNumber.TRUE||n%2!=0||o?r?{createType:null,headerFooterId:r}:{createType:2,headerFooterId:null}:{createType:4,headerFooterId:null}:{createType:0,headerFooterId:null};case p.DocumentEditArea.FOOTER:return c!==h.BooleanNumber.TRUE||A?d!==h.BooleanNumber.TRUE||n%2!=0||s?a?{createType:null,headerFooterId:a}:{createType:3,headerFooterId:null}:{createType:5,headerFooterId:null}:{createType:1,headerFooterId:null};default:throw Error(`Invalid editArea: ${t}`)}}w(tK,"checkCreateHeaderFooterType");let tq=(w(ng=class extends h.Disposable{constructor(e,t,n,i,r,a,o,s,l){super(),F(this,"_loadedMap",/* @__PURE__ */new WeakSet),this._context=e,this._commandService=t,this._editorService=n,this._instanceSrv=i,this._renderManagerService=r,this._docSkeletonManagerService=a,this._docSelectionRenderService=o,this._localeService=s,this._componentManager=l,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(g.RichTextEditingMutation.id===e.id){let e=this._context.unit,t=this._docSkeletonManagerService.getViewModel().getEditArea(),n=e.getSnapshot().documentStyle.documentFlavor;t!==p.DocumentEditArea.BODY&&n===h.DocumentFlavor.MODERN&&this._commandService.executeCommand(t9.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(tU,tF))}_init(){let{unitId:e}=this._context,t=K(this._context);null==t||null==t.document||this._loadedMap.has(t.document)||(this._initialMain(e),this._loadedMap.add(t.document))}_initialMain(e){let{document:t}=K(this._context);this.disposeWithMe(t.onDblclick$.subscribeEvent(async n=>{if(this._isEditorReadOnly(e)||!this._isTraditionalMode())return;let{offsetX:i,offsetY:r}=n,{pageLayoutType:a=p.PageLayoutType.VERTICAL,pageMarginLeft:o,pageMarginTop:s}=t.getOffsetConfig(),l=this._getTransformCoordForDocumentOffset(i,r);if(null==l)return;let A=this._docSkeletonManagerService.getViewModel(),d=this._docSkeletonManagerService.getSkeleton(),c=A.getEditArea(),{editArea:u,pageNumber:g}=d.findEditAreaByCoord(l,a,o,s);if(c===u)return;A.setEditArea(u);let{createType:m,headerFooterId:f}=tK(A,u,g);if(u===p.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(i,r);else if(null!=m){let t=(0,h.Tools).generateRandomId(6);this._docSelectionRenderService.setSegment(t),this._docSelectionRenderService.setSegmentPage(g),await this._commandService.executeCommand(t0.id,{unitId:e,createType:m,segmentId:t})}else null!=f&&(this._docSelectionRenderService.setSegment(f),this._docSelectionRenderService.setSegmentPage(g),this._docSelectionRenderService.setCursorManually(i,r))}))}_getTransformCoordForDocumentOffset(e,t){let{document:n,scene:i}=K(this._context),{documentTransform:r}=n.getOffsetConfig(),a=i.getViewports()[0];if(null==a)return;let o=a.transformVector2SceneCoord((0,p.Vector2).FromArray([e,t]));return r.clone().invert().applyPoint(o)}_drawHeaderFooterLabel(){let e=this._localeService;this._renderManagerService.currentRender$.subscribe(t=>{if(null==t)return;let n=this._renderManagerService.getRenderById(t);if(this._editorService.isEditor(t)||null==this._instanceSrv.getUniverDocInstance(t)||!this._isTraditionalMode()||null==n)return;let{mainComponent:i}=n;this.disposeWithMe((0,h.toDisposable)(i.pageRender$.subscribe(n=>{if(this._editorService.isEditor(t))return;let i=this._docSkeletonManagerService.getViewModel().getEditArea()===p.DocumentEditArea.BODY,{page:r,pageLeft:a,pageTop:o,ctx:s}=n,{pageWidth:l,pageHeight:A,marginTop:d,marginBottom:c}=r;s.save(),s.translate(a-.5,o-.5),i?((0,p.Rect).drawWith(s,{left:0,top:0,width:l,height:d,fill:"rgba(255, 255, 255, 0.5)"}),s.save(),s.translate(0,A-c),(0,p.Rect).drawWith(s,{left:0,top:0,width:l,height:c,fill:"rgba(255, 255, 255, 0.5)"})):(s.save(),s.translate(0,d),(0,p.Rect).drawWith(s,{left:0,top:d,width:l,height:A-d-c,fill:"rgba(255, 255, 255, 0.5)"})),s.restore(),i||((0,p.Path).drawWith(s,{dataArray:[{command:"M",points:[0,d]},{command:"L",points:[l,d]}],strokeWidth:1,stroke:tz}),(0,p.Path).drawWith(s,{dataArray:[{command:"M",points:[0,A-c]},{command:"L",points:[l,A-c]}],strokeWidth:1,stroke:tz}),s.translate(0,d+1),tk.drawWith(s,{text:e.t("headerFooter.header"),color:tG}),s.translate(0,A-d-c),tk.drawWith(s,{text:e.t("headerFooter.footer"),color:tG})),s.restore()})))})}_isEditorReadOnly(e){let t=this._editorService.getEditor(e);return!!t&&t.isReadOnly()}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===h.DocumentFlavor.TRADITIONAL}_getDocDataModel(){return this._context.unit}},"DocHeaderFooterController"),ng);tq=tj([tW(1,h.ICommandService),tW(2,e5),tW(3,h.IUniverInstanceService),tW(4,p.IRenderManagerService),tW(5,(0,h.Inject)(g.DocSkeletonManagerService)),tW(6,(0,h.Inject)(e0)),tW(7,(0,h.Inject)(h.LocaleService)),tW(8,(0,h.Inject)(N.ComponentManager))],tq);let tX={id:"sidebar.operation.doc-header-footer-panel",type:h.CommandType.OPERATION,handler:/* @__PURE__ */w(async(e,t)=>{let n=e.get(N.ISidebarService),i=e.get(h.LocaleService);return"open"===t.value?n.open({header:{title:i.t("headerFooter.panel")},children:{label:tU},onClose:/* @__PURE__ */w(()=>{},"onClose"),width:400}):n.close(),!0},"handler")};function tJ(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function tZ(e,t,n,i){let r=(0,h.JSONX).getInstance(),a=null!=e?e:(0,h.Tools).generateRandomId(6),o=t===tY.DEFAULT_HEADER||t===tY.FIRST_PAGE_HEADER||t===tY.EVEN_PAGE_HEADER,s=r.insertOp([o?"headers":"footers",a],{[o?"headerId":"footerId"]:a,body:tJ()});i.push(s);let l=(0,h.Tools).generateRandomId(6),A=r.insertOp([o?"footers":"headers",l],{[o?"footerId":"headerId"]:l,body:tJ()});i.push(A);let d="defaultHeaderId",c="defaultFooterId";switch(t){case tY.DEFAULT_HEADER:d="defaultHeaderId",c="defaultFooterId";break;case tY.DEFAULT_FOOTER:d="defaultFooterId",c="defaultHeaderId";break;case tY.FIRST_PAGE_HEADER:d="firstPageHeaderId",c="firstPageFooterId";break;case tY.FIRST_PAGE_FOOTER:d="firstPageFooterId",c="firstPageHeaderId";break;case tY.EVEN_PAGE_HEADER:d="evenPageHeaderId",c="evenPageFooterId";break;case tY.EVEN_PAGE_FOOTER:d="evenPageFooterId",c="evenPageHeaderId";break;default:throw Error(`Unknown header footer type: ${t}`)}for(let[e,t]of[[d,a],[c,l]])if(null!=n[e]){let a=r.replaceOp(["documentStyle",e],n[e],t);i.push(a)}else{let n=r.insertOp(["documentStyle",e],t);i.push(n)}return i}w(tJ,"getEmptyHeaderFooterBody"),w(tZ,"createHeaderFooterAction");let t$="doc.command.core-header-footer",t0={id:t$,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n;let i=e.get(h.ICommandService),r=e.get(h.IUniverInstanceService),a=e.get(p.IRenderManagerService),{unitId:o,segmentId:s,createType:l,headerFooterProps:A}=t,d=null==(n=a.getRenderById(o))?void 0:n.with(g.DocSkeletonManagerService),c=r.getUniverDocInstance(o),u=null==d?void 0:d.getViewModel();if(null==c||null==u)return!1;let m=u.getEditArea(),{documentStyle:f}=c.getSnapshot(),S=(null==A?void 0:A.marginFooter)!=null||(null==A?void 0:A.marginHeader)!=null,I={id:g.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:[{startOffset:0,endOffset:0,collapsed:!0}],debounce:!0}};S&&(I.params.noNeedSetTextRange=!0);let v=(0,h.JSONX).getInstance(),E=[];return null!=l&&tZ(s,l,f,E),null!=A&&Object.keys(A).forEach(e=>{let t;let n=A[e],i=f[e];n===i||((t=void 0===i?v.insertOp(["documentStyle",e],n):v.replaceOp(["documentStyle",e],i,n),E.push(t),"useFirstPageHeaderFooter"!==e||n!==h.BooleanNumber.TRUE||f.firstPageHeaderId)?"evenAndOddHeaders"!==e||n!==h.BooleanNumber.TRUE||f.evenPageHeaderId||tZ(s,m===p.DocumentEditArea.HEADER?tY.EVEN_PAGE_HEADER:tY.EVEN_PAGE_FOOTER,f,E):tZ(s,m===p.DocumentEditArea.HEADER?tY.FIRST_PAGE_HEADER:tY.FIRST_PAGE_FOOTER,f,E))}),0!==E.length&&(I.params.actions=E.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!i.syncExecuteCommand(I.id,I.params))},"handler")},t1={id:"doc.command.open-header-footer-panel",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>e.get(h.ICommandService).executeCommand(tX.id,{value:"open"}),"handler")},t9={id:"doc.command.close-header-footer",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n;let i=e.get(h.ICommandService),r=e.get(p.IRenderManagerService),a=e.get(g.DocSelectionManagerService),{unitId:o}=t,s=r.getRenderById(o);if(null==s)return!1;let{scene:l}=s,A=l.getTransformerByCreate(),d=s.with(g.DocSkeletonManagerService),c=s.with(e0),u=null==d?void 0:d.getSkeleton(),m=null==d?void 0:d.getViewModel();return null!=m&&null!=u&&(a.replaceDocRanges([]),A.clearSelectedObjects(),c.setSegment(""),c.setSegmentPage(-1),m.setEditArea(p.DocumentEditArea.BODY),u.calculate(),null==(n=s.mainComponent)||n.makeDirty(!0),i.executeCommand(tX.id,{value:"close"}),!0)},"handler")},t3="UI_PLUGIN_DOCS",t2=`${t3}_COLOR_PICKER_COMPONENT`,t4=`${t3}_FONT_FAMILY_COMPONENT`,t6=`${t3}_FONT_FAMILY_ITEM_COMPONENT`,t8=`${t3}_FONT_SIZE_COMPONENT`,t5={docListTypePicker:"univer-doc-list-type-picker",docListTypePickerItem:"univer-doc-list-type-picker-item",docListTypePickerItemActive:"univer-doc-list-type-picker-item-active"},t7=/* @__PURE__ */w(e=>{let{value:t,onChange:n,options:i}=e;return /* @__PURE__ */eu.jsx("div",{className:t5.docListTypePicker,children:i.map(e=>/* @__PURE__ */eu.jsx("img",{className:t5.docListTypePickerItem+(t===e.value?` ${t5.docListTypePickerItemActive}`:""),onClick:/* @__PURE__ */w(()=>{n(e.value)},"onClick"),src:e.img},e.value))})},"ListTypePicker"),ne=[{value:h.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],nt=/* @__PURE__ */w(e=>/* @__PURE__ */eu.jsx(t7,{...e,options:ne}),"OrderListTypePicker"),nn=[{value:h.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEA2ADYAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/CABEIAPQA2AMBEQACEQEDEQH/xAA1AAEAAQUBAQEAAAAAAAAAAAAACgYHCAkLBQMEAQEAAwEBAQAAAAAAAAAAAAAAAwQFAgEG/9oADAMBAAIQAxAAAACfwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY8d832469EAAAAAAAAAAAGsueOJbo1p/8Aj3fuAAAAAAAAAACkPWuaeOJvoVp5OTcuPz6BiSAAAAAAAVcZEAAHO72aObsXc2fLtgCiwAAAAAAD9pU4ABaDry3vXmUMfQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAh26VXVVYjmyZdvYHD2AAAAAAAAAABq1sR8mD6HNEielP0wsO+KYLFAAAAAFTl9QAAAYrSc8hn6PMtL15MozLU8HJuDzChAAAAAD1CugAAADC6XjX9NxvBqTeiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYRS8R1rsEwbNtAAAAAAAAAAADCmXjlk7+fhFLxN7y7c27KtinyzoABUJeEAAAAAAFg++eXXvZ+rSxH0Nsa9Klz7A8UtiAAe0XOAAAAAAALB986RbUUjalOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABaXryFlqVJx+Vc9jwAAAAAAAAAAAIXepVkMUptlkEgFlwAAAAAAD2i5wAKQ9c7Tao3j496C+PdAGPoAAAAAABUJeEAA1G2Yqb9blqsoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH/xAAoEAABBAMAAgEDBAMAAAAAAAAGAAUHFwQICQoWECBAYAIDFTABGFD/2gAIAQEAAQgA/wC3J+3ep8JEuMFzOzvDQQtDW/sH3HXTfTB516PyhO+DwK5Fue+8iP3RPenFxcbCxsfDw/tpAN2KMwM0kco0C7EaQ9H3MiFoE6yS4T9mOyMLc9oXh+JgKB4sj2GIt+fZCJeyES9kIl7IRL2QiXshEvZCJeyES9kIl7IRL2QiXshEvZCJeyES9kIkCvbzmFTXj5f099uZh1zk2VYt/NOvEf07/c/V+zsLvmYfRXgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgeq8D1Xgem4NG2rM/Zz8D6Z9gmMNm4bkOBpm0v1SAdIdYIg1djT8u6ZeUuzwrIhVB+hkS+WF0QEDDHc5V5y9Itf+mEIfql+Evt+104l+unLPciUwL48XubyqNOqILGLT8GTjmNQ25Z+BYZgrDMFYZgrDMFYZgrDMFYZgrDMFYZgrDMFYZgg0yJHUkbcDP/o3h1jZ9y9R9gdYXmdYMlPWuWjmD5qXinc8jpxlol6HSJ8PLTjvjbkteXVA6qoHVVA6qoHVVA6qoHVVA6qoHVVA6qoHVVA6maPmZjcsZ0xP6du+eOme9rPgte0cT+OHyZikoxSz/DOztA81NrEwfl+/m/kCc6YEep0nTk35MH+xc9ksGbz/AHG/W+UG87NeyDYCcd/N/J76LT29TpOi8f7vdk5uSBaF7tfBU7ZDGw57piWuRK1yJWuRK1yJWuRIVkF5fH7Aa8v+7ZvWSFtwIWM4Bn7q5yjmnl9NP6holbGxye3JvZmbg1wabdRW0b2828+CFn/nmfMaVUKqFVCqhVQoejj+BeMN2+w2b1khbcCFjOAZ+5XePFC3PmaTafpJ/IZ4m6O9bYakyepZ1X6x9pevW6mbHunY7gOTUPsbW8/ceUju2Sm5BDfKmB+UHPQO5u6hAsKt3zbyt5W8reVvK3lbyt5W8reVvK3lbyt5W8h6R/554w2n6ZADG+RwM0j52ZNod8/G/wB6TWAi/wAfuIj3pR1WmfojsP8ARVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEqoIlVBEhWPnljfsB0y/p7JcwxTppq05hmBwh0Ue9DefUfBUhfk/wD/xAA6EAABBAECAwYEAgkEAwAAAAAEAgMFBgEABxITpREUlNTV5QgVldMQIBYhIiMkMDNAYBc0VHIYUHP/2gAIAQEACT8A/wDd/E98PG0dxNQK6HU9z96ttqDZS2juHITg0Fa7LEyj6DMLR3VbQq0kcaeVlfFjtlI6cgpyOBmISbhzhpOImIiTGaNjZSLkgnXw5COkA32SwThHnhixnmn2HXGnELz/AHBEcrdKTQxtxsTESLbJTMtu5bxzW4It6PfzhqRjqdGBzV/mo91TTcjD1U2Mw8gg4fChpjcradq6S0lSYLcEouaJ+IzdgWUy9Y7ne3ZbvBFm26q8th8M0Mpx0G8XFsuFk3H4Ks2ODmx2BAxGGhRBBWmxxhRh20tMDjsNJQ0ywy0hLbTTaUtttpShCcJxjGP7bEvmtUGqWG52HEBAzNpnMwlYiS5qV+T1qugyc/YJPuIT/cYaFjjpSSJ5YYAhBLzbSrvOQW49b55T21O68ZFUzcOYgR+LmWqrRAk/PA2iAYwntkXYSVNkIDDgqrHHQ6T4/JVlKJ2U2lvatpFTMCS0bF/PhFLn/iX3eYay5mOkl0atV+Ur0Jh5To5qKE87FEYbtTiXoEasbd7X1CCpFOghu1aQIGux7EcCl8hfa8ce+2x3qTky1OnSsk+VJHvvmlPvOfjPzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+p+a+qHff1PzX1Q77+peUKHc79zGCDy32V8EcYtHG066pCuFaUrTxJzwqSlWOzOMZ/MRY9t9ndx7vibbkdsyTasd8OO+JaXjHwIQ6BfGIr9PvakyMzUXQlCx0PIrnqRhgCLRVxZQHnkHv/8Aj7tOWakYh7PAuJuW7lhbyQh41t8h5yiQEdKjuDcxCLlHOrKw68hj8kR1CU87qI6hKed1EdQlPO6iOoSnndRHUJTzuojqEp53UR1CU87qI6hKed1EdQlPO6iOoSnndRHUJTzuojqEp53UR1CU87qI6hKed1EdQlPO6jeQWxzOU73w93g5rS2XP3bxTjSuJpxaf2kZ7O3tx2KxjOPy1kO3ba7nVs6s2eGLaZWvu5SUuBysW+8y/wDLLDASLQc7W5phvvsHPR0dLgrbMCZcSSZJVbaetrisTskOKLKWeelZM+xWy1SQ4eMDjmWS0S8vMuCNLeQCgxsFsh9sZDqv8uodN3YmKcefX7PvzuI5Jn7bKsAD7Q54m3NXrspDSFyj455JwKrdJT8RCmSI3PhIuxwChJeRo3w/7wUl0ptUtU26lNbeTKAMP4ceYrNugZ49qIOW1jI7J1grVyGZQrjcjCHcYXomRh5ivHDwO6G11mUIm57aWYll18UKWwE46JJwc2OOQdVbRHKzHzoTBTS2o6ci52DiP7cwyNtgu3ETRoiVjlZbkYZW8F9qOz5k3HEJWhwM+Fj72XKBHsLSTHlCNGjZwQO3+Jbuax8Rm2u6+39ujFvv9yc/QuiTu80BM4ESru65aMkNuXYwE15GXRIywzorDiEyJCHvwe5BbHc+U7y2neDmnisufu3kONK4mnFp/aRns7e3HYrGM4l+nxfktS/T4vyWpfp8X5LUv0+L8lqX6fF+S1L9Pi/Jal+nxfktS/T4vyWpfp8X5LUv0+L8lqX6fF+S1Jc8R/vnNa7mA1x8oAp5v94yK26nhdbQr9leO3s7M9qc5xn+QULHJ3h22nK1CzBzbzwNfubKWpmg2Ywcf+IJFrF4i69YCBWex0pmNWO2pKnMKxT5Wi7l7dzhMDZq7LMLadZfZ7HBjwH8pwzJwcwE4PLQM2Ct6Nm4cwKUjiCAi2Hl6r0jA7d1Gq2PbvYR+TFeCVerlaeKDu9xg8vN4UZWahW2pmnuSDSe5SdhsxogRjhVUmRW/wAFvtjlcnmLHU2h7HIfaIRwKdbeRjtWynCuJtXanKsY7M5wrBs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07Rs14gH07RMo4QLzuWgh4RbOeew6OvjS0EyvPYh5WU8LiexWE5z24xlOf5Ow9Q3LNhxnRa/b1Zk6xuFXB3cuOd1hNwakfB28OM7y5312CzMO180xtp6RijMt4xrYCY3JOAfUQBGbsbi2+5VdhxSeHCSqpmRj69OMITlXCLZI6ZGypXGtpbiGlNxcdBwcMCLGRENDgjRkVFRoLKBwo+NjgmmBAQRB222BRBWWmB2UIaabQhKU4/y+a/5EVt9t9FEDfpnunc+7KeCqlUCeV/0InJwhHyqtRXMkpJz/AGwxYlI2s/1Tu5ZPw+bhQSPlFMqvzclDMLszfDTXf/iPV9xZBbHzKVfejbIkTvcYUz/cST6gx3/kNFpEQppVq3MvhYRhkPTK0y72tNvlNBFGSkuXhMdAQwh0qcpSR2xyJr/kRW3u3sUQT+hm1lM7yp4Kq1UJ5X/QicnCEfNbLK8ySknP9qKJq2PlllvxVM+HHfiwFOEEkkkOMxte2i3Nk31LdefedWNFUG5mOKcccULWLC8pSouS/FDLhAvdeWghLi2c88wcdfGlpxleexDysp4XE9isJzntxjKchQvhzvUdBQvhzvUdBQvhzvUdBQvhzvUdBQvhzvUdDRjY5XeuYsdktD2OQGQQjgU6a8jHatlOFcTau1OVYx2ZzhWP51MBu+3F3ByOcCRjDMlDyTOFqirPWJVKFFQFpgClYNhZoLKSBCE5bcw+G+UKQk677E3c48jZTescDLMbZ41nOX11izoYwoWA3FgBVITNQqlpHkh0pnoFT8W+tAUedLzEucJGRUVGCEHyUnJHkNigx8eCK26UacaU60MIIM06QSQ62yy2txaU5rYMv8UsuC1J7cbcSbQ58b8PMaeP2tyEg3nmim7wmiu5QWWjLo9DHdci4txc4uQkGPwI7p3vu/8AEcnn8vkFME/0uazxcXJ4P6ieHi4v19nDmw9J9z1Yek+56sPSfc9WHpPuerD0n3PUz3vuneP4f5dyOZzxXxv6vfnuHh53H/TVxcPD+rt4sfz6YDd9uLuDkc4EjGGZKHkmcLVFWesSqUKKgLTAFKwbCzQWUkCEJy25h8N8oUi3g/EHuPE2mWH+HY6TgcARu19JXnKY6zyEURzRTd4TRXXAi5sTGYmuDtuOVlKDJJ4oX/IZn5BtztPT5q7W2SQ2kgvEZDCrI7jFh5cazIzksRhiJgYlpxJEtMnARo3aQU1jN5pPwp7FwRjViuhbW0u3G5sFtVtamT7qEbdrLuPVJ6bue4E+02sCIgKudSmrPMpOejw6rW4qbm4OdKtMxGw8YBLWY4KMjTrHJBhMDnTpkdCiAQwBUuU27IEBRIIUYK8QtgAQcVtplH9w2dY7tuLY6Jdd3oavPc+SnJidmEgbHbN90RngeOnLA+Dfzo8hTTqX2NtTB18osjGRIozdOcFDuu/t1BQl5227qSoA+ZgcaRU20QTVqejhqlNaU0K1mGjcTDoI8xOTLpP417q3tmq91b2zVe6t7ZqvdW9s1Xure2ar3VvbNV7q3tmq91b2zVe6t7ZqvdW9s1Xure2ar3VvbNV7q3tmq91b2zVe6t7ZqG7p3vvH8R8x5/L5Ar5P9LuLPFxcng/qJ4eLi/X2cOfySdkhYu81Sw1CSmKbYZSo26KBskSXDlyVXtUI+LMVuwgsGLJhpyLJYPipBoc4R1DzCM4mLDvr8Nk3L/paLSrhIGgVbejbiZeKRC7nbeTZ7E87t7uGMpJMTa8w+JGKXaYiTg7MBZQ4+DlWErsuNmpEvd2QKdEYcgSN7txHJGC2qrgQ5bmXB4fbusx1gnqsyBh5dbJo9HYdWwy4L3j8hsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RsL4g707RMY4OL3rmIHeLW9nnhkDo4EuhMoz2LeTlXE4nsThWcducYTn8rMVD/EHtkiUt/w+3kxlpChLNkVtUnQZk7Lo62KfuQOEJDS7jjyx4WWYr9tUGe5XER5dbdrO9260vLby7yxZ7ISZeEsFnSKDWage6Mlb7btUosTWgZGLKKJ+W2l6z5a7v3p1hH+T/wD/xAA3EQACAQEFBQQIBQUAAAAAAAABAhEDBCExQVEAEkBhgSIycZEFEBNCYHKxwSNSodHwUGKCkuL/2gAIAQIBAT8A/ra06jCVpuw1VWI8wI2IIJBEEXEHEHQ8TZqPtqqp7vec6KMfO5RzM7Wy0iiooUey0AErduLFwGjEeQ5kEcOoLEKMWIAkgCSYEk3DxN21azVaEFwCp95ZKg6EwIPjjltZ1FlszVnHaYb0HGMEXqTJ8eWzMXYsxlmJJPM8TY64r0zRqwzKI7V++nOcSMD0Ou3pGr3KI+dvoo01PlxSO1NldTDKZH7HkcCMxtVqGrUao1xY4DIAQB0AA+L6FgLqHrErN4Qd6P7iZidImMSDcG9HUSIUup1kN5gi/oRtWoPQfdfA3qwwYcuYzGXhBPD2VA9opKcN4nx3QWjrHrt6BrOWzRlI6kKena/QcRSqeyqJU/KwJGowI6iRsjrUUOhlWEg/zAjMZH1ekKy7ooqZYkM/IC8DxJg+A58TTrVaR/DcrOIxU+KmR1idmttoYRv7vyqAfOJHQjbG8/GFGi9ZwiDxOSjU/YZ7Wiw7iB6UtujtqbyYxYfddMOJo0XrOETxJOCjMn9szdtRopQQIg+Zs2Op+wy9VssmNakNS6D9WX6kdRxFOo1Ng6GGH8g6g5jaz2hbQsi5x3l05jVTkcsDthebgMTta7X7WadMxTHeb8//AD9cTxNOo1Ng6GGH8g6g5ja0W16yhFG4sDfg946fLyzz+IkRnZUUSzEAdfsMSchtUs9ls1IGqDUc3DtMpZoyAIAUamYGMmATeSQIE3DTlffdz4mwUgA1oe4KCFJwAA7bdBd/ttaKxr1C57ouQaLl1OJ58gOIU7pDXGCDBEgwZvGY1Gexp0bbSDgBKgESMVYe6wzXMTfBkRftbGFCzrRS7e7PPdW9j/kYB1k8VZq5oVJ9xoDjlqOa4jW8Z7WuqK1ZiplFAVcYIGJ6mfER8Uf/xAAzEQEAAQICBwYFAwUAAAAAAAABAgMRITEAEkBBUWGRBHGBobHBECJg0fAyQlJQctLh8f/aAAgBAwEBPwD+tsomDKI80PXaqs9SDLfkd7l0z8NKNLXdeeJfC/7ni8Q83uTaFsLwx46QqwqYDjwcHvOP5fSotWqQHAbf5Phj00AiAZBY2mtTacteOAu7DVfs7unDTs0f1Tf7T1fbz2pCQiXHP89NIRIRImR/18/q+p2iykAbYMnK/Lj3+pmdpmONk4Wt0T3HSnUjULnibx/Mn3ubRVWNOSZ2t1Q9/j2dSoH8hHwL+20TjrxlHiee58HRGKiWTM+HZ4N9dMASPNyXuDDveTtMoQn+qI89/Ux0KFMb2v3tzp9/rGc4043fA3r+Zu7SlX1m07F35Xccn2eu0zmU46z4HF4aTnKctaXgbg4Hwo1soTeUX2fZ2iUSQxkXH866VKbTeI5Ps8/hRo6vzS/VuP4/79NplEkMZFx/OulOgQWS6zf5eR9/qJSIycgu6RqVas7RSJvwGxzuYvda/Iu6efPae0TvanHNstvKPo9NKcCnEN+cni/YyNoS4nHDDB8HdprToTYuMc7OScTOzx54Y6URqVGbux8XI8MU4WNqq0ypG37jGL7dz9ndpRhqQBLLi+x087/VH//Z"},{value:h.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:h.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],ni=/* @__PURE__ */w(e=>/* @__PURE__ */eu.jsx(t7,{...e,options:nn}),"BulletListTypePicker"),nr=`${t3}_ORDER_LIST_TYPE_COMPONENT`,na=`${t3}_BULLET_LIST_TYPE_COMPONENT`,no={id:"doc.command.tab",type:h.CommandType.COMMAND,async handler(e,t){let n=e.get(W).onAutoFormat(no.id,t);return(await (0,h.sequenceExecuteAsync)(n,e.get(h.ICommandService))).result}},ns={id:"doc.command.after-space",type:h.CommandType.COMMAND,async handler(e){let t=e.get(W).onAutoFormat(ns.id);return(await (0,h.sequenceExecuteAsync)(t,e.get(h.ICommandService))).result}},nl={id:"doc.command.enter",type:h.CommandType.COMMAND,async handler(e){let t=e.get(W).onAutoFormat(nl.id);return(await (0,h.sequenceExecuteAsync)(t,e.get(h.ICommandService))).result}};function nA(e){return e.getContextValue(h.FOCUSING_DOC)&&e.getContextValue(h.FOCUSING_UNIVER_EDITOR)&&!e.getContextValue(h.FOCUSING_COMMON_DRAWINGS)}function nd(e){return e.getContextValue(h.FOCUSING_DOC)&&e.getContextValue(h.FOCUSING_UNIVER_EDITOR)&&!e.getContextValue(h.FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE)&&!e.getContextValue(h.FOCUSING_COMMON_DRAWINGS)}w(nA,"whenDocAndEditorFocused"),w(nd,"whenDocAndEditorFocusedWithBreakLine");let nc={id:no.id,binding:N.KeyCode.TAB,preconditions:nA},nu={id:no.id,binding:N.KeyCode.TAB|N.MetaKeys.SHIFT,preconditions:nA,staticParameters:{shift:!0}};var nh,ng,np,nm=Object.defineProperty,nf=Object.getOwnPropertyDescriptor,nS=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?nf(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&nm(t,n,a),a},"__decorateClass$o"),nI=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$o");let nv=(w(np=class extends h.Disposable{constructor(e){super(),F(this,"_cacheStyle",null),this._textSelectionManagerService=e,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}setStyleCache(e){this._cacheStyle={...this._cacheStyle,...e}}_clearStyleCache(){this._cacheStyle=null}},"DocMenuStyleService"),np);function nE(e,t,n){return n.executeCommand(nz.id,{preCommandId:e,...null!=t?t:{}})}nv=nS([nI(0,(0,h.Inject)(g.DocSelectionManagerService))],nv),w(nE,"handleInlineFormat");let nC="doc.command.set-inline-format-bold",nT={id:nC,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nC,t,e.get(h.ICommandService)),"handler")},nb="doc.command.set-inline-format-italic",ny={id:nb,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nb,t,e.get(h.ICommandService)),"handler")},nR="doc.command.set-inline-format-underline",nx={id:nR,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nR,t,e.get(h.ICommandService)),"handler")},nO="doc.command.set-inline-format-strikethrough",nB={id:nO,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nO,t,e.get(h.ICommandService)),"handler")},nM="doc.command.set-inline-format-subscript",nD={id:nM,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nM,t,e.get(h.ICommandService)),"handler")},nN="doc.command.set-inline-format-superscript",n_={id:nN,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nN,t,e.get(h.ICommandService)),"handler")},nU="doc.command.set-inline-format-fontsize",nP={id:nU,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nU,t,e.get(h.ICommandService)),"handler")},nQ="doc.command.set-inline-format-font-family",nw={id:nQ,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nQ,t,e.get(h.ICommandService)),"handler")},nF="doc.command.set-inline-format-text-color",nL={id:nF,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nF,t,e.get(h.ICommandService)),"handler")},nk="doc.command.set-inline-format-text-background-color",nH={id:nk,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nk,t,e.get(h.ICommandService)),"handler")},nV="doc.command.reset-inline-format-text-background-color",nj={id:nV,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>nE(nV,t,e.get(h.ICommandService)),"handler")},nW={[nT.id]:"bl",[ny.id]:"it",[nx.id]:"ul",[nB.id]:"st",[nP.id]:"fs",[nw.id]:"ff",[nL.id]:"cl",[nH.id]:"bg",[nj.id]:"bg",[nD.id]:"va",[n_.id]:"va"},nz={id:"doc.command.set-inline-format",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let n;let{value:i,preCommandId:r}=t,a=e.get(h.ICommandService),o=e.get(g.DocSelectionManagerService),s=e.get(h.IUniverInstanceService),l=e.get(nv),A=o.getDocRanges();if(0===A.length)return!1;let d=A[0].segmentId,c=s.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if(null==c)return!1;let u=c.getUnitId();switch(r){case nT.id:case ny.id:case nx.id:case nB.id:case nD.id:case n_.id:n=nY(c.getSelfOrHeaderFooterModel(d).getBody().textRuns,r,A);break;case nP.id:case nw.id:n=i;break;case nL.id:case nH.id:n={rgb:i};break;case nj.id:n={rgb:null};break;default:throw Error(`Unknown command: ${r} in handleInlineFormat`)}let p={id:g.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:A}},m=new h.TextX,f=(0,h.JSONX).getInstance(),S=new h.MemoryCursor;for(let e of(S.reset(),A)){let{startOffset:t,endOffset:i}=e;if(null==t||null==i)continue;if(t===i){l.setStyleCache({[nW[r]]:n});continue}let a={dataStream:"",textRuns:[{st:0,ed:i-t,ts:{[nW[r]]:n}}]},o=t-S.cursor;0!==o&&m.push({t:h.TextXActionType.RETAIN,len:o}),m.push({t:h.TextXActionType.RETAIN,body:a,len:i-t}),S.reset(),S.moveCursor(i)}let I=Z(c,d);return p.params.actions=f.editOp(m.serialize(),I),!!a.syncExecuteCommand(p.id,p.params)},"handler")};function nG(e){return null!==e&&"object"==typeof e}function nY(e,t,n){let i=0,r=0,a=nW[t];for(;i!==e.length&&r!==n.length;){let{startOffset:o,endOffset:s}=n[r],{st:l,ed:A,ts:d}=e[i];if(s<=l)r++;else if(A<=o)i++;else{if(/bl|it/.test(a))return(null==d?void 0:d[a])===h.BooleanNumber.TRUE?h.BooleanNumber.FALSE:h.BooleanNumber.TRUE;if(/ul|st/.test(a))return nG(null==d?void 0:d[a])&&(null==d?void 0:d[a]).s===h.BooleanNumber.TRUE?{s:h.BooleanNumber.FALSE}:{s:h.BooleanNumber.TRUE};if(/va/.test(a))return t===nD.id?(null==d?void 0:d[a])===h.BaselineOffset.SUBSCRIPT?h.BaselineOffset.NORMAL:h.BaselineOffset.SUBSCRIPT:(null==d?void 0:d[a])===h.BaselineOffset.SUPERSCRIPT?h.BaselineOffset.NORMAL:h.BaselineOffset.SUPERSCRIPT;i++}}return/bl|it/.test(a)?h.BooleanNumber.TRUE:/ul|st/.test(a)?{s:h.BooleanNumber.TRUE}:t===nD.id?h.BaselineOffset.SUBSCRIPT:h.BaselineOffset.SUPERSCRIPT}w(nG,"isTextDecoration"),w(nY,"getReverseFormatValueInSelection");let nK={id:"doc.command.list-operation",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{var n,i;let r=e.get(g.DocSelectionManagerService),a=e.get(h.IUniverInstanceService),o=e.get(h.ICommandService),s=t.listType,l=a.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),A=null!=(n=r.getDocRanges())?n:[];if(null==l||0===A.length)return!1;let d=A[0].segmentId,c=null==(i=l.getSelfOrHeaderFooterModel(d).getBody())?void 0:i.paragraphs;if(null==c)return!1;let u=n2(A,c),p=l.getUnitId(),m={id:g.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:A,isEditing:!1}};new(0,h.MemoryCursor)().reset();let f=(0,h.BuildTextUtils).paragraph.bullet.switch({paragraphs:u,listType:s,document:l,segmentId:d}),S=(0,h.JSONX).getInstance(),I=Z(l,d);return m.params.actions=S.editOp(f.serialize(),I),!!o.syncExecuteCommand(m.id,m.params)},"handler")},nq={id:"doc.command.change-list-type",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{var n,i;let r=e.get(g.DocSelectionManagerService),a=e.get(h.IUniverInstanceService),o=e.get(h.ICommandService),{listType:s}=t,l=a.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),A=r.getDocRanges();if(null==l||null==A||!A.length)return!1;let{segmentId:d}=A[0],c=null!=(n=r.getDocRanges())?n:[],u=null==(i=l.getSelfOrHeaderFooterModel(d).getBody())?void 0:i.paragraphs;if(null==u)return!1;let p=n2(c,u),m=l.getUnitId(),f=(0,h.BuildTextUtils).paragraph.bullet.set({paragraphs:p,listType:s,segmentId:d,document:l});if(!f)return!1;let S=(0,h.JSONX).getInstance(),I={id:g.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:c,isEditing:!1}},v=Z(l,d);return I.params.actions=S.editOp(f.serialize(),v),!!o.syncExecuteCommand(I.id,I.params)},"handler")};var nX=((l=nX||{})[l.increase=1]="increase",l[l.decrease=-1]="decrease",l);let nJ={id:"doc.command.change-list-nesting-level",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{var n,i;if(!t)return!1;let{type:r}=t,a=e.get(g.DocSelectionManagerService),o=e.get(h.IUniverInstanceService),s=e.get(h.ICommandService),l=o.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),A=a.getActiveTextRange();if(null==l||null==A)return!1;let{segmentId:d}=A,c=null!=(n=a.getDocRanges())?n:[],u=null==(i=l.getSelfOrHeaderFooterModel(d).getBody())?void 0:i.paragraphs;if(null==u)return!1;let p=n3(A,u),m=l.getUnitId(),f=(0,h.JSONX).getInstance(),S=(0,h.BuildTextUtils).paragraph.bullet.changeNestLevel({paragraphs:p,type:r,segmentId:d,document:l}),I={id:g.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:c,isEditing:!1}},v=Z(l,d);return I.params.actions=f.editOp(S.serialize(),v),!!s.syncExecuteCommand(I.id,I.params)},"handler")},nZ={id:"doc.command.bullet-list",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{let n=e.get(h.ICommandService);return null!=t&&t.value?n.syncExecuteCommand(nq.id,{listType:t.value}):n.syncExecuteCommand(nK.id,{listType:h.PresetListType.BULLET_LIST})},"handler")},n$={id:"doc.command.check-list",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{let n=e.get(h.ICommandService);return null!=t&&t.value?n.syncExecuteCommand(nq.id,{listType:t.value}):n.syncExecuteCommand(nK.id,{listType:h.PresetListType.CHECK_LIST})},"handler")},n0={id:"doc.command.toggle-check-list",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{var n;if(!t)return!1;let i=e.get(h.IUniverInstanceService),r=e.get(h.ICommandService),{index:a,segmentId:o,textRanges:s}=t,l=i.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if(null==l||(null==(n=l.getSelfOrHeaderFooterModel(o).getBody())?void 0:n.paragraphs)==null)return!1;let A=l.getUnitId(),d={id:g.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:null!=s?s:[],segmentId:o,isEditing:!1}},c=(0,h.BuildTextUtils).paragraph.bullet.toggleChecklist({document:l,paragraphIndex:a,segmentId:o});if(!c)return!1;let u=(0,h.JSONX).getInstance(),p=Z(l,o);return d.params.actions=u.editOp(c.serialize(),p),!!r.syncExecuteCommand(d.id,d.params)},"handler")},n1={id:"doc.command.order-list",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{let n=e.get(h.ICommandService);return null!=t&&t.value?n.syncExecuteCommand(nq.id,{listType:t.value}):n.syncExecuteCommand(nK.id,{listType:h.PresetListType.ORDER_LIST})},"handler")},n9={id:"doc.command.quick-list",type:h.CommandType.COMMAND,handler(e,t){var n,i,r,a,o;if(!t)return!1;let s=e.get(g.DocSelectionManagerService),l=e.get(h.IUniverInstanceService),A=e.get(h.ICommandService),d=l.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),c=s.getActiveTextRange();if(null==d||null==c)return!1;let{segmentId:u}=c,{listType:m,paragraph:f}=t,{paragraphStart:S,paragraphEnd:I}=f,v=new h.TextX,E=(0,h.JSONX).getInstance(),{defaultTabStop:C=36}=d.getSnapshot().documentStyle,T=null!=(i=null==(n=d.getSelfOrHeaderFooterModel(u).getBody())?void 0:n.sectionBreaks)?i:[],{startIndex:b,paragraphStyle:y={}}=f,{indentFirstLine:R,snapToGrid:x,indentStart:O}=y,B=h.PRESET_LIST_TYPE[m].nestingLevel[0].paragraphProperties||{},{hanging:M,indentStart:D}=B,N=B.textStyle,{charSpace:_,gridType:U}=n4(b,T)||{charSpace:0,gridType:h.GridType.LINES},P=(0,p.getCharSpaceApply)(_,C,U,x),Q=(0,h.Tools).generateRandomId(6),w=null!=(a=null==(r=d.getBody())?void 0:r.paragraphs)?a:[],F=w.findIndex(e=>e.startIndex===f.startIndex),L=w[F-1],k=w[F+1];L&&L.bullet&&0===L.bullet.listType.indexOf(m)?Q=L.bullet.listId:k&&k.bullet&&0===k.bullet.listType.indexOf(m)&&(Q=k.bullet.listId);let H={id:g.RichTextEditingMutation.id,params:{unitId:d.getUnitId(),actions:[],textRanges:[{startOffset:S,endOffset:S,collapsed:!0}],isEditing:!1}};v.push({t:h.TextXActionType.RETAIN,len:S}),v.push({t:h.TextXActionType.DELETE,len:I-S}),v.push({t:h.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...y,textStyle:{...y.textStyle,...N},indentFirstLine:void 0,hanging:M,indentStart:{v:(0,p.getNumberUnitValue)(D,P)-(0,p.getNumberUnitValue)(M,P)+(0,p.getNumberUnitValue)(R,P)+(0,p.getNumberUnitValue)(O,P)}},bullet:{...null!=(o=f.bullet)?o:{nestingLevel:0,textStyle:{fs:20}},listType:m,listId:Q}}]}});let V=Z(d,u);return H.params.actions=E.editOp(v.serialize(),V),!!A.syncExecuteCommand(H.id,H.params)}};function n3(e,t){let{startOffset:n,endOffset:i}=e,r=[],a=-1;for(let e of t){let{startIndex:t}=e;(n>a&&n<=t||i>a&&i<=t||t>=n&&t<=i)&&r.push(e),a=t}return r}function n2(e,t){let n=[];for(let i of e){let e=n3(i,t);n.push(...e)}return n}function n4(e,t){let n=t.sort((0,h.sortRulesFactory)("startIndex"));for(let i=0;i<n.length;i++){let n=t[i];if(n.startIndex>=e)return n}}w(n3,"getParagraphsInRange"),w(n2,"getParagraphsInRanges"),w(n4,"findNearestSectionBreak");let n6={id:"doc.command.align-action",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w((e,t)=>{var n;let i=e.get(g.DocSelectionManagerService),r=e.get(h.IUniverInstanceService),a=e.get(h.ICommandService),{alignType:o}=t,s=r.getCurrentUniverDocInstance();if(null==s)return!1;let l=i.getDocRanges();if(0===l.length)return!1;let A=l[0].segmentId,d=null==(n=s.getSelfOrHeaderFooterModel(A).getBody())?void 0:n.paragraphs;if(null==d)return!1;let c=n2(l,d),u=s.getUnitId(),p=c.every(e=>{var t;return(null==(t=e.paragraphStyle)?void 0:t.horizontalAlign)===o}),m={id:g.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:l}},f=new h.MemoryCursor;f.reset();let S=new h.TextX,I=(0,h.JSONX).getInstance();for(let e of c){let{startIndex:t}=e;S.push({t:h.TextXActionType.RETAIN,len:t-f.cursor});let n={...e.paragraphStyle,horizontalAlign:p?h.HorizontalAlign.UNSPECIFIED:o};S.push({t:h.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...e,paragraphStyle:n,startIndex:0}]},coverType:h.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(t+1)}let v=Z(s,A);return m.params.actions=I.editOp(S.serialize(),v),!!a.syncExecuteCommand(m.id,m.params)},"handler")},n8={id:"doc.command.align-left",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(e=>e.get(h.ICommandService).syncExecuteCommand(n6.id,{alignType:h.HorizontalAlign.LEFT}),"handler")},n5={id:"doc.command.align-center",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(e=>e.get(h.ICommandService).syncExecuteCommand(n6.id,{alignType:h.HorizontalAlign.CENTER}),"handler")},n7={id:"doc.command.align-right",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(e=>e.get(h.ICommandService).syncExecuteCommand(n6.id,{alignType:h.HorizontalAlign.RIGHT}),"handler")},ie={id:"doc.command.align-justify",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(e=>e.get(h.ICommandService).syncExecuteCommand(n6.id,{alignType:h.HorizontalAlign.JUSTIFIED}),"handler")},it={id:nT.id,binding:N.KeyCode.B|N.MetaKeys.CTRL_COMMAND,preconditions:nA},ii={id:ny.id,binding:N.KeyCode.I|N.MetaKeys.CTRL_COMMAND,preconditions:nA},ir={id:nx.id,binding:N.KeyCode.U|N.MetaKeys.CTRL_COMMAND,preconditions:nA},ia={id:nB.id,binding:N.KeyCode.X|N.MetaKeys.SHIFT|N.MetaKeys.CTRL_COMMAND,preconditions:nA},io={id:nD.id,binding:N.KeyCode.COMMA|N.MetaKeys.CTRL_COMMAND,preconditions:nA},is={id:n_.id,binding:N.KeyCode.PERIOD|N.MetaKeys.CTRL_COMMAND,preconditions:nA},il={id:n8.id,binding:N.KeyCode.L|N.MetaKeys.CTRL_COMMAND|N.MetaKeys.SHIFT,preconditions:nA},iA={id:n7.id,binding:N.KeyCode.R|N.MetaKeys.CTRL_COMMAND|N.MetaKeys.SHIFT,preconditions:nA},id={id:n5.id,binding:N.KeyCode.E|N.MetaKeys.CTRL_COMMAND|N.MetaKeys.SHIFT,preconditions:nA},ic={id:ie.id,binding:N.KeyCode.J|N.MetaKeys.CTRL_COMMAND|N.MetaKeys.SHIFT,preconditions:nA},iu={id:n1.id,binding:N.KeyCode.Digit7|N.MetaKeys.CTRL_COMMAND|N.MetaKeys.SHIFT,preconditions:nA},ih={id:nZ.id,binding:N.KeyCode.Digit8|N.MetaKeys.CTRL_COMMAND|N.MetaKeys.SHIFT,preconditions:nA},ig=/* @__PURE__ */w((e,t)=>{let n=e.get(h.IUniverInstanceService).getUniverDocInstance(t.unitId),i=(null==n?void 0:n.zoomRatio)||1;return{...(0,h.Tools).deepClone(t),zoomRatio:i}},"SetDocZoomRatioUndoMutationFactory"),ip={id:"doc.operation.set-zoom-ratio",type:h.CommandType.OPERATION,handler:/* @__PURE__ */w((e,t)=>{let n=e.get(h.IUniverInstanceService).getUniverDocInstance(t.unitId);if(!n)return!1;let i=n.getSnapshot();return null==i.settings?i.settings={zoomRatio:t.zoomRatio}:i.settings.zoomRatio=t.zoomRatio,!0},"handler")},im=[50,80,100,130,150,170,200,400];function iS(){let e=(0,h.useDependency)(h.ICommandService),t=(0,h.useDependency)(h.IUniverInstanceService),n=(0,m.useMemo)(()=>t.getCurrentTypeOfUnit$(h.UniverInstanceType.UNIVER_DOC),[]),i=(0,h.useObservable)(n),r=(0,m.useCallback)(()=>{var e,t;return i?Math.round((null!=(t=null==(e=i.getSettings())?void 0:e.zoomRatio)?t:1)*100):100},[i]),[a,o]=(0,m.useState)(()=>r());function s(t){o(t),null!=i&&e.executeCommand(ip.id,{unitId:i.getUnitId(),zoomRatio:t/100})}return(0,m.useEffect)(()=>(o(r()),e.onCommandExecuted(e=>{e.id===ip.id&&o(r())}).dispose),[e,r]),w(s,"handleChange"),/* @__PURE__ */eu.jsx(U.Slider,{min:10,value:a,shortcuts:im,onChange:s})}function iI(e){return /* @__PURE__ */eu.jsx("section",{className:"univer-doc-count-bar",children:/* @__PURE__ */eu.jsx(iS,{})})}w(iS,"ZoomSlider"),w(iI,"CountBar");let iv=/* @__PURE__ */w(()=>/* @__PURE__ */eu.jsxs("div",{className:"univer-doc-footer-container",children:[/* @__PURE__ */eu.jsx("div",{}),/* @__PURE__ */eu.jsx(iI,{})]}),"DocFooter"),iE="docs-ui.config",iC={layout:{docContainerConfig:{outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},toolbarConfig:{undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0}}};var iT=((A=iT||{})[A.ABOVE=0]="ABOVE",A[A.BELLOW=1]="BELLOW",A),ib=((d=ib||{})[d.LEFT=0]="LEFT",d[d.RIGHT=1]="RIGHT",d);function iy(e,t){let n=h.DataStreamTreeTokenType.TABLE_START,i=[],r=[];for(let a=0;a<e;a++){n+=h.DataStreamTreeTokenType.TABLE_ROW_START;for(let e=0;e<t;e++)n+=`${h.DataStreamTreeTokenType.TABLE_CELL_START}\r
${h.DataStreamTreeTokenType.TABLE_CELL_END}`,i.push({startIndex:n.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),r.push({startIndex:n.length-2});n+=h.DataStreamTreeTokenType.TABLE_ROW_END}return{dataStream:n+=h.DataStreamTreeTokenType.TABLE_END,paragraphs:i,sectionBreaks:r}}function iR(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function ix(e){let t=iR();return{tableCells:[...Array(e).fill(null).map(()=>(0,h.Tools).deepClone(t))],trHeight:{val:{v:30},hRule:h.TableCellHeightRule.AUTO}}}function iO(e){return{size:{type:h.TableSizeType.SPECIFIED,width:{v:e}}}}function iB(e,t,n){let i=iO(n/t),r=ix(t);return{tableRows:[...Array(e).fill(null).map(()=>(0,h.Tools).deepClone(r))],tableColumns:[...Array(t).fill(null).map(()=>(0,h.Tools).deepClone(i))],tableId:(0,h.generateRandomId)(6),align:h.TableAlignmentType.START,indent:{v:0},textWrap:h.TableTextWrapType.NONE,position:{positionH:{relativeFrom:h.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:h.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:h.TableSizeType.UNSPECIFIED,width:{v:n}}}}function iM(e,t){if(!e&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let i of t){let{startOffset:t,endOffset:r,segmentId:a}=i;null==t||null==r||null==a||(e=Math.min(e,t),n=Math.max(n,r))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:""}}else if(e){let{startOffset:t,endOffset:n,segmentId:i}=e;return null==t||null==n||null==i?null:{startOffset:t,endOffset:n,segmentId:i}}}function iD(e){let t=h.DataStreamTreeTokenType.TABLE_ROW_START,n=[],i=[];for(let r=0;r<e;r++)n.push({startIndex:(t+=`${h.DataStreamTreeTokenType.TABLE_CELL_START}\r
${h.DataStreamTreeTokenType.TABLE_CELL_END}`).length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),i.push({startIndex:t.length-2});return{dataStream:t+=h.DataStreamTreeTokenType.TABLE_ROW_END,paragraphs:n,sectionBreaks:i}}function iN(){let e=`${h.DataStreamTreeTokenType.TABLE_CELL_START}\r
${h.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],n=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:2}),{dataStream:e,paragraphs:t,sectionBreaks:n}}function i_(e,t,n){var i,r,a;let{startOffset:o,endOffset:s,segmentId:l}=e,A=n.getSelfOrHeaderFooterViewModel(l),d=0===t?o:s,c=null,u=null==(a=null==(r=null==(i=n.getBody())?void 0:i.tables)?void 0:r.find(e=>d>=e.startIndex&&d<=e.endIndex))?void 0:a.tableId,h=0;for(let e of A.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){for(let e of n.children)if(e.startIndex<=d&&d<=e.endIndex){h=n.children.indexOf(e),c=e;break}}if(c)break}if(c)break}return null==c||null==u?null:{offset:0===t?c.startIndex:c.endIndex+1,colCount:c.children.length,tableId:u,insertRowIndex:0===t?h:h+1}}function iU(e,t,n){var i,r,a;let{startOffset:o,endOffset:s,segmentId:l}=e,A=n.getSelfOrHeaderFooterViewModel(l),d=0===t?o:s,c=null==(a=null==(r=null==(i=n.getBody())?void 0:i.tables)?void 0:r.find(e=>d>=e.startIndex&&d<=e.endIndex))?void 0:a.tableId,u=[],h=null,g=-1;for(let e of A.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(d<n.startIndex||d>n.endIndex)continue;for(let e of(h=n,n.children)){for(let t of e.children){let n=e.children.indexOf(t);if(d>=t.startIndex&&d<=t.endIndex){g=n;break}}if(-1!==g)break}}if(h)break}if(h)break}if(null==h||null==c||-1===g)return null;let p=0;for(let e of h.children){let n=e.children[g],i=0===t?n.startIndex:n.endIndex+1;u.push(i-p),p=i}return{offsets:u,tableId:c,columnIndex:g,rowCount:h.children.length}}function iP(e,t,n){let i=[],r=t[n].size.width.v,a=0;for(let e=0;e<t.length;e++)a+=t[e].size.width.v;a+=r;for(let n=0;n<t.length;n++)i.push(t[n].size.width.v/a*e);return{widths:i,newColWidth:r=r/a*e}}function iQ(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=[],c=-1,u=0,h=-1,g=!1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;for(let e of(h=n.startIndex+3,n.children)){let t=n.children.indexOf(e),{startIndex:i,endIndex:r}=e;a>=i&&a<=r?(c=i,d.push(t),u+=r-i+1):(i>a&&r<o||o>=i&&o<=r)&&(d.push(t),u+=r-i+1),d.length===n.children.length&&(g=!0)}}if(d.length)break}if(d.length)break}return null==A||0===d.length?null:{tableId:A,rowIndexes:d,offset:c,len:u,cursor:h,selectWholeTable:g}}function iw(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=[],c=null,u=[],h=-1,g=-1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;for(let e of(c=n,n.children))for(let t of e.children){let n=e.children.indexOf(t);a>=t.startIndex&&a<=t.endIndex&&(h=n),o>=t.startIndex&&o<=t.endIndex&&(g=n)}}if(c)break}if(c)break}if(null==c||null==A)return null;for(let e=h;e<=g;e++)u.push(e);let p=0;for(let e of c.children){let t=e.children[h],n=e.children[g];d.push({retain:t.startIndex-p,delete:n.endIndex-t.startIndex+1}),p=n.endIndex+1}return{offsets:d,tableId:A,columnIndexes:u,cursor:c.startIndex+3,selectWholeTable:u.length===c.children[0].children.length,rowCount:c.children.length}}function iF(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=-1,c=0,u=-1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;d=n.startIndex,c=n.endIndex-n.startIndex+1,u=n.startIndex}if(n)break}if(c>0)break}return null==A?null:{tableId:A,offset:d,len:c,cursor:u}}function iL(e,t){var n,i,r;let{startOffset:a,endOffset:o,segmentId:s}=e,l=t.getSelfOrHeaderFooterViewModel(s),A=null==(r=null==(i=null==(n=t.getBody())?void 0:n.tables)?void 0:i.find(e=>a>=e.startIndex&&o<=e.endIndex))?void 0:r.tableId,d=[],c=null,u=-1,h=-1,g=-1;for(let e of l.children){for(let t of e.children){let{children:e}=t,n=e[0];if(n){if(a<n.startIndex||o>n.endIndex)continue;for(let e of(c=n,n.children)){let t=n.children.indexOf(e);for(let n of e.children){let i=e.children.indexOf(n);a>=n.startIndex&&a<=n.endIndex&&(u=t,h=i),o>=n.startIndex&&o<=n.endIndex&&(g=i)}}}if(c)break}if(c)break}if(null==c||null==A||-1===u)return null;let p=c.children[u];for(let e=h;e<=g;e++){let t=p.children[e];d.push({retain:t.startIndex+1,delete:t.endIndex-t.startIndex-3})}return{offsets:d,tableId:A,cursor:c.startIndex+3,rowCount:c.children.length}}w(iy,"genEmptyTable"),w(iR,"getEmptyTableCell"),w(ix,"getEmptyTableRow"),w(iO,"getTableColumn"),w(iB,"genTableSource"),w(iM,"getRangeInfoFromRanges"),w(iD,"getInsertRowBody"),w(iN,"getInsertColumnBody"),w(i_,"getInsertRowActionsParams"),w(iU,"getInsertColumnActionsParams"),w(iP,"getColumnWidths"),w(iQ,"getDeleteRowsActionsParams"),w(iw,"getDeleteColumnsActionParams"),w(iF,"getDeleteTableActionParams"),w(iL,"getDeleteRowContentActionParams");var ik=((c=ik||{})[c.NEXT=0]="NEXT",c[c.PREV=1]="PREV",c);function iH(e,t,n){let{startOffset:i}=t,r=null;for(let t of e.children){for(let e of t.children){let t=e.children[0];if(t&&i>t.startIndex&&i<t.endIndex){r=t;break}}if(r)break}if(null==r)return null;let a=-1,o=-1,s=null;for(let e of r.children){for(let t of e.children)if(i>t.startIndex&&i<t.endIndex){a=e.children.indexOf(t),o=r.children.indexOf(e),s=e;break}if(a>-1)break}if(-1===a||-1===o||null==s)return null;let l=null;if(0===n){if(!(l=s.children[a+1])){let e=r.children[o+1];e&&(l=e.children[0])}}else if(!(l=s.children[a-1])){let e=r.children[o-1];e&&(l=e.children[e.children.length-1])}if(l){let{startIndex:e,endIndex:t}=l;return{startOffset:e+1,endOffset:t-2}}}function iV(e,t){let n=[],{customBlocks:i=[]}=e;for(let e of t){let{startOffset:t,endOffset:r}=e;if(!(null==t||null==r))for(let e of i){let{startIndex:i}=e;i>=t&&i<r&&n.push(e.blockId)}}return n}function ij(e){return e.some(e=>{let{startNodePosition:t}=e;return!!t&&(null==t?void 0:t.path.indexOf("cells"))>-1})}w(iH,"getCellOffsets"),w(iV,"getCustomBlockIdsInSelections"),w(ij,"hasRangeInTable");let iW={id:"doc.command.inner-paste",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n,i,r,a;let{segmentId:o,textRanges:s,doc:l}=t,A=e.get(h.ICommandService),d=e.get(g.DocSelectionManagerService),c=e.get(h.IUniverInstanceService),u=d.getTextRanges(),p=d.getRectRanges(),{body:m,tableSource:f,drawings:S}=l;if(!Array.isArray(u)||0===u.length||null==m)return!1;let I=c.getCurrentUniverDocInstance(),v=null==I?void 0:I.getSelfOrHeaderFooterModel(o).getBody();if(null==I||null==v)return!1;let E=u.map(e=>(0,h.BuildTextUtils).selection.getInsertSelection(e,v)),C=I.getUnitId(),T={id:g.RichTextEditingMutation.id,params:{unitId:C,actions:[],textRanges:s,segmentId:o}},b=new h.MemoryCursor;b.reset();let y=new h.TextX,R=(0,h.JSONX).getInstance(),x=[],O=!!(null!=(n=m.tables)&&n.length),B=!!(null!=(i=m.customBlocks)&&i.length);if(O&&o||O&&ij(E)||E.length&&null!=p&&p.length)return!1;for(let e of E){let{startOffset:t,endOffset:n,collapsed:i}=e,s=t-b.cursor,l=(0,h.Tools).deepClone(m);if(O)for(let e of l.tables){let{tableId:t}=e,n=(0,h.Tools).generateRandomId(6);e.tableId=n;let i=(0,h.Tools).deepClone(f[t]);i.tableId=n;let r=R.insertOp(["tableSource",n],i);x.push(r)}if(B&&S){let e=null!=(a=null==(r=I.getSnapshot().drawingsOrder)?void 0:r.length)?a:0;for(let t of l.customBlocks){let{blockId:n}=t,i=(0,h.Tools).generateRandomId(6);t.blockId=i;let r=(0,h.Tools).deepClone(S[n]);r.drawingId=i;let a=R.insertOp(["drawings",i],r),o=R.insertOp(["drawingsOrder",e],i);x.push(a),x.push(o)}}if(i)y.push({t:h.TextXActionType.RETAIN,len:s});else{let{dos:t}=(0,h.BuildTextUtils).selection.getDeleteActions(e,o,b.cursor,v);y.push(...t)}y.push({t:h.TextXActionType.INSERT,body:l,len:m.dataStream.length}),b.reset(),b.moveCursor(n)}let M=Z(I,o);return x.push(R.editOp(y.serialize(),M)),T.params.actions=x.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!A.syncExecuteCommand(T.id,T.params)},"handler")};function iz(e,t,n){var i,r;let a=t.getSelfOrHeaderFooterModel(n).getBody(),o=new h.TextX,s=(0,h.JSONX).getInstance(),l=[];if(null==a)return l;let A=new h.MemoryCursor;for(let t of(A.reset(),e)){let{startOffset:e,endOffset:i,collapsed:r}=t;if(null==e||null==i)continue;let s=e-A.cursor;r?o.push({t:h.TextXActionType.RETAIN,len:s}):o.push(...(0,h.BuildTextUtils).selection.getDeleteExcludeLastLineBreakActions(t,a,n,A.cursor,!1)),A.reset(),A.moveCursor(i)}let d=Z(t,n);l.push(s.editOp(o.serialize(),d));let c=iV(a,e),u=null!=(i=t.getDrawings())?i:{},g=null!=(r=t.getDrawingsOrder())?r:[],p=c.sort((e,t)=>g.indexOf(e)>g.indexOf(t)?-1:g.indexOf(e)<g.indexOf(t)?1:0);if(p.length>0)for(let e of p){let t=u[e],n=g.indexOf(e);if(null==t||n<0)continue;let i=s.removeOp(["drawings",e],t),r=s.removeOp(["drawingsOrder",n],e);l.push(i),l.push(r)}return l.reduce((e,t)=>(0,h.JSONX).compose(e,t),null)}function iG(e,t,n,i){let r=[];if(null==t.getSelfOrHeaderFooterModel(i).getBody())return r;let a=new h.TextX,o=(0,h.JSONX).getInstance(),s=new h.MemoryCursor;for(let t of(s.reset(),e)){let{startOffset:e,endOffset:l,spanEntireRow:A,spanEntireTable:d}=t;if(!(null==e||null==l)){if(d){let t=iF({startOffset:e,endOffset:l,segmentId:i},n);if(null==t)continue;let{offset:A,len:d,tableId:c}=t;A-s.cursor>0&&a.push({t:h.TextXActionType.RETAIN,len:A-s.cursor}),a.push({t:h.TextXActionType.DELETE,len:d});let u=o.removeOp(["tableSource",c]);r.push(u),s.moveCursorTo(A+d)}else if(A){let t=iQ({startOffset:e,endOffset:l,segmentId:i},n);if(null==t)continue;let{offset:A,rowIndexes:d,len:c,tableId:u}=t;for(let e of(A-s.cursor>0&&a.push({t:h.TextXActionType.RETAIN,len:A-s.cursor}),a.push({t:h.TextXActionType.DELETE,len:c}),d.reverse())){let t=o.removeOp(["tableSource",u,"tableRows",e]);r.push(t)}s.moveCursorTo(A+c)}else{let t=iL({startOffset:e,endOffset:l,segmentId:i},n);if(null==t)continue;let{offsets:r}=t;for(let e of r){let{retain:t,delete:n}=e;t-s.cursor>0&&a.push({t:h.TextXActionType.RETAIN,len:t-s.cursor}),a.push({t:h.TextXActionType.DELETE,len:n}),s.moveCursorTo(t+n)}}}}let l=Z(t,i);return r.push(o.editOp(a.serialize(),l)),r.reduce((e,t)=>(0,h.JSONX).compose(e,t),null)}function iY(e,t,n,i,r){let a=[];if(Array.isArray(e)&&(null==e?void 0:e.length)!==0&&(a=iz(e,n,r)),Array.isArray(t)&&(null==t?void 0:t.length)!==0){let e=iG(t,n,i,r);a=null==a||0===a.length?e:(0,h.JSONX).compose(a,(0,h.JSONX).transform(e,a,"right"))}return a}w(iz,"getCutActionsFromTextRanges"),w(iG,"getCutActionsFromRectRanges"),w(iY,"getCutActionsFromDocRanges");let iK={id:"doc.command.inner-cut",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n,i;let{segmentId:r,textRanges:a}=t,o=e.get(h.ICommandService),s=e.get(g.DocSelectionManagerService),l=e.get(h.IUniverInstanceService),A=null!=(n=t.selections)?n:s.getTextRanges(),d=s.getRectRanges();if((!Array.isArray(A)||0===A.length)&&(!Array.isArray(d)||0===d.length))return!1;let c=null==(i=l.getCurrentUniverDocInstance())?void 0:i.getUnitId();if(!c)return!1;let u=l.getUniverDocInstance(c);if(null==u)return!1;let p=J(e,c);if(null==p)return!1;let m=p.getViewModel(),f={id:g.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:a}};return f.params.actions=iY(A,d,u,m,r),!!o.syncExecuteCommand(f.id,f.params)},"handler")};var iq=((u=iq||{})[u.LEFT=0]="LEFT",u[u.RIGHT=1]="RIGHT",u);let iX={id:"doc.command.insert-text",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n;let i=e.get(h.ICommandService),{range:r,segmentId:a,body:o,unitId:s,cursorOffset:l,extendLastRange:A}=t,d=e.get(g.DocSelectionManagerService),c=e.get(h.IUniverInstanceService).getUnit(s,h.UniverInstanceType.UNIVER_DOC);if(null==c)return!1;let u=d.getActiveTextRange(),p=c.getSelfOrHeaderFooterModel(null!=(n=null==u?void 0:u.segmentId)?n:"").getBody();if(null==p)return!1;let m=A?(0,h.BuildTextUtils).selection.getDeleteSelection(r,p):(0,h.BuildTextUtils).selection.getInsertSelection(r,p),{startOffset:f,collapsed:S}=m,I=null!=l?l:o.dataStream.length,v=[{startOffset:f+I,endOffset:f+I,style:null==u?void 0:u.style,collapsed:S}],E={id:g.RichTextEditingMutation.id,params:{unitId:s,actions:[],textRanges:v,debounce:!0}},C=new h.TextX,T=(0,h.JSONX).getInstance();if(S)f>0&&C.push({t:h.TextXActionType.RETAIN,len:f});else{let{dos:e,retain:t}=(0,h.BuildTextUtils).selection.getDeleteActions(m,a,0,p);C.push(...e),E.params.textRanges=[{startOffset:f+I+t,endOffset:f+I+t,collapsed:S}]}C.push({t:h.TextXActionType.INSERT,body:o,len:o.dataStream.length});let b=Z(c,a);return E.params.actions=T.editOp(C.serialize(),b),!!i.syncExecuteCommand(E.id,E.params)},"handler")},iJ={id:"doc.command.delete-text",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n;let i=e.get(h.ICommandService),r=e.get(h.IUniverInstanceService),{range:a,segmentId:o,unitId:s,direction:l,len:A=1}=t,d=r.getUnit(s,h.UniverInstanceType.UNIVER_DOC),c=null==d?void 0:d.getSelfOrHeaderFooterModel(o).getBody();if(null==d||null==c)return!1;let{startOffset:u}=a,p=c.dataStream,m=l===iq.LEFT?u-A:u,f=m+A-1,S=null==(n=c.customRanges)?void 0:n.filter(e=>(0,h.BuildTextUtils).customRange.isIntersecting(e.startIndex,e.endIndex,m,f)),I=null==S?void 0:S.filter(e=>(0,h.BuildTextUtils).customRange.shouldDeleteCustomRange(m,A,e,p)),v=[];for(let e=0;e<A;e++)v.push(m+e);null==I||I.forEach(e=>{v.push(e.startIndex,e.endIndex)}),v.sort((e,t)=>e-t);let E=v[0],C={id:g.RichTextEditingMutation.id,params:{unitId:s,actions:[],textRanges:[{startOffset:E,endOffset:E,collapsed:!0}],debounce:!0}},T=new h.TextX,b=(0,h.JSONX).getInstance(),y=0;for(let e=0;e<v.length;e++){let t=v[e];t-y>0&&T.push({t:h.TextXActionType.RETAIN,len:t-y}),T.push({t:h.TextXActionType.DELETE,len:1}),y=t+1}let R=Z(d,o);return C.params.actions=b.editOp(T.serialize(),R),!!i.syncExecuteCommand(C.id,C.params)},"handler")},iZ={id:"doc.command.update-text",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let{range:n,segmentId:i,updateBody:r,coverType:a,unitId:o,textRanges:s}=t,l=e.get(h.ICommandService),A=e.get(h.IUniverInstanceService).getCurrentUniverDocInstance();if(null==A)return!1;let d={id:g.RichTextEditingMutation.id,params:{unitId:o,actions:[],textRanges:s}},c=new h.TextX,u=(0,h.JSONX).getInstance(),{startOffset:p,endOffset:m}=n;c.push({t:h.TextXActionType.RETAIN,len:p}),c.push({t:h.TextXActionType.RETAIN,body:r,len:m-p,coverType:a});let f=Z(A,i);return d.params.actions=u.editOp(c.serialize(),f),!!l.syncExecuteCommand(d.id,d.params)},"handler")},i$=h.BuildTextUtils.selection.getDeleteSelection,i0={id:"doc.command.delete-custom-block",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n;let i=e.get(g.DocSelectionManagerService),r=e.get(h.IUniverInstanceService),a=e.get(h.ICommandService),o=i.getActiveTextRange(),s=r.getCurrentUniverDocInstance();if(null==o||null==s)return!1;let{direction:l,range:A,unitId:d,drawingId:c}=t,{startOffset:u,segmentId:p,style:m}=o,f=l===iq.LEFT?u-1:u,S={id:g.RichTextEditingMutation.id,params:{unitId:d,actions:[],textRanges:[{startOffset:f,endOffset:f,style:m}],prevTextRanges:[A]}},I=new h.TextX,v=(0,h.JSONX).getInstance(),E=[];u>0&&I.push({t:h.TextXActionType.RETAIN,len:l===iq.LEFT?u-1:u}),I.push({t:h.TextXActionType.DELETE,len:1});let C=Z(s,p);E.push(v.editOp(I.serialize(),C));let T=(null!=(n=s.getDrawings())?n:{})[c],b=s.getDrawingsOrder().indexOf(c),y=v.removeOp(["drawings",c],T),R=v.removeOp(["drawingsOrder",b],c);return E.push(y),E.push(R),S.params.actions=E.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!a.syncExecuteCommand(S.id,S.params)},"handler")},i1={id:"doc.command.merge-two-paragraph",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let n,i;let r=e.get(g.DocSelectionManagerService),a=e.get(h.IUniverInstanceService),o=e.get(h.ICommandService),{direction:s,range:l}=t,A=r.getActiveTextRange(),d=r.getTextRanges();if(null==A||null==d)return!1;let{segmentId:c,style:u}=A,p=a.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),m=null==p?void 0:p.getSelfOrHeaderFooterModel(c).getBody();if(null==p||null==m)return!1;let f=i$(A,m),S=p.getUnitId(),{startOffset:I,collapsed:v}=f;if(!v)return!1;let E=s===iq.LEFT?I:I+1;for(let e of m.paragraphs){if(e.startIndex>=E){i=e;break}n=e}if(null==n||null==i)return!1;let C=s===iq.LEFT?I-1:I,T={id:g.RichTextEditingMutation.id,params:{unitId:S,actions:[],textRanges:[{startOffset:C,endOffset:C,style:u}],prevTextRanges:[l]}},b=new h.TextX,y=(0,h.JSONX).getInstance();n.startIndex>0&&b.push({t:h.TextXActionType.RETAIN,len:n.startIndex}),b.push({t:h.TextXActionType.DELETE,len:1}),i.startIndex>n.startIndex+1&&b.push({t:h.TextXActionType.RETAIN,len:i.startIndex-n.startIndex-1}),b.push({t:h.TextXActionType.RETAIN,len:1,coverType:h.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...(0,h.Tools).deepClone(n),startIndex:0}]}});let R=Z(p,c);return T.params.actions=y.editOp(b.serialize(),R),!!o.syncExecuteCommand(T.id,T.params)},"handler")};function i9(e,t){let n=0;if(null==e||0===e.length){if("number"==typeof t[0].startOffset){let e=t[0],{spanEntireRow:i,spanEntireTable:r}=e;n=r?e.startOffset-3:i?e.startRow>0?e.startOffset-6:e.startOffset:t[0].startOffset}}else if(e.length>0&&t.length>0){let i=e[0],r=t[0];if(null!=i.startOffset&&null!=r.startOffset){if(i.startOffset<r.startOffset)n=i.startOffset;else if(i.startOffset>=r.startOffset){let{spanEntireRow:e,spanEntireTable:t}=r;t?n=r.startOffset-3:e&&(n=r.startOffset-6)}}}return n}w(i9,"getCursorWhenDelete");let i3={id:"doc.command.delete-left",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{var t,n;let i=e.get(g.DocSelectionManagerService),r=e.get(h.IUniverInstanceService),a=e.get(h.ICommandService),o=!0,s=r.getCurrentUniverDocInstance();if(null==s)return!1;let l=J(e,s.getUnitId()),A=i.getActiveTextRange(),d=i.getRectRanges(),c=i.getTextRanges(),u=null==l?void 0:l.getSkeleton();if(null==u)return!1;if(null!=d&&d.length){let e=i9(c,d),t=d[0].segmentId;return a.executeCommand(iK.id,{segmentId:t,textRanges:[{startOffset:e,endOffset:e}]})}if(null==A||null==c)return!1;let{segmentId:m,style:f,segmentPage:S}=A,I=s.getSelfOrHeaderFooterModel(m).getBody();if(null==I)return!1;let v=i$(A,I),{startOffset:E,collapsed:C}=v,T=u.findNodeByCharIndex(E,m,S),b=(0,p.hasListGlyph)(T),y=(0,p.isIndentByGlyph)(T,I),R=E,x=u.findNodeByCharIndex(E-1,m,S);if((0,p.isFirstGlyph)(T)&&x!==T&&(!0===b||!0===y)&&C){let e=(0,p.getParagraphByGlyph)(T,I);if(null==e)return!1;let t=null==e?void 0:e.startIndex,n={startIndex:0},i=e.paragraphStyle;if(!0===b){let t=e.paragraphStyle;if(t){n.paragraphStyle=t;let{hanging:e}=t;e&&(n.paragraphStyle.indentStart=e,n.paragraphStyle.hanging=void 0)}}else if(!0===y){let t=e.bullet;t&&(n.bullet=t),null!=i&&(n.paragraphStyle={...i},delete n.paragraphStyle.hanging,delete n.paragraphStyle.indentStart)}let r=[{startOffset:R,endOffset:R,style:f}];o=await a.executeCommand(iZ.id,{unitId:s.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...n}]},range:{startOffset:t,endOffset:t+1},textRanges:r,coverType:h.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(!0===C){if(null==x)return!0;if("\r"===x.content)o=await a.executeCommand(i1.id,{direction:iq.LEFT,range:v});else if("\b"===x.streamType){let e=null==(n=s.getSnapshot().drawings)?void 0:n[null!=(t=x.drawingId)?t:""];if(null==e)return!0;if(e.layoutType===h.PositionedObjectLayoutType.INLINE){let e=s.getUnitId();o=await a.executeCommand(i0.id,{direction:iq.LEFT,range:A,unitId:e,drawingId:x.drawingId})}else{let e=u.findNodeByCharIndex(E-2);if(null==e)return!0;R-=x.count;let t=[{startOffset:R-=e.count,endOffset:R,style:f}];o=await a.executeCommand(iJ.id,{unitId:s.getUnitId(),range:{...A,startOffset:A.startOffset-1,endOffset:A.endOffset-1},segmentId:m,direction:iq.LEFT,len:e.count,textRanges:t})}}else R-=x.count,o=await a.executeCommand(iJ.id,{unitId:s.getUnitId(),range:v,segmentId:m,direction:iq.LEFT,len:x.count})}else{let e=i4(v,[v]);o=await a.executeCommand(iK.id,{segmentId:m,textRanges:e,selections:[v]})}return o},"handler")},i2={id:"doc.command.delete-right",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{var t,n;let i=e.get(g.DocSelectionManagerService),r=e.get(h.IUniverInstanceService).getCurrentUniverDocInstance();if(!r)return!1;let a=J(e,r.getUnitId()),o=e.get(h.ICommandService),s=i.getActiveTextRange(),l=i.getRectRanges(),A=i.getTextRanges(),d=null==a?void 0:a.getSkeleton();if(null!=l&&l.length){let e=i9(A,l),t=l[0].segmentId;return o.executeCommand(iK.id,{segmentId:t,textRanges:[{startOffset:e,endOffset:e}]})}if(null==s||null==d||null==A)return!1;let{segmentId:c,style:u,segmentPage:p}=s,m=null==r?void 0:r.getSelfOrHeaderFooterModel(c).getBody();if(!r||!m)return!1;let f=i$(s,m,iq.RIGHT),{startOffset:S,endOffset:I,collapsed:v}=f;if(S===m.dataStream.length-2&&v)return!0;let E=!1;if(!0===v){let e=d.findNodeByCharIndex(S,c,p),i=d.findNodeByCharIndex(S+1);if(e.streamType===h.DataStreamTreeTokenType.PARAGRAPH&&(null==i?void 0:i.streamType)===h.DataStreamTreeTokenType.SECTION_BREAK)return!1;if("\r"===e.content)E=await o.executeCommand(i1.id,{direction:iq.RIGHT,range:s});else if("\b"===e.streamType){let a=null==(n=r.getSnapshot().drawings)?void 0:n[null!=(t=e.drawingId)?t:""];if(null==a)return!0;if(a.layoutType===h.PositionedObjectLayoutType.INLINE){let t=r.getUnitId();E=await o.executeCommand(i0.id,{direction:iq.RIGHT,range:s,unitId:t,drawingId:e.drawingId})}else{if(null==i)return!0;E=await o.executeCommand(iJ.id,{unitId:r.getUnitId(),range:{...s,startOffset:S+1,endOffset:I+1},segmentId:c,direction:iq.RIGHT,textRanges:[{startOffset:S+1,endOffset:S+1,style:u}],len:i.count})}}else E=await o.executeCommand(iJ.id,{unitId:r.getUnitId(),range:f,segmentId:c,direction:iq.RIGHT,textRanges:[{startOffset:S,endOffset:S,style:u}],len:e.count})}else{let e=i4(f,[f]);E=await o.executeCommand(iK.id,{segmentId:c,textRanges:e,selections:[f]})}return E},"handler")};function i4(e,t){let n=e.endOffset;for(let i of t){let{startOffset:t,endOffset:r}=i;null==t||null==r||r<=e.endOffset&&(n-=r-t)}return[{startOffset:n,endOffset:n,style:e.style}]}function i6(){return(0,h.Tools).generateRandomId(6)}function i8(e){let t=e.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}w(i4,"getTextRangesWhenDelete"),w(i6,"genId"),w(i8,"extractId");let i5=class{constructor(){F(this,"_cache",new h.LRUMap(10))}set(e,t){this._cache.set(e,t)}get(e){return this._cache.get(e)}clear(){this._cache.clear()}};w(i5,"CopyContentCache");let i7=new i5;function re(e){let t=e.style,n={},i=e.tagName.toLowerCase();switch(i){case"b":case"em":case"strong":n.bl=h.BooleanNumber.TRUE;break;case"s":n.st={s:h.BooleanNumber.TRUE};break;case"u":n.ul={s:h.BooleanNumber.TRUE};break;case"i":n.it=h.BooleanNumber.TRUE;break;case"sub":case"sup":n.va="sup"===i?h.BaselineOffset.SUPERSCRIPT:h.BaselineOffset.SUBSCRIPT}for(let e=0;e<t.length;e++){let i=t[e],r=t.getPropertyValue(i);switch(i){case"font-family":n.ff=r.replace(/^"/g,"").replace(/"$/g,"");break;case"font-size":{let e=Number.parseInt(r);Number.isNaN(e)||(r.endsWith("pt")?n.fs=e:r.endsWith("px")&&(n.fs=(0,p.pixelToPt)(e)));break}case"font-style":"italic"===r&&(n.it=h.BooleanNumber.TRUE);break;case"font-weight":(Number(r)>400||"bold"===String(r))&&(n.bl=h.BooleanNumber.TRUE);break;case"text-decoration":/underline/.test(r)?n.ul={s:h.BooleanNumber.TRUE}:/overline/.test(r)?n.ol={s:h.BooleanNumber.TRUE}:/line-through/.test(r)&&(n.st={s:h.BooleanNumber.TRUE});break;case"color":try{let e=new h.ColorKit(r);e.isValid&&(n.cl={rgb:e.toRgbString()})}catch{}break;case"background-color":{let e=new h.ColorKit(r);e.isValid&&(n.bg={rgb:e.toRgbString()})}}}return n}function rt(e){let t=new DOMParser,n=`<x-univer id="univer-root">${e}</x-univer>`;return t.parseFromString(n,"text/html").querySelector("#univer-root")}function rn(e,t){let n=e.tagName.toLowerCase();return"string"==typeof t?n===t:Array.isArray(t)?t.some(e=>e===n):t(e)}w(re,"extractNodeStyle"),w(rt,"parseToDom"),w(rn,"matchFilter");let ri=class e{constructor(){F(this,"_tableCache",[]),F(this,"_styleCache",/* @__PURE__ */new Map),F(this,"_styleRules",[]),F(this,"_afterProcessRules",[])}static use(e){if(this._pluginList.includes(e))throw Error(`Univer paste plugin ${e.name} already added`);this._pluginList.push(e)}convert(t){let n=e._pluginList.find(e=>e.checkPasteType(t)),i=rt(t),r={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[]},tableSource:{}};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,i.childNodes,r),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],r}_process(e,t,n){var i,r;let a=n.body;for(let o of t)if(o.nodeType===Node.TEXT_NODE){let t;if((null==(i=o.nodeValue)?void 0:i.trim())==="")continue;let n=null==(r=o.nodeValue)?void 0:r.replace(/[\r\n]/g,"");e&&this._styleCache.has(e)&&(t=this._styleCache.get(e)),a.dataStream+=n,t&&Object.getOwnPropertyNames(t).length&&a.textRuns.push({st:a.dataStream.length-n.length,ed:a.dataStream.length,ts:t})}else{if((0,h.skipParseTagNames).includes(o.nodeName.toLowerCase()))continue;if(o.nodeType===Node.ELEMENT_NODE){let t=this._processBeforeLink(o,n),i=e?this._styleCache.get(e):{},r=this._styleRules.find(({filter:e})=>rn(o,e)),a=r?r.getStyle(o):re(o);this._styleCache.set(o,{...i,...a});let{childNodes:s}=o;this._processBeforeTable(o,n),this._process(o,s,n),this._processAfterTable(o,n);let l=this._afterProcessRules.find(({filter:e})=>rn(o,e));l&&l.handler(n,o),this._processAfterLink(o,n,t)}}}_processBeforeTable(e,t){var n;let i=e.tagName.toUpperCase(),r=t.body;switch(i){case"TABLE":{"\r"!==r.dataStream[r.dataStream.length-1]&&(r.dataStream+="\r",null==r.paragraphs&&(r.paragraphs=[]),null==(n=r.paragraphs)||n.push({startIndex:r.dataStream.length-1}));let e=iB(0,0,600);this._tableCache.push({table:e,startIndex:r.dataStream.length}),r.dataStream+=h.DataStreamTreeTokenType.TABLE_START;break}case"TR":{let e=ix(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(e),r.dataStream+=h.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{let e=iR(),t=this._tableCache[this._tableCache.length-1].table;t.tableRows[t.tableRows.length-1].tableCells.push(e),r.dataStream+=h.DataStreamTreeTokenType.TABLE_CELL_START}}}_processAfterTable(e,t){var n,i;let r=e.tagName.toUpperCase(),a=t.body;null==t.tableSource&&(t.tableSource={}),null==a.tables&&(a.tables=[]),null==a.sectionBreaks&&(a.sectionBreaks=[]);let{tableSource:o}=t;switch(r){case"TABLE":{let{startIndex:e,table:t}=this._tableCache.pop(),n=t.tableRows[0].tableCells.length,i=iO(600/n),r=[...Array(n).fill(null).map(()=>(0,h.Tools).deepClone(i))];t.tableColumns=r,o[t.tableId]=t,a.dataStream+=h.DataStreamTreeTokenType.TABLE_END,a.tables.push({startIndex:e,endIndex:a.dataStream.length,tableId:t.tableId});break}case"TR":a.dataStream+=h.DataStreamTreeTokenType.TABLE_ROW_END;break;case"TD":"\r"!==a.dataStream[a.dataStream.length-1]&&(null==(n=a.paragraphs)||n.push({startIndex:a.dataStream.length}),a.dataStream+="\r"),null==(i=a.sectionBreaks)||i.push({startIndex:a.dataStream.length}),a.dataStream+=`
${h.DataStreamTreeTokenType.TABLE_CELL_END}`}}_processBeforeLink(e,t){let n=t.body,i=n.dataStream.length;return"A"===e.tagName.toUpperCase()&&(n.dataStream+=h.DataStreamTreeTokenType.CUSTOM_RANGE_START),i}_processAfterLink(e,t,n){var i,r;let a=t.body;"A"===e.tagName.toUpperCase()&&(a.dataStream+=h.DataStreamTreeTokenType.CUSTOM_RANGE_END,a.customRanges=null!=(i=a.customRanges)?i:[],a.customRanges.push({startIndex:n,endIndex:a.dataStream.length-1,rangeId:null!=(r=e.dataset.rangeid)?r:(0,h.generateRandomId)(),rangeType:h.CustomRangeType.HYPERLINK,properties:{url:e.href}}))}};function rr(e){let t=e.style,n={};for(let e=0;e<t.length;e++){let i=t[e],r=t.getPropertyValue(i);switch(i){case"margin-top":{let e=Number.parseInt(r);n.spaceAbove={v:/pt/.test(r)?(0,p.ptToPixel)(e):e};break}case"margin-bottom":{let e=Number.parseInt(r);n.spaceBelow={v:/pt/.test(r)?(0,p.ptToPixel)(e):e};break}case"line-height":{let e=Number.parseFloat(r);r.endsWith("%")&&(e/=100),n.lineSpacing=e}}}return Object.getOwnPropertyNames(n).length?n:null}function ra(e,t){let{st:n,ed:i,ts:r={}}=t,{ff:a,fs:o,it:s,bl:l,ul:A,st:d,ol:c,bg:u,cl:g,va:p}=r,m=e.slice(n,i),f=[];return s===h.BooleanNumber.TRUE&&(m=`<i>${m}</i>`),p===h.BaselineOffset.SUPERSCRIPT?m=`<sup>${m}</sup>`:p===h.BaselineOffset.SUBSCRIPT&&(m=`<sub>${m}</sub>`),(null==A?void 0:A.s)===h.BooleanNumber.TRUE&&(m=`<u>${m}</u>`),(null==d?void 0:d.s)===h.BooleanNumber.TRUE&&(m=`<s>${m}</s>`),l===h.BooleanNumber.TRUE&&(m=`<strong>${m}</strong>`),a&&f.push(`font-family: ${a}`),g&&f.push(`color: ${g.rgb}`),o&&f.push(`font-size: ${o}pt`),c&&f.push("text-decoration: overline"),u&&f.push(`background: ${u.rgb}`),f.length?`<span style="${f.join("; ")};">${m}</span>`:m}function ro(e,t,n){let{dataStream:i,textRuns:r=[]}=e,a=t,o=[];for(let e of r){let{st:r,ed:s}=e;(0,h.Tools).hasIntersectionBetweenTwoRanges(t,n,r,s)&&(r>a?(o.push(i.slice(a,r)),o.push(ra(i,{...e,ed:Math.min(s,n)}))):o.push(ra(i,{...e,st:a,ed:Math.min(s,n)}))),a=Math.max(t,Math.min(s,n))}return a!==n&&o.push(i.slice(a,n)),o.join("")}function rs(e,t,n){let{customRanges:i=[]}=e,r=i.filter(e=>e.startIndex>=t&&e.endIndex<=n),a=t,o="";r.forEach(t=>{var n,i;let{startIndex:r,endIndex:s,rangeType:l,rangeId:A}=t,d=ro(e,a,r);o+=d;let c=ro(e,r+1,s);l===h.CustomRangeType.HYPERLINK?o+=`<a data-rangeid="${A}" href="${null!=(i=null==(n=t.properties)?void 0:n.url)?i:""}">${c}</a>`:o+=c,a=s+1});let s=ro(e,a,n);return o+=s}function rl(e){let{paragraphs:t=[],sectionBreaks:n=[]}=e,{dataStream:i}=e;i.endsWith(`\r
`)||(i+=`\r
`,t.push({startIndex:i.length-2}),n.push({startIndex:i.length-1}),e.dataStream=i,e.paragraphs=t,e.sectionBreaks=n);let r={html:""};for(let t of(0,p.parseDataStreamToTree)(i))rA(t,e,r);return r.html}function rA(e,t,n){var i;switch(e.nodeType){case h.DataStreamTreeNodeType.SECTION_BREAK:for(let i of e.children)rA(i,t,n);break;case h.DataStreamTreeNodeType.PARAGRAPH:{let{children:r,startIndex:a,endIndex:o}=e,{paragraphStyle:s={}}=null!=(i=t.paragraphs.find(e=>e.startIndex===o))?i:{},{spaceAbove:l,spaceBelow:A,lineSpacing:d}=s,c=[];if(null!=l&&("number"==typeof l?c.push(`margin-top: ${l}px`):c.push(`margin-top: ${l.v}px`)),null!=A&&("number"==typeof A?c.push(`margin-bottom: ${A}px`):c.push(`margin-bottom: ${A.v}px`)),null!=d&&c.push(`line-height: ${d}`),n.html+=`<p class="UniverNormal" ${c.length?`style="${c.join("; ")};"`:""}>`,r.length)for(let e of r)rA(e,t,n);n.html+=`${rs(t,a,o)}</p>`;break}case h.DataStreamTreeNodeType.TABLE:{let{children:i}=e;for(let e of(n.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>',i))rA(e,t,n);n.html+="</tbody></table>";break}case h.DataStreamTreeNodeType.TABLE_ROW:{let{children:i}=e;for(let e of(n.html+='<tr class="UniverTableRow">',i))rA(e,t,n);n.html+="</tr>";break}case h.DataStreamTreeNodeType.TABLE_CELL:{let{children:i}=e;for(let e of(n.html+='<td class="UniverTableCell">',i))rA(e,t,n);n.html+="</td>";break}default:throw Error(`Unknown node type: ${e.nodeType}`)}}w(ri,"HtmlToUDMService"),F(ri,"_pluginList",[]),w(rr,"getParagraphStyle"),w(ra,"covertTextRunToHtml"),w(ro,"getBodyInlineSlice"),w(rs,"getBodySliceHtml"),w(rl,"convertBodyToHtml"),w(rA,"processNode");let rd=class{convert(e){if(0===e.length)throw Error("The bodyList length at least to be 1");let t="";for(let n of(0,h.Tools).deepClone(e))t+=rl(n);return t}};w(rd,"UDMToHtmlService");var rc=Object.defineProperty,ru=Object.getOwnPropertyDescriptor,rh=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?ru(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&rc(t,n,a),a},"__decorateClass$n"),rg=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$n");function rp(e,t,n){var i,r,a;let o=(0,h.getBodySlice)(e,t,n+2),s=h.DataStreamTreeTokenType.TABLE_START+h.DataStreamTreeTokenType.TABLE_ROW_START+h.DataStreamTreeTokenType.TABLE_CELL_START+o.dataStream+h.DataStreamTreeTokenType.TABLE_CELL_END+h.DataStreamTreeTokenType.TABLE_ROW_END+h.DataStreamTreeTokenType.TABLE_END;return o.dataStream=s,null==(i=o.textRuns)||i.forEach(e=>{let{st:t,ed:n}=e;e.st=t+3,e.ed=n+3}),null==(r=o.tables)||r.forEach(e=>{let{startIndex:t,endIndex:n}=e;e.startIndex=t+3,e.endIndex=n+3}),null==(a=o.paragraphs)||a.forEach(e=>{let{startIndex:t}=e;e.startIndex=t+3}),o}ri.use({name:"univer-doc-paste-plugin-word",checkPasteType:e=>/word|mso/i.test(e),stylesRules:[{filter:["b"],getStyle(e){let t=re(e);return{bl:h.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter:e=>"P"===e.tagName,handler(e,t){let n=e.body;null==n.paragraphs&&(n.paragraphs=[]);let i={startIndex:n.dataStream.length},r=rr(t);r&&(i.paragraphStyle=r),n.paragraphs.push(i),n.dataStream+="\r"}}]}),ri.use({name:"univer-doc-paste-plugin-lark",checkPasteType:e=>/lark-record-clipboard/i.test(e),stylesRules:[{filter:["s"],getStyle(e){let t=re(e);return{st:{s:h.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter:e=>"DIV"===e.tagName&&/ace-line/i.test(e.className),handler(e){let t=e.body;null==t.paragraphs&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]}),ri.use({name:"univer-doc-paste-plugin-univer",checkPasteType:e=>/UniverNormal/i.test(e),stylesRules:[],afterProcessRules:[{filter:e=>"P"===e.tagName&&/UniverNormal/i.test(e.className),handler(e,t){let n=e.body;null==n.paragraphs&&(n.paragraphs=[]);let i={startIndex:n.dataStream.length},r=rr(t);r&&(i.paragraphStyle=r),n.paragraphs.push(i),n.dataStream+="\r"}}]}),w(rp,"getTableSlice");let rm=(0,h.createIdentifier)("doc.clipboard-service"),rf=(w(aX=class extends h.Disposable{constructor(e,t,n,i,r){super(),F(this,"_clipboardHooks",[]),F(this,"_htmlToUDM",new ri),F(this,"_umdToHtml",new rd),this._univerInstanceService=e,this._logService=t,this._commandService=n,this._clipboardInterfaceService=i,this._docSelectionManagerService=r}async copy(e=h.SliceBodyType.copy){var t;let{bodyList:n=[],needCache:i=!1,snapshot:r}=null!=(t=this._getDocumentBodyInRanges(e))?t:{};if(0===n.length||null==r)return!1;try{let e=this._docSelectionManagerService.getActiveTextRange(),t=!!(null!=e&&e.segmentId);this._setClipboardData(n,r,!t&&i)}catch(e){return this._logService.error("[DocClipboardService] copy failed",e),!1}return!0}async cut(){return this._cut()}async paste(e){let t=await this._genDocDataFromClipboardItems(e);return this._paste(t)}async legacyPaste(e,t){var n;let i=this._genDocDataFromHtmlAndText(e,t);if((null==(n=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC))?void 0:n.getUnitId())===h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY){if(t){let e=(0,h.BuildTextUtils).transform.fromPlainText(t);return this._paste({body:e})}i.body.textRuns=[]}return this._paste(i)}async _cut(){var e,t,n;let{segmentId:i,endOffset:r,style:a}=null!=(e=this._docSelectionManagerService.getActiveTextRange())?e:{},o=null!=(t=this._docSelectionManagerService.getTextRanges())?t:[],s=null!=(n=this._docSelectionManagerService.getRectRanges())?n:[];if(null==i&&this._logService.error("[DocClipboardController] segmentId is not existed"),0===o.length&&0===s.length)return!1;this.copy(h.SliceBodyType.cut);try{let e=0;if(s.length>0)e=i9(o,s);else if(null!=r)for(let t of(e=r,o)){let{startOffset:n,endOffset:i}=t;null==n||null==i||i<=r&&(e-=i-n)}let t=[{startOffset:e,endOffset:e,style:a}];return this._commandService.executeCommand(iK.id,{segmentId:i,textRanges:t})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(e){var t,n;let{body:i}=e;if(null==i)return!1;let r=(0,h.normalizeBody)(i);if(!(null==(t=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC))?void 0:t.getUnitId()))return!1;this._clipboardHooks.forEach(e=>{e.onBeforePaste&&(r=e.onBeforePaste(r))}),r.customRanges=null==(n=r.customRanges)?void 0:n.map(h.BuildTextUtils.customRange.copyCustomRange);let{segmentId:a,endOffset:o,style:s}=this._docSelectionManagerService.getActiveTextRange()||{},l=this._docSelectionManagerService.getTextRanges();if(null==a&&this._logService.error("[DocClipboardController] segmentId does not exist!"),null==o||null==l)return!1;try{let t=o;for(let e of l){let{startOffset:n,endOffset:i}=e;null==n||null==i||i<=o&&(t+=r.dataStream.length-(i-n))}let n=[{startOffset:t,endOffset:t,style:s}];return this._commandService.executeCommand(iW.id,{doc:{...e,body:r},segmentId:a,textRanges:n})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(e,t,n=!0){var i,r;let a=i6(),o=(e.length>1?e.map(e=>e.dataStream).join(`
`):e[0].dataStream).replaceAll(h.DataStreamTreeTokenType.CUSTOM_RANGE_START,"").replaceAll(h.DataStreamTreeTokenType.CUSTOM_RANGE_END,"").replaceAll(h.DataStreamTreeTokenType.TABLE_START,"").replaceAll(h.DataStreamTreeTokenType.TABLE_END,"").replaceAll(h.DataStreamTreeTokenType.TABLE_ROW_START,"").replaceAll(h.DataStreamTreeTokenType.TABLE_ROW_END,"").replaceAll(h.DataStreamTreeTokenType.TABLE_CELL_START,"").replaceAll(h.DataStreamTreeTokenType.TABLE_CELL_END,"").replaceAll(`\r
`," "),s=this._umdToHtml.convert(e);if(1===e.length&&n){s=s.replace(/(<[a-z]+)/,(e,t)=>`${t} data-copy-id="${a}"`);let n=e[0],o={body:n};if(null!=(i=n.customBlocks)&&i.length)for(let e of(o.drawings={},n.customBlocks)){let{blockId:n}=e,i=null==(r=t.drawings)?void 0:r[n];if(i){let t=(0,h.Tools).generateRandomId(6);e.blockId=t,o.drawings[t]={...(0,h.Tools).deepClone(i),drawingId:t}}}i7.set(a,o)}return this._clipboardInterfaceService.write(o,s)}addClipboardHook(e){return this._clipboardHooks.push(e),(0,h.toDisposable)(()=>{let t=this._clipboardHooks.indexOf(e);t>-1&&this._clipboardHooks.splice(t,1)})}_getDocumentBodyInRanges(e){var t;let n=this._univerInstanceService.getCurrentUniverDocInstance(),i=this._docSelectionManagerService.getDocRanges(),r=[],a=!0;if(null==n||0===i.length)return;let o=i[0].segmentId,s=null==(t=null==n?void 0:n.getSelfOrHeaderFooterModel(o))?void 0:t.getBody(),l=n.getSnapshot();if(null!=s){for(let t of i){let{startOffset:i,endOffset:l,collapsed:A,rangeType:d}=t;if(A||null==i||null==l)continue;if(d===h.DOC_RANGE_TYPE.RECT){let e;a=!1;let{spanEntireRow:n}=t;e=rp(s,i,l),r.push(e);continue}let c=(0,h.BuildTextUtils).selection.getDeleteSelection({startOffset:i,endOffset:l,collapsed:A},s),u=n.getSelfOrHeaderFooterModel(o).sliceBody(c.startOffset,c.endOffset,e);null!=u&&r.push(u)}return{bodyList:r,needCache:a,snapshot:l}}}async _genDocDataFromClipboardItems(e){try{let t="",n="";for(let i of e)for(let e of i.types)e===N.PLAIN_TEXT_CLIPBOARD_MIME_TYPE?n=await i.getType(e).then(e=>e&&e.text()):e===N.HTML_CLIPBOARD_MIME_TYPE&&(t=await i.getType(e).then(e=>e&&e.text()));return this._genDocDataFromHtmlAndText(t,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(e,t){if(!e){if(t)return{body:(0,h.BuildTextUtils).transform.fromPlainText(t)};throw Error("[DocClipboardService] html and text cannot be both empty!")}let n=i8(e);if(n){let e=i7.get(n);if(e)return e}return this._htmlToUDM.convert(e)}},"DocClipboardService"),aX);function rS(e){return e.getContextValue(h.FOCUSING_DOC)||e.getContextValue(h.EDITOR_ACTIVATED)}rf=rh([rg(0,h.IUniverInstanceService),rg(1,h.ILogService),rg(2,h.ICommandService),rg(3,N.IClipboardInterfaceService),rg(4,(0,h.Inject)(g.DocSelectionManagerService))],rf),w(rS,"whenDocOrEditor");let rI={id:N.CopyCommand.id,name:"doc.command.copy",type:h.CommandType.COMMAND,multi:!0,priority:999,preconditions:rS,handler:/* @__PURE__ */w(async e=>e.get(rm).copy(),"handler")},rv={id:N.CutCommand.id,name:"doc.command.cut",type:h.CommandType.COMMAND,multi:!0,priority:999,preconditions:rS,handler:/* @__PURE__ */w(async e=>e.get(rm).cut(),"handler")},rE={id:N.PasteCommand.id,name:"doc.command.paste",type:h.CommandType.COMMAND,multi:!0,priority:999,preconditions:rS,handler:/* @__PURE__ */w(async e=>{let t=e.get(rm),n=await e.get(N.IClipboardInterfaceService).read();return 0!==n.length&&t.paste(n)},"handler")},rC={id:"doc.command.switch-mode",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{var t,n,i,r,a;let o;let s=e.get(h.ICommandService),l=e.get(p.IRenderManagerService),A=e.get(g.DocSelectionManagerService),d=e.get(h.IUniverInstanceService).getCurrentUniverDocInstance();if(null==d)return!1;let c=d.getUnitId(),u=null==(t=l.getRenderById(c))?void 0:t.with(g.DocSkeletonManagerService).getSkeleton(),m=null==(n=l.getRenderById(c))?void 0:n.with(e0);if(null==u||null==m)return!1;let f=null==m?void 0:m.getSegment(),S=null==m?void 0:m.getSegmentPage(),I=d.getSnapshot().documentStyle.documentFlavor,v=A.getDocRanges(),E={id:g.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:I===h.DocumentFlavor.TRADITIONAL&&f?[]:v}},C=(0,h.JSONX).getInstance(),T=[];if(!(o=void 0===I?C.insertOp(["documentStyle","documentFlavor"],h.DocumentFlavor.MODERN):I===h.DocumentFlavor.MODERN?C.replaceOp(["documentStyle","documentFlavor"],I,h.DocumentFlavor.TRADITIONAL):C.replaceOp(["documentStyle","documentFlavor"],I,h.DocumentFlavor.MODERN)))return!1;if(T.push(o),I!==h.DocumentFlavor.MODERN){let{drawings:e={},body:t}=d.getSnapshot(),n=null!=(i=null==t?void 0:t.customBlocks)?i:[];for(let t in e){let i=e[t],o=n.find(e=>e.blockId===t);if(null==o)continue;let s=i.docTransform.positionV,{relativeFrom:l,posOffset:A}=s;if(l===h.ObjectRelativeFromV.PARAGRAPH)continue;let{startIndex:d}=o,c=u.findNodeByCharIndex(d,f,S),g=null==(r=null==c?void 0:c.parent)?void 0:r.parent,p=null==g?void 0:g.parent,m=null==p?void 0:p.lines.find(e=>e.paragraphIndex===(null==g?void 0:g.paragraphIndex)&&e.paragraphStart),I=null==(a=null==p?void 0:p.parent)?void 0:a.parent;if(null==c||null==g||null==m||null==p||null==I)continue;let v=0;l===h.ObjectRelativeFromV.LINE?v-=g.top:l===h.ObjectRelativeFromV.PAGE&&(v+=I.marginTop),v+=m.top;let E={...s,relativeFrom:h.ObjectRelativeFromV.PARAGRAPH,posOffset:(null!=A?A:0)-v},b=C.replaceOp(["drawings",t,"docTransform","positionV"],s,E);b&&T.push(b)}}return E.params.actions=T.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!s.syncExecuteCommand(E.id,E.params)},"handler")},rT={id:"doc.table.delete-rows",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{let t=e.get(g.DocSelectionManagerService),n=e.get(h.IUniverInstanceService),i=e.get(h.ICommandService),r=t.getRectRanges(),a=iM(t.getActiveTextRange(),r);if(null==a)return!1;let{segmentId:o}=a,s=n.getCurrentUniverDocInstance(),l=null==s?void 0:s.getSelfOrHeaderFooterModel(o).getBody();if(null==s||null==l)return!1;let A=J(e,s.getUnitId());if(null==A)return!1;let d=A.getViewModel(),c=null==s?void 0:s.getUnitId(),u=new h.TextX,p=(0,h.JSONX).getInstance(),m=iQ(a,d);if(null==m)return!1;let{offset:f,rowIndexes:S,len:I,tableId:v,cursor:E,selectWholeTable:C}=m;if(C)return i.executeCommand(ry.id);let T=[],b={id:g.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:[{startOffset:E,endOffset:E,collapsed:!0}]}};f>0&&u.push({t:h.TextXActionType.RETAIN,len:f}),u.push({t:h.TextXActionType.DELETE,len:I});let y=Z(s,o);for(let e of(T.push(p.editOp(u.serialize(),y)),S.reverse())){let t=p.removeOp(["tableSource",v,"tableRows",e]);T.push(t)}return b.params.actions=T.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!i.syncExecuteCommand(b.id,b.params)},"handler")},rb={id:"doc.table.delete-columns",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{let t=e.get(g.DocSelectionManagerService),n=e.get(h.IUniverInstanceService),i=e.get(h.ICommandService),r=t.getRectRanges(),a=iM(t.getActiveTextRange(),r);if(null==a)return!1;let{segmentId:o}=a,s=n.getCurrentUniverDocInstance(),l=null==s?void 0:s.getSelfOrHeaderFooterModel(o).getBody();if(null==s||null==l)return!1;let A=J(e,s.getUnitId());if(null==A)return!1;let d=A.getViewModel(),c=null==s?void 0:s.getUnitId(),u=new h.TextX,p=(0,h.JSONX).getInstance(),m=iw(a,d);if(null==m)return!1;let{offsets:f,columnIndexes:S,tableId:I,cursor:v,rowCount:E,selectWholeTable:C}=m;if(C)return i.executeCommand(ry.id);let T=[],b={id:g.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:[{startOffset:v,endOffset:v,collapsed:!0}]}};for(let e of f){let{retain:t,delete:n}=e;t>0&&u.push({t:h.TextXActionType.RETAIN,len:t}),u.push({t:h.TextXActionType.DELETE,len:n})}let y=Z(s,o);T.push(p.editOp(u.serialize(),y)),S.reverse();for(let e=0;e<E;e++)for(let t of S){let n=p.removeOp(["tableSource",I,"tableRows",e,"tableCells",t]);T.push(n)}for(let e of S){let t=p.removeOp(["tableSource",I,"tableColumns",e]);T.push(t)}return b.params.actions=T.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!i.syncExecuteCommand(b.id,b.params)},"handler")},ry={id:"doc.table.delete-table",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{let t=e.get(g.DocSelectionManagerService),n=e.get(h.IUniverInstanceService),i=e.get(h.ICommandService),r=t.getRectRanges(),a=iM(t.getActiveTextRange(),r);if(null==a)return!1;let{segmentId:o}=a,s=n.getCurrentUniverDocInstance(),l=null==s?void 0:s.getSelfOrHeaderFooterModel(o).getBody();if(null==s||null==l)return!1;let A=J(e,s.getUnitId());if(null==A)return!1;let d=A.getViewModel(),c=null==s?void 0:s.getUnitId(),u=new h.TextX,p=(0,h.JSONX).getInstance(),m=iF(a,d);if(null==m)return!1;let{offset:f,len:S,tableId:I,cursor:v}=m,E=[],C={id:g.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:[{startOffset:v,endOffset:v,collapsed:!0}]}};f>0&&u.push({t:h.TextXActionType.RETAIN,len:f}),u.push({t:h.TextXActionType.DELETE,len:S});let T=Z(s,o);return E.push(p.editOp(u.serialize(),T)),E.push(p.removeOp(["tableSource",I])),C.params.actions=E.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!i.syncExecuteCommand(C.id,C.params)},"handler")},rR="doc.command.table-insert-row",rx="doc.command.table-insert-column",rO={id:"doc.command.table-insert-row-above",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>e.get(h.ICommandService).executeCommand(rR,{position:iT.ABOVE}),"handler")},rB={id:"doc.command.table-insert-row-bellow",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>e.get(h.ICommandService).executeCommand(rR,{position:iT.BELLOW}),"handler")},rM={id:"doc.command.table-insert-column-left",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>e.get(h.ICommandService).executeCommand(rx,{position:ib.LEFT}),"handler")},rD={id:"doc.command.table-insert-column-right",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>e.get(h.ICommandService).executeCommand(rx,{position:ib.RIGHT}),"handler")},rN={id:rR,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let{position:n}=t,i=e.get(g.DocSelectionManagerService),r=e.get(h.IUniverInstanceService),a=e.get(h.ICommandService),o=i.getRectRanges(),s=iM(i.getActiveTextRange(),o);if(null==s)return!1;let{segmentId:l}=s,A=r.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),d=null==A?void 0:A.getSelfOrHeaderFooterModel(l).getBody();if(null==A||null==d)return!1;let c=J(e,A.getUnitId());if(null==c)return!1;let u=c.getViewModel(),p=null==A?void 0:A.getUnitId(),m=new h.TextX,f=(0,h.JSONX).getInstance(),S=i_(s,n,u);if(null==S)return!1;let{offset:I,colCount:v,tableId:E,insertRowIndex:C}=S,T=[],b=I+2,y={id:g.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:[{startOffset:b,endOffset:b,collapsed:!0}]}};I>0&&m.push({t:h.TextXActionType.RETAIN,len:I});let R=iD(v);m.push({t:h.TextXActionType.INSERT,body:R,len:R.dataStream.length});let x=Z(A,l);T.push(f.editOp(m.serialize(),x));let O=ix(v);return T.push(f.insertOp(["tableSource",E,"tableRows",C],O)),y.params.actions=T.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!a.syncExecuteCommand(y.id,y.params)},"handler")},r_={id:rx,type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n,i,r;let{position:a}=t,o=e.get(g.DocSelectionManagerService),s=e.get(h.IUniverInstanceService),l=e.get(h.ICommandService),A=o.getRectRanges(),d=iM(o.getActiveTextRange(),A);if(null==d)return!1;let{segmentId:c}=d,u=s.getCurrentUniverDocInstance(),p=null==u?void 0:u.getSelfOrHeaderFooterModel(c).getBody();if(null==u||null==p)return!1;let m=J(e,u.getUnitId());if(null==m)return!1;let f=m.getViewModel(),S=null==u?void 0:u.getUnitId(),I=new h.TextX,v=(0,h.JSONX).getInstance(),E=iU(d,a,f);if(null==E)return!1;let{offsets:C,columnIndex:T,tableId:b,rowCount:y}=E,R=[],x=C[0]+1,O={id:g.RichTextEditingMutation.id,params:{unitId:S,actions:[],textRanges:[{startOffset:x,endOffset:x,collapsed:!0}]}};for(let e of C){I.push({t:h.TextXActionType.RETAIN,len:e});let t=iN();I.push({t:h.TextXActionType.INSERT,body:t,len:t.dataStream.length})}let B=Z(u,c);R.push(v.editOp(I.serialize(),B));for(let e=0;e<y;e++){let t=iR(),n=v.insertOp(["tableSource",b,"tableRows",e,"tableCells",T],t);R.push(n)}let M=u.getSnapshot(),D=M.documentStyle,{marginLeft:N=0,marginRight:_=0}=D,U=(null!=(i=null==(n=D.pageSize)?void 0:n.width)?i:800)-N-_,P=null==(r=null==M?void 0:M.tableSource)?void 0:r[b].tableColumns,{newColWidth:Q,widths:w}=iP(U,P,T);for(let e=0;e<w.length;e++){let t=v.replaceOp(["tableSource",b,"tableColumns",e,"size","width","v"],P[e].size.width.v,w[e]);R.push(t)}let F=iO(Q),L=v.insertOp(["tableSource",b,"tableColumns",T],F);return R.push(L),O.params.actions=R.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!l.syncExecuteCommand(O.id,O.params)},"handler")},rU="COMPONENT_DOC_CREATE_TABLE_CONFIRM";function rP(e,t){let n=[];for(let t=0,i=e.length;t<i;t++)e[t]===h.DataStreamTreeTokenType.PARAGRAPH&&n.push({startIndex:t});if(t)for(let e of n)t.bullet&&(e.bullet=(0,h.Tools).deepClone(t.bullet)),t.paragraphStyle&&(e.paragraphStyle=(0,h.Tools).deepClone(t.paragraphStyle));return n}w(rP,"generateParagraphs");let rQ={id:"doc.command.break-line",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{var t,n;let i=e.get(g.DocSelectionManagerService),r=e.get(h.IUniverInstanceService),a=e.get(h.ICommandService),o=i.getActiveTextRange(),s=i.getRectRanges();if(null==o)return!1;if(s&&s.length){let{startOffset:e}=o;return i.replaceDocRanges([{startOffset:e,endOffset:e}]),!0}let{segmentId:l}=o,A=r.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),d=null==A?void 0:A.getSelfOrHeaderFooterModel(null!=l?l:"").getBody();if(null==A||null==d)return!1;let c=A.getUnitId(),{startOffset:u,endOffset:p}=(0,h.BuildTextUtils).selection.getInsertSelection(o,d),m=(null!=(t=d.paragraphs)?t:[]).find(e=>e.startIndex>=u);if(!m)return!1;let f=m.startIndex,S={dataStream:h.DataStreamTreeTokenType.PARAGRAPH,paragraphs:rP(h.DataStreamTreeTokenType.PARAGRAPH,m)},I=await a.executeCommand(iX.id,{unitId:c,body:S,range:{startOffset:u,endOffset:p},segmentId:l});return(null==(n=m.bullet)?void 0:n.listType)===h.PresetListType.CHECK_LIST_CHECKED?!!await a.executeCommand(n0.id,{index:f+1-(p-u),segmentId:l,textRanges:[{startOffset:u+1,endOffset:u+1}]})&&I:I},"handler")},rw={id:"doc.command.create-table",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n,i,r,a,o,s;let{rowCount:l,colCount:A}=t,d=e.get(g.DocSelectionManagerService),c=e.get(h.IUniverInstanceService),u=e.get(h.ICommandService),p=d.getActiveTextRange();if(null==p)return!1;let{segmentId:m,segmentPage:f}=p,S=c.getCurrentUniverDocInstance(),I=null==S?void 0:S.getSelfOrHeaderFooterModel(m).getBody();if(null==S||null==I)return!1;let v=S.getUnitId(),E=J(e,v),C=null==E?void 0:E.getSkeleton();if(null==C)return!1;let{startOffset:T}=(0,h.BuildTextUtils).selection.getInsertSelection(p,I),b=(null!=(n=I.paragraphs)?n:[]).find(e=>e.startIndex>=T),y=C.findNodeByCharIndex(T,m,f),R=null==(i=null==y?void 0:y.parent)?void 0:i.parent,x=C.findNodeByCharIndex(T-1,m,f),O=x&&"\r"!==x.content;if(null==y||null==R)return!1;let B=O||R.isBehindTable,M=new h.TextX,D=(0,h.JSONX).getInstance(),N=[],_=T+(B?4:3),U={id:g.RichTextEditingMutation.id,params:{unitId:v,actions:[],textRanges:[{startOffset:_,endOffset:_,collapsed:!0}]}};T>0&&M.push({t:h.TextXActionType.RETAIN,len:T}),B&&M.push({t:h.TextXActionType.INSERT,body:{dataStream:h.DataStreamTreeTokenType.PARAGRAPH,paragraphs:rP(h.DataStreamTreeTokenType.PARAGRAPH,b)},len:1});let{dataStream:P,paragraphs:Q,sectionBreaks:w}=iy(l,A),F=null==(s=null==(o=null==(a=null==(r=y.parent)?void 0:r.parent)?void 0:a.parent)?void 0:o.parent)?void 0:s.parent;if(null==F)return!1;let{pageWidth:L,marginLeft:k,marginRight:H}=F,V=iB(l,A,L-k-H);M.push({t:h.TextXActionType.INSERT,body:{dataStream:P,paragraphs:Q,sectionBreaks:w,tables:[{startIndex:0,endIndex:P.length,tableId:V.tableId}]},len:P.length});let j=Z(S,m);return N.push(D.editOp(M.serialize(),j)),N.push(D.insertOp(["tableSource",V.tableId],V)),U.params.actions=N.reduce((e,t)=>(0,h.JSONX).compose(e,t),null),!!u.syncExecuteCommand(U.id,U.params)},"handler")},rF="doc.component.create-table-confirm",rL={id:"doc.operation.create-table",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{let t=e.get(h.LocaleService),n=e.get(N.IConfirmService),i=e.get(h.ICommandService),r={rowCount:3,colCount:5},a=/* @__PURE__ */w((e,t)=>{r.rowCount=e,r.colCount=t},"handleRowColChange");return await n.open({id:rF,children:{label:{name:rU,props:{handleRowColChange:a,tableCreateParams:r}}},width:400,title:{title:t.t("toolbar.table.insert")},onConfirm:/* @__PURE__ */w(()=>{i.executeCommand(rw.id,r),n.close(rF)},"onConfirm"),onClose:/* @__PURE__ */w(()=>{n.close(rF)},"onClose")}),!0},"handler")},rk={id:"doc-paragraph-setting.command",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n,i,r;let a=e.get(g.DocSelectionManagerService),o=e.get(h.IUniverInstanceService),s=e.get(h.ICommandService),l=o.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),A=a.getDocRanges();if(!l||0===A.length||!t)return!1;let d=A[0].segmentId,c=l.getUnitId(),u=null!=(r=n2(A,null!=(i=null==(n=l.getSelfOrHeaderFooterModel(d).getBody())?void 0:n.paragraphs)?i:[]))?r:[],p={id:g.RichTextEditingMutation.id,params:{unitId:c,actions:[],textRanges:A}},m=new h.MemoryCursor;m.reset();let f=new h.TextX,S=(0,h.JSONX).getInstance();for(let e of u){let{startIndex:n}=e;f.push({t:h.TextXActionType.RETAIN,len:n-m.cursor});let i={...e.paragraphStyle,...t.paragraph};f.push({t:h.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...e,paragraphStyle:i,startIndex:0}]},coverType:h.UpdateDocsAttributeType.REPLACE}),m.moveCursorTo(n+1)}let I=Z(l,d);return p.params.actions=S.editOp(f.serialize(),I),!!s.syncExecuteCommand(p.id,p.params)},"handler")},rH=/* @__PURE__ */w(()=>{let e=(0,h.useDependency)(g.DocSelectionManagerService),t=(0,h.useDependency)(r5),n=(0,m.useMemo)(()=>e.getDocRanges(),[]);return(0,m.useEffect)(()=>{n.length||t.closePanel()},[n]),n},"useDocRanges"),rV=/* @__PURE__ */w(()=>{var e,t,n;let i=(0,h.useDependency)(h.IUniverInstanceService).getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC),r=rH();if(!i||0===r.length)return[];let a=r[0].segmentId;return null!=(n=n2(r,null!=(t=null==(e=i.getSelfOrHeaderFooterModel(a).getBody())?void 0:e.paragraphs)?t:[]))?n:[]},"useCurrentParagraph"),rj=/* @__PURE__ */w((e,t)=>{let n=(0,h.useDependency)(h.ICommandService),[i,r]=(0,m.useState)(()=>{var n,i;let r=e[0];return r?String(null!=(i=null==(n=r.paragraphStyle)?void 0:n.horizontalAlign)?i:t):t});return[i,/* @__PURE__ */w(e=>(r(e),n.executeCommand(rk.id,{paragraph:{horizontalAlign:Number(e)}})),"horizontalAlignSet")]},"useFirstParagraphHorizontalAlign"),rW=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),[n,i]=(0,m.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.indentStart,0):0});return[n,/* @__PURE__ */w(e=>(i(e),t.executeCommand(rk.id,{paragraph:{indentStart:{v:e}}})),"indentStartSet")]},"useFirstParagraphIndentStart"),rz=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),[n,i]=(0,m.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.indentEnd,0):0});return[n,/* @__PURE__ */w(e=>(i(e),t.executeCommand(rk.id,{paragraph:{indentEnd:{v:e}}})),"indentEndSet")]},"useFirstParagraphIndentEnd"),rG=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),[n,i]=(0,m.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.indentFirstLine,0):0});return[n,/* @__PURE__ */w(e=>(i(e),t.executeCommand(rk.id,{paragraph:{indentFirstLine:{v:e}}})),"indentFirstLineSet")]},"useFirstParagraphIndentFirstLine"),rY=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),[n,i]=(0,m.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.hanging,0):0});return[n,/* @__PURE__ */w(e=>(i(e),t.executeCommand(rk.id,{paragraph:{hanging:{v:e}}})),"hangingSet")]},"useFirstParagraphIndentHanging"),rK=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),[n,i]=(0,m.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.spaceAbove,0):0});return[n,/* @__PURE__ */w(e=>(i(e),t.executeCommand(rk.id,{paragraph:{spaceAbove:{v:e}}})),"spaceAboveSet")]},"useFirstParagraphIndentSpaceAbove"),rq=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),[n,i]=(0,m.useState)(()=>{var t;let n=e[0];return n?(0,p.getNumberUnitValue)(null==(t=n.paragraphStyle)?void 0:t.spaceBelow,0):0});return[n,/* @__PURE__ */w(e=>(i(e),t.executeCommand(rk.id,{paragraph:{spaceBelow:{v:e}}})),"spaceBelowSet")]},"useFirstParagraphSpaceBelow"),rX=/* @__PURE__ */w(e=>{let t=(0,h.useDependency)(h.ICommandService),n=(0,h.useDependency)(p.IRenderManagerService),i=(0,h.useDependency)(h.IUniverInstanceService),r=(0,m.useMemo)(()=>{var e;let t=i.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if(t)return null==(e=n.getRenderById(null==t?void 0:t.getUnitId()))?void 0:e.with(g.DocSkeletonManagerService).getSkeleton()},[]),a=(0,m.useMemo)(()=>new I.BehaviorSubject({}),[]),[o,s]=(0,m.useState)(()=>{var t,n;let i=e[0];return i&&null!=(n=null==(t=i.paragraphStyle)?void 0:t.lineSpacing)?n:1}),l=(0,m.useRef)(o),[A,d]=(0,m.useState)(()=>{var t,n;let i=e[0];return i&&null!=(n=null==(t=i.paragraphStyle)?void 0:t.spacingRule)?n:h.SpacingRule.AUTO}),c=/* @__PURE__ */w(async e=>{s(e),a.next({lineSpacing:e,spacingRule:A})},"lineSpacingSet"),u=/* @__PURE__ */w(async t=>{if(t!==A){let n=l.current;if(t===h.SpacingRule.AT_LEAST){let t=null==r?void 0:r.findNodeByCharIndex(e[0].startIndex),i=null==t?void 0:t.parent,a=null==i?void 0:i.parent;(null==a?void 0:a.contentHeight)!==void 0&&(n=Math.max(a.contentHeight,n))}else n>5&&(n=2);l.current=o,c(n),d(t),a.next({spacingRule:t})}},"spacingRuleSet");return(0,m.useEffect)(()=>{let e=a.pipe((0,C.filter)(e=>!!Object.keys(e).length),(0,_.bufferTime)(16),(0,C.filter)(e=>!!e.length),(0,b.map)(e=>e.reduce((e,t)=>(Object.keys(t).forEach(n=>{e[n]=t[n]}),e),{}))).subscribe(e=>t.executeCommand(rk.id,{paragraph:{...e}}));return()=>e.unsubscribe()},[]),{lineSpacing:[o,c],spacingRule:[A,u]}},"useFirstParagraphLineSpacing"),rJ={paragraphSettingIconList:"univer-paragraph-setting-icon-list",paragraphSettingIconListItem:"univer-paragraph-setting-icon-list-item",paragraphSettingIconListActive:"univer-paragraph-setting-icon-list-active",paragraphSettingTitle:"univer-paragraph-setting-title",paragraphSettingLabel:"univer-paragraph-setting-label",paragraphSettingMtBase:"univer-paragraph-setting-mt-base",paragraphSettingFlexCol:"univer-paragraph-setting-flex-col",paragraphSettingSpaceLine:"univer-paragraph-setting-space-line"},rZ=/* @__PURE__ */w(e=>{let{value:t,onChange:n,className:i="",min:r=0,max:a=100,step:o=1}=e,s=m.useRef(null);return /* @__PURE__ */eu.jsx(U.InputNumber,{step:o,ref:s,min:r,max:a,value:t,onChange:/* @__PURE__ */w(e=>{n(null!=e?e:0).finally(()=>{setTimeout(()=>{var e;null==(e=s.current)||e.focus()},30)})},"onChange"),className:i})},"AutoFocusInputNumber");function r$(){let e=(0,h.useDependency)(h.LocaleService),t=(0,m.useMemo)(()=>[{label:e.t("toolbar.alignLeft"),value:String(h.HorizontalAlign.LEFT),icon:/* @__PURE__ */eu.jsx(tE,{})},{label:e.t("toolbar.alignCenter"),value:String(h.HorizontalAlign.CENTER),icon:/* @__PURE__ */eu.jsx(tf,{})},{label:e.t("toolbar.alignRight"),value:String(h.HorizontalAlign.RIGHT),icon:/* @__PURE__ */eu.jsx(tT,{})},{label:e.t("toolbar.alignJustify"),value:String(h.HorizontalAlign.JUSTIFIED),icon:/* @__PURE__ */eu.jsx(tc,{})}],[]),n=rV(),[i,r]=rj(n,t[0].value),[a,o]=rW(n),[s,l]=rz(n),[A,d]=rG(n),[c,u]=rY(n),[g,p]=rK(n),[f,S]=rq(n),{lineSpacing:[I,v],spacingRule:[E,C]}=rX(n),T=(0,m.useMemo)(()=>E===h.SpacingRule.AUTO?{min:1,max:5,step:I<2?.5:1}:{min:1,max:100},[E,I]);return /* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSetting,children:[/* @__PURE__ */eu.jsx("div",{className:rJ.paragraphSettingTitle,children:e.t("doc.paragraphSetting.alignment")}),/* @__PURE__ */eu.jsx("div",{className:`${rJ.paragraphSettingIconList} ${rJ.paragraphSettingMtBase}`,children:t.map(e=>/* @__PURE__ */eu.jsx(U.Tooltip,{title:e.label,placement:"bottom",children:/* @__PURE__ */eu.jsx("span",{className:tB(rJ.paragraphSettingIconListItem,{[rJ.paragraphSettingIconListActive]:i===e.value}),onClick:/* @__PURE__ */w(()=>r(e.value),"onClick"),children:e.icon})},e.value))}),/* @__PURE__ */eu.jsx("div",{className:rJ.paragraphSettingTitle,children:e.t("doc.paragraphSetting.indentation")}),/* @__PURE__ */eu.jsxs("div",{children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.left"),"(px)"]}),/* @__PURE__ */eu.jsx(rZ,{className:rJ.paragraphSettingMtBase,value:a,onChange:/* @__PURE__ */w(e=>o(null!=e?e:0),"onChange")})]}),/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.right"),"(px)"]}),/* @__PURE__ */eu.jsx(rZ,{className:rJ.paragraphSettingMtBase,value:s,onChange:/* @__PURE__ */w(e=>l(null!=e?e:0),"onChange")})]}),/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.firstLine"),"(px)"]}),/* @__PURE__ */eu.jsx(rZ,{className:rJ.paragraphSettingMtBase,value:A,onChange:/* @__PURE__ */w(e=>d(null!=e?e:0),"onChange")})]}),/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.hanging"),"(px)"]}),/* @__PURE__ */eu.jsx(rZ,{className:rJ.paragraphSettingMtBase,value:c,onChange:/* @__PURE__ */w(e=>u(null!=e?e:0),"onChange")})]})]}),/* @__PURE__ */eu.jsx("div",{className:rJ.paragraphSettingTitle,children:e.t("doc.paragraphSetting.spacing")}),/* @__PURE__ */eu.jsxs("div",{children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.before"),"(px)"]}),/* @__PURE__ */eu.jsx(rZ,{className:rJ.paragraphSettingMtBase,value:g,onChange:/* @__PURE__ */w(e=>p(null!=e?e:0),"onChange")})]}),/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingLabel,children:[e.t("doc.paragraphSetting.after"),"(px)"]}),/* @__PURE__ */eu.jsx(rZ,{className:rJ.paragraphSettingMtBase,value:f,onChange:/* @__PURE__ */w(e=>S(null!=e?e:0),"onChange")})]}),/* @__PURE__ */eu.jsxs("div",{className:rJ.paragraphSettingFlexCol,children:[/* @__PURE__ */eu.jsx("div",{className:rJ.paragraphSettingLabel,children:e.t("doc.paragraphSetting.lineSpace")}),/* @__PURE__ */eu.jsxs("div",{className:`${rJ.paragraphSettingMtBase} ${rJ.paragraphSettingSpaceLine}`,style:{width:162},children:[/* @__PURE__ */eu.jsx(U.Select,{value:`${E}`,options:[{label:e.t("doc.paragraphSetting.multiSpace"),value:`${h.SpacingRule.AUTO}`},{label:e.t("doc.paragraphSetting.fixedValue"),value:`${h.SpacingRule.AT_LEAST}`}],onChange:/* @__PURE__ */w(e=>C(Number(e)),"onChange")}),/* @__PURE__ */eu.jsx(rZ,{...T,value:I,onChange:/* @__PURE__ */w(e=>v(null!=e?e:0),"onChange")})]})]})]})]})}w(r$,"ParagraphSetting");let r0=/* @__PURE__ */w((e,t)=>t.length===e.length&&e.some(e=>t.some(t=>t.startOffset===e.startOffset&&t.endOffset===e.endOffset)),"isRangesEqual"),r1=/* @__PURE__ */w((e,t)=>e.some(e=>t.some(t=>{let{startOffset:n,endOffset:i}=e,{startOffset:r,endOffset:a}=t;return null!=n&&null!=i&&null!=r&&null!=a&&n<=a&&i>=r})),"isRangesIntersection");function r9(){let e=(0,h.useDependency)(h.ICommandService),t=(0,h.useDependency)(h.LocaleService),n=(0,h.useObservable)(t.currentLocale$),[i,r]=(0,m.useState)(""),a=(0,m.useRef)([]);return(0,m.useEffect)(()=>{let t=e.onCommandExecuted(e=>{var t;if(g.SetTextSelectionsOperation.id===e.id){let t=e.params.ranges;r0(t,a.current)||r((0,h.generateRandomId)(4)),a.current=t}if(g.RichTextEditingMutation.id===e.id){let n=e.params,i=null!=(t=n.textRanges)?t:[];n.trigger!==rk.id&&r1(i,a.current)&&r((0,h.generateRandomId)(4))}});return()=>t.dispose()},[]),(0,m.useEffect)(()=>{r((0,h.generateRandomId)(4))},[n]),/* @__PURE__ */eu.jsx(r$,{},i)}w(r9,"ParagraphSettingIndex");var r3=Object.defineProperty,r2=Object.getOwnPropertyDescriptor,r4=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?r2(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&r3(t,n,a),a},"__decorateClass$m"),r6=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$m");let r8="doc_ui_paragraph-setting-panel",r5=(w(aJ=class extends h.Disposable{constructor(e,t,n){super(),F(this,"_id"),this._commandService=e,this._componentManager=t,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(r8,r9))}openPanel(){let e={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:r8},width:300};this._sidebarService.open(e)}closePanel(){this._sidebarService.close(this._id)}},"DocParagraphSettingController"),aJ);r5=r4([r6(0,h.ICommandService),r6(1,(0,h.Inject)(N.ComponentManager)),r6(2,(0,h.Inject)(N.ISidebarService))],r5);let r7={id:"sidebar.operation.doc-paragraph-setting-panel",type:h.CommandType.OPERATION,handler:/* @__PURE__ */w(e=>(e.get(r5).openPanel(),!0),"handler")},ae=/* @__PURE__ */w(e=>{let t=e.get(g.DocSelectionManagerService);return new R.Observable(e=>{let n=t.textSelection$.subscribe(()=>{let n=t.getActiveTextRange();n&&!n.collapsed?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})},"getDisableOnCollapsedObservable");function at(e){if(e.length<2)return!0;let t=e.map(e=>e.tableId);return t.every(e=>e===t[0])}w(at,"inSameTable");let an=/* @__PURE__ */w(e=>{let t=e.get(g.DocSelectionManagerService),n=e.get(h.IUniverInstanceService);return new R.Observable(e=>{let i=t.textSelection$.subscribe(()=>{var i;let r=t.getRectRanges(),a=t.getActiveTextRange();if(r&&r.length&&at(r)){e.next(!1);return}if(a&&(null==r||0===r.length)){let{segmentId:t,startOffset:r,endOffset:o}=a,s=n.getCurrentUniverDocInstance(),l=null==(i=null==s?void 0:s.getSelfOrHeaderFooterModel(t).getBody())?void 0:i.tables;if(l&&l.length&&l.some(e=>{let{startIndex:t,endIndex:n}=e;return r>t&&r<n||o>t&&o<n})){e.next(!1);return}}e.next(!0)});return e.next(!0),()=>i.unsubscribe()})},"getDisableWhenSelectionNotInTableObservable"),ai=/* @__PURE__ */w(e=>({id:rI.name,commandId:rI.id,type:N.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.copy",disabled$:ae(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}),"CopyMenuFactory"),ar=/* @__PURE__ */w(e=>({id:r7.id,type:N.MenuItemType.BUTTON,icon:"MenuSingle24",title:"doc.menu.paragraphSetting",hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}),"ParagraphSettingMenuFactory"),aa=/* @__PURE__ */w(e=>({id:rv.id,type:N.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.cut",disabled$:ae(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}),"CutMenuFactory"),ao=/* @__PURE__ */w(e=>({id:rE.id,type:N.MenuItemType.BUTTON,icon:"PasteSpecial",title:"rightClick.paste",hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}),"PasteMenuFactory"),as=/* @__PURE__ */w(e=>({id:i3.id,type:N.MenuItemType.BUTTON,icon:"PasteSpecial",title:"rightClick.delete",disabled$:ae(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}),"DeleteMenuFactory"),al="doc.menu.table-insert";function aA(e){return{id:al,type:N.MenuItemType.SUBITEMS,title:"table.insert",icon:"Insert",hidden$:(0,v.combineLatest)((0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),an(e),(e,t)=>e||t)}}function ad(e){return{id:rO.id,type:N.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAbove",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function ac(e){return{id:rB.id,type:N.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelow",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function au(e){return{id:rM.id,type:N.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumn",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function ah(e){return{id:rD.id,type:N.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumn",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}w(aA,"TableInsertMenuItemFactory"),w(ad,"InsertRowBeforeMenuItemFactory"),w(ac,"InsertRowAfterMenuItemFactory"),w(au,"InsertColumnLeftMenuItemFactory"),w(ah,"InsertColumnRightMenuItemFactory");let ag="doc.menu.table-delete";function ap(e){return{id:ag,type:N.MenuItemType.SUBITEMS,title:"table.delete",icon:"Reduce",hidden$:(0,v.combineLatest)((0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),an(e),(e,t)=>e||t)}}function am(e){return{id:rT.id,type:N.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRow",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function af(e){return{id:rb.id,type:N.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumn",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aS(e){return{id:ry.id,type:N.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridSingle",disabled$:an(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aI(e){let t=e.get(h.IUniverInstanceService),n=e.get(p.IRenderManagerService);return new R.Observable(e=>{let i=t.focused$.subscribe(i=>{if(null==i||t.getUnitType(i)!==h.UniverInstanceType.UNIVER_DOC)return e.next(!0);let r=n.getRenderById(i);if(null==r)return e.next(!0);r.with(g.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(t=>{e.next(t===p.DocumentEditArea.HEADER||t===p.DocumentEditArea.FOOTER)})}),r=n.getCurrentTypeOfRenderer(h.UniverInstanceType.UNIVER_DOC);if(null==r)return e.next(!0);let a=r.with(g.DocSkeletonManagerService).getViewModel();return e.next(a.getEditArea()!==p.DocumentEditArea.BODY),()=>i.unsubscribe()})}function av(e){let t=e.get(h.IUniverInstanceService),n=e.get(h.ICommandService);return new R.Observable(e=>{let i=n.onCommandExecuted(n=>{if(n.id===rC.id){let n=t.getCurrentUniverDocInstance();if(null==n){e.next(!0);return}let i=n.getSnapshot().documentStyle;e.next((null==i?void 0:i.documentFlavor)!==h.DocumentFlavor.TRADITIONAL)}}),r=t.focused$.subscribe(n=>{var i;if(null==n){e.next(!0);return}let r=t.getUnit(n);if(null==r){e.next(!0);return}return e.next((null==(i=r.getSnapshot().documentStyle)?void 0:i.documentFlavor)!==h.DocumentFlavor.TRADITIONAL)});return()=>{r.unsubscribe(),i.dispose()}})}function aE(e){let t=e.get(g.DocSelectionManagerService),n=e.get(h.IUniverInstanceService);return new R.Observable(i=>{let r=t.textSelection$.subscribe(t=>{if(null==t){i.next(!0);return}let{textRanges:r}=t;if(1!==r.length){i.next(!0);return}let{collapsed:a,startNodePosition:o,startOffset:s}=r[0];if(!a||null==s){i.next(!0);return}let l=n.getCurrentUniverDocInstance();if(null==l){i.next(!0);return}let A=J(e,l.getUnitId());if(null==A||A.getViewModel().getCustomRangeRaw(s)){i.next(!0);return}if(null!=o){let{path:e}=o;if(-1!==e.indexOf("cells")){i.next(!0);return}}i.next(!1)});return()=>r.unsubscribe()})}function aC(e){let t=e.get(g.DocSelectionManagerService);return new R.Observable(e=>{let n=t.textSelection$.subscribe(t=>{if(null==t){e.next(!0);return}let{textRanges:n,rectRanges:i}=t;if(0===n.length&&0===i.length){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function aT(e){let t=e.get(h.ICommandService);return{id:nT.id,type:N.MenuItemType.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nz.id){let t=aY(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.bl;n.next(r===h.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function ab(e){let t=e.get(h.ICommandService);return{id:ny.id,type:N.MenuItemType.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nz.id){let t=aY(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.it;n.next(r===h.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function ay(e){let t=e.get(h.ICommandService);return{id:nx.id,type:N.MenuItemType.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nz.id){let t=aY(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.ul;n.next((null==r?void 0:r.s)===h.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aR(e){let t=e.get(h.ICommandService);return{id:nB.id,type:N.MenuItemType.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nz.id){let t=aY(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.st;n.next((null==r?void 0:r.s)===h.BooleanNumber.TRUE)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function ax(e){let t=e.get(h.ICommandService);return{id:nD.id,type:N.MenuItemType.BUTTON,icon:"SubscriptSingle",tooltip:"toolbar.subscript",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nz.id){let t=aY(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.va;n.next(r===h.BaselineOffset.SUBSCRIPT)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aO(e){let t=e.get(h.ICommandService);return{id:n_.id,type:N.MenuItemType.BUTTON,icon:"SuperscriptSingle",tooltip:"toolbar.superscript",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nz.id){let t=aY(e);if(null==t){n.next(!1);return}let r=null==(i=t.ts)?void 0:i.va;n.next(r===h.BaselineOffset.SUPERSCRIPT)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aB(e){let t=e.get(h.ICommandService);return{id:nw.id,tooltip:"toolbar.font",type:N.MenuItemType.SELECTOR,label:t4,selections:(0,N.FONT_FAMILY_LIST).map(e=>({label:{name:t6,hoverable:!0},value:e.value})),value$:new R.Observable(n=>{let i=N.FONT_FAMILY_LIST[0].value,r=t.onCommandExecuted(t=>{var r;let a=t.id;if(a===g.SetTextSelectionsOperation.id||a===nw.id){let t=aY(e);if(null==t){n.next(i);return}let a=null==(r=t.ts)?void 0:r.ff;n.next(null!=a?a:i)}});return n.next(i),r.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aM(e){let t=e.get(h.ICommandService);return{id:nP.id,type:N.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:t8,props:{min:1,max:400}},selections:N.FONT_SIZE_LIST,value$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===nP.id){let t=aY(e);if(null==t){n.next(14);return}let r=null==(i=t.ts)?void 0:i.fs;n.next(null!=r?r:14)}});return n.next(14),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aD(e){let t=e.get(h.ICommandService),n=e.get(h.ThemeService);return{id:nL.id,icon:"FontColor",tooltip:"toolbar.textColor.main",type:N.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:t2,hoverable:!1}}],value$:new R.Observable(e=>{let i=n.getCurrentTheme().textColor,r=t.onCommandExecuted(t=>{if(t.id===nL.id){let n=t.params.value;e.next(null!=n?n:i)}});return e.next(i),r.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aN(e){return{id:t1.id,type:N.MenuItemType.BUTTON,icon:"HeaderFooterSingle",tooltip:"toolbar.headerFooter",disabled$:av(e),hidden$:(0,v.combineLatest)((0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),(0,N.getHeaderFooterMenuHiddenObservable)(e),(e,t)=>e||t)}}w(ap,"TableDeleteMenuItemFactory"),w(am,"DeleteRowsMenuItemFactory"),w(af,"DeleteColumnsMenuItemFactory"),w(aS,"DeleteTableMenuItemFactory"),w(aI,"getInsertTableHiddenObservable"),w(av,"getHeaderFooterDisabledObservable"),w(aE,"getTableDisabledObservable"),w(aC,"disableMenuWhenNoDocRange"),w(aT,"BoldMenuItemFactory"),w(ab,"ItalicMenuItemFactory"),w(ay,"UnderlineMenuItemFactory"),w(aR,"StrikeThroughMenuItemFactory"),w(ax,"SubscriptMenuItemFactory"),w(aO,"SuperscriptMenuItemFactory"),w(aB,"FontFamilySelectorMenuItemFactory"),w(aM,"FontSizeSelectorMenuItemFactory"),w(aD,"TextColorSelectorMenuItemFactory"),w(aN,"HeaderFooterMenuItemFactory");let a_="doc.menu.table";function aU(e){return{id:a_,type:N.MenuItemType.SUBITEMS,icon:"GridSingle",tooltip:"toolbar.table.main",disabled$:aE(e),hidden$:(0,v.combineLatest)((0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),aI(e),(0,N.getHeaderFooterMenuHiddenObservable)(e),(e,t,n)=>e||t||n)}}function aP(e){return{id:rL.id,title:"toolbar.table.insert",type:N.MenuItemType.BUTTON,hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aQ(e){let t=e.get(h.ICommandService);return{id:n8.id,type:N.MenuItemType.BUTTON,icon:"LeftJustifyingSingle",tooltip:"toolbar.alignLeft",disabled$:aC(e),activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===n6.id){let t=aK(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===h.HorizontalAlign.LEFT)}});return n.next(!1),i.dispose}),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aw(e){let t=e.get(h.ICommandService);return{id:n5.id,type:N.MenuItemType.BUTTON,icon:"HorizontallySingle",tooltip:"toolbar.alignCenter",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===n6.id){let t=aK(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===h.HorizontalAlign.CENTER)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aF(e){let t=e.get(h.ICommandService);return{id:n7.id,type:N.MenuItemType.BUTTON,icon:"RightJustifyingSingle",tooltip:"toolbar.alignRight",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===n6.id){let t=aK(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===h.HorizontalAlign.RIGHT)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aL(e){let t=e.get(h.ICommandService);return{id:ie.id,type:N.MenuItemType.BUTTON,icon:"AlignTextBothSingle",tooltip:"toolbar.alignJustify",activated$:new R.Observable(n=>{let i=t.onCommandExecuted(t=>{var i;let r=t.id;if(r===g.SetTextSelectionsOperation.id||r===n6.id){let t=aK(e);if(null==t)return;let r=null==(i=t.paragraphStyle)?void 0:i.horizontalAlign;n.next(r===h.HorizontalAlign.JUSTIFIED)}});return n.next(!1),i.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}w(aU,"TableMenuFactory"),w(aP,"InsertTableMenuFactory"),w(aQ,"AlignLeftMenuItemFactory"),w(aw,"AlignCenterMenuItemFactory"),w(aF,"AlignRightMenuItemFactory"),w(aL,"AlignJustifyMenuItemFactory");let ak=/* @__PURE__ */w(e=>new R.Observable(t=>{let n;let i=e.get(h.IUniverInstanceService),r=e.get(g.DocSelectionManagerService),a=i.focused$.subscribe(e=>{if(null==n||n.unsubscribe(),null==e)return;let a=i.getUniverDocInstance(e);null!=a&&(n=r.textSelection$.subscribe(()=>{var e,n;let i=r.getActiveTextRange();if(i){let r;let o=a.getSelfOrHeaderFooterModel(null==i?void 0:i.segmentId);if(n3(i,null!=(n=null==(e=o.getBody())?void 0:e.paragraphs)?n:[]).every(e=>{var t;return r||(r=null==(t=e.bullet)?void 0:t.listType),e.bullet&&e.bullet.listType===r})){t.next(r);return}}t.next(void 0)}))});return()=>{a.unsubscribe(),null==n||n.unsubscribe()}}),"listValueFactory$");function aH(e){return{id:n1.id,type:N.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:nr,hoverable:!1},value$:ak(e)}],icon:"OrderSingle",tooltip:"toolbar.order",hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),disabled$:aC(e),activated$:ak(e).pipe((0,b.map)(e=>e&&0===e.indexOf("ORDER_LIST")))}}function aV(e){return{id:nZ.id,type:N.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:na,hoverable:!1},value$:ak(e)}],icon:"UnorderSingle",tooltip:"toolbar.unorder",disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),activated$:ak(e).pipe((0,b.map)(e=>e&&0===e.indexOf("BULLET_LIST")))}}function aj(e){return{id:n$.id,type:N.MenuItemType.BUTTON,icon:"TodoList",tooltip:"toolbar.checklist",disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC),activated$:ak(e).pipe((0,b.map)(e=>e&&0===e.indexOf("CHECK_LIST")))}}function aW(e){let t=e.get(h.ICommandService),n=e.get(h.IUniverInstanceService);return{id:rC.id,type:N.MenuItemType.BUTTON,icon:"KeyboardSingle",tooltip:"toolbar.documentFlavor",hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC,void 0,h.DOCS_ZEN_EDITOR_UNIT_ID_KEY),activated$:new R.Observable(e=>{var i;let r=t.onCommandExecuted(t=>{var i;if(t.id===rC.id){let t=n.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);e.next((null==(i=null==t?void 0:t.getSnapshot())?void 0:i.documentStyle.documentFlavor)===h.DocumentFlavor.MODERN)}}),a=n.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);return e.next((null==(i=null==a?void 0:a.getSnapshot())?void 0:i.documentStyle.documentFlavor)===h.DocumentFlavor.MODERN),()=>r.dispose()})}}function az(e){return{id:nj.id,type:N.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColor"}}function aG(e){let t=e.get(h.ICommandService),n=e.get(h.ThemeService);return{id:nH.id,tooltip:"toolbar.fillColor.main",type:N.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucket",selections:[{label:{name:t2,hoverable:!1}}],value$:new R.Observable(e=>{let i=n.getCurrentTheme().primaryColor,r=t.onCommandExecuted(t=>{if(t.id===nH.id){let n=t.params.value;e.next(null!=n?n:i)}});return e.next(i),r.dispose}),disabled$:aC(e),hidden$:(0,N.getMenuHiddenObservable)(e,h.UniverInstanceType.UNIVER_DOC)}}function aY(e){var t,n;let i;let r=e.get(h.IUniverInstanceService),a=e.get(g.DocSelectionManagerService),o=e.get(nv),s=r.getCurrentUniverDocInstance(),l=a.getActiveTextRange(),A=null!=(t=o.getStyleCache())?t:{};if(null==s||null==l)return{ts:A};let{startOffset:d,segmentId:c}=l,u=null==(n=s.getSelfOrHeaderFooterModel(c).getBody())?void 0:n.textRuns;if(null==u)return{ts:A};for(let e=u.length-1;e>=0;e--){let t=u[e];if(t.st<=d&&d<=t.ed){i=t;break}}return{...i,ts:{...null==i?void 0:i.ts,...A}}}function aK(e){var t;let n=e.get(h.IUniverInstanceService),i=e.get(g.DocSelectionManagerService),r=n.getCurrentUniverDocInstance(),a=i.getActiveTextRange();if(null==r||null==a)return;let{startOffset:o,segmentId:s}=a,l=null==(t=r.getSelfOrHeaderFooterModel(s).getBody())?void 0:t.paragraphs;if(null==l)return;let A=-1;for(let e of l){let{startIndex:t}=e;if(o>A&&o<=t)return e;A=t}return null}w(aH,"OrderListMenuItemFactory"),w(aV,"BulletListMenuItemFactory"),w(aj,"CheckListMenuItemFactory"),w(aW,"DocSwitchModeMenuItemFactory"),w(az,"ResetBackgroundColorMenuItemFactory"),w(aG,"BackgroundColorSelectorMenuItemFactory"),w(aY,"getFontStyleAtCursor"),w(aK,"getParagraphStyleAtCursor");let aq={[N.RibbonStartGroup.FORMAT]:{[nT.id]:{order:0,menuItemFactory:aT},[ny.id]:{order:1,menuItemFactory:ab},[nx.id]:{order:2,menuItemFactory:ay},[nB.id]:{order:3,menuItemFactory:aR},[nD.id]:{order:4,menuItemFactory:ax},[n_.id]:{order:5,menuItemFactory:aO},[nP.id]:{order:6,menuItemFactory:aM},[nw.id]:{order:7,menuItemFactory:aB},[nL.id]:{order:8,menuItemFactory:aD},[nH.id]:{order:9,menuItemFactory:aG,[nj.id]:{order:0,menuItemFactory:az}}},[N.RibbonStartGroup.LAYOUT]:{[a_]:{order:1,menuItemFactory:aU,[rL.id]:{order:0,menuItemFactory:aP}},[n8.id]:{order:2,menuItemFactory:aQ},[n5.id]:{order:3,menuItemFactory:aw},[n7.id]:{order:4,menuItemFactory:aF},[ie.id]:{order:5,menuItemFactory:aL},[n1.id]:{order:6,menuItemFactory:aH},[nZ.id]:{order:7,menuItemFactory:aV},[n$.id]:{order:8,menuItemFactory:aj},[t1.id]:{order:9,menuItemFactory:aN},[rC.id]:{order:10,menuItemFactory:aW}},[N.ContextMenuPosition.MAIN_AREA]:{[N.ContextMenuGroup.FORMAT]:{[rI.name]:{order:0,menuItemFactory:ai},[rv.id]:{order:1,menuItemFactory:aa},[rE.id]:{order:2,menuItemFactory:ao},[i3.id]:{order:3,menuItemFactory:as}},[N.ContextMenuGroup.LAYOUT]:{[r7.id]:{order:0,menuItemFactory:ar},[al]:{order:1,menuItemFactory:aA,[rO.id]:{order:1,menuItemFactory:ad},[rB.id]:{order:2,menuItemFactory:ac},[rM.id]:{order:3,menuItemFactory:au},[rD.id]:{order:4,menuItemFactory:ah}},[ag]:{order:2,menuItemFactory:ap,[rT.id]:{order:1,menuItemFactory:am},[rb.id]:{order:2,menuItemFactory:af},[ry.id]:{order:3,menuItemFactory:aS}}}}};var aX,aJ,aZ,a$=Object.defineProperty,a0=Object.getOwnPropertyDescriptor,a1=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?a0(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&a$(t,n,a),a},"__decorateClass$l"),a9=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$l");let a3=(w(aZ=class extends h.Disposable{constructor(e,t,n,i,r,a,o,s,l){super(),this._injector=e,this._componentManager=t,this._commandService=n,this._layoutService=i,this._menuManagerService=r,this._uiPartsService=a,this._univerInstanceService=o,this._shortcutService=s,this._configService=l,this._init()}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(t2,U.ColorPicker)),this.disposeWithMe(e.register(t4,N.FontFamily)),this.disposeWithMe(e.register(t6,N.FontFamilyItem)),this.disposeWithMe(e.register(t8,N.FontSize)),this.disposeWithMe(e.register(na,ni)),this.disposeWithMe(e.register(nr,nt)),this.disposeWithMe(e.register("TodoList",tx))}_initUiParts(){var e,t;let n=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_SHEET),i=this._configService.getConfig(iE);null!=(t=null==(e=null==i?void 0:i.layout)?void 0:e.docContainerConfig)&&t.footer&&!n&&this.disposeWithMe(this._uiPartsService.registerComponent(N.BuiltInUIPart.FOOTER,()=>(0,h.connectInjector)(iv,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(aq)}_initShortCut(){[it,ii,ir,ia,io,is,id,ic,iA,il,iu,ih,nc].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[t0,t1,tX].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(h.UniverInstanceType.UNIVER_DOC,e=>{this._injector.get(p.IRenderManagerService).getRenderById(e).with(e0).focus()}))}},"DocUIController"),aZ);a3=a1([a9(0,(0,h.Inject)(h.Injector)),a9(1,(0,h.Inject)(N.ComponentManager)),a9(2,h.ICommandService),a9(3,N.ILayoutService),a9(4,N.IMenuManagerService),a9(5,N.IUIPartsService),a9(6,h.IUniverInstanceService),a9(7,N.IShortcutService),a9(8,h.IConfigService)],a3);var a2=Object.defineProperty,a4=Object.getOwnPropertyDescriptor,a6=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?a4(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&a2(t,n,a),a},"__decorateClass$k"),a8=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$k");let a5=(w(a7=class extends h.RxDisposable{constructor(e,t,n,i){super(),this._context=e,this._textSelectionManagerService=t,this._editorService=n,this._docSkeletonManagerService=i,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>{if(null==e)return;let{isEditing:t,unitId:n}=e;n===this._context.unitId&&t&&this._context.unitId!==h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._scrollToSelection()})}scrollToRange(e){let t=this._docSkeletonManagerService.getSkeleton();if(!t)return;let{startOffset:n}=e,i=t.findNodePositionByCharIndex(n);i&&this.scrollToNode(i)}scrollToNode(e){var t;let{unitId:n,scene:i,mainComponent:r}=this._context,a=this._docSkeletonManagerService.getSkeleton();if(null==r||null==a)return;let o=r.getOffsetConfig(),{docsLeft:s,docsTop:l}=o,{contentBoxPointGroup:A}=new ex(o,a).getRangePointData(e,e),{left:d,top:c,height:u}=eU(A),h=d+s,g=c+l,p=i.getViewport(G.VIEW_MAIN),m=this._editorService.getEditor(n);if(null==p)return;let{left:f,top:S,right:I,bottom:v}=p.getBounding().viewBound,E=0,C=0,T=m?null!=(t=m.params.backScrollOffset)?t:0:100;g<S?E=g-S-T:g>v-u&&(E=g-v+u+T),h<f?C=h-f:h>I-1.5&&(C=h-I+1.5);let b=p.transViewportScroll2ScrollValue(C,E);p.scrollByBarDeltaValue(b)}_scrollToSelection(){let e=this._textSelectionManagerService.getActiveTextRange();if(null==e)return;let{collapsed:t,startNodePosition:n}=e;t&&this.scrollToNode(n)}},"DocBackScrollRenderController"),a7);a5=a6([a8(1,(0,h.Inject)(g.DocSelectionManagerService)),a8(2,e5),a8(3,(0,h.Inject)(g.DocSkeletonManagerService))],a5);var a7,oe,ot=Object.defineProperty,on=Object.getOwnPropertyDescriptor,oi=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?on(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&ot(t,n,a),a},"__decorateClass$j"),or=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$j");let oa=(w(oe=class extends h.RxDisposable{constructor(e,t,n,i,r,a,o){super(),this._context=e,this._commandService=t,this._docSelectionRenderService=n,this._docSkeletonManagerService=i,this._editorService=r,this._renderManagerService=a,this._univerInstanceService=o,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(e){var t,n;let i=null==(t=this._renderManagerService.getRenderById(e))?void 0:t.with(g.DocSkeletonManagerService),r=null==i?void 0:i.getSkeleton();if(!r||r.getViewModel().getDataModel().getSnapshot().disabled)return;r.calculate();let a=this._editorService.getEditor(e);if(this._editorService.isEditor(e)&&!(null!=a&&a.params.scrollBar)){null==(n=this._context.mainComponent)||n.makeDirty();return}this._recalculateSizeBySkeleton(r)}_addNewRender(){let{scene:e,engine:t}=this._context,n=new p.Viewport(G.VIEW_MAIN,e,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});e.attachControl(),e.onMouseWheel$.subscribeEvent((t,i)=>{let r=this._univerInstanceService.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if((null==r?void 0:r.getUnitId())===this._context.unitId){if(t.ctrlKey){let n=Math.abs(t.deltaX),i=n<40?.2:n<80?.4:.2;i*=t.deltaY>0?-1:1,e.scaleX<1&&(i/=2),e.scaleX+i>4?e.scale(4,4):e.scaleX+i<.1?e.scale(.1,.1):t.preventDefault()}else n.onMouseWheel(t,i)}}),new p.ScrollBar(n),e.addLayer(new p.Layer(e,[],Y),new p.Layer(e,[],4)),this._addComponent(),t.runRenderLoop(()=>{e.render()}),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){let{scene:e,unit:t,components:n}=this._context,i={pageMarginLeft:20,pageMarginTop:20},r=new p.Documents(z.MAIN,void 0,i);r.zIndex=10;let a=new p.DocBackground(z.BACKGROUND,void 0,i);a.zIndex=10,this._context.mainComponent=r,n.set(z.MAIN,r),n.set(z.BACKGROUND,a),e.addObjects([r],Y),e.addObjects([a],0),null==this._editorService.getEditor(t.getUnitId())&&e.enableLayerCache(Y)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>{this._create(e)})}_create(e){if(!e)return;let{mainComponent:t,components:n}=this._context,i=n.get(z.BACKGROUND);t.changeSkeleton(e),i.changeSkeleton(e),this._recalculateSizeBySkeleton(e)}_initCommandListener(){let e=[g.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){let{unitId:e}=t.params;this.reRender(e)}}))}_recalculateSizeBySkeleton(e){var t;let{mainComponent:n,scene:i,unitId:r,components:a}=this._context,o=a.get(z.BACKGROUND),s=null==(t=e.getSkeletonData())?void 0:t.pages;if(null==s)return;let l=0,A=0,d=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let e=0,t=s.length;e<t;e++){let i=s[e],{pageWidth:r,pageHeight:a,marginLeft:o,marginRight:c,marginTop:u,marginBottom:g}=i;d===h.DocumentFlavor.MODERN&&(r===Number.POSITIVE_INFINITY&&(r=i.width+o+c),a===Number.POSITIVE_INFINITY&&(a=i.height+u+g)),n.pageLayoutType===p.PageLayoutType.VERTICAL?(A+=a,A+=n.pageMarginTop,e===t-1&&(A+=n.pageMarginTop),l=Math.max(l,r)):n.pageLayoutType===p.PageLayoutType.HORIZONTAL&&(l+=r,e!==t-1&&(l+=n.pageMarginLeft),A=Math.max(A,a))}n.resize(l,A),o.resize(l,A);let c=this._editorService.getEditor(r);(!this._editorService.isEditor(r)||null!=c&&c.params.scrollBar)&&i.resize(l,A)}},"DocRenderController"),oe);oa=oi([or(1,h.ICommandService),or(2,(0,h.Inject)(e0)),or(3,(0,h.Inject)(g.DocSkeletonManagerService)),or(4,e5),or(5,p.IRenderManagerService),or(6,h.IUniverInstanceService)],oa);let oo=class extends h.RxDisposable{constructor(e){super(),F(this,"_previousActiveRange",null),F(this,"_undoMutationParamsCache",[]),F(this,"_redoMutationParamsCache",[]),this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:t=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=t}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,t){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(t)}fetchComposedUndoRedoMutationParams(){if(0===this._undoMutationParamsCache.length||null==this._previousActiveRange||0===this._redoMutationParamsCache.length)return null;let{unitId:e}=this._undoMutationParamsCache[0],t={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((e,t)=>(0,h.JSONX).compose(e,t.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((e,t)=>(0,h.JSONX).compose(e,t.actions),null),textRanges:[]},undoMutationParams:t,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}};w(oo,"DocIMEInputManagerService");let os={id:"doc.command.ime-input",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{var n,i;let{unitId:r,newText:a,oldTextLen:o,isCompositionEnd:s,isCompositionStart:l}=t,A=e.get(h.ICommandService),d=e.get(p.IRenderManagerService),c=e.get(h.IUniverInstanceService),u=e.get(nv),m=null==(n=d.getRenderById(r))?void 0:n.with(oo),f=c.getUnit(r,h.UniverInstanceType.UNIVER_DOC);if(null==f||null==m)return!1;let S=m.getActiveRange();if(!S)return!1;let{style:I,segmentId:v}=S,E=f.getSelfOrHeaderFooterModel(v).getBody();if(null==E)return!1;let C=(0,h.BuildTextUtils).selection.getInsertSelection(S,E);Object.assign(S,C);let{startOffset:T}=S,b=a.length,y=[{startOffset:T+b,endOffset:T+b,collapsed:!0,style:I}],R={id:g.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:y}},x=u.getStyleCache(),O=et(null!=(i=E.textRuns)?i:[],T+o,x),B=new h.TextX,M=(0,h.JSONX).getInstance();if(!S.collapsed&&l){let{dos:e,retain:t}=(0,h.BuildTextUtils).selection.getDeleteActions(S,v,0,E);B.push(...e),R.params.textRanges=[{startOffset:T+b+t,endOffset:T+b+t,collapsed:!0}]}else B.push({t:h.TextXActionType.RETAIN,len:T});o>0&&B.push({t:h.TextXActionType.DELETE,len:o}),B.push({t:h.TextXActionType.INSERT,body:{dataStream:a,textRuns:O?[{...O,st:0,ed:a.length}]:[]},len:a.length});let D=Z(f,v);R.params.actions=M.editOp(B.serialize(),D),R.params.noHistory=!s,R.params.isCompositionEnd=s;let N=A.syncExecuteCommand(R.id,R.params);return m.pushUndoRedoMutationParams(N,R.params),!!N},"handler")},ol={type:h.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:/* @__PURE__ */w(async(e,t)=>{var n,i,r;let a=e.get(h.ICommandService),o=e.get(h.IUndoRedoService),s=e.get(h.IUniverInstanceService),l=null==(n=s.getCurrentUniverDocInstance())?void 0:n.getUnitId();if(!l)return!1;let A=1;if(t&&(l=null!=(i=t.documentId)?i:l,A=null!=(r=t.zoomRatio)?r:A),!s.getUniverDocInstance(l))return!1;let d={zoomRatio:A,unitId:l},c=ig(e,d);return!!a.syncExecuteCommand(ip.id,d)&&(o.pushUndoRedo({unitID:l,undoMutations:[{id:ip.id,params:c}],redoMutations:[{id:ip.id,params:d}]}),!0)},"handler")},oA={id:"doc.table.tab-in-table",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async(e,t)=>{let{shift:n}=t,i=e.get(g.DocSelectionManagerService),r=i.getActiveTextRange(),a=e.get(h.ICommandService),o=e.get(h.IUniverInstanceService).getCurrentUniverDocInstance();if(!o)return!1;let s=J(e,o.getUnitId()),l=null==s?void 0:s.getSkeleton(),A=null==l?void 0:l.getViewModel().getSelfOrHeaderFooterViewModel(null==r?void 0:r.segmentId);if(null==A||null==r)return!1;let d=null;if(d=n?iH(A,r,ik.PREV):iH(A,r,ik.NEXT)){let{startOffset:e,endOffset:t}=d;return i.replaceDocRanges([{startOffset:e,endOffset:t}]),!0}return!1!==n||await a.executeCommand(rN.id,{position:iT.BELLOW})},"handler")},od={id:"doc.operation.move-cursor",type:h.CommandType.OPERATION,handler:/* @__PURE__ */w((e,t)=>!!t,"handler")},oc={id:"doc.operation.move-selection",type:h.CommandType.OPERATION,handler:/* @__PURE__ */w((e,t)=>!!t,"handler")},ou={id:"doc.operation.select-all",type:h.CommandType.COMMAND,handler:/* @__PURE__ */w(async e=>{let t=e.get(h.IUniverInstanceService),n=e.get(g.DocSelectionManagerService),i=t.getCurrentUniverDocInstance(),r=n.getActiveTextRange();if(null==i||null==r)return!1;let{segmentId:a}=r,o=i.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(null==o)return!1;let s=[{startOffset:0,endOffset:o.dataStream.length-2}];return n.replaceTextRanges(s,!1),!0},"handler")};var oh,og=Object.defineProperty,op=Object.getOwnPropertyDescriptor,om=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?op(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&og(t,n,a),a},"__decorateClass$i"),of=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$i");let oS=(oh=class{constructor(e,t,n){F(this,"_docContainer"),F(this,"getComponent",/* @__PURE__ */w(e=>{if(this._docContainer=e,!e.getContentRef().current)throw Error("container is not ready")},"getComponent")),F(this,"changeLocale",/* @__PURE__ */w(e=>{this._localeService.setLocale(e)},"changeLocale")),this._localeService=e,this._injector=t,this._configService=n}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(iE),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(e){if(this._docContainer)return e(this._docContainer)}getDocContainer(){return this._docContainer}},w(oh,"DocContainerUIController"),oh);oS=om([of(0,(0,h.Inject)(h.LocaleService)),of(1,(0,h.Inject)(h.Injector)),of(2,h.IConfigService)],oS);var oI,ov=Object.defineProperty,oE=Object.getOwnPropertyDescriptor,oC=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oE(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&ov(t,n,a),a},"__decorateClass$h"),oT=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$h");let ob=(w(oI=class extends h.RxDisposable{constructor(e){super(),F(this,"_docContainerController"),this._injector=e,this._docContainerController=this._injector.createInstance(oS)}},"AppUIController"),oI);ob=oC([oT(0,(0,h.Inject)(h.Injector))],ob);var oy,oR=Object.defineProperty,ox=Object.getOwnPropertyDescriptor,oO=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?ox(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oR(t,n,a),a},"__decorateClass$g"),oB=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$g");let oM=(oy=class extends h.Disposable{constructor(e){super(),this._docAutoFormatService=e,this._initListTabAutoFormat(),this._initListSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:no.id,match:/* @__PURE__ */w(e=>{var t;let{selection:n,paragraphs:i,unit:r}=e;if(1===i.length&&n.startOffset===i[0].paragraphStart&&i[0].bullet){let e=null==(t=r.getBody())?void 0:t.paragraphs,n=null==e?void 0:e.filter(e=>{var t;return(null==(t=e.bullet)?void 0:t.listId)===i[0].bullet.listId});return(null==n?void 0:n.findIndex(e=>e.startIndex===i[0].startIndex))!==0}return!!(i.length>1&&i.some(e=>e.bullet))},"match"),getMutations(e){let t=e.commandParams;return[{id:nJ.id,params:{type:null!=t&&t.shift?nX.decrease:nX.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:no.id,match:/* @__PURE__ */w(e=>{let{selection:t}=e,{startNodePosition:n,endNodePosition:i}=t;return!!(n&&i&&eB(n,i)||n&&!i&&n.path.indexOf("cells")>-1)},"match"),getMutations(e){let t=e.commandParams;return[{id:oA.id,params:{shift:!!(null!=t&&t.shift)}}]},priority:99}))}_initListSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:ns.id,match:/* @__PURE__ */w(e=>{var t;let{selection:n,paragraphs:i,unit:r}=e;if(!n.collapsed||1!==i.length)return!1;let a=null==(t=r.getBody())?void 0:t.dataStream.slice(i[0].paragraphStart,i[0].paragraphEnd-1);return!!(a&&Object.keys(h.QuickListTypeMap).includes(a))},"match"),getMutations(e){var t;let{paragraphs:n,unit:i}=e,r=null==(t=i.getBody())?void 0:t.dataStream.slice(n[0].paragraphStart,n[0].paragraphEnd-1);if(r&&Object.keys(h.QuickListTypeMap).includes(r)){let e=h.QuickListTypeMap[r];return[{id:n9.id,params:{listType:e,paragraph:n[0]}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:nl.id,match:/* @__PURE__ */w(e=>{let{paragraphs:t}=e;return!!(1===t.length&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},"match"),getMutations:/* @__PURE__ */w(e=>{let t=e.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:nJ.id,params:{type:nX.decrease}}]:[{id:nK.id,params:{listType:e.paragraphs[0].bullet.listType}}]:[]},"getMutations")}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:nl.id,match:/* @__PURE__ */w(()=>!0,"match"),getMutations:()=>[{id:rQ.id}],priority:-9999}))}},w(oy,"DocAutoFormatController"),oy);function oD(e){return e.rows[0].cells[0].sections[0].columns[0].lines[0]}function oN(e){let t=e.rows[e.rows.length-1],n=t.cells[t.cells.length-1];return(0,p.getLastLine)(n)}function o_(e,t){let{ed:n}=e,{skeTables:i}=t,r=null;for(let e of i.values())if(e.st===n+1){r=e;break}return r}function oU(e){let t=null==e?void 0:e.parent,n=null,i=null;if(null==e||null==t)return{lineBeforeTable:n,lineAfterTable:i};let{st:r,ed:a}=e,o=t.type===p.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return(0,p.lineIterator)(o,e=>{e.st===a+1?i=e:e.ed===r-1&&(n=e)}),{lineBeforeTable:n,lineAfterTable:i}}function oP(e){var t,n;let i=e.parent,r=null==i?void 0:i.parent,a=null==r?void 0:r.tableId;if(null==i||null==r)return;let o=i.cells.indexOf(e),s=r.rows[r.rows.indexOf(i)+1];if(null==s){if(a.indexOf("#-#")){let[e,i]=a.split("#-#"),s=null==(n=null==(t=r.parent)?void 0:t.parent)?void 0:n.pages,l=`${e}#-#${Number.parseInt(i)+1}`;if(s)for(let e of s){let{skeTables:t}=e;if(t.has(l)){let e=t.get(l);if(null!=e&&e.rows.length)return e.rows[0].cells[o]}}}return}return s.cells[o]}function oQ(e){var t,n;let i=e.parent,r=null==i?void 0:i.parent;if(null==i||null==r)return;let a=r.rows[r.rows.indexOf(i)-1],o=i.cells.indexOf(e);if(null==a){if(r.tableId.indexOf("#-#")){let[e,i]=r.tableId.split("#-#"),a=null==(n=null==(t=r.parent)?void 0:t.parent)?void 0:n.pages,s=`${e}#-#${Number.parseInt(i)-1}`;if(a)for(let e of a){let{skeTables:t}=e;if(t.has(s)){let e=t.get(s);if(null!=e&&e.rows.length)return e.rows[e.rows.length-1].cells[o]}}}return}return a.cells[o]}function ow(e,t){let{st:n}=e,{skeTables:i}=t,r=null;for(let e of i.values())if(e.ed===n-1){r=e;break}return r}function oF(e){return e.sections[0].columns[0].lines[0]}function oL(e){return(0,p.getLastLine)(e)}oM=oO([oB(0,(0,h.Inject)(W))],oM),w(oD,"firstLineInTable"),w(oN,"lastLineInTable"),w(o_,"findTableAfterLine"),w(oU,"findLineBeforeAndAfterTable"),w(oP,"findBellowCell"),w(oQ,"findAboveCell"),w(ow,"findTableBeforeLine"),w(oF,"firstLineInCell"),w(oL,"lastLineInCell");var ok,oH=Object.defineProperty,oV=Object.getOwnPropertyDescriptor,oj=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?oV(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oH(t,n,a),a},"__decorateClass$f"),oW=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$f");let oz=(w(ok=class extends h.Disposable{constructor(e,t,n,i){super(),F(this,"_onInputSubscription"),this._univerInstanceService=e,this._renderManagerService=t,this._textSelectionManagerService=n,this._commandService=i,this._commandExecutedListener()}dispose(){var e;super.dispose(),null==(e=this._onInputSubscription)||e.unsubscribe()}_commandExecutedListener(){let e=[od.id,oc.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(!e.includes(t.id))return;let n=t.params;switch(t.id){case od.id:return this._handleMoveCursor(n.direction);case oc.id:return this._handleShiftMoveSelection(n.direction);default:throw Error("Unknown command")}}))}_handleShiftMoveSelection(e){var t,n,i;let r=this._textSelectionManagerService.getActiveTextRange(),a=this._textSelectionManagerService.getTextRanges(),o=this._univerInstanceService.getCurrentUniverDocInstance();if(null==o)return;let s=null==(t=this._renderManagerService.getRenderById(o.getUnitId()))?void 0:t.with(g.DocSkeletonManagerService).getSkeleton(),l=this._getDocObject();if(null==r||null==s||null==l)return;let{startOffset:A,endOffset:d,style:c,collapsed:u,direction:p,segmentId:m,startNodePosition:f,endNodePosition:S,segmentPage:I}=r;if(a.length>1){let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;for(let e of a)t=Math.min(t,e.startOffset),n=Math.max(n,e.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:e===h.Direction.LEFT||e===h.Direction.UP?n:t,endOffset:e===h.Direction.LEFT||e===h.Direction.UP?t:n,style:c}],!1);return}let v=u||p===h.RANGE_DIRECTION.FORWARD?A:d,E=u||p===h.RANGE_DIRECTION.FORWARD?d:A,C=null!=(n=o.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)?n:Number.POSITIVE_INFINITY;if(e===h.Direction.LEFT||e===h.Direction.RIGHT){let t=s.findNodeByCharIndex(E-1,m,I),n=s.findNodeByCharIndex(E,m,I);E=Math.min(C-2,Math.max(0,E=e===h.Direction.RIGHT?E+n.count:E-(null!=(i=null==t?void 0:t.count)?i:0))),this._textSelectionManagerService.replaceTextRanges([{startOffset:v,endOffset:E,style:c}],!1),this._scrollToFocusNodePosition(o.getUnitId(),E)}else{let t=s.findNodeByCharIndex(E,m,I),n=l.document.getOffsetConfig(),i=u?f:p===h.RANGE_DIRECTION.FORWARD?S:f,r=this._getTopOrBottomPosition(s,t,i,e===h.Direction.DOWN,!0);if(null==r){let t=e===h.Direction.UP?0:C-2;if(t===E)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:v,endOffset:t,style:c}],!1);return}let a=new ex(n,s).getRangePointData(r,r).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:v,endOffset:a.endOffset,style:c}],!1),this._scrollToFocusNodePosition(o.getUnitId(),a.endOffset)}}_handleMoveCursor(e){var t,n,i,r;let a=this._textSelectionManagerService.getActiveTextRange(),o=this._textSelectionManagerService.getTextRanges(),s=this._univerInstanceService.getCurrentUniverDocInstance();if(null==s)return!1;let l=null==(t=this._renderManagerService.getRenderById(s.getUnitId()))?void 0:t.with(g.DocSkeletonManagerService).getSkeleton(),A=this._getDocObject();if(null==a||null==l||null==A||null==o)return;let{startOffset:d,endOffset:c,style:u,collapsed:p,segmentId:m,startNodePosition:f,endNodePosition:S,segmentPage:I}=a,v=s.getSelfOrHeaderFooterModel(m).getBody();if(null==v)return;let E=null!=(n=v.dataStream.length)?n:Number.POSITIVE_INFINITY,C=null!=(i=s.getCustomRanges())?i:[];if(e===h.Direction.LEFT||e===h.Direction.RIGHT){let t;if(!a.collapsed||o.length>1){let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(let e of o)n=Math.min(n,e.startOffset),i=Math.max(i,e.endOffset);t=e===h.Direction.LEFT?n:i}else{let n=l.findNodeByCharIndex(d-1,m,I),i=l.findNodeByCharIndex(d,m,I),a=l.findNodeByCharIndex(d+1,m,I);t=e===h.Direction.LEFT?Math.max(0,d-(null!=(r=null==n?void 0:n.count)?r:1)):Math.min(E-2,c+i.count+((null==a?void 0:a.streamType)===h.DataStreamTreeTokenType.SECTION_BREAK?1:0))}let n=[h.DataStreamTreeTokenType.CUSTOM_RANGE_START,h.DataStreamTreeTokenType.CUSTOM_RANGE_END,h.DataStreamTreeTokenType.TABLE_START,h.DataStreamTreeTokenType.TABLE_END,h.DataStreamTreeTokenType.TABLE_ROW_START,h.DataStreamTreeTokenType.TABLE_ROW_END,h.DataStreamTreeTokenType.TABLE_CELL_START,h.DataStreamTreeTokenType.TABLE_CELL_END,h.DataStreamTreeTokenType.SECTION_BREAK];if(e===h.Direction.LEFT)for(;n.includes(v.dataStream[t]);)t--;else for(;n.includes(v.dataStream[t]);)t++;C.filter(e=>e.wholeEntity&&e.startIndex<t&&e.endIndex>=t).forEach(n=>{t=e===h.Direction.LEFT?Math.min(n.startIndex,t):Math.max(n.endIndex+1,t)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,t),endOffset:Math.max(0,t),style:u}],!1),this._scrollToFocusNodePosition(s.getUnitId(),t)}else{let t=l.findNodeByCharIndex(d,m,I),n=l.findNodeByCharIndex(c,m,I),i=A.document.getOffsetConfig(),r=this._getTopOrBottomPosition(l,e===h.Direction.UP||p?t:n,e===h.Direction.UP||p?f:S,e===h.Direction.DOWN);if(null==r){let t;t=p?e===h.Direction.UP?0:E-2:e===h.Direction.UP?d:c,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,t),endOffset:Math.max(0,t),style:u}],!1);return}let a=new ex(i,l).getRangePointData(r,r).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...a,style:u}],!1),this._scrollToFocusNodePosition(s.getUnitId(),a.endOffset)}}_getTopOrBottomPosition(e,t,n,i,r=!1){if(null==t||null==n)return;let a=this._getGlyphLeftOffsetInLine(t),o=this._getNextOrPrevLine(t,i,r);if(null==o)return;let s=this._matchPositionByLeftOffset(e,o,a,n);if(null!=s)return{...s,isBack:!0}}_getGlyphLeftOffsetInLine(e){let t=e.parent;if(null==t)return Number.NEGATIVE_INFINITY;let n=t.left,{left:i}=e;return n+i}_matchPositionByLeftOffset(e,t,n,i){let r={distance:Number.POSITIVE_INFINITY};for(let e of t.divides){let t=e.left;for(let i of e.glyphGroup){if(i.streamType===h.DataStreamTreeTokenType.SECTION_BREAK)continue;let{left:e}=i,a=Math.abs(n-(t+e));a<r.distance&&(r.glyph=i,r.distance=a)}}if(null==r.glyph)return;let{segmentPage:a}=i;return e.findPositionByGlyph(r.glyph,a)}_getNextOrPrevLine(e,t,n=!1){var i,r,a,o,s,l,A,d,c,u,h,g;let m;let f=e.parent,S=null==f?void 0:f.parent,I=null==S?void 0:S.parent,v=null==I?void 0:I.parent,E=null==v?void 0:v.parent;if(null==f||null==S||null==I||null==v||null==E)return;let C=I.lines.indexOf(S);if(-1===C)return;if(E.type===p.DocumentSkeletonPageType.CELL&&n){let e=oG(E,t);if(e)return e}if(!0===t){m=I.lines[C+1];let e=o_(S,E);if(e){let t=oD(e);t&&(m=t)}}else{m=I.lines[C-1];let e=ow(S,E);if(e){let t=oN(e);t&&(m=t)}}if(null!=m)return m;let T=v.columns.indexOf(I);if(-1===T)return;if(!0===t)m=null==(i=v.columns[T+1])?void 0:i.lines[0];else{let e=null==(a=null==(r=v.columns)?void 0:r[T-1])?void 0:a.lines;m=null==e?void 0:e[e.length-1]}if(null!=m)return m;let b=E.sections.indexOf(v);if(-1===b)return;if(!0===t)m=null==(s=null==(o=E.sections[b-1])?void 0:o.columns[0])?void 0:s.lines[0];else{let e=null==(A=null==(l=E.sections)?void 0:l[b-1])?void 0:A.columns,t=null==e?void 0:e[e.length-1],n=null==t?void 0:t.lines;m=null==n?void 0:n[n.length-1]}if(null!=m)return m;if(E.type===p.DocumentSkeletonPageType.CELL)return oG(E,t);let y=E.parent;if(null==y)return;let R=y.pages.indexOf(E);if(-1!==R){if(!0===t)m=null==(u=null==(c=null==(d=y.pages[R+1])?void 0:d.sections[0])?void 0:c.columns[0])?void 0:u.lines[0];else{let e=null==(h=y.pages[R-1])?void 0:h.sections;if(null==e)return;let t=null==(g=e[e.length-1])?void 0:g.columns,n=t[t.length-1],i=null==n?void 0:n.lines;m=i[i.length-1]}if(null!=m)return m}}_scrollToFocusNodePosition(e,t){var n;let i=null==(n=this._renderManagerService.getRenderById(e))?void 0:n.with(a5);null!=i&&i.scrollToRange({startOffset:t,endOffset:t,collapsed:!0})}_getDocObject(){return q(this._univerInstanceService,this._renderManagerService)}},"DocMoveCursorController"),ok);function oG(e,t){var n,i;let r=null;if(!0===t){let t=oP(e);if(t)r=oF(t);else{let{lineAfterTable:t}=oU(null==(n=e.parent)?void 0:n.parent);t&&(r=t)}}else{let t=oQ(e);if(t)r=oL(t);else{let{lineBeforeTable:t}=oU(null==(i=e.parent)?void 0:i.parent);t&&(r=t)}}return r}oz=oj([oW(0,h.IUniverInstanceService),oW(1,p.IRenderManagerService),oW(2,(0,h.Inject)(g.DocSelectionManagerService)),oW(3,h.ICommandService)],oz),w(oG,"findAboveOrBellowCellLine");let oY="univer-create-item",oK="univer-create-label",oq="univer-create-input",oX=/* @__PURE__ */w(({handleRowColChange:e,tableCreateParams:t})=>{let n=(0,h.useDependency)(h.LocaleService),[i,r]=(0,m.useState)(3),[a,o]=(0,m.useState)(5);function s(t,n){r(t),o(n),e(t,n)}return w(s,"handleInputChange"),(0,m.useEffect)(()=>{r(t.rowCount),o(t.colCount)},[t]),/* @__PURE__ */eu.jsxs("div",{className:"univer-create",children:[/* @__PURE__ */eu.jsxs("div",{className:oY,children:[/* @__PURE__ */eu.jsx("span",{className:oK,children:n.t("toolbar.table.rowCount")}),/* @__PURE__ */eu.jsx(U.InputNumber,{min:1,max:20,precision:0,value:i,onChange:/* @__PURE__ */w(e=>{s(e,a)},"onChange"),className:oq})]}),/* @__PURE__ */eu.jsxs("div",{className:oY,children:[/* @__PURE__ */eu.jsx("span",{className:oK,children:n.t("toolbar.table.colCount")}),/* @__PURE__ */eu.jsx(U.InputNumber,{min:1,max:20,precision:0,value:a,onChange:/* @__PURE__ */w(e=>{s(i,e)},"onChange"),className:oq})]})]})},"DocCreateTableConfirm");var oJ,oZ=Object.defineProperty,o$=Object.getOwnPropertyDescriptor,o0=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?o$(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&oZ(t,n,a),a},"__decorateClass$e"),o1=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$e");let o9=(w(oJ=class extends h.Disposable{constructor(e,t){super(),this._commandService=e,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[rL].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_initCustomComponents(){let e=this._componentManager;this.disposeWithMe(e.register(rU,oX))}_init(){}},"DocTableController"),oJ);o9=o0([o1(0,h.ICommandService),o1(1,(0,h.Inject)(N.ComponentManager))],o9);let o3=4;var o2=Object.defineProperty,o4=Object.getOwnPropertyDescriptor,o6=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?o4(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&o2(t,n,a),a},"__decorateClass$d"),o8=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$d");function o5(e,t){let n=o7(e.left,e.top,t),i=o7(e.right,e.bottom,t);return{left:n.x,top:n.y,right:i.x,bottom:i.y}}function o7(e,t,n){let{scaleX:i,scaleY:r}=n.getAncestorScale(),a=n.getViewport(G.VIEW_MAIN);if(!a)return{x:e,y:t};let{viewportScrollX:o,viewportScrollY:s}=a;return{x:(e-o)*i,y:(t-s)*r}}function se(e,t,n){let{scaleX:i,scaleY:r}=n.getAncestorScale(),a=n.getViewport(G.VIEW_MAIN);if(!a)return{x:e,y:t};let{viewportScrollX:o,viewportScrollY:s}=a;return{x:e/i+o,y:t/r+s}}w(o5,"transformBound2OffsetBound"),w(o7,"transformPosition2Offset"),w(se,"transformOffset2Bound");let st=/* @__PURE__ */w((e,t)=>{let{scene:n,mainComponent:i,engine:r}=t,a=t.with(g.DocSkeletonManagerService).getSkeleton(),o=a.findNodePositionByCharIndex(e.startOffset,!1,e.segmentId,e.segmentPage),s=a.findNodePositionByCharIndex(e.endOffset,!1,e.segmentId,e.segmentPage);if(!s||!o)return;let l=i.getOffsetConfig(),{docsLeft:A,docsTop:d}=l,c=r.getCanvasElement(),u=c.getBoundingClientRect(),h=(0,p.pxToNum)(c.style.width),{top:m,left:f,width:S}=u,I=S/h,{scaleX:v,scaleY:E}=n.getAncestorScale(),{borderBoxPointGroup:C}=new ex(l,a).getRangePointData(o,s);return eP(C).map(e=>o5(e,n)).map(e=>({left:(e.left+A*v)*I+f,right:(e.right+A*v)*I+f,top:(e.top+d*E)*I+m,bottom:(e.bottom+d*E)*I+m}))},"calcDocRangePositions$1"),sn=(sd=class extends h.Disposable{constructor(e,t,n,i){super(),this._globalPopupManagerService=e,this._renderManagerService=t,this._univerInstanceService=n,this._commandService=i}_createObjectPositionObserver(e,t){let n=/* @__PURE__ */w(()=>{let{scene:n,engine:i}=t,{left:r,top:a,width:o,height:s}=e,l=i.getCanvasElement(),A=l.getBoundingClientRect(),d=(0,p.pxToNum)(l.style.width),c=o5({left:r,right:r+o,top:a,bottom:a+s},n),{top:u,left:h,width:g}=A,m=g/d;return{left:c.left*m+h,right:c.right*m+h,top:c.top*m+u,bottom:c.bottom*m+u}},"calc"),i=n(),r=new I.BehaviorSubject(i),a=new h.DisposableCollection;a.add(this._commandService.onCommandExecuted(e=>{e.id===ip.id&&r.next(n())}));let o=t.scene.getViewport(G.VIEW_MAIN);return o&&a.add(o.onScrollAfter$.subscribeEvent(()=>{r.next(n())})),{position:i,position$:r,disposable:a}}_createRangePositionObserver(e,t){var n;let i=null!=(n=st(e,t))?n:[],r=new I.BehaviorSubject(i),a=new h.DisposableCollection;a.add(this._commandService.onCommandExecuted(n=>{if(n.id===ip.id){let n=st(e,t);n&&r.next(n)}}));let o=t.scene.getViewport(G.VIEW_MAIN);return o&&a.add(o.onScrollAfter$.subscribeEvent(()=>{let n=st(e,t);n&&r.next(n)})),{positions:i,positions$:r,disposable:a}}attachPopupToObject(e,t,n){let i=this._renderManagerService.getRenderById(n);if(!i)throw Error(`Current render not found, unitId: ${n}`);let{position:r,position$:a,disposable:o}=this._createObjectPositionObserver(e,i),s=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:r,anchorRect$:a,canvasElement:i.engine.getCanvasElement()});return{dispose:/* @__PURE__ */w(()=>{this._globalPopupManagerService.removePopup(s),a.complete(),o.dispose()},"dispose")}}attachPopupToRange(e,t,n){if(!this._univerInstanceService.getUnit(n))throw Error(`Document not found, unitId: ${n}`);let{direction:i="top",multipleDirection:r}=t,a=this._renderManagerService.getRenderById(n);if(!a)throw Error(`Current render not found, unitId: ${n}`);let{positions:o,positions$:s,disposable:l}=this._createRangePositionObserver(e,a),A=s.pipe((0,b.map)(e=>i.includes("top")?e[0]:e[e.length-1])),d=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:i.includes("top")?o[0]:o[o.length-1],anchorRect$:A,excludeRects:o,excludeRects$:s,direction:i.includes("top")||i.includes("bottom")?o.length>1?r:i:"bottom",canvasElement:a.engine.getCanvasElement()});return{dispose:/* @__PURE__ */w(()=>{this._globalPopupManagerService.removePopup(d),s.complete(),l.dispose()},"dispose"),canDispose:/* @__PURE__ */w(()=>this._globalPopupManagerService.activePopupId!==d,"canDispose")}}},w(sd,"DocCanvasPopManagerService"),sd);sn=o6([o8(0,(0,h.Inject)(N.ICanvasPopupService)),o8(1,p.IRenderManagerService),o8(2,h.IUniverInstanceService),o8(3,h.ICommandService)],sn);var si=Object.defineProperty,sr=Object.getOwnPropertyDescriptor,sa=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sr(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&si(t,n,a),a},"__decorateClass$c"),so=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$c");let ss=/* @__PURE__ */w((e,t,n,i)=>{var r,a,o,s,l;let A=n.findNodePositionByCharIndex(e.startOffset,!1,e.segmentId,i),d=n.getSkeletonData(),c=e.endOffset;if(e.segmentId){let t=null!=(l=Array.from(null!=(a=null==(r=null==d?void 0:d.skeFooters.get(e.segmentId))?void 0:r.values())?a:[])[0])?l:Array.from(null!=(s=null==(o=null==d?void 0:d.skeHeaders.get(e.segmentId))?void 0:o.values())?s:[])[0];t&&(c=Math.min(t.ed,c))}let u=n.findNodePositionByCharIndex(c,!1,e.segmentId,i);if(!u||!A)return;let h=t.getOffsetConfig(),{borderBoxPointGroup:g}=new ex(h,n).getRangePointData(A,u);return eP(g).map(e=>({top:e.top+h.docsTop-o3,bottom:e.bottom+h.docsTop+o3,left:e.left+h.docsLeft,right:e.right+h.docsLeft}))},"calcDocRangePositions"),sl=/* @__PURE__ */w((e,t,n,i=-1)=>{let r=n.findPositionByGlyph(e,i);if(!r)return;let a=t.getOffsetConfig(),o={...r,isBack:!0},{borderBoxPointGroup:s}=new ex(a,n).getRangePointData(o,o),l=eP(s)[0];return{top:l.top+a.docsTop,bottom:l.bottom+a.docsTop,left:l.left+a.docsLeft,right:l.left+a.docsLeft+e.width}},"calcDocGlyphPosition"),sA=(sc=class extends h.Disposable{constructor(e,t){super(),F(this,"_hoverCustomRanges$",new I.BehaviorSubject([])),F(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe((0,E.distinctUntilChanged)((e,t)=>e.length===t.length&&e.every((e,n)=>t[n].range.rangeId===e.range.rangeId&&t[n].segmentId===e.segmentId&&t[n].segmentPageIndex===e.segmentPageIndex)))),F(this,"_clickCustomRanges$",new x.Subject),F(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable()),F(this,"_hoverBullet$",new x.Subject),F(this,"hoverBullet$",this._hoverBullet$.pipe((0,E.distinctUntilChanged)((e,t)=>(null==e?void 0:e.paragraph.startIndex)===(null==t?void 0:t.paragraph.startIndex)&&(null==e?void 0:e.segmentId)===(null==t?void 0:t.segmentId)&&(null==e?void 0:e.segmentPageIndex)===(null==t?void 0:t.segmentPageIndex)))),F(this,"_clickBullet$",new x.Subject),F(this,"clickBullets$",this._clickBullet$.asObservable()),F(this,"_customRangeDirty",!0),F(this,"_bulletDirty",!0),F(this,"_customRangeBounds",[]),F(this,"_bulletBounds",[]),this._context=e,this._docSkeletonManagerService=t,this._initResetDirty(),this._initEvents(),this._initPointer()}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=p.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(t=>{t.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(p.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0})),this.disposeWithMe((0,h.fromEventSubject)(this._context.engine.onTransformChange$).pipe((0,C.filter)(e=>e.type===p.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0}))}_initEvents(){this.disposeWithMe((0,h.fromEventSubject)(this._context.scene.onPointerMove$).pipe((0,D.throttleTime)(30)).subscribe(e=>{this._hoverCustomRanges$.next(this._calcActiveRanges(e)),this._hoverBullet$.next(this._calcActiveBullet(e))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));let e=(0,h.fromEventSubject)(this._context.mainComponent.onPointerDown$),t=(0,h.fromEventSubject)(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe((0,O.switchMap)(e=>t.pipe((0,B.take)(1),(0,b.map)(t=>({down:e,up:t})))),(0,C.filter)(({down:e,up:t})=>e.target===t.target&&t.timeStamp-e.timeStamp<300)).subscribe(({down:e})=>{if(2===e.button)return;let t=this._calcActiveRanges(e);t.length&&this._clickCustomRanges$.next(t.pop());let n=this._calcActiveBullet(e);n&&this._clickBullet$.next(n)}))}_buildCustomRangeBoundsBySegment(e,t=-1){var n,i,r;let a=null!=(r=null==(i=null==(n=this._context.unit.getSelfOrHeaderFooterModel(e))?void 0:n.getBody())?void 0:i.customRanges)?r:[],o=[];return a.forEach(n=>{let i=ss({startOffset:n.startIndex,endOffset:n.endIndex,collapsed:!1,segmentId:e},this._documents,this._skeleton,t);if(!i)return null;o.push({customRange:n,rects:i,segmentId:e,segmentPageIndex:t})}),o}_buildCustomRangeBounds(){var e;if(!this._customRangeDirty)return;this._customRangeDirty=!1;let t=[];t.push(...this._buildCustomRangeBoundsBySegment()),null==(e=this._skeleton.getSkeletonData())||e.pages.forEach((e,n)=>{e.headerId&&t.push(...this._buildCustomRangeBoundsBySegment(e.headerId,n)),e.footerId&&t.push(...this._buildCustomRangeBoundsBySegment(e.footerId,n))}),this._customRangeBounds=t}_calcActiveRanges(e){this._buildCustomRangeBounds();let{offsetX:t,offsetY:n}=e,{x:i,y:r}=se(t,n,this._context.scene);return this._customRangeBounds.filter(e=>e.rects.some(e=>{let{left:t,right:n,top:a,bottom:o}=e;return i>=t&&i<=n&&r>=a&&r<=o})).map(e=>({segmentId:e.segmentId,range:e.customRange,segmentPageIndex:e.segmentPageIndex,rects:e.rects}))}_buildBulletBoundsBySegment(e,t=-1){var n,i,r,a,o;let s=null==(n=this._context.unit.getSelfOrHeaderFooterModel(e))?void 0:n.getBody(),l=(null!=(i=null==s?void 0:s.paragraphs)?i:[]).filter(e=>e.bullet&&0===e.bullet.listType.indexOf("CHECK_LIST")),A=[],d=this._skeleton.getSkeletonData();if(!d)return A;let c=/* @__PURE__ */w(n=>{var i,r,a;for(let o of n){let n=[...o.sections];if(o.skeTables){let e=Array.from(o.skeTables.values());n.push(...e.map(e=>e.rows.map(e=>e.cells.map(e=>e.sections))).flat(4))}for(let o of n)for(let n of o.columns)for(let o of n.lines)if(o.paragraphStart){let n=l.find(e=>e.startIndex===o.paragraphIndex);if(n){let s=null==(a=null==(r=null==(i=null==o?void 0:o.divides)?void 0:i[0])?void 0:r.glyphGroup)?void 0:a[0];if(!s)continue;let l=sl(s,this._documents,this._skeleton,t);if(!l)continue;A.push({rect:l,segmentId:e,segmentPageIndex:t,paragraph:n})}}}return A},"calc");if(e){let t=null!=(o=null==(r=d.skeFooters.get(e))?void 0:r.values())?o:null==(a=d.skeHeaders.get(e))?void 0:a.values();return t?c(Array.from(t)):A}return c(d.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),null==(e=this._skeleton.getSkeletonData())||e.pages.forEach((e,t)=>{e.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(e.headerId,t)),e.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(e.footerId,t))}))}_calcActiveBullet(e){this._buildBulletBounds();let{offsetX:t,offsetY:n}=e,{x:i,y:r}=se(t,n,this._context.scene);return this._bulletBounds.find(e=>{let{left:t,right:n,top:a,bottom:o}=e.rect;return i>=t&&i<=n&&r>=a&&r<=o})}},w(sc,"DocEventManagerService"),sc);sA=sa([so(1,(0,h.Inject)(g.DocSkeletonManagerService))],sA);var sd,sc,su,sh=Object.defineProperty,sg=Object.getOwnPropertyDescriptor,sp=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sg(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sh(t,n,a),a},"__decorateClass$b"),sm=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$b");let sf=(w(su=class extends h.Disposable{constructor(e,t,n,i,r){super(),this._context=e,this._docSkeletonManagerService=t,this._commandService=n,this._docEventManagerService=i,this._textSelectionManagerService=r,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(e=>{let t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(n0.id,{index:e.paragraph.startIndex,segmentId:e.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(e=>{e?this._context.mainComponent.setCursor(p.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(p.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(e,t,n,i){let{documentTransform:r}=e.getOffsetConfig(),a=t.transformVector2SceneCoord((0,p.Vector2).FromArray([n,i]));if(a)return r.clone().invert().applyPoint(a)}},"DocChecklistRenderController"),su);sf=sp([sm(1,(0,h.Inject)(g.DocSkeletonManagerService)),sm(2,h.ICommandService),sm(3,(0,h.Inject)(sA)),sm(4,(0,h.Inject)(g.DocSelectionManagerService))],sf);var sS,sI=Object.defineProperty,sv=Object.getOwnPropertyDescriptor,sE=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sv(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sI(t,n,a),a},"__decorateClass$a"),sC=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$a");let sT=(w(sS=class extends h.RxDisposable{constructor(e,t,n,i,r,a){super(),this._context=e,this._commandService=t,this._docClipboardService=n,this._docSelectionRenderService=i,this._contextService=r,this._editorService=a,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var e;null==(e=this._docSelectionRenderService)||e.onPaste$.pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>{var t,n;if(!rS(this._contextService))return;e.event.preventDefault();let i=e.event,r=null==(t=i.clipboardData)?void 0:t.getData("text/html"),a=null==(n=i.clipboardData)?void 0:n.getData("text/plain");this._editorService.getEditor(this._context.unitId)&&(null!=r?r:"").indexOf("</table>")>-1&&(r=""),this._docClipboardService.legacyPaste(r,a)})}},"DocClipboardController"),sS);sT=sE([sC(1,h.ICommandService),sC(2,rm),sC(3,(0,h.Inject)(e0)),sC(4,h.IContextService),sC(5,e5)],sT);var sb=Object.defineProperty,sy=Object.getOwnPropertyDescriptor,sR=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sy(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sb(t,n,a),a},"__decorateClass$9"),sx=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$9");let sO=[h.DEFAULT_EMPTY_DOCUMENT_VALUE,h.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,h.DOCS_ZEN_EDITOR_UNIT_ID_KEY],sB=(w(sM=class extends h.Disposable{constructor(e,t,n){super(),this._context=e,this._contextMenuService=t,this._commandService=n,sO.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,t;let n=(null==(t=null==(e=this._context)?void 0:e.mainComponent)?void 0:t.onPointerDown$).subscribeEvent(e=>{2===e.button&&this._contextMenuService.triggerContextMenu(e,N.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(n)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{e.id===g.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}},"DocContextMenuRenderController"),sM);sB=sR([sx(1,N.IContextMenuService),sx(2,h.ICommandService)],sB);var sM,sD,sN=Object.defineProperty,s_=Object.getOwnPropertyDescriptor,sU=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?s_(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sN(t,n,a),a},"__decorateClass$8"),sP=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$8");let sQ=(w(sD=class extends h.Disposable{constructor(e,t,n,i,r,a,o){super(),F(this,"_initialEditors",/* @__PURE__ */new Set),this._context=e,this._univerInstanceService=t,this._editorService=n,this._commandService=i,this._docSelectionRenderService=r,this._docSkeletonManagerService=a,this._renderManagerService=o,this._initialize()}_initialize(){this.disposeWithMe(this._editorService.resize$.subscribe(e=>{e===this._context.unitId&&this._resize(e)})),this._editorService.getAllEditor().forEach(e=>{let t=e.getEditorId();t===this._context.unitId&&(this._initialEditors.has(t)||(this._initialEditors.add(t),this._resize(t)))}),this._commandExecutedListener(),this._initialSetValue(),this._initialBlur(),this._initialFocus(),this._initialValueChange()}_resize(e){var t,n;if(null==e)return;let i=this._editorService.getEditor(e);if((null==i?void 0:i.cancelDefaultResizeListener)===!0)return;let r=this._univerInstanceService.getUniverDocInstance(e);if(!r)return;let a=this._docSkeletonManagerService.getSkeleton();if(null==i||null==i.render||null==a||null==r)return;a.calculate();let{marginTop:o=0,marginBottom:s=0,marginLeft:l=0,marginRight:A=0}=r.getSnapshot().documentStyle,{scene:d,mainComponent:c}=i.render,{actualHeight:u,actualWidth:h}=a.getActualSize();u+=o+s,h+=l+A;let{width:g,height:m}=i.getBoundingClientRect(),f=d.getViewport(G.VIEW_MAIN),S=null==f?void 0:f.getScrollBar(),I=Math.max(h,g),v=Math.max(u,m);d.transformByState({width:I,height:v}),null==c||c.resize(I,v),i.isSingle()?h>g?null==S?f&&new p.ScrollBar(f,{barSize:8,enableVertical:!1}):null==f||f.resetCanvasSizeAndUpdateScroll():(S=null,null==f||f.scrollToBarPos({x:0,y:0}),null==(n=null==f?void 0:f.getScrollBar())||n.dispose()):u>m?null==S?f&&new p.ScrollBar(f,{enableHorizontal:!1,barSize:8}):null==f||f.resetCanvasSizeAndUpdateScroll():(S=null,null==f||f.scrollToBarPos({x:0,y:0}),null==(t=null==f?void 0:f.getScrollBar())||t.dispose())}_initialSetValue(){this.disposeWithMe(this._editorService.setValue$.subscribe(e=>{e.editorUnitId===this._context.unitId&&this._commandService.executeCommand(em.id,{unitId:e.editorUnitId,body:e.body,segmentId:null})}))}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{let{unitId:e}=this._context,t=this._editorService.getEditor(e),n=this._editorService.getFocusEditor();null==t||t.isSheetEditor()||n&&n.getEditorId()===e||this._editorService.blur()}))}_initialFocus(){this.disposeWithMe(this._editorService.focus$.subscribe(e=>{var t;(null==(t=this._editorService.getFocusEditor())?void 0:t.getEditorId())===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges([e]))}));let e=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe((0,T.fromEvent)(window,"mousedown").subscribe(t=>{let n=t.target.classList[0]||"";if((0,h.checkForSubstrings)(n,e)){this._editorService.changeSpreadsheetFocusState(!0),t.stopPropagation();return}this._editorService.changeSpreadsheetFocusState(!1)})),this._univerInstanceService.getAllUnitsForType(h.UniverInstanceType.UNIVER_SHEET).forEach(e=>{let t=e.getUnitId(),n=this._renderManagerService.getRenderById(t),i=null==n?void 0:n.engine.getCanvas().getCanvasEle();null!=i&&(0,T.fromEvent)(i,"mousedown").subscribe(e=>{this._editorService.changeSpreadsheetFocusState(!0),e.stopPropagation()})})}_initialValueChange(){this.disposeWithMe(this._docSelectionRenderService.onCompositionupdate$.subscribe(this._valueChange.bind(this))),this.disposeWithMe(this._docSelectionRenderService.onInput$.subscribe(this._valueChange.bind(this))),this.disposeWithMe(this._docSelectionRenderService.onKeydown$.subscribe(this._valueChange.bind(this))),this.disposeWithMe(this._docSelectionRenderService.onPaste$.subscribe(this._valueChange.bind(this)))}_valueChange(){let{unitId:e}=this._context,t=this._editorService.getEditor(e);null==t||t.isSheetEditor()||this._editorService.refreshValueChange(e)}_commandExecutedListener(){let e=[g.RichTextEditingMutation.id,N.SetEditorResizeOperation.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){let{unitId:e}=t.params;if(this._editorService.isSheetEditor(e)||e!==this._context.unitId)return;let n=this._editorService.getEditor(e);n&&!n.params.scrollBar&&(this._resize(e),this._valueChange())}}))}},"DocEditorBridgeController"),sD);sQ=sU([sP(1,h.IUniverInstanceService),sP(2,e5),sP(3,h.ICommandService),sP(4,(0,h.Inject)(e0)),sP(5,(0,h.Inject)(g.DocSkeletonManagerService)),sP(6,p.IRenderManagerService)],sQ);var sw,sF=Object.defineProperty,sL=Object.getOwnPropertyDescriptor,sk=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sL(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sF(t,n,a),a},"__decorateClass$7"),sH=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$7");let sV=(w(sw=class extends h.Disposable{constructor(e,t,n,i,r){super(),F(this,"_previousIMEContent",""),F(this,"_isCompositionStart",!0),F(this,"_onStartSubscription"),F(this,"_onUpdateSubscription"),F(this,"_onEndSubscription"),this._context=e,this._docSelectionRenderService=t,this._docImeInputManagerService=n,this._docSkeletonManagerService=i,this._commandService=r,this._initialize()}dispose(){var e,t,n;null==(e=this._onStartSubscription)||e.unsubscribe(),null==(t=this._onUpdateSubscription)||t.unsubscribe(),null==(n=this._onEndSubscription)||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(e=>{if(null==e)return;this._resetIME();let{activeRange:t}=e;null!=t&&this._docImeInputManagerService.setActiveRange((0,h.Tools).deepClone(t))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(e=>{this._updateContent(e,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(e=>{this._updateContent(e,!1)})}async _updateContent(e,t){if(null==e)return;let n=this._context.unitId,i=this._docSkeletonManagerService.getSkeleton(),{event:r,activeRange:a}=e;if(null==i||null==a)return;let o=r.data;o===this._previousIMEContent&&t||(await this._commandService.executeCommand(os.id,{unitId:n,newText:o,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!t}),t?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=o):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}},"DocIMEInputController"),sw);sV=sk([sH(1,(0,h.Inject)(e0)),sH(2,(0,h.Inject)(oo)),sH(3,(0,h.Inject)(g.DocSkeletonManagerService)),sH(4,h.ICommandService)],sV);var sj,sW=Object.defineProperty,sz=Object.getOwnPropertyDescriptor,sG=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sz(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sW(t,n,a),a},"__decorateClass$6"),sY=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$6");let sK=(w(sj=class extends h.Disposable{constructor(e,t,n,i,r){super(),F(this,"_onInputSubscription"),this._context=e,this._docSelectionRenderService=t,this._docSkeletonManagerService=n,this._commandService=i,this._docMenuStyleService=r,this._init()}dispose(){var e;super.dispose(),null==(e=this._onInputSubscription)||e.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async e=>{var t;if(null==e)return;let{unitId:n}=this._context,{event:i,content:r="",activeRange:a}=e,o=this._docSkeletonManagerService.getSkeleton();if(null==i.data||null==o||null==a)return;let{segmentId:s}=a,l=[h.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,h.DOCS_ZEN_EDITOR_UNIT_ID_KEY,h.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY],A=this._context.unit.getSelfOrHeaderFooterModel(s).getBody(),d=this._docMenuStyleService.getStyleCache(),c=et(null!=(t=null==A?void 0:A.textRuns)?t:[],a.endOffset,d);await this._commandService.executeCommand(iX.id,{unitId:n,body:{dataStream:r,textRuns:c?[{...c,st:0,ed:r.length}]:[]},range:a,segmentId:s,extendLastRange:l.includes(n)})," "===r&&await this._commandService.executeCommand(ns.id)})}},"DocInputController"),sj);sK=sG([sY(1,(0,h.Inject)(e0)),sY(2,(0,h.Inject)(g.DocSkeletonManagerService)),sY(3,h.ICommandService),sY(4,(0,h.Inject)(nv))],sK);let sq=class extends h.Disposable{constructor(e){super(),this._context=e}calculatePagePosition(){var e,t;let n=K(this._context),i=null!=(t=null==(e=this._context.unit.getSettings())?void 0:e.zoomRatio)?t:1,{document:r,scene:a,docBackground:o}=n,s=null==a?void 0:a.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:c}=r;if(null==s||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;let{width:u,height:h}=s,g=0,p=c,m=0,f=0,S=Number.POSITIVE_INFINITY;u>(l+2*d)*i?(g=(u/2-l*i/2)/i,m=(u-2*d)/i,S=0):(g=d,S=((m=l+2*d)-u/i)/2),f=h>A?(h-2*c)/i:A+2*c,a.resize(m,f),u<=1&&(g=-1e4,p=-1e4),r.translate(g,p),o.translate(g,p);let I=a.getViewport(G.VIEW_MAIN);return S!==Number.POSITIVE_INFINITY&&null!=I&&I.scrollToViewportPos({viewportScrollX:S}),this}};w(sq,"DocPageLayoutService");var sX,sJ=Object.defineProperty,sZ=Object.getOwnPropertyDescriptor,s$=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?sZ(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&sJ(t,n,a),a},"__decorateClass$5"),s0=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$5");let s1=(w(sX=class extends h.Disposable{constructor(e,t,n){super(),this._context=e,this._docPageLayoutService=t,this._textSelectionManagerService=n;let i=this._context.unitId;if((0,h.isInternalEditorID)(i)&&i!==h.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe((0,h.fromEventSubject)(this._context.engine.onTransformChange$).pipe((0,C.filter)(e=>e.type===p.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),(0,D.throttleTime)(0,S.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}},"DocResizeRenderController"),sX);s1=s$([s0(1,(0,h.Inject)(sq)),s0(2,(0,h.Inject)(g.DocSelectionManagerService))],s1);var s9,s3=Object.defineProperty,s2=Object.getOwnPropertyDescriptor,s4=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?s2(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&s3(t,n,a),a},"__decorateClass$4"),s6=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$4");let s8=(w(s9=class extends h.Disposable{constructor(e,t,n,i,r,a,o){super(),F(this,"_loadedMap",/* @__PURE__ */new WeakSet),this._context=e,this._commandService=t,this._editorService=n,this._instanceSrv=i,this._docSelectionRenderService=r,this._docSkeletonManagerService=a,this._docSelectionManagerService=o,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){let{unitId:e}=this._context,t=K(this._context);null==t||null==t.document||this._loadedMap.has(t.document)||(this._initialMain(e),this._loadedMap.add(t.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(e=>{if(null==e)return;let{unitId:t,docRanges:n,isEditing:i,options:r}=e;t===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,i,r))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(e=>{null!=e&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(e)}))}_initialMain(e){let{document:t,scene:n}=K(this._context);this.disposeWithMe(t.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(e)||(t.cursor=p.CURSOR_TYPE.TEXT)})),this.disposeWithMe(t.onPointerLeave$.subscribeEvent(()=>{t.cursor=p.CURSOR_TYPE.DEFAULT,n.resetCursor()})),this.disposeWithMe(t.onPointerDown$.subscribeEvent((n,i)=>{if(this._isEditorReadOnly(e))return;let r=this._instanceSrv.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);(null==r?void 0:r.getUnitId())!==e&&this._instanceSrv.setCurrentUnitForType(e);let a=this._docSkeletonManagerService.getSkeleton(),{offsetX:o,offsetY:s}=n,l=this._getTransformCoordForDocumentOffset(o,s);if(null!=l){let{pageLayoutType:e=p.PageLayoutType.VERTICAL,pageMarginLeft:n,pageMarginTop:i}=t.getOffsetConfig(),{editArea:r}=a.findEditAreaByCoord(l,e,n,i),o=this._docSkeletonManagerService.getViewModel(),s=o.getEditArea();s!==p.DocumentEditArea.BODY&&r!==p.DocumentEditArea.BODY&&r!==s&&o.setEditArea(r)}if(this._docSelectionRenderService.__onPointDown(n),this._editorService.getEditor(e)){this._setEditorFocus(e);let{offsetX:t,offsetY:i}=n;setTimeout(()=>{e!==this._editorService.getFocusId()&&(this._setEditorFocus(e),this._docSelectionRenderService.setCursorManually(t,i))},0)}2!==n.button&&i.stopPropagation()})),this.disposeWithMe(t.onDblclick$.subscribeEvent(t=>{this._isEditorReadOnly(e)||this._docSelectionRenderService.__handleDblClick(t)})),this.disposeWithMe(t.onTripleClick$.subscribeEvent(t=>{this._isEditorReadOnly(e)||this._docSelectionRenderService.__handleTripleClick(t)}))}_getTransformCoordForDocumentOffset(e,t){let{document:n,scene:i}=K(this._context),{documentTransform:r}=n.getOffsetConfig(),a=i.getViewports()[0];if(null==a)return;let o=a.transformVector2SceneCoord((0,p.Vector2).FromArray([e,t]));return r.clone().invert().applyPoint(o)}_isEditorReadOnly(e){let t=this._editorService.getEditor(e);return!!t&&t.isReadOnly()}_setEditorFocus(e){this._editorService.focusStyle(e)}_commandExecutedListener(){let e=[ip.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{var n;if(e.includes(t.id)){let{unitId:e}=t.params;if(e!==(null==(n=this._docSelectionManagerService.__getCurrentSelection())?void 0:n.unitId))return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(!e)return;let{unitId:t}=this._context;(0,h.isInternalEditorID)(t)||(this._docSelectionRenderService.focus(),this._docSelectionManagerService.replaceDocRanges([{startOffset:0,endOffset:0}],{unitId:t,subUnitId:t},!1))}))}},"DocSelectionRenderController"),s9);s8=s4([s6(1,h.ICommandService),s6(2,e5),s6(3,h.IUniverInstanceService),s6(4,(0,h.Inject)(e0)),s6(5,(0,h.Inject)(g.DocSkeletonManagerService)),s6(6,(0,h.Inject)(g.DocSelectionManagerService))],s8);var s5,s7=Object.defineProperty,le=Object.getOwnPropertyDescriptor,lt=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?le(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&s7(t,n,a),a},"__decorateClass$3"),ln=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$3");let li=(w(s5=class extends h.Disposable{constructor(e,t,n,i,r,a,o,s){super(),this._context=e,this._contextService=t,this._docSkeletonManagerService=n,this._univerInstanceService=i,this._commandService=r,this._textSelectionManagerService=a,this._editorService=o,this._docPageLayoutService=s,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),setTimeout(()=>this.updateViewZoom(1,!0),20)}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(null==e)return;let{unitId:t,scene:n}=this._context;this._editorService.isEditor(t)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(e=>{if(!e.ctrlKey||!this._contextService.getContextValue(h.FOCUSING_DOC))return;let t=this._univerInstanceService.getCurrentUniverDocInstance();if(!t)return;let{documentFlavor:i}=t.getSnapshot().documentStyle;if(i===h.DocumentFlavor.MODERN)return;let r=Math.abs(e.deltaX),a=r<40?.2:r<80?.4:.2;a*=e.deltaY>0?-1:1,n.scaleX<1&&(a/=2);let o=t.zoomRatio,s=+Number.parseFloat(`${o+a}`).toFixed(1);s=s>=4?4:s<=.1?.1:s,this._commandService.executeCommand(ol.id,{zoomRatio:s,unitId:t.getUnitId()}),e.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(null==e)return;let t=this._univerInstanceService.getCurrentUniverDocInstance();if(!t)return;let n=t.zoomRatio||1;this.updateViewZoom(n,!1)}))}_initCommandExecutedListener(){let e=[ip.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)&&t.params.unitId===this._context.unitId){let e=this._context.unit.zoomRatio||1;this.updateViewZoom(e)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{e.id===rC.id&&this._commandService.executeCommand(ol.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(e,t=!0){var n;let i=K(this._context);i.scene.scale(e,e),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),t&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),null==(n=i.scene.getTransformer())||n.clearSelectedObjects()}},"DocZoomRenderController"),s5);li=lt([ln(1,h.IContextService),ln(2,(0,h.Inject)(g.DocSkeletonManagerService)),ln(3,h.IUniverInstanceService),ln(4,h.ICommandService),ln(5,(0,h.Inject)(g.DocSelectionManagerService)),ln(6,e5),ln(7,(0,h.Inject)(sq))],li);var lr=Object.defineProperty,la=Object.getOwnPropertyDescriptor,lo=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?la(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&lr(t,n,a),a},"__decorateClass$2"),ls=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$2");let ll=(w(lx=class extends h.RxDisposable{constructor(e,t,n,i,r){super(),F(this,"_docStateChange$",new I.BehaviorSubject(null)),F(this,"docStateChange$",this._docStateChange$.asObservable()),F(this,"_historyStateCache",/* @__PURE__ */new Map),F(this,"_changeStateCache",/* @__PURE__ */new Map),F(this,"_historyTimer",null),F(this,"_changeStateCacheTimer",null),this._undoRedoService=e,this._commandService=t,this._univerInstanceService=n,this._docStateEmitService=i,this._renderManagerService=r,this._initialize(),this._listenDocStateChange()}getStateCache(e){var t,n;return{history:null!=(t=this._historyStateCache.get(e))?t:[],collaboration:null!=(n=this._changeStateCache.get(e))?n:[]}}setStateCache(e,t){this._historyStateCache.set(e,t.history),this._changeStateCache.set(e,t.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===h.UndoCommandId||e.id===h.RedoCommandId){let e=this._univerInstanceService.getCurrentUniverDocInstance();if(null==e)return;let t=e.getUnitId();this._pushHistory(t),this._emitChangeState(t)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>{var t;if(null==e)return;let{isCompositionEnd:n,isSync:i,syncer:r,...a}=e,o=null==(t=this._renderManagerService.getRenderById(i?r:e.unitId))?void 0:t.with(oo);if(null!=o){if(n){let e=o.fetchComposedUndoRedoMutationParams();if(null==e)throw Error("historyParams is null in RichTextEditingMutation");let{undoMutationParams:t,redoMutationParams:n,previousActiveRange:i}=e;a.redoState.actions=n.actions,a.undoState.actions=t.actions,a.undoState.textRanges=[i]}this._setChangeState(a)}})}_cacheChangeState(e,t="history"){let{trigger:n,unitId:i,noHistory:r,debounce:a=!1}=e;if(r||null==n||"history"===t&&(n===h.RedoCommandId||n===h.UndoCommandId))return;let o="history"===t?this._historyStateCache:this._changeStateCache,s="history"===t?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(o.has(i)){let t=o.get(i);null==t||t.push(e)}else o.set(i,[e]);a?"history"===t?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{s(i)},300)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{s(i)},300)):s(i)}_pushHistory(e){let t=this._undoRedoService,n=this._historyStateCache.get(e);if(!Array.isArray(n)||0===n.length)return;let i=n.length,r=n[0].commandId,a=n[0],o=n[i-1],s={unitId:e,actions:n.reduce((e,t)=>(0,h.JSONX).compose(e,t.redoState.actions),null),textRanges:o.redoState.textRanges},l={unitId:e,actions:n.reverse().reduce((e,t)=>(0,h.JSONX).compose(e,t.undoState.actions),null),textRanges:a.undoState.textRanges};t.pushUndoRedo({unitID:e,undoMutations:[{id:r,params:l}],redoMutations:[{id:r,params:s}]}),n.length=0}_emitChangeState(e){let t=this._changeStateCache.get(e);if(!Array.isArray(t)||0===t.length)return;let n=t.length,{commandId:i,trigger:r,segmentId:a,noHistory:o,debounce:s}=t[0],l=t[0],A=t[n-1],d={unitId:e,actions:t.reduce((e,t)=>(0,h.JSONX).compose(e,t.redoState.actions),null),textRanges:A.redoState.textRanges},c={unitId:e,actions:t.reverse().reduce((e,t)=>(0,h.JSONX).compose(e,t.undoState.actions),null),textRanges:l.undoState.textRanges};t.length=0,this._docStateChange$.next({commandId:i,unitId:e,trigger:r,redoState:d,undoState:c,segmentId:a,noHistory:o,debounce:s})}},"DocStateChangeManagerService"),lx);ll=lo([ls(0,(0,h.Inject)(h.IUndoRedoService)),ls(1,h.ICommandService),ls(2,h.IUniverInstanceService),ls(3,(0,h.Inject)(g.DocStateEmitService)),ls(4,p.IRenderManagerService)],ll);var lA=Object.defineProperty,ld=Object.getOwnPropertyDescriptor,lc=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?ld(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&lA(t,n,a),a},"__decorateClass$1"),lu=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam$1");let lh="univer-doc-main-canvas",lg=(w(lO=class extends h.RxDisposable{constructor(e,t){super(),this._instanceSrv=e,this._renderManagerService=t,this._init()}_init(){this._renderManagerService.createRender$.pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>this._createRenderWithId(e)),this._instanceSrv.getAllUnitsForType(h.UniverInstanceType.UNIVER_DOC).forEach(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitAdded$(h.UniverInstanceType.UNIVER_DOC).pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitDisposed$(h.UniverInstanceType.UNIVER_DOC).pipe((0,M.takeUntil)(this.dispose$)).subscribe(e=>this._disposeRenderer(e))}_createRenderer(e){var t;let n=e.getUnitId(),i=null==(t=this._instanceSrv.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC))?void 0:t.getUnitId();this._renderManagerService.created$.subscribe(e=>{e.unitId===i&&(e.engine.getCanvas().setId(lh),e.engine.getCanvas().getContext().setId(lh))}),this._renderManagerService.has(n)||(this._createRenderWithId(n),this._renderManagerService.setCurrent(n))}_createRenderWithId(e){this._renderManagerService.createRender(e)}_disposeRenderer(e){let t=e.getUnitId();this._renderManagerService.removeRender(t)}},"DocsRenderService"),lO);lg=lc([lu(0,h.IUniverInstanceService),lu(1,p.IRenderManagerService)],lg);let lp={id:nl.id,preconditions:nd,binding:N.KeyCode.ENTER},lm={id:i3.id,preconditions:nA,binding:N.KeyCode.BACKSPACE},lf={id:i2.id,preconditions:nA,binding:N.KeyCode.DELETE},lS={id:od.id,binding:N.KeyCode.ARROW_UP,preconditions:nA,staticParameters:{direction:h.Direction.UP}},lI={id:od.id,binding:N.KeyCode.ARROW_DOWN,preconditions:nA,staticParameters:{direction:h.Direction.DOWN}},lv={id:od.id,binding:N.KeyCode.ARROW_LEFT,preconditions:nA,staticParameters:{direction:h.Direction.LEFT}},lE={id:od.id,binding:N.KeyCode.ARROW_RIGHT,preconditions:nA,staticParameters:{direction:h.Direction.RIGHT}},lC={id:oc.id,binding:N.KeyCode.ARROW_UP|N.MetaKeys.SHIFT,preconditions:nA,staticParameters:{direction:h.Direction.UP}},lT={id:oc.id,binding:N.KeyCode.ARROW_DOWN|N.MetaKeys.SHIFT,preconditions:nA,staticParameters:{direction:h.Direction.DOWN}},lb={id:oc.id,binding:N.KeyCode.ARROW_LEFT|N.MetaKeys.SHIFT,preconditions:nA,staticParameters:{direction:h.Direction.LEFT}},ly={id:oc.id,binding:N.KeyCode.ARROW_RIGHT|N.MetaKeys.SHIFT,preconditions:nA,staticParameters:{direction:h.Direction.RIGHT}},lR={id:ou.id,binding:N.KeyCode.A|N.MetaKeys.CTRL_COMMAND,preconditions:/* @__PURE__ */w(e=>e.getContextValue(h.FOCUSING_UNIVER_EDITOR)&&(e.getContextValue(h.FOCUSING_DOC)||e.getContextValue(h.EDITOR_ACTIVATED)),"preconditions")};var lx,lO,lB,lM=Object.defineProperty,lD=Object.getOwnPropertyDescriptor,lN=/* @__PURE__ */w((e,t,n)=>t in e?lM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,"__defNormalProp"),l_=/* @__PURE__ */w((e,t,n,i)=>{for(var r,a=i>1?void 0:i?lD(t,n):t,o=e.length-1;o>=0;o--)(r=e[o])&&(a=(i?r(t,n,a):r(a))||a);return i&&a&&lM(t,n,a),a},"__decorateClass"),lU=/* @__PURE__ */w((e,t)=>(n,i)=>t(n,i,e),"__decorateParam"),lP=/* @__PURE__ */w((e,t,n)=>lN(e,t+"",n),"__publicField");let lQ=(w(lB=class extends h.Plugin{constructor(e=iC,t,n,i,r,a){super(),this._config=e,this._injector=t,this._renderManagerSrv=n,this._commandService=i,this._logService=r,this._configService=a;let{menu:o,...s}=this._config;o&&this._configService.setConfig("menu",o,{merge:!0}),this._configService.setConfig(iE,s),this._initDependencies(t),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),(0,h.touchDependencies)(this._injector,[[ll],[lg]])}onRendered(){this._initUI(),this._initRenderModules(),(0,h.touchDependencies)(this._injector,[[oM],[oz],[r5],[o9],[a3]])}_initCommand(){[i3,i2,nT,ny,nx,nB,nD,n_,nP,nw,nL,nj,nH,nz,rQ,iX,iJ,i0,iZ,i1,ip,n1,nZ,nK,n8,n5,n7,n6,ie,rw,rN,rO,rB,r_,rM,rD,rT,rb,ry,t9,oA,no,ns,nl,nJ,nq,n$,n0,n9,os,rC,rk,iW,iK,ep,eg,em,ol,ou,r7,od,oc].forEach(e=>{this._commandService.registerCommand(e)}),[rI,rv,rE].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e)))}_initializeShortcut(){[lS,lI,lE,lv,lC,lT,lb,ly,lR,lm,lf,lp,nu].forEach(e=>{this._injector.get(N.IShortcutService).registerShortcut(e)})}_initDependencies(e){(0,h.mergeOverrideWithDependencies)([[sT],[sQ],[a3],[oM],[o9],[oz],[ob],[r5],[e5,{useClass:e8}],[tD,{useClass:tM}],[rm,{useClass:rf}],[sn],[lg],[ll],[W],[nv]],this._config.override).forEach(t=>e.add(t))}_markDocAsFocused(){let e=this._injector.get(h.IUniverInstanceService),t=this._injector.get(e5);try{let n=e.getCurrentUnitForType(h.UniverInstanceType.UNIVER_DOC);if(!n)return;let i=n.getUnitId();t.isEditor(i)||e.focusUnit(n.getUnitId())}catch(e){this._logService.warn(e)}}_initUI(){this._injector.get(ob)}_initRenderBasics(){[[(0,g.DocSkeletonManagerService)],[e0],[(0,g.DocInterceptorService)],[sq],[oo],[oa],[li]].forEach(e=>{this._renderManagerSrv.registerRenderModule(h.UniverInstanceType.UNIVER_DOC,e)})}_initRenderModules(){[[sA],[a5],[s8],[tq],[s1],[sB],[sf],[sT],[sK],[sV],[sQ]].forEach(e=>{this._renderManagerSrv.registerRenderModule(h.UniverInstanceType.UNIVER_DOC,e)})}},"UniverDocsUIPlugin"),lB);lP(lQ,"pluginName","DOC_UI_PLUGIN"),lQ=l_([(0,h.DependentOn)(p.UniverRenderEnginePlugin),lU(1,(0,h.Inject)(h.Injector)),lU(2,p.IRenderManagerService),lU(3,h.ICommandService),lU(4,h.ILogService),lU(5,h.IConfigService)],lQ)}),n("bbuk8",function(n,i){e(n.exports,"bufferTime",function(){return u});var r=t("9tuco"),a=t("dCdPC"),o=t("jaOYC"),s=t("hMcgT"),l=t("iDS9r"),A=t("fVAG8"),d=t("sCDrc"),c=t("idNW3");function u(e){for(var t,n,i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var h=null!==(t=(0,d.popScheduler)(i))&&void 0!==t?t:A.asyncScheduler,g=null!==(n=i[0])&&void 0!==n?n:null,p=i[1]||1/0;return(0,o.operate)(function(t,n){var i=[],o=!1,A=function(e){var t=e.buffer;e.subs.unsubscribe(),(0,l.arrRemove)(i,e),n.next(t),o&&d()},d=function(){if(i){var t=new a.Subscription;n.add(t);var r={buffer:[],subs:t};i.push(r),(0,c.executeSchedule)(t,h,function(){return A(r)},e)}};null!==g&&g>=0?(0,c.executeSchedule)(n,h,d,g,!0):o=!0,d();var u=(0,s.createOperatorSubscriber)(n,function(e){var t,n,a=i.slice();try{for(var o=(0,r.__values)(a),s=o.next();!s.done;s=o.next()){var l=s.value,d=l.buffer;d.push(e),p<=d.length&&A(l)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},function(){for(;null==i?void 0:i.length;)n.next(i.shift().buffer);null==u||u.unsubscribe(),n.complete(),n.unsubscribe()},void 0,function(){return i=null});t.subscribe(u)})}})}();
//# sourceMappingURL=es.63eea4d7.js.map
