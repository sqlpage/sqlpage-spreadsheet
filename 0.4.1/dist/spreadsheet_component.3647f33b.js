var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function t(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var r={},n={},i=e.parcelRequire26fc;null==i&&((i=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var i={id:e,exports:{}};return r[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequire26fc=i);var o=i.register;o("7yNYd",function(r,n){let o,s,a,l,u,c,h,d,p,f,g,m,_,y,E,v,b,R,T,I,C,S,x,O,A,w,N,D,L,M,U,P,k,F,j,B,H,V,$,G,W,z,Y,K,X,q,J,Q,Z,ee,et,er,en,ei,eo,es,ea,el,eu,ec,eh,ed,ep,ef,eg,em,e_,ey,eE,ev,eb,eR,eT,eI,eC,eS,ex,eO,eA,ew,eN,eD,eL,eM,eU,eP,ek,eF,ej,eB,eH,eV,e$,eG,eW,ez;t(r.exports,"debounce",function(){return nF}),t(r.exports,"mergeWith",function(){return nW}),t(r.exports,"remove",function(){return nY}),t(r.exports,"isBooleanString",function(){return nX}),t(r.exports,"DOCS_NORMAL_EDITOR_UNIT_ID_KEY",function(){return nJ}),t(r.exports,"DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY",function(){return nQ}),t(r.exports,"DOCS_ZEN_EDITOR_UNIT_ID_KEY",function(){return nZ}),t(r.exports,"DEFAULT_EMPTY_DOCUMENT_VALUE",function(){return n0}),t(r.exports,"IS_ROW_STYLE_PRECEDE_COLUMN_STYLE",function(){return n1}),t(r.exports,"createInternalEditorID",function(){return n2}),t(r.exports,"isInternalEditorID",function(){return n5}),t(r.exports,"isClassDependencyItem",function(){return n9}),t(r.exports,"Quantity",function(){return uC}),t(r.exports,"createIdentifier",function(){return iy}),t(r.exports,"Optional",function(){return iS}),t(r.exports,"Inject",function(){return ix}),t(r.exports,"Injector",function(){return i4}),t(r.exports,"useInjector",function(){return ol}),t(r.exports,"useDependency",function(){return ou}),t(r.exports,"connectInjector",function(){return od}),t(r.exports,"useObservable",function(){return oy}),t(r.exports,"registerDependencies",function(){return ov}),t(r.exports,"touchDependencies",function(){return ob}),t(r.exports,"CustomCommandExecutionError",function(){return oT}),t(r.exports,"InterceptorEffectEnum",function(){return oI}),t(r.exports,"createInterceptorKey",function(){return oC}),t(r.exports,"composeInterceptors",function(){return oS}),t(r.exports,"InterceptorManager",function(){return oO}),t(r.exports,"MemoryCursor",function(){return ow}),t(r.exports,"isNumeric",function(){return oN}),t(r.exports,"isSafeNumeric",function(){return oD}),t(r.exports,"Registry",function(){return oM}),t(r.exports,"requestImmediateMacroTask",function(){return oU}),t(r.exports,"mergeSets",function(){return oF}),t(r.exports,"toDisposable",function(){return oX}),t(r.exports,"DisposableCollection",function(){return oJ}),t(r.exports,"Disposable",function(){return oZ}),t(r.exports,"RxDisposable",function(){return o1}),t(r.exports,"IContextService",function(){return o2}),t(r.exports,"ILogService",function(){return o6}),t(r.exports,"CommandType",function(){return st}),t(r.exports,"ICommandService",function(){return sr}),t(r.exports,"NilCommand",function(){return si}),t(r.exports,"sequenceExecute",function(){return sl}),t(r.exports,"sequenceExecuteAsync",function(){return su}),t(r.exports,"fromCallback",function(){return sc}),t(r.exports,"bufferDebounceTime",function(){return sd}),t(r.exports,"searchArray",function(){return sg}),t(r.exports,"MOVE_BUFFER_VALUE",function(){return sm}),t(r.exports,"checkIfMove",function(){return s_}),t(r.exports,"BorderStyleTypes",function(){return sE}),t(r.exports,"BorderType",function(){return sv}),t(r.exports,"Dimension",function(){return sS}),t(r.exports,"Direction",function(){return sx}),t(r.exports,"getReverseDirection",function(){return sO}),t(r.exports,"LocaleType",function(){return sN}),t(r.exports,"TextDirection",function(){return sj}),t(r.exports,"TextDecoration",function(){return sB}),t(r.exports,"HorizontalAlign",function(){return sH}),t(r.exports,"VerticalAlign",function(){return sV}),t(r.exports,"WrapStrategy",function(){return s$}),t(r.exports,"FontItalic",function(){return sG}),t(r.exports,"FontWeight",function(){return sW}),t(r.exports,"BaselineOffset",function(){return sz}),t(r.exports,"BooleanNumber",function(){return sY}),t(r.exports,"CellValueType",function(){return sK}),t(r.exports,"Tools",function(){return ai}),t(r.exports,"generateRandomId",function(){return ao}),t(r.exports,"composeStyles",function(){return as}),t(r.exports,"convertBodyToHtml",function(){return al}),t(r.exports,"COLORS",function(){return aE}),t(r.exports,"ColorKit",function(){return ab}),t(r.exports,"isWhiteColor",function(){return ak}),t(r.exports,"UpdateDocsAttributeType",function(){return aF}),t(r.exports,"isICellData",function(){return aj}),t(r.exports,"getCellValueType",function(){return aB}),t(r.exports,"isNullCell",function(){return aH}),t(r.exports,"isCellV",function(){return aV}),t(r.exports,"RANGE_TYPE",function(){return a$}),t(r.exports,"AbsoluteRefType",function(){return aG}),t(r.exports,"selectionToArray",function(){return aW}),t(r.exports,"RANGE_DIRECTION",function(){return az}),t(r.exports,"DOC_RANGE_TYPE",function(){return aY}),t(r.exports,"getCellInfoInMergeData",function(){return aK}),t(r.exports,"makeCellToSelection",function(){return aX}),t(r.exports,"makeCellRangeToRangeData",function(){return aq}),t(r.exports,"isCellCoverable",function(){return aQ}),t(r.exports,"getColorStyle",function(){return aZ}),t(r.exports,"isFormulaString",function(){return a0}),t(r.exports,"isFormulaId",function(){return a1}),t(r.exports,"handleStyleToString",function(){return a2}),t(r.exports,"getBorderStyleType",function(){return a3}),t(r.exports,"isValidRange",function(){return a6}),t(r.exports,"cellToRange",function(){return a4}),t(r.exports,"checkForSubstrings",function(){return a7}),t(r.exports,"horizontalLineSegmentsSubtraction",function(){return le}),t(r.exports,"checkParagraphHasIndentByStyle",function(){return lt}),t(r.exports,"insertTextToContent",function(){return lr}),t(r.exports,"deleteContent",function(){return ln}),t(r.exports,"isRealNum",function(){return lo}),t(r.exports,"hashAlgorithm",function(){return ls}),t(r.exports,"LRUMap",function(){return lf}),t(r.exports,"numfmt",function(){return lv}),t(r.exports,"getArrayLength",function(){return lb}),t(r.exports,"insertMatrixArray",function(){return lR}),t(r.exports,"spliceArray",function(){return lT}),t(r.exports,"concatMatrixArray",function(){return lI}),t(r.exports,"sliceMatrixArray",function(){return lC}),t(r.exports,"moveMatrixArray",function(){return lS}),t(r.exports,"ObjectMatrix",function(){return lw}),t(r.exports,"DEFAULT_STYLES",function(){return lN}),t(r.exports,"Range",function(){return lP}),t(r.exports,"moveRangeByOffset",function(){return lk}),t(r.exports,"splitIntoGrid",function(){return lj}),t(r.exports,"Rectangle",function(){return lX}),t(r.exports,"getIntersectRange",function(){return lG}),t(r.exports,"queryObjectMatrix",function(){return lZ}),t(r.exports,"createRowColIter",function(){return l0}),t(r.exports,"numberToABC",function(){return l1}),t(r.exports,"numberToListABC",function(){return l5}),t(r.exports,"sortRules",function(){return l3}),t(r.exports,"sortRulesByDesc",function(){return l6}),t(r.exports,"sortRulesFactory",function(){return l4}),t(r.exports,"UniverInstanceType",function(){return l9}),t(r.exports,"TextXActionType",function(){return uB}),t(r.exports,"DataStreamTreeNodeType",function(){return uH}),t(r.exports,"DataStreamTreeTokenType",function(){return uV}),t(r.exports,"GlyphType",function(){return uW}),t(r.exports,"BulletAlignment",function(){return uz}),t(r.exports,"CustomRangeType",function(){return uY}),t(r.exports,"CustomDecorationType",function(){return uK}),t(r.exports,"DocumentFlavor",function(){return uq}),t(r.exports,"GridType",function(){return uJ}),t(r.exports,"SectionType",function(){return uQ}),t(r.exports,"ColumnSeparatorType",function(){return uZ}),t(r.exports,"WrapTextType",function(){return u2}),t(r.exports,"PositionedObjectLayoutType",function(){return u5}),t(r.exports,"SpacingRule",function(){return u6}),t(r.exports,"TableSizeType",function(){return u8}),t(r.exports,"TableAlignmentType",function(){return u7}),t(r.exports,"TableTextWrapType",function(){return ct}),t(r.exports,"TableCellHeightRule",function(){return cr}),t(r.exports,"FontStyleType",function(){return ci}),t(r.exports,"ObjectRelativeFromH",function(){return co}),t(r.exports,"ObjectRelativeFromV",function(){return cs}),t(r.exports,"NumberUnitType",function(){return ca}),t(r.exports,"AlignTypeH",function(){return cl}),t(r.exports,"AlignTypeV",function(){return cu}),t(r.exports,"PageOrientType",function(){return ch}),t(r.exports,"PresetListType",function(){return cg}),t(r.exports,"PRESET_LIST_TYPE",function(){return cv}),t(r.exports,"QuickListTypeMap",function(){return cR}),t(r.exports,"normalizeTextRuns",function(){return cT}),t(r.exports,"SliceBodyType",function(){return cX}),t(r.exports,"getBodySlice",function(){return cq}),t(r.exports,"normalizeBody",function(){return cJ}),t(r.exports,"TextX",function(){return ho}),t(r.exports,"JSONX",function(){return ha}),t(r.exports,"DocumentDataModel",function(){return hd}),t(r.exports,"BuildTextUtils",function(){return hG}),t(r.exports,"EventSubject",function(){return hY}),t(r.exports,"fromEventSubject",function(){return hK}),t(r.exports,"IResourceManagerService",function(){return hX}),t(r.exports,"UserManagerService",function(){return h0}),t(r.exports,"IAuthzIoService",function(){return de}),t(r.exports,"IConfigService",function(){return dt}),t(r.exports,"FOCUSING_SHEET",function(){return di}),t(r.exports,"FOCUSING_DOC",function(){return ds}),t(r.exports,"FOCUSING_EDITOR_BUT_HIDDEN",function(){return dl}),t(r.exports,"EDITOR_ACTIVATED",function(){return du}),t(r.exports,"FOCUSING_EDITOR_INPUT_FORMULA",function(){return dc}),t(r.exports,"FOCUSING_FX_BAR_EDITOR",function(){return dh}),t(r.exports,"FOCUSING_UNIVER_EDITOR",function(){return dd}),t(r.exports,"FOCUSING_EDITOR_STANDALONE",function(){return dp}),t(r.exports,"FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",function(){return df}),t(r.exports,"FOCUSING_COMMON_DRAWINGS",function(){return dg}),t(r.exports,"FORMULA_EDITOR_ACTIVATED",function(){return dm}),t(r.exports,"ErrorService",function(){return dy}),t(r.exports,"DEFAULT_WORKSHEET_ROW_HEIGHT",function(){return dT}),t(r.exports,"DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY",function(){return dI}),t(r.exports,"DEFAULT_WORKSHEET_COLUMN_WIDTH",function(){return dC}),t(r.exports,"mergeWorksheetSnapshotWithDefault",function(){return dS}),t(r.exports,"extractPureTextFromCell",function(){return dw}),t(r.exports,"getOriginCellValue",function(){return dN}),t(r.exports,"Workbook",function(){return dP}),t(r.exports,"SlideDataModel",function(){return dF}),t(r.exports,"IUniverInstanceService",function(){return d$}),t(r.exports,"LifecycleStages",function(){return dW}),t(r.exports,"LifecycleService",function(){return d0}),t(r.exports,"ILocalStorageService",function(){return d2}),t(r.exports,"LocaleService",function(){return d3}),t(r.exports,"PermissionStatus",function(){return d6}),t(r.exports,"IPermissionService",function(){return d4}),t(r.exports,"Plugin",function(){return pe}),t(r.exports,"DependentOn",function(){return pa}),t(r.exports,"mergeOverrideWithDependencies",function(){return pc}),t(r.exports,"IResourceLoaderService",function(){return ph}),t(r.exports,"ThemeService",function(){return pf}),t(r.exports,"IUndoRedoService",function(){return pE}),t(r.exports,"RedoCommandId",function(){return pR}),t(r.exports,"UndoCommandId",function(){return pT}),t(r.exports,"UndoCommand",function(){return pI}),t(r.exports,"RedoCommand",function(){return pC}),t(r.exports,"nameCharacterCheck",function(){return px}),t(r.exports,"isRangesEqual",function(){return pO}),t(r.exports,"skipParseTagNames",function(){return pA}),t(r.exports,"DataValidationErrorStyle",function(){return pw}),t(r.exports,"DataValidationOperator",function(){return pD}),t(r.exports,"DataValidationRenderMode",function(){return pL}),t(r.exports,"DataValidationStatus",function(){return pM}),t(r.exports,"DataValidationType",function(){return pU}),t(r.exports,"RTree",function(){return p8}),t(r.exports,"Univer",function(){return fu});var eY=i("5LPkb"),eK=i("5K4WI"),eX=i("bXJOC"),eq=i("arCqp"),eJ=i("lMvMU"),eQ=i("hciHF"),eZ=i("i54iF"),e0=i("1O3Nt"),e1=i("3yupB"),e2=i("9GqS8"),e5=i("1mjSk"),e3=i("b7wVW"),eX=(i("aMpZj"),i("bXJOC")),eJ=i("lMvMU"),eQ=(i("bDEN0"),i("hciHF")),e6=i("5gqvu"),e4=i("8L69c"),e9=Object.defineProperty,e8=(e,t,r)=>t in e?e9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,e7=(e,t)=>e9(e,"name",{value:t,configurable:!0}),te=(e,t,r)=>e8(e,"symbol"!=typeof t?t+"":t,r);function tt(){tn()}e7(function(e,t){for(var r=0;r<t.length;r++){let n=t[r];if("string"!=typeof n&&!Array.isArray(n)){for(let t in n)if("default"!==t&&!(t in e)){let r=Object.getOwnPropertyDescriptor(n,t);r&&Object.defineProperty(e,t,r.get?r:{enumerable:!0,get:/* @__PURE__ */e7(()=>n[t],"get")})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))},"_mergeNamespaces"),e7(tt,"installShims");let tr="u">typeof e?e:"u">typeof self?self:window;function tn(){"function"!=typeof tr.requestIdleCallback&&(tr.requestIdleCallback=/* @__PURE__ */e7(function(e){let t=Date.now();return setTimeout(/* @__PURE__ */e7(function(){let r=Math.max(0,50-(Date.now()-t));e({didTimeout:0===r,timeRemaining:()=>r})},"rICCallback"),1)},"shimRIC")),"function"!=typeof tr.cancelIdleCallback&&(tr.cancelIdleCallback=/* @__PURE__ */e7(function(e){clearTimeout(e)},"shimCancelRIC"))}e7(tn,"installRequestIdleCallback");var ti="object"==typeof e&&e&&e.Object===Object&&e,to="object"==typeof self&&self&&self.Object===Object&&self,ts=ti||to||Function("return this")(),ta=ts.Symbol,tl=Object.prototype,tu=tl.hasOwnProperty,tc=tl.toString,th=ta?ta.toStringTag:void 0;function td(e){var t=tu.call(e,th),r=e[th];try{e[th]=void 0;var n=!0}catch{}var i=tc.call(e);return n&&(t?e[th]=r:delete e[th]),i}e7(td,"getRawTag");var tp=Object.prototype.toString;function tf(e){return tp.call(e)}e7(tf,"objectToString");var tg=ta?ta.toStringTag:void 0;function tm(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":tg&&tg in Object(e)?td(e):tf(e)}function t_(e){return null!=e&&"object"==typeof e}function ty(e){return"symbol"==typeof e||t_(e)&&"[object Symbol]"==tm(e)}function tE(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}e7(tm,"baseGetTag"),e7(t_,"isObjectLike"),e7(ty,"isSymbol"),e7(tE,"arrayMap");var tv=Array.isArray,tb=1/0,tR=ta?ta.prototype:void 0,tT=tR?tR.toString:void 0;function tI(e){if("string"==typeof e)return e;if(tv(e))return tE(e,tI)+"";if(ty(e))return tT?tT.call(e):"";var t=e+"";return"0"==t&&1/e==-tb?"-0":t}e7(tI,"baseToString");var tC=/\s/;function tS(e){for(var t=e.length;t--&&tC.test(e.charAt(t)););return t}e7(tS,"trimmedEndIndex");var tx=/^\s+/;function tO(e){return e&&e.slice(0,tS(e)+1).replace(tx,"")}function tA(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}e7(tO,"baseTrim"),e7(tA,"isObject$1");var tw=NaN,tN=/^[-+]0x[0-9a-f]+$/i,tD=/^0b[01]+$/i,tL=/^0o[0-7]+$/i,tM=parseInt;function tU(e){if("number"==typeof e)return e;if(ty(e))return tw;if(tA(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=tA(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=tO(e);var r=tD.test(e);return r||tL.test(e)?tM(e.slice(2),r?2:8):tN.test(e)?tw:+e}function tP(e){return e}function tk(e){if(!tA(e))return!1;var t=tm(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}e7(tU,"toNumber"),e7(tP,"identity"),e7(tk,"isFunction$1");var tF=ts["__core-js_shared__"],tj=(up=/[^.]+$/.exec(tF&&tF.keys&&tF.keys.IE_PROTO||""))?"Symbol(src)_1."+up:"";function tB(e){return!!tj&&tj in e}e7(tB,"isMasked");var tH=Function.prototype.toString;function tV(e){if(null!=e){try{return tH.call(e)}catch{}try{return e+""}catch{}}return""}e7(tV,"toSource");var t$=/^\[object .+?Constructor\]$/,tG=Object.prototype,tW=Function.prototype.toString,tz=tG.hasOwnProperty,tY=RegExp("^"+tW.call(tz).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tK(e){return!(!tA(e)||tB(e))&&(tk(e)?tY:t$).test(tV(e))}function tX(e,t){return null==e?void 0:e[t]}function tq(e,t){var r=tX(e,t);return tK(r)?r:void 0}e7(tK,"baseIsNative"),e7(tX,"getValue"),e7(tq,"getNative");var tJ=Object.create,tQ=function(){function e(){}return e7(e,"object"),function(t){if(!tA(t))return{};if(tJ)return tJ(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();function tZ(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function t0(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}e7(tZ,"apply"),e7(t0,"copyArray");var t1=Date.now;function t2(e){var t=0,r=0;return function(){var n=t1(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function t5(e){return function(){return e}}e7(t2,"shortOut"),e7(t5,"constant");var t3=function(){try{var e=tq(Object,"defineProperty");return e({},"",{}),e}catch{}}(),t6=t2(t3?function(e,t){return t3(e,"toString",{configurable:!0,enumerable:!1,value:t5(t),writable:!0})}:tP),t4=/^(?:0|[1-9]\d*)$/;function t9(e,t){var r=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==r||"symbol"!=r&&t4.test(e))&&e>-1&&e%1==0&&e<t}function t8(e,t,r){"__proto__"==t&&t3?t3(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function t7(e,t){return e===t||e!=e&&t!=t}e7(t9,"isIndex"),e7(t8,"baseAssignValue"),e7(t7,"eq");var re=Object.prototype.hasOwnProperty;function rt(e,t,r){var n=e[t];re.call(e,t)&&t7(n,r)&&(void 0!==r||t in e)||t8(e,t,r)}function rr(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=void 0;void 0===l&&(l=e[a]),i?t8(r,a,l):rt(r,a,l)}return r}e7(rt,"assignValue"),e7(rr,"copyObject");var rn=Math.max;function ri(e,t,r){return t=rn(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=rn(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),tZ(e,this,a)}}function ro(e,t){return t6(ri(e,t,tP),e+"")}function rs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function ra(e){return null!=e&&rs(e.length)&&!tk(e)}function rl(e,t,r){if(!tA(r))return!1;var n=typeof t;return("number"==n?!!(ra(r)&&t9(t,r.length)):"string"==n&&t in r)&&t7(r[t],e)}function ru(e){return ro(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&rl(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n,o)}return t})}e7(ri,"overRest"),e7(ro,"baseRest"),e7(rs,"isLength"),e7(ra,"isArrayLike"),e7(rl,"isIterateeCall"),e7(ru,"createAssigner");var rc=Object.prototype;function rh(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||rc)}function rd(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function rp(e){return t_(e)&&"[object Arguments]"==tm(e)}e7(rh,"isPrototype"),e7(rd,"baseTimes"),e7(rp,"baseIsArguments");var rf=Object.prototype,rg=rf.hasOwnProperty,rm=rf.propertyIsEnumerable,r_=rp(/* @__PURE__ */function(){return arguments}())?rp:function(e){return t_(e)&&rg.call(e,"callee")&&!rm.call(e,"callee")};function ry(){return!1}e7(ry,"stubFalse");var rE=n&&!n.nodeType&&n,rv=rE&&r&&!r.nodeType&&r,rb=rv&&rv.exports===rE?ts.Buffer:void 0,rR=(rb?rb.isBuffer:void 0)||ry,rT={};function rI(e){return t_(e)&&rs(e.length)&&!!rT[tm(e)]}function rC(e){return function(t){return e(t)}}rT["[object Float32Array]"]=rT["[object Float64Array]"]=rT["[object Int8Array]"]=rT["[object Int16Array]"]=rT["[object Int32Array]"]=rT["[object Uint8Array]"]=rT["[object Uint8ClampedArray]"]=rT["[object Uint16Array]"]=rT["[object Uint32Array]"]=!0,rT["[object Arguments]"]=rT["[object Array]"]=rT["[object ArrayBuffer]"]=rT["[object Boolean]"]=rT["[object DataView]"]=rT["[object Date]"]=rT["[object Error]"]=rT["[object Function]"]=rT["[object Map]"]=rT["[object Number]"]=rT["[object Object]"]=rT["[object RegExp]"]=rT["[object Set]"]=rT["[object String]"]=rT["[object WeakMap]"]=!1,e7(rI,"baseIsTypedArray"),e7(rC,"baseUnary");var rS=n&&!n.nodeType&&n,rx=rS&&r&&!r.nodeType&&r,rO=rx&&rx.exports===rS&&ti.process,rA=function(){try{return rx&&rx.require&&rx.require("util").types||rO&&rO.binding&&rO.binding("util")}catch{}}(),rw=rA&&rA.isTypedArray,rN=rw?rC(rw):rI;function rD(e,t){var r=tv(e),n=!r&&r_(e),i=!r&&!n&&rR(e),o=!r&&!n&&!i&&rN(e),s=r||n||i||o,a=s?rd(e.length,String):[],l=a.length;for(var u in e)s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||t9(u,l))||a.push(u);return a}function rL(e,t){return function(r){return e(t(r))}}function rM(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}e7(rD,"arrayLikeKeys"),e7(rL,"overArg"),e7(rM,"nativeKeysIn");var rU=Object.prototype.hasOwnProperty;function rP(e){if(!tA(e))return rM(e);var t=rh(e),r=[];for(var n in e)"constructor"==n&&(t||!rU.call(e,n))||r.push(n);return r}function rk(e){return ra(e)?rD(e):rP(e)}e7(rP,"baseKeysIn"),e7(rk,"keysIn");var rF=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rj=/^\w*$/;function rB(e,t){if(tv(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||ty(e))||rj.test(e)||!rF.test(e)||null!=t&&e in Object(t)}e7(rB,"isKey");var rH=tq(Object,"create");function rV(){this.__data__=rH?rH(null):{},this.size=0}function r$(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}e7(rV,"hashClear"),e7(r$,"hashDelete");var rG=Object.prototype.hasOwnProperty;function rW(e){var t=this.__data__;if(rH){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return rG.call(t,e)?t[e]:void 0}e7(rW,"hashGet");var rz=Object.prototype.hasOwnProperty;function rY(e){var t=this.__data__;return rH?void 0!==t[e]:rz.call(t,e)}function rK(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=rH&&void 0===t?"__lodash_hash_undefined__":t,this}function rX(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function rq(){this.__data__=[],this.size=0}function rJ(e,t){for(var r=e.length;r--;)if(t7(e[r][0],t))return r;return -1}e7(rY,"hashHas"),e7(rK,"hashSet"),e7(rX,"Hash"),rX.prototype.clear=rV,rX.prototype.delete=r$,rX.prototype.get=rW,rX.prototype.has=rY,rX.prototype.set=rK,e7(rq,"listCacheClear"),e7(rJ,"assocIndexOf");var rQ=Array.prototype.splice;function rZ(e){var t=this.__data__,r=rJ(t,e);return!(r<0)&&(r==t.length-1?t.pop():rQ.call(t,r,1),--this.size,!0)}function r0(e){var t=this.__data__,r=rJ(t,e);return r<0?void 0:t[r][1]}function r1(e){return rJ(this.__data__,e)>-1}function r2(e,t){var r=this.__data__,n=rJ(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function r5(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}e7(rZ,"listCacheDelete"),e7(r0,"listCacheGet"),e7(r1,"listCacheHas"),e7(r2,"listCacheSet"),e7(r5,"ListCache"),r5.prototype.clear=rq,r5.prototype.delete=rZ,r5.prototype.get=r0,r5.prototype.has=r1,r5.prototype.set=r2;var r3=tq(ts,"Map");function r6(){this.size=0,this.__data__={hash:new rX,map:new(r3||r5),string:new rX}}function r4(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function r9(e,t){var r=e.__data__;return r4(t)?r["string"==typeof t?"string":"hash"]:r.map}function r8(e){var t=r9(this,e).delete(e);return this.size-=t?1:0,t}function r7(e){return r9(this,e).get(e)}function ne(e){return r9(this,e).has(e)}function nt(e,t){var r=r9(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function nr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function nn(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var r=/* @__PURE__ */e7(function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s},"memoized");return r.cache=new(nn.Cache||nr),r}function ni(e){var t=nn(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}e7(r6,"mapCacheClear"),e7(r4,"isKeyable"),e7(r9,"getMapData"),e7(r8,"mapCacheDelete"),e7(r7,"mapCacheGet"),e7(ne,"mapCacheHas"),e7(nt,"mapCacheSet"),e7(nr,"MapCache"),nr.prototype.clear=r6,nr.prototype.delete=r8,nr.prototype.get=r7,nr.prototype.has=ne,nr.prototype.set=nt,e7(nn,"memoize"),nn.Cache=nr,e7(ni,"memoizeCapped");var no=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ns=/\\(\\)?/g,na=ni(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(no,function(e,r,n,i){t.push(n?i.replace(ns,"$1"):r||e)}),t});function nl(e){return null==e?"":tI(e)}function nu(e,t){return tv(e)?e:rB(e,t)?[e]:na(nl(e))}e7(nl,"toString"),e7(nu,"castPath");var nc=1/0;function nh(e){if("string"==typeof e||ty(e))return e;var t=e+"";return"0"==t&&1/e==-nc?"-0":t}function nd(e,t){t=nu(t,e);for(var r=0,n=t.length;null!=e&&r<n;)e=e[nh(t[r++])];return r&&r==n?e:void 0}e7(nh,"toKey"),e7(nd,"baseGet"),e7(function(e,t,r){var n=null==e?void 0:nd(e,t);return void 0===n?r:n},"get");var np=rL(Object.getPrototypeOf,Object),nf=Object.prototype,ng=Function.prototype.toString,nm=nf.hasOwnProperty,n_=ng.call(Object);function ny(e){if(!t_(e)||"[object Object]"!=tm(e))return!1;var t=np(e);if(null===t)return!0;var r=nm.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&ng.call(r)==n_}function nE(){this.__data__=new r5,this.size=0}function nv(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}function nb(e){return this.__data__.get(e)}function nR(e){return this.__data__.has(e)}function nT(e,t){var r=this.__data__;if(r instanceof r5){var n=r.__data__;if(!r3||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new nr(n)}return r.set(e,t),this.size=r.size,this}function nI(e){var t=this.__data__=new r5(e);this.size=t.size}e7(ny,"isPlainObject"),e7(nE,"stackClear"),e7(nv,"stackDelete"),e7(nb,"stackGet"),e7(nR,"stackHas"),e7(nT,"stackSet"),e7(nI,"Stack"),nI.prototype.clear=nE,nI.prototype.delete=nv,nI.prototype.get=nb,nI.prototype.has=nR,nI.prototype.set=nT;var nC=n&&!n.nodeType&&n,nS=nC&&r&&!r.nodeType&&r,nx=nS&&nS.exports===nC?ts.Buffer:void 0;function nO(e,t){return e.slice()}nx&&nx.allocUnsafe,e7(nO,"cloneBuffer");var nA=ts.Uint8Array;function nw(e){var t=new e.constructor(e.byteLength);return new nA(t).set(new nA(e)),t}function nN(e,t){var r=nw(e.buffer);return new e.constructor(r,e.byteOffset,e.length)}function nD(e){return"function"!=typeof e.constructor||rh(e)?{}:tQ(np(e))}function nL(e){return function(e,t,r){for(var n=-1,i=Object(e),o=r(e),s=o.length;s--;){var a=o[++n];if(!1===t(i[a],a,i))break}return e}}e7(nw,"cloneArrayBuffer"),e7(nN,"cloneTypedArray"),e7(nD,"initCloneObject"),e7(nL,"createBaseFor");var nM=nL(),nU=/* @__PURE__ */e7(function(){return ts.Date.now()},"now"),nP=Math.max,nk=Math.min;function nF(e,t,r){var n,i,o,s,a,l,u=0,c=!1,h=!1,d=!0;if("function"!=typeof e)throw TypeError("Expected a function");function p(t){var r=n,o=i;return n=i=void 0,u=t,s=e.apply(o,r)}function f(e){return u=e,a=setTimeout(_,t),c?p(e):s}function g(e){var r=e-l,n=e-u,i=t-r;return h?nk(i,o-n):i}function m(e){var r=e-l,n=e-u;return void 0===l||r>=t||r<0||h&&n>=o}function _(){var e=nU();if(m(e))return y(e);a=setTimeout(_,g(e))}function y(e){return a=void 0,d&&n?p(e):(n=i=void 0,s)}function E(){void 0!==a&&clearTimeout(a),u=0,n=l=i=a=void 0}function v(){return void 0===a?s:y(nU())}function b(){var e=nU(),r=m(e);if(n=arguments,i=this,l=e,r){if(void 0===a)return f(l);if(h)return clearTimeout(a),a=setTimeout(_,t),p(l)}return void 0===a&&(a=setTimeout(_,t)),s}return t=tU(t)||0,tA(r)&&(c=!!r.leading,o=(h="maxWait"in r)?nP(tU(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),e7(p,"invokeFunc"),e7(f,"leadingEdge"),e7(g,"remainingWait"),e7(m,"shouldInvoke"),e7(_,"timerExpired"),e7(y,"trailingEdge"),e7(E,"cancel"),e7(v,"flush"),e7(b,"debounced"),b.cancel=E,b.flush=v,b}function nj(e,t,r){(void 0===r||t7(e[t],r))&&(void 0!==r||t in e)||t8(e,t,r)}function nB(e){return t_(e)&&ra(e)}function nH(e,t){if(!("constructor"===t&&"function"==typeof e[t])&&"__proto__"!=t)return e[t]}function nV(e){return rr(e,rk(e))}function n$(e,t,r,n,i,o,s){var a=nH(e,r),l=nH(t,r),u=s.get(l);if(u){nj(e,r,u);return}var c=o?o(a,l,r+"",e,t,s):void 0,h=void 0===c;if(h){var d=tv(l),p=!d&&rR(l),f=!d&&!p&&rN(l);c=l,d||p||f?tv(a)?c=a:nB(a)?c=t0(a):p?(h=!1,c=nO(l)):f?(h=!1,c=nN(l)):c=[]:ny(l)||r_(l)?(c=a,r_(a)?c=nV(a):(!tA(a)||tk(a))&&(c=nD(l))):h=!1}h&&(s.set(l,c),i(c,l,n,o,s),s.delete(l)),nj(e,r,c)}function nG(e,t,r,n,i){e!==t&&nM(t,function(o,s){if(i||(i=new nI),tA(o))n$(e,t,s,r,nG,n,i);else{var a=n?n(nH(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),nj(e,s,a)}},rk)}e7(nF,"debounce"),e7(nj,"assignMergeValue"),e7(nB,"isArrayLikeObject"),e7(nH,"safeGet"),e7(nV,"toPlainObject"),e7(n$,"baseMergeDeep"),e7(nG,"baseMerge");let nW=ru(function(e,t,r,n){nG(e,t,r,n)});function nz(e,t,r,n){if(!tA(e))return e;t=nu(t,e);for(var i=-1,o=t.length,s=o-1,a=e;null!=a&&++i<o;){var l=nh(t[i]),u=r;if("__proto__"===l||"constructor"===l||"prototype"===l)break;if(i!=s){var c=a[l];u=void 0,u=tA(c)?c:t9(t[i+1])?[]:{}}rt(a,l,u),a=a[l]}return e}function nY(e,t){let r=e.indexOf(t);return r>-1&&(e.splice(r,1),!0)}function nK(e,t){for(let r=e.length-1;r>-1;r--){let n=e[r];if(t(n,r))return n}return null}function nX(e){return["true","false"].includes(e.toLowerCase())}ru(function(e,t,r){nG(e,t,r)}),e7(nz,"baseSet"),e7(function(e,t,r){return null==e?e:nz(e,t,r)},"set"),e7(nY,"remove"),e7(function(e){let t=/* @__PURE__ */new Set,r=[];for(let n of e)t.has(n)||(t.add(n),r.push(n));return r},"dedupe"),e7(nK,"findLast"),e7(function(e,t){if(0===e.length)return e;let r=t%e.length;return e.slice(r).concat(e.slice(0,r))},"rotate"),e7(function(e,t){let r=/* @__PURE__ */new Map;return e.forEach(e=>{let n=t(e),i=r.get(n);r.has(n)||(i=[],r.set(n,i)),i.push(e)}),r},"groupBy"),e7(function(e){return Array.isArray(e)?e:[e]},"makeArray"),e7(nX,"isBooleanString");let nq="__INTERNAL_EDITOR__",nJ=`${nq}DOCS_NORMAL`,nQ=`${nq}DOCS_FORMULA_BAR`,nZ=`${nq}ZEN_EDITOR`,n0=`\r
`,n1="isRowStylePrecedeColumnStyle";function n2(e){return`${nq}${e}`}function n5(e){return e.startsWith(nq)}e7(n2,"createInternalEditorID"),e7(n5,"isInternalEditorID");var n3=Symbol("$$IDENTIFIER_DECORATOR");function n6(e){return e&&!0===e[n3]}function n4(e){return"function"==typeof e}function n9(e){return!!(e&&"u">typeof e.useClass)}function n8(e){return!!(e&&"u">typeof e.useFactory)}function n7(e){return!!(e&&"u">typeof e.useValue)}function ie(e){return!!(e&&"u">typeof e.useExisting)}function it(e){return!!(e&&"u">typeof e.useAsync)}e7(n6,"isIdentifierDecorator"),e7(n4,"isCtor"),e7(n9,"isClassDependencyItem"),e7(n8,"isFactoryDependencyItem"),e7(n7,"isValueDependencyItem"),e7(ie,"isExistingDependencyItem"),e7(it,"isAsyncDependencyItem");var ir=Symbol("AsyncHook");function ii(e){return!!(e&&e.__symbol===ir)}function io(e){return typeof e>"u"?"undefined":n4(e)&&!e[n3]?e.name:e.toString()}e7(ii,"isAsyncHook"),e7(io,"prettyPrintIdentifier"),(uf=uC||(uC={})).MANY="many",uf.OPTIONAL="optional",uf.REQUIRED="required",(ug=uS||(uS={})).SELF="self",ug.SKIP_SELF="skipSelf";var is=(um=/* @__PURE__ */e7(function(e,t){return(um=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}um(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),ia=function(e){function t(t){return e.call(this,"[redi]: ".concat(t))||this}return is(t,e),e7(t,"RediError"),t}(Error),il=(u_=/* @__PURE__ */e7(function(e,t){return(u_=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}u_(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),iu=Symbol("$$TARGET"),ic=Symbol("$$DEPENDENCIES"),ih=function(e){function t(t,r){var n="Could not find dependency registered on the ".concat(t,' (indexed) parameter of the constructor of "').concat(io(r),'".');return e.call(this,n)||this}return il(t,e),e7(t,"DependencyDescriptorNotFoundError"),t}(ia),id=function(e){function t(t,r){var n='It seems that you register "undefined" as dependency on the '.concat(r+1,' parameter of "').concat(io(t),'". Please make sure that there is not cyclic dependency among your TypeScript files, or consider using "forwardRef". For more info please visit our website https://redi.wendell.fun/docs/debug#could-not-find-dependency-registered-on');return e.call(this,n)||this}return il(t,e),e7(t,"IdentifierUndefinedError"),t}(ia);function ip(e){return e[ic]||[]}function ig(e,t){var r=ip(e).find(function(e){return e.paramIndex===t});if(!r)throw new ih(t,e);return r}function im(e,t,r,n,i){void 0===n&&(n=uC.REQUIRED);var o={paramIndex:r,identifier:t,quantity:n,lookUp:i,withNew:!1};if(typeof t>"u")throw new id(e,r);e[iu]===e?e[ic].push(o):(e[ic]=[o],e[iu]=e)}e7(ip,"getDependencies"),e7(ig,"getDependencyByIndex"),e7(im,"setDependency");var i_=/* @__PURE__ */new Set;function iy(e){if(i_.has(e))throw new ia('Identifier "'.concat(e,'" already exists.'));i_.add(e);var t=/* @__PURE__ */e7(function(e,r,n){im(e,t,n)},"decorator");return t.toString=function(){return e},t[n3]=!0,t}e7(iy,"createIdentifier");var iE=(uy=/* @__PURE__ */e7(function(e,t){return(uy=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}uy(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),iv=function(e){function t(t,r,n){var i='Expect "'.concat(r,'" dependency items for id "').concat(io(t),'" but get ').concat(n,".");return e.call(this,i)||this}return iE(t,e),e7(t,"QuantityCheckError"),t}(ia);function ib(e,t,r){if(t===uC.OPTIONAL&&r>1||t===uC.REQUIRED&&1!==r)throw new iv(e,t,r)}function iR(e,t){return e===uC.MANY?t:t[0]}function iT(e,t,r){ig(e,t).quantity=r}function iI(e){return /* @__PURE__ */e7(function t(r){return this instanceof t?this:function(t,n,i){if(r)im(t,r,i,e);else{if(e===uC.REQUIRED)throw new id(t,i);iT(t,i,e)}}},"decoratorFactory")}e7(ib,"checkQuantity"),e7(iR,"retrieveQuantity"),e7(iT,"changeQuantity"),e7(iI,"quantifyDecoratorFactoryProducer");var iC=iI(uC.MANY),iS=iI(uC.OPTIONAL),ix=iI(uC.REQUIRED);function iO(e){return!!e&&"function"==typeof e.unwrap}function iA(e){return iO(e)?e.unwrap():e}function iw(e){return!!e&&"function"==typeof e.dispose}e7(function(e){return{unwrap:e}},"forwardRef"),e7(iO,"isForwardRef"),e7(iA,"normalizeForwardRef"),e7(iw,"isDisposable");var iN=(uE=/* @__PURE__ */e7(function(e,t){return(uE=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}uE(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function iD(e){return 1===e.length}e7(iD,"isBareClassDependency");var iL=[];function iM(e){iL.push(e)}function iU(){iL.pop()}function iP(){iL.length=0}e7(iM,"pushResolvingStack"),e7(iU,"popupResolvingStack"),e7(iP,"clearResolvingStack");var ik=function(e){function t(t,r,n){var i='Cannot find "'.concat(io(r),'" registered by any injector. It is the ').concat(n,'th param of "').concat(n6(t)?io(t):t.name,'".');return e.call(this,i)||this}return iN(t,e),e7(t,"DependencyNotFoundForModuleError"),t}(ia),iF=function(e){function t(t){var r=this,n='Cannot find "'.concat(io(t),'" registered by any injector. The stack of dependencies is: "').concat(iL.map(function(e){return io(e)}).join(" -> "),'".');return r=e.call(this,n)||this,iP(),r}return iN(t,e),e7(t,"DependencyNotFoundError"),t}(ia),ij=function(){function e(e){var t=this;this.dependencyMap=/* @__PURE__ */new Map,this.normalizeDependencies(e).map(function(e){return t.add(e[0],e[1])})}return e7(e,"DependencyCollection"),e.prototype.add=function(e,t){typeof t>"u"&&(t={useClass:e,lazy:!1});var r=this.dependencyMap.get(e);typeof r>"u"&&(r=[],this.dependencyMap.set(e,r)),r.push(t)},e.prototype.delete=function(e){this.dependencyMap.delete(e)},e.prototype.get=function(e,t){void 0===t&&(t=uC.REQUIRED);var r=this.dependencyMap.get(e);return ib(e,t,r.length),iR(t,r)},e.prototype.has=function(e){return this.dependencyMap.has(e)},e.prototype.append=function(e){var t=this;this.normalizeDependencies(e).forEach(function(e){return t.add(e[0],e[1])})},e.prototype.dispose=function(){this.dependencyMap.clear()},e.prototype.normalizeDependencies=function(e){return e.map(function(e){return[e[0],iD(e)?{useClass:e[0],lazy:!1}:e[1]]})},e}(),iB=function(){function e(){this.resolvedDependencies=/* @__PURE__ */new Map}return e7(e,"ResolvedDependencyCollection"),e.prototype.add=function(e,t){var r=this.resolvedDependencies.get(e);typeof r>"u"&&(r=[],this.resolvedDependencies.set(e,r)),r.push(t)},e.prototype.has=function(e){return this.resolvedDependencies.has(e)},e.prototype.delete=function(e){this.resolvedDependencies.has(e)&&(this.resolvedDependencies.get(e).forEach(function(e){return iw(e)?e.dispose():void 0}),this.resolvedDependencies.delete(e))},e.prototype.get=function(e,t){void 0===t&&(t=uC.REQUIRED);var r=this.resolvedDependencies.get(e);if(!r)throw new iF(e);return ib(e,t,r.length),t===uC.MANY?r:r[0]},e.prototype.dispose=function(){Array.from(this.resolvedDependencies.values()).forEach(function(e){e.forEach(function(e){return iw(e)?e.dispose():void 0})}),this.resolvedDependencies.clear()},e}();function iH(e,t,r){ig(e,t).lookUp=r}function iV(e){return /* @__PURE__ */e7(function t(){return this instanceof t?this:function(t,r,n){iH(t,n,e)}},"DecoratorFactory")}e7(iH,"changeLookup"),e7(iV,"lookupDecoratorFactoryProducer");var i$=iV(uS.SKIP_SELF),iG=iV(uS.SELF);function iW(e,t,r){ig(e,t).withNew=r}function iz(e){return /* @__PURE__ */e7(function t(){return this instanceof t?this:function(t,r,n){iW(t,n,e)}},"DecoratorFactory")}e7(iW,"changeToSelf"),e7(iz,"withNewDecoratorFactoryProducer");var iY=iz(!0);function iK(e,t){return void 0===t&&(t=0),e?e.map(function(e,r){if(r+=t,!Array.isArray(e))return{paramIndex:r,identifier:e,quantity:uC.REQUIRED,withNew:!1};var n=e.slice(0,e.length-1),i=e[e.length-1],o=void 0,s=uC.REQUIRED,a=!1;return n.forEach(function(e){if(e instanceof iG)o=uS.SELF;else if(e instanceof i$)o=uS.SKIP_SELF;else if(e instanceof iS)s=uC.OPTIONAL;else if(e instanceof iC)s=uC.MANY;else if(e instanceof iY)a=!0;else throw new ia("unknown dep modifier ".concat(e,"."))}),{paramIndex:r,identifier:i,quantity:s,lookUp:o,withNew:a}}):[]}e7(iK,"normalizeFactoryDeps"),function(){if("u">typeof requestIdleCallback&&"u">typeof cancelIdleCallback)ux=/* @__PURE__ */e7(function(e,t){var r=requestIdleCallback(e,"number"==typeof t?{timeout:t}:void 0),n=!1;return function(){n||(n=!0,cancelIdleCallback(r))}},"runWhenIdle");else{var e=Object.freeze({didTimeout:!0,timeRemaining:/* @__PURE__ */e7(function(){return 15},"timeRemaining")});ux=/* @__PURE__ */e7(function(t){var r=setTimeout(function(){return t(e)}),n=!1;return function(){n||(n=!0,clearTimeout(r))}},"runWhenIdle")}}();var iX=function(){function e(e){var t=this;this.didRun=!1,this.selfExecutor=function(){try{t.value=e()}catch(e){t.error=e}finally{t.didRun=!0}},this.disposeCallback=ux(function(){return t.selfExecutor()})}return e7(e,"IdleValue"),e.prototype.hasRun=function(){return this.didRun},e.prototype.dispose=function(){this.disposeCallback()},e.prototype.getValue=function(){if(this.didRun||(this.dispose(),this.selfExecutor()),this.error)throw this.error;return this.value},e}(),iq=(uv=/* @__PURE__ */e7(function(e,t){return(uv=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}uv(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),iJ=/* @__PURE__ */e7(function(){return(iJ=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},"__assign$1"),iQ=/* @__PURE__ */e7(function(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},"__spreadArray$2"),iZ=Symbol("$$NOT_INSTANTIATED_SYMBOL"),i0=function(e){function t(t){return e.call(this,'Detecting cyclic dependency. The last identifier is "'.concat(io(t),'".'))||this}return iq(t,e),e7(t,"CircularDependencyError"),t}(ia),i1=function(e){function t(){return e.call(this,"Injector cannot be accessed after it was disposed.")||this}return iq(t,e),e7(t,"InjectorAlreadyDisposedError"),t}(ia),i2=function(e){function t(t){return e.call(this,'Async item "'.concat(io(t),'" returns another async item.'))||this}return iq(t,e),e7(t,"AsyncItemReturnAsyncItemError"),t}(ia),i5=function(e){function t(t){return e.call(this,'Cannot get async item "'.concat(io(t),'" from sync api.'))||this}return iq(t,e),e7(t,"GetAsyncItemFromSyncApiError"),t}(ia),i3=function(e){function t(t){return e.call(this,'Cannot add dependency "'.concat(io(t),'" after it is already resolved.'))||this}return iq(t,e),e7(t,"AddDependencyAfterResolutionError"),t}(ia),i6=function(e){function t(t){return e.call(this,'Cannot dependency dependency "'.concat(io(t),'" after it is already resolved.'))||this}return iq(t,e),e7(t,"DeleteDependencyAfterResolutionError"),t}(ia),i4=function(){function e(e,t){void 0===t&&(t=null),this.parent=t,this.children=[],this.resolutionOngoing=0,this.disposed=!1,this.dependencyCollection=new ij(e||[]),this.resolvedDependencyCollection=new iB,t&&t.children.push(this)}return e7(e,"Injector"),e.prototype.createChild=function(t){return this._ensureInjectorNotDisposed(),new e(t,this)},e.prototype.dispose=function(){this.children.forEach(function(e){return e.dispose()}),this.children.length=0,this.dependencyCollection.dispose(),this.resolvedDependencyCollection.dispose(),this.deleteSelfFromParent(),this.disposed=!0},e.prototype.deleteSelfFromParent=function(){if(this.parent){var e=this.parent.children.indexOf(this);e>-1&&this.parent.children.splice(e,1)}},e.prototype.add=function(e){this._ensureInjectorNotDisposed();var t=e[0],r=e[1];if(this.resolvedDependencyCollection.has(t))throw new i3(t);typeof r>"u"?this.dependencyCollection.add(t):it(r)||n9(r)||n7(r)||n8(r)?this.dependencyCollection.add(t,r):this.resolvedDependencyCollection.add(t,r)},e.prototype.replace=function(e){this._ensureInjectorNotDisposed();var t=e[0];if(this.resolvedDependencyCollection.has(t))throw new i3(t);this.dependencyCollection.delete(t),1===e.length?this.dependencyCollection.add(t):this.dependencyCollection.add(t,e[1])},e.prototype.delete=function(e){if(this._ensureInjectorNotDisposed(),this.resolvedDependencyCollection.has(e))throw new i6(e);this.dependencyCollection.delete(e)},e.prototype.invoke=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._ensureInjectorNotDisposed();var i={get:/* @__PURE__ */e7(function(e,r,n){return t._get(e,r,n)},"get"),has:/* @__PURE__ */e7(function(e){return t.has(e)},"has")};return e.apply(void 0,iQ([i],r,!1))},e.prototype.has=function(e){var t;return this.dependencyCollection.has(e)||(null===(t=this.parent)||void 0===t?void 0:t.has(e))||!1},e.prototype.get=function(e,t,r){this._ensureInjectorNotDisposed();var n=this._get(e,t,r);if(Array.isArray(n)&&n.some(function(e){return ii(e)})||ii(n))throw new i5(e);return n},e.prototype._get=function(e,t,r,n){var i=uC.REQUIRED;if(t===uC.REQUIRED||t===uC.OPTIONAL||t===uC.MANY?i=t:r=t,!n){var o=this.getValue(e,i,r);if(o!==iZ)return o}return this.createDependency(e,i,r,!n)},e.prototype.getAsync=function(e){this._ensureInjectorNotDisposed();var t=this.getValue(e,uC.REQUIRED);if(t!==iZ)return Promise.resolve(t);var r=this.createDependency(e,uC.REQUIRED);return ii(r)?r.whenReady():Promise.resolve(r)},e.prototype.createInstance=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._ensureInjectorNotDisposed(),this._resolveClassImpl.apply(this,iQ([{useClass:e}],t,!1))},e.prototype._resolveDependency=function(e,t,r){var n;void 0===r&&(r=!0),iM(e);try{n=n7(t)?this._resolveValueDependency(e,t):n8(t)?this._resolveFactory(e,t,r):n9(t)?this._resolveClass(e,t,r):ie(t)?this._resolveExisting(e,t):this._resolveAsync(e,t),iU()}catch(e){throw iU(),e}return n},e.prototype._resolveExisting=function(e,t){var r=this.get(t.useExisting);return this.resolvedDependencyCollection.add(e,r),r},e.prototype._resolveValueDependency=function(e,t){var r=t.useValue;return this.resolvedDependencyCollection.add(e,r),r},e.prototype._resolveClass=function(e,t,r){var n,i=this;if(void 0===r&&(r=!0),t.lazy){var o=new iX(function(){return i._ensureInjectorNotDisposed(),i._resolveClassImpl(t)});n=new Proxy(/* @__PURE__ */Object.create(null),{get:/* @__PURE__ */e7(function(e,t){if(t in e)return e[t];if("whenReady"!==t){var r=o.getValue(),n=r[t];return"function"!=typeof n||(n=n.bind(r),e[t]=n),n}},"get"),set:/* @__PURE__ */e7(function(e,t,r){return o.getValue()[t]=r,!0},"set")})}else n=this._resolveClassImpl(t);return e&&r&&this.resolvedDependencyCollection.add(e,n),n},e.prototype._resolveClassImpl=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=e.useClass;this.markNewResolution(i);for(var o=ip(i).sort(function(e,t){return e.paramIndex-t.paramIndex}).map(function(e){return iJ(iJ({},e),{identifier:iA(e.identifier)})}),s=[],a=0;a<o.length;a++){var l=o[a];try{var u=this._get(l.identifier,l.quantity,l.lookUp,l.withNew);s.push(u)}catch(e){throw e instanceof iF?new ik(i,l.identifier,l.paramIndex):e}}var c=iQ([],r,!0),h=o.length>0?o[0].paramIndex:c.length;if(c.length!==h){console.warn("[redi]: Expect ".concat(h," custom parameter(s) of ").concat(io(i)," but get ").concat(c.length,"."));var d=h-c.length;c=d>0?iQ(iQ([],c,!0),Array(d).fill(void 0),!0):c.slice(0,h)}var p=new(i.bind.apply(i,iQ(iQ([void 0],c,!1),s,!1)));return null===(t=null==e?void 0:e.onInstantiation)||void 0===t||t.call(e,p),this.markResolutionCompleted(),p},e.prototype._resolveFactory=function(e,t,r){this.markNewResolution(e);for(var n,i=iK(t.deps),o=[],s=0;s<i.length;s++){var a=i[s];try{var l=this._get(a.identifier,a.quantity,a.lookUp,a.withNew);o.push(l)}catch(t){throw t instanceof iF?new ik(e,a.identifier,a.paramIndex):t}}var u=t.useFactory.apply(null,o);return r&&this.resolvedDependencyCollection.add(e,u),this.markResolutionCompleted(),null===(n=null==t?void 0:t.onInstantiation)||void 0===n||n.call(t,u),u},e.prototype._resolveAsync=function(e,t){var r=this;return{__symbol:ir,whenReady:/* @__PURE__ */e7(function(){return r._resolveAsyncImpl(e,t)},"whenReady")}},e.prototype._resolveAsyncImpl=function(e,t){var r=this;return t.useAsync().then(function(n){var i,o=r.getValue(e);if(o!==iZ)return o;if(Array.isArray(n)){var s=n[1];if(it(s))throw new i2(e);i=r._resolveDependency(e,s)}else i=n4(n)?r._resolveClassImpl({useClass:n,onInstantiation:t.onInstantiation}):n;return r.resolvedDependencyCollection.add(e,i),i})},e.prototype.getValue=function(e,t,r){var n=this;void 0===t&&(t=uC.REQUIRED);var i=/* @__PURE__ */e7(function(){return n.dependencyCollection.has(e)&&!n.resolvedDependencyCollection.has(e)?iZ:n.resolvedDependencyCollection.get(e,t)},"onSelf"),o=/* @__PURE__ */e7(function(){return n.parent?n.parent.getValue(e,t):iZ},"onParent");return r===uS.SKIP_SELF?o():r===uS.SELF||this.resolvedDependencyCollection.has(e)||this.dependencyCollection.has(e)?i():o()},e.prototype.createDependency=function(t,r,n,i){var o=this;void 0===r&&(r=uC.REQUIRED),void 0===i&&(i=!0);var s=/* @__PURE__ */e7(function(){var e=o.dependencyCollection.get(t,r),n=null;return Array.isArray(e)?n=e.map(function(e){return o._resolveDependency(t,e,i)}):e&&(n=o._resolveDependency(t,e,i)),n},"onSelf"),a=/* @__PURE__ */e7(function(){if(o.parent)return o.parent.createDependency(t,r,void 0,i);if(r===uC.OPTIONAL)return null;throw iM(t),new iF(t)},"onParent");return n===uS.SKIP_SELF?a():t===e?this:this.dependencyCollection.has(t)?s():a()},e.prototype.markNewResolution=function(e){if(this.resolutionOngoing+=1,this.resolutionOngoing>=300)throw new i0(e)},e.prototype.markResolutionCompleted=function(){this.resolutionOngoing-=1},e.prototype._ensureInjectorNotDisposed=function(){if(this.disposed)throw new i1},e}();e7(function(e,t,r){void 0===r&&(r=0),iK(t,r).forEach(function(t){im(e,t.identifier,t.paramIndex,t.quantity,t.lookUp)})},"setDependencies");var i9="u">typeof globalThis&&globalThis||"u">typeof window&&window||"u">typeof e&&e,i8="REDI_GLOBAL_LOCK",i7="u">typeof e4&&null!=e4.versions&&null!=e4.versions.node;i9[i8]?i7||console.error(`[redi]: You are loading scripts of redi more than once! This may cause undesired behavior in your application.
Maybe your dependencies added redi as its dependency and bundled redi to its dist files. Or you import different versions of redi.
For more info please visit our website: https://redi.wendell.fun/en-US/docs/debug#import-scripts-of-redi-more-than-once`):i9[i8]=!0;var oe="REDI_CONTEXT_LOCK",ot="u">typeof e4&&null!=e4.versions&&null!=e4.versions.node,or="u">typeof globalThis&&globalThis||"u">typeof window&&window||"u">typeof e&&e;or[oe]?ot||console.error('[redi]: "RediContext" is already created. You may import "RediContext" from different paths. Use "import { RediContext } from \'@wendellhu/redi/react-bindings\'; instead."'):or[oe]=!0;var on=e6.createContext({injector:null});on.displayName="RediContext";var oi=on.Provider,oo=on.Consumer,os=(ub=/* @__PURE__ */e7(function(e,t){return(ub=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ub(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),oa=function(e){function t(){return e.call(this,"Using dependency injection outside of a RediContext.")||this}return os(t,e),e7(t,"HooksNotInRediContextError"),t}(ia);function ol(){var e=e6.useContext(on);if(!e.injector)throw new oa;return e.injector}function ou(e,t,r){var n=ol();return e6.useMemo(function(){return n.get(e,t,r)},[e,t,r])}e7(ol,"useInjector"),e7(ou,"useDependency");var oc=/* @__PURE__ */e7(function(){return(oc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},"__assign");function oh(e){var t=e.children,r=e.dependencies,n=e6.useRef(null);return e6.useEffect(function(){return function(){var e;return null===(e=n.current)||void 0===e?void 0:e.dispose()}},[]),e6.createElement(oo,null,function(e){var i;return n.current?i=n.current:(i=e.injector?e.injector.createChild(r):new i4(r),n.current=i),e6.createElement(oi,{value:{injector:i}},t)})}function od(e,t){return /* @__PURE__ */e7(function(r){return e6.createElement(oi,{value:{injector:t}},e6.createElement(e,oc({},r)))},"ComponentWithInjector")}e7(oh,"RediInjector"),e7(od,"connectInjector"),e7(function(e,t){return /* @__PURE__ */e7(function(r){return e6.createElement(oh,{dependencies:t},e6.createElement(e,oc({},r)))},"ComponentWithInjector")},"connectDependencies");var op=(uR=/* @__PURE__ */e7(function(e,t){return(uR=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},"extendStatics"),function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}uR(e,t),e7(r,"__"),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),of=function(e){function t(t){return e.call(this,'You should make "RediContext" as '.concat(t.constructor.name,"'s default context type. ")+"If you want to use multiple context, please check this on React doc site. https://reactjs.org/docs/context.html#classcontexttype")||this}return op(t,e),e7(t,"ClassComponentNotInRediContextError"),t}(ia);e7(function(e,t,r){return function(){return{get:/* @__PURE__ */e7(function(){var n=this.context;if(!n||!n.injector)throw new of(this);return n.injector.get(e,t||uC.REQUIRED,r)},"get")}}},"WithDependency");var og=/* @__PURE__ */e7(function(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},"__spreadArray$1");function om(e,t){var r=e instanceof eY.BehaviorSubject&&typeof t>"u"?e.getValue():t,n=(0,e6.useState)(r),i=n[0],o=n[1];return(0,e6.useEffect)(function(){var t=e.subscribe(function(e){return o(e)});return function(){return t.unsubscribe()}},[e]),i}function o_(e){return"function"==typeof e?e():e}function oy(e,t,r,n){if("function"==typeof e&&!n)throw new ia("Expected deps to be provided when observable is a function!");var i,o=(0,e6.useRef)(null),s=(0,e6.useRef)(!1),a=(0,e6.useMemo)(function(){return e},og([],"u">typeof n?n:[e],!0)),l=(0,e6.useState)(0);l[0];var u=l[1],c=(0,e6.useRef)((a&&o_(a).subscribe(function(e){s.current=!0,i=e}).unsubscribe(),null!=i?i:t));if((0,e6.useEffect)(function(){var e=null;return a&&(o.current=o_(a),e=o.current.subscribe(function(e){c.current=e,u(function(e){return e+1})})),function(){return null==e?void 0:e.unsubscribe()}},[a]),r&&!s.current)throw Error("Expect `shouldHaveSyncValue` but not getting a sync value!");return c.current}e7(om,"useDependencyValue"),e7(o_,"unwrap"),e7(oy,"useObservable"),e7(function(e){var t=(0,e6.useState)(0)[1];(0,e6.useEffect)(function(){var r=e.subscribe(function(){return t(function(e){return e+1})});return function(){return r.unsubscribe()}},[])},"useUpdateBinder");var oE=/* @__PURE__ */new WeakMap;function ov(e,t){t.forEach(t=>e.add(t))}function ob(e,t){t.forEach(([t])=>{e.has(t)&&e.get(t)})}e7(function(e,t){var r=(0,e6.useRef)(void 0),n=om(e,t),i=(0,e6.useMemo)(function(){return(0,e6.createContext)(n)},[e]),o=(0,e6.useCallback)(function(e){return(e6&&e6.__esModule?e6.default:e6).createElement(i.Provider,{value:n},e.children)},[e,n]);return r.current!==e&&(r.current&&oE.delete(r.current),r.current=e,oE.set(e,i)),{Provider:o,value:n}},"useDependencyContext"),e7(function(e){var t=oE.get(e);if(!t)throw new ia("try to read context value but no ancestor component subscribed it.");return(0,e6.useContext)(t)},"useDependencyContextValue"),e7(ov,"registerDependencies"),e7(ob,"touchDependencies"),e7(function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;let i=Object.prototype.hasOwnProperty.bind(t);for(let n=0;n<r.length;n++){let o=r[n];if(!i(o)||e[o]!==t[o])return!1}return!0},"shallowEqual");let oR=class extends Error{constructor(e){super(e),this.name="CustomCommandExecutionError"}};e7(oR,"CustomCommandExecutionError");let oT=oR;e7(function(e,t=16){let r=0,n=null;return /* @__PURE__ */e7(function(...i){let o=Date.now();o-r<t?(n&&clearTimeout(n),n=setTimeout(()=>{r=o,e.apply(this,i)},t)):(r=o,e.apply(this,i))},"throttled")},"throttle");var oI=((o=oI||{})[o.Style=1]="Style",o[o.Value=2]="Value",o);function oC(e){return`sheet_interceptor_${e}`}e7(oC,"createInterceptorKey");let oS=/* @__PURE__ */e7(e=>function(t,r){let n=-1,i=t;for(let t=0;t<=e.length;t++){if(t<=n)throw Error("[SheetInterceptorService]: next() called multiple times!");if(n=t,t===e.length)break;let o=e[t],s=!1;if(i=o.handler(i,r,e=>(s=!0,e)),!s)break}return i},"composeInterceptors"),ox=class{constructor(e){te(this,"_interceptorsByName",/* @__PURE__ */new Map),te(this,"_interceptorPoints"),this._interceptorPoints=e}fetchThroughInterceptors(e){return oS(this._interceptorsByName.get(e)||[])}intercept(e,t){this._interceptorsByName.has(e)||this._interceptorsByName.set(e,[]);let r=this._interceptorsByName.get(e);return r.push(t),this._interceptorsByName.set(e,r.sort((e,t)=>{var r,n;return(null!=(r=t.priority)?r:0)-(null!=(n=e.priority)?n:0)})),()=>nY(this._interceptorsByName.get(e),t)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}};e7(ox,"InterceptorManager");let oO=ox,oA=class{constructor(){te(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(e){this.cursor+=e}moveCursorTo(e){this.cursor=e}};e7(oA,"MemoryCursor");let ow=oA;function oN(e){return/^-?\d+(\.\d+)?$/.test(e)}function oD(e){return!!oN(e)&&Number(e)<=Number.MAX_SAFE_INTEGER}e7(function(e,t){for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},"mixinClass"),e7(oN,"isNumeric"),e7(oD,"isSafeNumeric");let oL=class e{constructor(){te(this,"_data",[])}static create(){return new e}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){let t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}};e7(oL,"Registry");let oM=oL;function oU(e){let t=new MessageChannel,r=!1,n=/* @__PURE__ */e7(()=>{r||e()},"hanlder");return t.port1.onmessage=n,t.port2.postMessage(null),()=>{r=!0,t.port1.close(),t.port2.close()}}async function oP(e){for(let[t,r]of e.entries())try{if(!await r())return{index:t,result:!1}}catch(e){return{index:t,result:!1,error:e}}return{result:!0,index:-1}}function ok(e){for(let[t,r]of e.entries())try{if(!r())return{index:t,result:!1}}catch(e){return{index:t,result:!1,error:e}}return{result:!0,index:-1}}function oF(e,t){return t.forEach(t=>e.add(t)),e}function oj(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:/* @__PURE__ */e7(function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}},"next")};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function oB(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function oH(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function oV(e){return"function"==typeof e}function o$(e){var t=e(/* @__PURE__ */e7(function(e){Error.call(e),e.stack=Error().stack},"_super"));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}e7(class e{constructor(){te(this,"_data",/* @__PURE__ */new Map)}static create(){return new e}add(e,t){this._data.has(e)||this._data.set(e,t)}delete(e){this._data.delete(e)}getData(){return this._data}},"RegistryAsMap"),e7(oU,"requestImmediateMacroTask"),e7(oP,"sequenceAsync"),e7(ok,"sequence"),e7(oF,"mergeSets"),e7(oj,"__values"),e7(oB,"__read"),e7(oH,"__spreadArray"),e7(oV,"isFunction"),e7(o$,"createErrorClass");var oG=o$(function(e){return /* @__PURE__ */e7(function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(e,t){return t+1+") "+e.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t},"UnsubscriptionErrorImpl")});function oW(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}e7(oW,"arrRemove");var oz=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e7(t,"Subscription"),t.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o){if(this._parentage=null,Array.isArray(o))try{for(var s=oj(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this)}var l=this.initialTeardown;if(oV(l))try{l()}catch(e){i=e instanceof oG?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var c=oj(u),h=c.next();!h.done;h=c.next()){var d=h.value;try{oK(d)}catch(e){i=null!=i?i:[],e instanceof oG?i=oH(oH([],oB(i)),oB(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}if(i)throw new oG(i)}},t.prototype.add=function(e){var r;if(e&&e!==this){if(this.closed)oK(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&oW(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&oW(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function oY(e){return e instanceof oz||e&&"closed"in e&&oV(e.remove)&&oV(e.add)&&oV(e.unsubscribe)}function oK(e){oV(e)?e():e.unsubscribe()}function oX(e){let t=!1;return e?oY(e)?{dispose:/* @__PURE__ */e7(()=>e.unsubscribe(),"dispose")}:"function"==typeof e?{dispose:/* @__PURE__ */e7(()=>{t||(t=!0,e())},"dispose")}:e:oX(()=>{})}oz.EMPTY,e7(oY,"isSubscription"),e7(oK,"execFinalizer"),e7(oX,"toDisposable"),e7(function(e){return oX(()=>{e.unsubscribe()})},"fromObservable");let oq=class{constructor(){te(this,"_disposables",/* @__PURE__ */new Set)}add(e){let t=oX(e);return this._disposables.add(t),{dispose:/* @__PURE__ */e7(()=>{t.dispose(),this._disposables.delete(t)},"dispose")}}dispose(){this._disposables.forEach(e=>{e.dispose()}),this._disposables.clear()}};e7(oq,"DisposableCollection");let oJ=oq,oQ=class{constructor(){te(this,"_disposed",!1),te(this,"_collection",new oJ)}disposeWithMe(e){return this._collection.add(e)}ensureNotDisposed(){if(this._disposed)throw Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}};e7(oQ,"Disposable");let oZ=oQ,o0=class extends oZ{constructor(){super(...arguments),te(this,"dispose$",new e5.Subject)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}};e7(o0,"RxDisposable");let o1=o0;e7(class extends oZ{constructor(e){super(),te(this,"_ref",0),this._rootDisposable=e}inc(){if(this._disposed)throw Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,0===this._ref&&(this._rootDisposable.dispose(),this.dispose())}},"RCDisposable");let o2=iy("univer.context-service"),o5=class extends oZ{constructor(){super(...arguments),te(this,"_contextChanged$",new e5.Subject),te(this,"contextChanged$",this._contextChanged$.asObservable()),te(this,"_contextMap",/* @__PURE__ */new Map)}dispose(){super.dispose(),this._contextChanged$.complete()}getContextValue(e){var t;return null!=(t=this._contextMap.get(e))&&t}setContextValue(e,t){this._contextMap.set(e,t),this._contextChanged$.next({[e]:t})}subscribeContextValue$(e){return new e0.Observable(t=>{let r=this._contextChanged$.pipe((0,eJ.filter)(t=>"u">typeof t[e])).subscribe(r=>t.next(r[e]));return this._contextMap.has(e)&&t.next(this._contextMap.get(e)),()=>r.unsubscribe()})}};e7(o5,"ContextService");var o3=((s=o3||{})[s.SILENT=0]="SILENT",s[s.ERROR=1]="ERROR",s[s.WARN=2]="WARN",s[s.INFO=3]="INFO",s[s.VERBOSE=4]="VERBOSE",s);let o6=iy("univer.log"),o4=class extends oZ{constructor(){super(...arguments),te(this,"_logLevel",3)}debug(...e){this._logLevel>=4&&this._log(console.debug,...e)}log(...e){this._logLevel>=3&&this._log(console.log,...e)}warn(...e){this._logLevel>=2&&this._log(console.warn,...e)}error(...e){this._logLevel>=1&&this._log(console.error,...e)}setLogLevel(e){this._logLevel=e}_log(e,...t){let r=t[0];/^\[(.*?)\]/g.test(r)?e(`\x1b[97;104m${r}\x1b[0m`,...t.slice(1)):e(...t)}};e7(o4,"DesktopLogService");var o9=Object.defineProperty,o8=Object.getOwnPropertyDescriptor,o7=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?o8(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&o9(t,r,o),o},"__decorateClass$7"),se=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$7"),st=((a=st||{})[a.COMMAND=0]="COMMAND",a[a.OPERATION=1]="OPERATION",a[a.MUTATION=2]="MUTATION",a);let sr=iy("anywhere.command-service"),sn=class{constructor(){te(this,"_commands",/* @__PURE__ */new Map),te(this,"_commandTypes",/* @__PURE__ */new Map)}registerCommand(e){if(this._commands.has(e.id))throw Error(`[CommandRegistry]: command "${e.id}" has been registered before.`);return this._commands.set(e.id,e),this._commandTypes.set(e.id,e.type),oX(()=>{this._commands.delete(e.id),this._commandTypes.delete(e.id)})}hasCommand(e){return this._commands.has(e)}getCommand(e){return this._commands.has(e)?[this._commands.get(e)]:null}getCommandType(e){return this._commandTypes.get(e)}};e7(sn,"CommandRegistry");let si={id:"nil",type:0,handler:/* @__PURE__ */e7(()=>!0,"handler")},so=(e7(uO=class extends oZ{constructor(e,t){super(),te(this,"_commandRegistry"),te(this,"_beforeCommandExecutionListeners",[]),te(this,"_commandExecutedListeners",[]),te(this,"_multiCommandDisposables",/* @__PURE__ */new Map),te(this,"_commandExecutingLevel",0),te(this,"_commandExecutionStack",[]),this._injector=e,this._logService=t,this._commandRegistry=new sn,this._registerCommand(si)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0}hasCommand(e){return this._commandRegistry.hasCommand(e)}registerCommand(e){return this._registerCommand(e)}registerMultipleCommand(e){return this._registerMultiCommand(e)}beforeCommandExecuted(e){if(-1===this._beforeCommandExecutionListeners.indexOf(e))return this._beforeCommandExecutionListeners.push(e),oX(()=>{let t=this._beforeCommandExecutionListeners.indexOf(e);this._beforeCommandExecutionListeners.splice(t,1)});throw Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(e){if(-1===this._commandExecutedListeners.indexOf(e))return this._commandExecutedListeners.push(e),oX(()=>{let t=this._commandExecutedListeners.indexOf(e);this._commandExecutedListeners.splice(t,1)});throw Error("[CommandService]: could not add a listener twice.")}async executeCommand(e,t,r){try{let n=this._commandRegistry.getCommand(e);if(n){let[e]=n,i={id:e.id,type:e.type,params:t},o=this._pushCommandExecutionStack(i);this._beforeCommandExecutionListeners.forEach(e=>e(i,r));let s=await this._execute(e,t,r);return this._commandExecutedListeners.forEach(e=>e(i,r)),o.dispose(),s}throw Error(`[CommandService]: command "${e}" is not registered.`)}catch(e){if(this._logService.error(e),e instanceof oT)return!1;throw e}}syncExecuteCommand(e,t,r){var n;try{let i=this._commandRegistry.getCommand(e);if(i){let[e]=i,o={id:e.id,type:e.type,params:t};if(2===e.type){let e=nK(this._commandExecutionStack,e=>0===e.type);e&&(o.params=null!=(n=o.params)?n:{},o.params.trigger=e.id)}let s=this._pushCommandExecutionStack(o);this._beforeCommandExecutionListeners.forEach(e=>e(o,r));let a=this._syncExecute(e,t,r);return this._commandExecutedListeners.forEach(e=>e(o,r)),s.dispose(),a}throw Error(`[CommandService]: command "${e}" is not registered.`)}catch(e){if(e instanceof oT)return!1;throw this._logService.error(e),e}}_pushCommandExecutionStack(e){return this._commandExecutionStack.push(e),oX(()=>nY(this._commandExecutionStack,e))}_registerCommand(e){return this._commandRegistry.registerCommand(e)}_registerMultiCommand(e){let t;let r=this._commandRegistry.getCommand(e.id);if(r){if(!0!==r[0].multi)throw Error("Command has registered as a single command.");t=r[0]}else{let r=new oJ;t=new sa(e.id),r.add(this._commandRegistry.registerCommand(t)),r.add(oX(()=>{this._multiCommandDisposables.delete(e.id)})),this._multiCommandDisposables.set(e.id,r)}let n=t.registerImplementation(e);return oX(()=>{var r;n.dispose(),t.hasImplementations()||null==(r=this._multiCommandDisposables.get(e.id))||r.dispose()})}async _execute(e,t,r){let n;this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${e.id}"`),this._commandExecutingLevel++;try{n=await this._injector.invoke(e.handler,t,r),this._commandExecutingLevel--}catch(e){throw n=!1,this._commandExecutingLevel=0,e}return n}_syncExecute(e,t,r){let n;this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${e.id}".`),this._commandExecutingLevel++;try{if((n=this._injector.invoke(e.handler,t,r))instanceof Promise)throw TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(e){throw n=!1,this._commandExecutingLevel=0,e}return n}},"CommandService"),uO);so=o7([se(0,ix(i4)),se(1,o6)],so);let ss=class{constructor(e){te(this,"name"),te(this,"multi",!0),te(this,"type",0),te(this,"priority",0),te(this,"_implementations",[]),te(this,"handler",/* @__PURE__ */e7(async(e,t)=>{if(!this._implementations.length)return!1;let r=e.get(o6),n=e.get(o2),i=e.get(i4);for(let e of this._implementations){let o=e.command.preconditions;if((!o||o&&o(n))&&(r.debug("[MultiCommand]",`executing implementation "${e.command.name}".`),await i.invoke(e.command.handler,t)))return!0}return!1},"handler")),this.id=e,this.name=e}registerImplementation(e){let t={command:e};return this._implementations.push(t),this._implementations.sort((e,t)=>t.command.priority-e.command.priority),oX(()=>{let e=this._implementations.indexOf(t);this._implementations.splice(e,1)})}hasImplementations(){return this._implementations.length>0}};e7(ss,"MultiCommand");let sa=ss;function sl(e,t,r){return ok(e.map(e=>()=>t.syncExecuteCommand(e.id,e.params,r)))}function su(e,t,r){return oP(e.map(e=>()=>t.executeCommand(e.id,e.params,r)))}function sc(e){return new e0.Observable(t=>{let r=e((...e)=>t.next(e));return()=>null==r?void 0:r.dispose()})}function sh(e){return /* @__PURE__ */e7(function(t){return new e0.Observable(r=>(t.subscribe({next:/* @__PURE__ */e7(t=>{r.next(t),e(t)&&r.complete()},"next"),complete:/* @__PURE__ */e7(()=>r.complete(),"complete"),error:/* @__PURE__ */e7(e=>r.error(e),"error")}),()=>r.unsubscribe()))},"complateAfter")}function sd(e=0){return t=>{let r=[];return t.pipe((0,e3.tap)(e=>r.push(e)),(0,eX.debounceTime)(e),(0,eQ.map)(()=>r),(0,e3.tap)(()=>r=[]))}}function sp(e,t){let r=0,n=e.length-1;for(;r<=n;){let i=Math.floor((n+r)/2);if(t<e[i]&&(0===i||t>=e[i-1]))return i;if(t>=e[i])r=i+1;else if(t<e[i])n=i-1;else break}return -1}function sf(e,t){let r=0,n=0,i=-1,o=e.length-1;for(;r<e.length&&o>=0&&o>=r;){if(n=e[o],t>=(0===o?0:e[o-1])&&t<=n){i=o;break}if(n=e[r],t>=(0===r?0:e[r-1])&&t<n){i=r;break}r++,o--}return i}function sg(e,t){let r=e.length-1;return t<0?-1:t<e[0]?0:t>e[e.length-1]?Number.POSITIVE_INFINITY:r=e.length<40||t<=e[20]||t>=e[r-20]?sf(e,t):sp(e,t)}e7(sl,"sequenceExecute"),e7(su,"sequenceExecuteAsync"),e7(sc,"fromCallback"),e7(sh,"takeAfter"),e7(sd,"bufferDebounceTime"),e7(sp,"binarySearchArray"),e7(sf,"orderSearchArray"),e7(sg,"searchArray"),e7(function(e){let t=new Blob([e],{type:"text/javascript"});return window.URL.createObjectURL(t)},"codeToBlob");let sm=2;function s_(e,t){if(null==t||null==e)return!0;let{left:r=0,top:n=0,height:i=0,width:o=0,angle:s=0}=t,{left:a=0,top:l=0,height:u=0,width:c=0,angle:h=0}=e;return Math.abs(a-r)>sm||Math.abs(l-n)>sm||Math.abs(c-o)>sm||Math.abs(u-i)>sm||Math.abs(h-s)>1}e7(s_,"checkIfMove");var sy=((l=sy||{})[l.DEFAULT_SERIES=0]="DEFAULT_SERIES",l[l.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",l),sE=((u=sE||{})[u.NONE=0]="NONE",u[u.THIN=1]="THIN",u[u.HAIR=2]="HAIR",u[u.DOTTED=3]="DOTTED",u[u.DASHED=4]="DASHED",u[u.DASH_DOT=5]="DASH_DOT",u[u.DASH_DOT_DOT=6]="DASH_DOT_DOT",u[u.DOUBLE=7]="DOUBLE",u[u.MEDIUM=8]="MEDIUM",u[u.MEDIUM_DASHED=9]="MEDIUM_DASHED",u[u.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",u[u.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",u[u.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",u[u.THICK=13]="THICK",u),sv=((c=sv||{}).TOP="top",c.BOTTOM="bottom",c.LEFT="left",c.RIGHT="right",c.NONE="none",c.ALL="all",c.OUTSIDE="outside",c.INSIDE="inside",c.HORIZONTAL="horizontal",c.VERTICAL="vertical",c.TLBR="tlbr",c.TLBC_TLMR="tlbc_tlmr",c.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",c.BLTR="bl_tr",c.MLTR_BCTR="mltr_bctr",c),sb=((h=sb||{})[h.UNSUPPORTED=0]="UNSUPPORTED",h[h.RGB=1]="RGB",h[h.HEX=2]="HEX",h[h.THEME=3]="THEME",h),sR=((d=sR||{})[d.ON=0]="ON",d[d.OFF=1]="OFF",d),sT=((p=sT||{})[p.PASTE_NORMAL=0]="PASTE_NORMAL",p[p.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",p[p.PASTE_FORMAT=2]="PASTE_FORMAT",p[p.PASTE_FORMULA=3]="PASTE_FORMULA",p[p.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",p[p.PASTE_VALUES=5]="PASTE_VALUES",p[p.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",p[p.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",p),sI=((f=sI||{})[f.LEFT=0]="LEFT",f[f.RIGHT=1]="RIGHT",f),sC=((g=sC||{})[g.DOCUMENT=0]="DOCUMENT",g[g.PROJECT=1]="PROJECT",g),sS=((m=sS||{})[m.COLUMNS=0]="COLUMNS",m[m.ROWS=1]="ROWS",m),sx=((_=sx||{})[_.UP=0]="UP",_[_.RIGHT=1]="RIGHT",_[_.DOWN=2]="DOWN",_[_.LEFT=3]="LEFT",_);function sO(e){switch(e){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}e7(sO,"getReverseDirection");var sA=((y=sA||{})[y.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",y[y.TEXT=1]="TEXT",y[y.NUMBER=2]="NUMBER",y[y.PERCENT=3]="PERCENT",y[y.CURRENCY=4]="CURRENCY",y[y.DATE=5]="DATE",y[y.TIME=6]="TIME",y[y.DATE_TIME=7]="DATE_TIME",y[y.SCIENTIFIC=8]="SCIENTIFIC",y),sw=((E=sw||{})[E.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",E[E.MIN=1]="MIN",E[E.MAX=2]="MAX",E[E.NUMBER=3]="NUMBER",E[E.PERCENT=4]="PERCENT",E[E.PERCENTILE=5]="PERCENTILE",E),sN=((v=sN||{}).EN_US="enUS",v.ZH_CN="zhCN",v.RU_RU="ruRU",v.ZH_TW="zhTW",v.VI_VN="viVN",v.FA_IR="faIR",v),sD=((b=sD||{})[b.RANGE=0]="RANGE",b[b.SHEET=1]="SHEET",b),sL=((R=sL||{}).Line="line",R.LineInv="lineInv",R.Triangle="triangle",R.RtTriangle="rtTriangle",R.Rect="rect",R.Diamond="diamond",R.Parallelogram="parallelogram",R.Trapezoid="trapezoid",R.NonIsocelesTrapezoid="nonIsocelesTrapezoid",R.Pentagon="pentagon",R.Hexagon="hexagon",R.Heptagon="heptagon",R.Octagon="octagon",R.Decagon="decagon",R.Dodecagon="dodecagon",R.Star4="star4",R.Star5="star5",R.Star6="star6",R.Star7="star7",R.Star8="star8",R.Star10="star10",R.Star12="star12",R.Star16="star16",R.Star24="star24",R.Star32="star32",R.RoundRect="roundRect",R.Round1Rect="round1Rect",R.Round2SameRect="round2SameRect",R.Round2DiagRect="round2DiagRect",R.Ellipse="ellipse",R),sM=((T=sM||{}).RightArrow="rightArrow",T.LeftArrow="leftArrow",T.UpArrow="upArrow",T.DownArrow="downArrow",T.LeftRightArrow="leftRightArrow",T.UpDownArrow="upDownArrow",T.QuadArrow="quadArrow",T.LeftRightUpArrow="leftRightUpArrow",T.BentArrow="bentArrow",T.UturnArrow="uturnArrow",T.CircularArrow="circularArrow",T.NotchedRightArrow="notchedRightArrow",T.HomePlate="homePlate",T.Chevron="chevron",T.LeftCircularArrow="leftCircularArrow",T.LeftRightCircularArrow="leftRightCircularArrow",T),sU=((I=sU||{}).Plaque="plaque",I.Can="can",I.Cube="cube",I.Bevel="bevel",I.Donut="donut",I.NoSmoking="noSmoking",I.BlockArc="blockArc",I.FoldedCorner="foldedCorner",I),sP=((C=sP||{}).SmileyFace="smileyFace",C.Heart="heart",C.LightningBolt="lightningBolt",C.Sun="sun",C.Moon="moon",C.Cloud="cloud",C.Arc="arc",C.Backpack="backpack",C.Frame="frame",C.HalfFrame="halfFrame",C.Corner="corner",C.Chord="chord",C.Pie="pie",C.Teardrop="teardrop",C.WedgeRectCallout="wedgeRectCallout",C.WedgeRRectCallout="wedgeRRectCallout",C.WedgeEllipseCallout="wedgeEllipseCallout",C.CloudCallout="cloudCallout",C.BorderCallout1="borderCallout1",C.BorderCallout2="borderCallout2",C.BorderCallout3="borderCallout3",C.AccentCallout1="accentCallout1",C.AccentCallout2="accentCallout2",C.AccentCallout3="accentCallout3",C.Callout1="callout1",C.Callout2="callout2",C.Callout3="callout3",C.ActionButtonBackPrevious="actionButtonBackPrevious",C.ActionButtonEnd="actionButtonEnd",C.ActionButtonForwardNext="actionButtonForwardNext",C.ActionButtonHelp="actionButtonHelp",C.ActionButtonHome="actionButtonHome",C.ActionButtonInformation="actionButtonInformation",C.ActionButtonMovie="actionButtonMovie",C.ActionButtonReturn="actionButtonReturn",C.ActionButtonSound="actionButtonSound",C),sk=((S=sk||{})[S.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",S[S.PAST_YEAR=1]="PAST_YEAR",S[S.PAST_MONTH=2]="PAST_MONTH",S[S.PAST_WEEK=3]="PAST_WEEK",S[S.YESTERDAY=4]="YESTERDAY",S[S.TODAY=5]="TODAY",S[S.TOMORROW=6]="TOMORROW",S),sF=((x=sF||{})[x.GRID=0]="GRID",x[x.KANBAN=1]="KANBAN",x[x.GANTT=2]="GANTT",x),sj=((O=sj||{})[O.UNSPECIFIED=0]="UNSPECIFIED",O[O.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",O[O.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",O),sB=((A=sB||{})[A.DASH=0]="DASH",A[A.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",A[A.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",A[A.DASHED_HEAVY=3]="DASHED_HEAVY",A[A.DASH_LONG=4]="DASH_LONG",A[A.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",A[A.DOT_DASH=6]="DOT_DASH",A[A.DOT_DOT_DASH=7]="DOT_DOT_DASH",A[A.DOTTED=8]="DOTTED",A[A.DOTTED_HEAVY=9]="DOTTED_HEAVY",A[A.DOUBLE=10]="DOUBLE",A[A.NONE=11]="NONE",A[A.SINGLE=12]="SINGLE",A[A.THICK=13]="THICK",A[A.WAVE=14]="WAVE",A[A.WAVY_DOUBLE=15]="WAVY_DOUBLE",A[A.WAVY_HEAVY=16]="WAVY_HEAVY",A[A.WORDS=17]="WORDS",A),sH=((w=sH||{})[w.UNSPECIFIED=0]="UNSPECIFIED",w[w.LEFT=1]="LEFT",w[w.CENTER=2]="CENTER",w[w.RIGHT=3]="RIGHT",w[w.JUSTIFIED=4]="JUSTIFIED",w[w.BOTH=5]="BOTH",w[w.DISTRIBUTED=6]="DISTRIBUTED",w),sV=((N=sV||{})[N.UNSPECIFIED=0]="UNSPECIFIED",N[N.TOP=1]="TOP",N[N.MIDDLE=2]="MIDDLE",N[N.BOTTOM=3]="BOTTOM",N),s$=((D=s$||{})[D.UNSPECIFIED=0]="UNSPECIFIED",D[D.OVERFLOW=1]="OVERFLOW",D[D.CLIP=2]="CLIP",D[D.WRAP=3]="WRAP",D),sG=((L=sG||{})[L.NORMAL=0]="NORMAL",L[L.ITALIC=1]="ITALIC",L),sW=((M=sW||{})[M.NORMAL=0]="NORMAL",M[M.BOLD=1]="BOLD",M),sz=((U=sz||{})[U.NORMAL=1]="NORMAL",U[U.SUBSCRIPT=2]="SUBSCRIPT",U[U.SUPERSCRIPT=3]="SUPERSCRIPT",U),sY=((P=sY||{})[P.FALSE=0]="FALSE",P[P.TRUE=1]="TRUE",P),sK=((k=sK||{})[k.STRING=1]="STRING",k[k.NUMBER=2]="NUMBER",k[k.BOOLEAN=3]="BOOLEAN",k[k.FORCE_STRING=4]="FORCE_STRING",k),sX=((F=sX||{})[F.DARK1=0]="DARK1",F[F.LIGHT1=1]="LIGHT1",F[F.DARK2=2]="DARK2",F[F.LIGHT2=3]="LIGHT2",F[F.ACCENT1=4]="ACCENT1",F[F.ACCENT2=5]="ACCENT2",F[F.ACCENT3=6]="ACCENT3",F[F.ACCENT4=7]="ACCENT4",F[F.ACCENT5=8]="ACCENT5",F[F.ACCENT6=9]="ACCENT6",F[F.HYPERLINK=10]="HYPERLINK",F[F.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",F),sq=((j=sq||{}).OFFICE="Office",j.OFFICE_2007_2010="Office 2007-2010",j.GRAYSCALE="Grayscale",j.BLUE_WARM="Blue Warm",j.BLUE="Blue",j.BLUE_II="Blue II",j.BLUE_GREEN="Blue Green",j.GREEN="Green",j.GREEN_YELLOW="Green Yellow",j.YELLOW="Yellow",j.YELLOW_ORANGE="Yellow Orange",j.ORANGE="Orange",j.ORANGE_RED="Orange Red",j.RED_ORANGE="Red Orange",j.RED="Red",j.RED_VIOLET="Red Violet",j.VIOLET="Violet",j.VIOLET_II="Violet II",j.MEDIAN="Median",j.PAPER="Paper",j.MARQUEE="Marquee",j.SLIPSTREAM="Slipstream",j.Aspect="Aspect",j);let sJ=/* @__PURE__ */e7(e=>crypto.getRandomValues(new Uint8Array(e)),"random"),sQ=/* @__PURE__ */e7((e,t,r)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*n*t/e.length);return (o=t)=>{let s="";for(;;){let t=r(i),a=i;for(;a--;)if((s+=e[t[a]&n]||"").length===o)return s}}},"customRandom"),sZ=/* @__PURE__ */e7((e,t=21)=>sQ(e,t,sJ),"customAlphabet"),s0=/* @__PURE__ */e7((e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&r[e]];return t},"nanoid"),s1=/* @__PURE__ */new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),s2=RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function s5(e){if(!Number.isNaN(+e))return!1;if(e.startsWith("http://localhost:3002")||e.startsWith("localhost:3002"))return!0;if(s2.test(e)){if(s3(e))return!0;try{let t=new URL(s4(e)).hostname.split(".").pop();if(t&&s1.has(t))return!0}catch{}}return!1}function s3(e){return/^[a-zA-Z]+:\/\//.test(e)}function s6(e){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e)}function s4(e){return s3(e)?e:s6(e)?`mailto://${e}`:`https://${e}`}e7(s5,"isLegalUrl"),e7(s3,"hasProtocol"),e7(s6,"isEmail"),e7(s4,"normalizeUrl");let s9=/^-ms-/,s8=/-([a-z])/g,s7=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function ae(e,t){return ai.getValueType(e)===ai.getValueType(t)&&(ai.isArray(e)?at(e,t):ai.isObject(e)?ar(e,t):ai.isDate(e)?e.getTime()===t.getTime():ai.isRegExp(e)?e.toString()===t.toString():e===t)}function at(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(!ae(e[r],t[r]))return!1;return!0}function ar(e,t){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i of r)if(!n.includes(i)||!ae(e[i],t[i]))return!1;return!0}e7(ae,"isValueEqual"),e7(at,"diffArrays"),e7(ar,"diffObject");let an=class e{static stringAt(e){let t="",r=e;for(;r>=s7.length;)r/=s7.length,r-=1,t+=s7[r%s7.length];let n=e%s7.length;return t+s7[n]}static indexAt(e){let t=0;for(let r=0;r<e.length-1;r+=1){let n=e.charCodeAt(r)-65,i=e.length-1-r;t+=s7.length**i+s7.length*n}return t+(e.charCodeAt(e.length-1)-65)}static deleteBlank(t){return e.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){let e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,r="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(r)return"Mac";if("X11"===navigator.platform&&!t&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){let e=navigator.userAgent,t=e.indexOf("Opera")>-1,r=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,n=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,i=e.indexOf("Edge")>-1,o=e.indexOf("Firefox")>-1,s=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome"),a=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(r){RegExp("MSIE (\\d+\\.\\d+);").test(e);let t=Number.parseFloat(RegExp.$1);return 7===t?"IE7":8===t?"IE8":9===t?"IE9":10===t?"IE10":"0"}return o?"FF":t?"Opera":s?"Safari":a?"Chrome":i?"Edge":n?"IE11":"Unknown browser"}static generateRandomId(e=21,t){return ao(e,t)}static getClassName(e){return e.constructor.name}static deepMerge(t,...r){function n(t,r){t.forEach((t,o)=>{var s,a;if(e.isArray(t)){let e=null!=(s=r[o])?s:[];r[o]=e,n(t,e);return}if(e.isObject(t)){let e=null!=(a=r[o])?a:{};r[o]=e,i(t,e);return}r[o]=t})}function i(t,r){Object.keys(t).forEach(o=>{var s,a;let l=t[o];if(e.isObject(l)){let e=null!=(s=r[o])?s:{};r[o]=e,i(l,e);return}if(e.isArray(l)){let e=null!=(a=r[o])?a:[];r[o]=e,n(l,e);return}r[o]=l})}function o(r){Object.keys(r).forEach(o=>{var s,a;let l=r[o];if(e.isArray(l)){let e=null!=(s=t[o])?s:[];t[o]=e,n(l,e);return}if(e.isObject(l)){let e=null!=(a=t[o])?a:{};t[o]=e,i(l,e);return}t[o]=l})}return r.forEach(e=>e&&o(e)),e7(n,"deepArray"),e7(i,"deepObject"),e7(o,"deepItem"),t}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){return ae(e,t)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){let r=[];return t.forEach((t,n)=>{r[n]=e.deepClone(t)}),r}if(this.isObject(t)){let r={};return Object.keys(t).forEach(n=>{let i=t[n];r[n]=e.deepClone(i)}),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}return t}static getLanguage(){return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||"en-US"}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return null!=e}static isBlank(e){return!this.isDefine(e)||!!this.isString(e)&&""===e.trim()}static isBoolean(e){return"[object Boolean]"===this.getValueType(e)}static isPlainObject(e){return!!this.isDefine(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}static isFunction(e){return"[object Function]"===this.getValueType(e)}static isDate(e){return"[object Date]"===this.getValueType(e)}static isRegExp(e){return"[object RegExp]"===this.getValueType(e)}static isArray(e){return"[object Array]"===this.getValueType(e)}static isString(e){return"[object String]"===this.getValueType(e)}static isNumber(e){return"[object Number]"===this.getValueType(e)}static isStringNumber(e){return!isNaN(Number.parseFloat(e))&&isFinite(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isEmptyObject(e){for(let t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){return"micromessenger"===String(navigator.userAgent.toLowerCase().match(/MicroMessenger/i))}static isAndroid(){let e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(e){return s5(e)}static normalizeUrl(e){return s4(e)}static itCount(e){return t=>{for(let r=0;r<e;r++)t&&t()}}static hasLength(t,r){return!!e.isDefine(t)&&(e.isDefine(r)?t.length===r:t.length>0)}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(s9,"ms-").replace(s8,this.fCamelCase)}static removeNull(t){return this.isObject(t)&&Object.keys(t).forEach(r=>{let n=t[r];null==n?delete t[r]:e.removeNull(n)}),t}static fillTwoDimensionalArray(e,t,r){return Array(e).fill(r).map(e=>Array(t).fill(r))}static numToWord(e){let t="";for(;e>0;){let r=e%26;t=String.fromCharCode(96+(r=0===r?r=26:r))+t,e=(e-r)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(null==e||0===e.length)return Number.NaN;let t=e.toLowerCase().split(""),r=t.length,n=0;for(let e=0;e<r;e++)n+=(t[e].charCodeAt(0)-96)*26**(r-e-1);return 0===n?Number.NaN:n-1}static chatAtABC(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}static randSort(e){for(let t=0,r=e.length;t<r;t++){let n=Number.parseInt((Math.random()*r).toString()),i=e[n];e[n]=e[t],e[t]=i}return e}static commonExtend(e,t){let r={};for(let t in e)r[t]=e[t];for(let e in t)null!=t[e]&&(r[e]=t[e]);return r}static commonExtend1(e,t){for(let r in e)null==t[r]&&(t[r]=e[r]);return t}static arrayToObject(e){let t={};return e.forEach((e,r)=>{t[r]={},e.forEach((e,n)=>{t[r][n]=e})}),t}static hasIntersectionBetweenTwoRanges(e,t,r,n){return t>=r&&n>=e}static isStartValidPosition(e){return/^[A-Za-z_]/.test(e)}static isValidParameter(e){let t=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(e),r=e.length<=255;return!t&&r}static clamp(e,t,r){return Math.max(t,Math.min(r,e))}static now(){return performance&&performance.now?performance.now():Date.now()}};e7(an,"Tools");let ai=an;function ao(e=21,t){return t?sZ(t,e)():s0(e)}function as(...e){let t={},r=e.length;for(let n=r-1;n>=0;n--){let r=e[n];if(r)for(let e of Object.keys(r))void 0===t[e]&&(t[e]=r[e])}return t}function aa(e,t,r){let{dataStream:n,textRuns:i=[]}=e,o=t,s=[];for(let e of i){let{st:i,ed:a}=e;ai.hasIntersectionBetweenTwoRanges(t,r,i,a)&&(i>o?(s.push(n.slice(o,i)),s.push(au(n,{...e,ed:Math.min(a,r)}))):s.push(au(n,{...e,st:o,ed:Math.min(a,r)}))),o=Math.max(t,Math.min(a,r))}return o!==r&&s.push(n.slice(o,r)),s.join("")}function al(e,t=!0){var r;if(!t||null==(r=e.paragraphs)||!r.length)return aa(e,0,e.dataStream.length);{let{dataStream:t,paragraphs:r=[]}=e,n="",i=-1;for(let t of r){let{startIndex:r,paragraphStyle:o={}}=t,{spaceAbove:s,spaceBelow:a,lineSpacing:l}=o,u=[];null!=s&&("number"==typeof s?u.push(`margin-top: ${s}px`):u.push(`margin-top: ${s.v}px`)),null!=a&&("number"==typeof a?u.push(`margin-bottom: ${a}px`):u.push(`margin-bottom: ${a.v}px`)),null!=l&&u.push(`line-height: ${l}`),r>i+1?n+=`<p class="UniverNormal" ${u.length?`style="${u.join("; ")};"`:""}>${aa(e,i+1,r)}</p>`:n+=`<p class="UniverNormal" ${u.length?`style="${u.join("; ")};"`:""}></p>`,i=r}return i!==t.length&&(n+=aa(e,i,t.length)),n}}function au(e,t){let{st:r,ed:n,ts:i={}}=t,{ff:o,fs:s,it:a,bl:l,ul:u,st:c,ol:h,bg:d,cl:p,va:f}=i,g=e.slice(r,n),m=[];return a===sY.TRUE&&(g=`<i>${g}</i>`),f===sz.SUPERSCRIPT?g=`<sup>${g}</sup>`:f===sz.SUBSCRIPT&&(g=`<sub>${g}</sub>`),(null==u?void 0:u.s)===sY.TRUE&&(g=`<u>${g}</u>`),(null==c?void 0:c.s)===sY.TRUE&&(g=`<s>${g}</s>`),l===sY.TRUE&&(g=`<strong>${g}</strong>`),o&&m.push(`font-family: ${o}`),p&&m.push(`color: ${p.rgb}`),s&&m.push(`font-size: ${s}pt`),h&&m.push("text-decoration: overline"),d&&m.push(`background: ${d.rgb}`),m.length?`<span style="${m.join("; ")};">${g}</span>`:g}e7(ao,"generateRandomId"),e7(as,"composeStyles"),e7(aa,"getBodySliceHtml"),e7(al,"convertBodyToHtml"),e7(au,"covertTextRunToHtml");let ac={[sq.OFFICE]:{[sX.ACCENT1]:"#4472C4",[sX.ACCENT2]:"#ED7D31",[sX.ACCENT3]:"#A5A5A5",[sX.ACCENT4]:"#70AD47",[sX.ACCENT5]:"#5B9BD5",[sX.ACCENT6]:"#70AD47",[sX.DARK1]:"#000000",[sX.DARK2]:"#44546A",[sX.LIGHT1]:"#FFFFFF",[sX.LIGHT2]:"#E7E6E6",[sX.HYPERLINK]:"#0563C1",[sX.FOLLOWED_HYPERLINK]:"#954F72"}},ah=class{constructor(){te(this,"_themeValue",sX.LIGHT1),te(this,"_themeColors"),te(this,"_themeTint"),te(this,"_rgbValue",""),te(this,"_colorType"),this._colorType=sb.UNSUPPORTED,this._themeColors=sq.OFFICE,this._themeTint=0}asRgbColor(){return new am(this._rgbValue,this)}asThemeColor(){return new ay(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case sb.THEME:return this.asThemeColor();case sb.RGB:return this.asRgbColor();case sb.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=sb.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=sb.THEME,this._themeColors=e}setThemeTint(e){this._colorType=sb.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=sb.THEME,this._themeValue=e,this}getColorType(){return this._colorType}};e7(ah,"ColorBuilder");let ad=class e{constructor(e){te(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${(0x1000000+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,r=+`0x${e[2]}${e[3]}`,n=+`0x${e[4]}${e[5]}`;return new ah().setRgbColor(`rgb(${t},${r},${n})`).asRgbColor()}static hexToRgbString(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,r,n)=>t+t+r+r+n+n);let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),r=null;if(t){let e=Number.parseInt(t[1],16),n=Number.parseInt(t[2],16),i=Number.parseInt(t[3],16);r=`rgba(${e},${n},${i})`}return r}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new e(this._builder)}equals(e){return!1}};e7(ad,"Color");let ap=ad,af=class{constructor(e){te(this,"_saturation",0),te(this,"_hue",0),te(this,"_lightness",0),te(this,"_alpha",0);let t=e.getRed()/255,r=e.getGreen()/255,n=e.getBlue()/255,i=e.getAlpha()/255,o=Math.min(t,Math.min(r,n)),s=Math.max(t,Math.max(r,n)),a=s-o;if(s===o){this._hue=0,this._saturation=0,this._lightness=s;return}this._lightness=(o+s)/2,this._lightness<.5?this._saturation=a/(s+o):this._saturation=a/(2-s-o),t===s&&(this._hue=(r-n)/a),r===s&&(this._hue=2+(n-t)/a),n===s&&(this._hue=4+(t-r)/a),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=i}asRgbColor(){let e;let t=new ah;if(0===this._saturation)return t.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),t.asRgbColor();e=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;let r=2*this._lightness-e,n=this._hue/360,i=this.setColor(e,r,n+1/3),o=this.setColor(e,r,n),s=this.setColor(e,r,n-1/3);return t.setRgbColor(`rgba(${Math.round(255*i)},${Math.round(255*o)},${Math.round(255*s)},${255*this._alpha})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),6*r<1?t+(e-t)*6*r:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}setLightness(e){this._lightness=e}};e7(af,"HLSColor");let ag=class e extends ap{constructor(t,r){super(r),te(this,"_cssString"),te(this,"_red"),te(this,"_green"),te(this,"_blue"),te(this,"_alpha");let n=t.match(e.RGBA_EXTRACT);if(n){let e=+n[1],r=+n[2],i=+n[3],o=+n[4];this._cssString=t,this._red=e,this._green=r,this._blue=i,this._alpha=o;return}if(n=t.match(e.RGB_EXTRACT)){let e=+n[1],r=+n[2],i=+n[3];this._cssString=t,this._red=e,this._green=r,this._blue=i,this._alpha=1;return}throw Error("Invalid rgba or rgb color")}asHexString(){return ap.rgbColorToHexValue(this)}getRed(){let t=this._red+e.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getGreen(){let t=this._green+e.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getBlue(){let t=this._blue+e.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getAlpha(){return this._alpha}getColorType(){return sb.RGB}clone(){return new e(this._cssString,this._builder)}asThemeColor(){throw Error("rgb color not support to themeColor")}equals(t){return t instanceof e&&t._red===this._red&&t._blue===this._blue&&t._green===this._green&&t._alpha===this._alpha}getCssString(){return this._cssString}};e7(ag,"RgbColor"),te(ag,"RGB_COLOR_AMT",0),te(ag,"RGBA_EXTRACT",RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),te(ag,"RGB_EXTRACT",RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let am=ag,a_=class e extends ap{constructor(e,t,r,n){super(n),te(this,"_themeColorType"),te(this,"_themeTint"),te(this,"_themeColors"),this._themeColorType=e,this._themeTint=t,this._themeColors=r}lumValue(e,t){return null==e?t:e<0?t*(1+e):t*(1-e)+(255-255*(1-e))}asRgbColor(){let t;let r=ac[this._themeColors];if(null==r)throw Error("not find themeColors type");let n=r[this._themeColorType];if(null==n)throw Error("not find themeColors value");if(e._cacheThemeColor.has(this._themeColors)){if((t=e._cacheThemeColor.get(this._themeColors)).has(this._themeColorType))return t.get(this._themeColorType)}else t=/* @__PURE__ */new Map,e._cacheThemeColor.set(this._themeColors,t);let i=new af(ap.hexValueToRgbColor(n));i.setLightness(this.lumValue(this._themeTint,255*i.getLightness())/255);let o=i.asRgbColor();return t.set(this._themeColorType,o),o}clone(){return new e(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(t){return t instanceof e&&t._themeColorType===this._themeColorType}getColorType(){return sb.THEME}getThemeColorType(){return this._themeColorType}};e7(a_,"ThemeColor"),te(a_,"_cacheThemeColor",/* @__PURE__ */new Map);let ay=a_,aE={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]},av=class e{constructor(t){if(te(this,"_color"),te(this,"_rgbColor"),te(this,"_isValid",!1),null==t){this._setNullColor();return}if(t instanceof e){this._color={...t._color},this._rgbColor={...t._rgbColor};return}let r=aI(t);if(null==r){this._setNullColor();return}this._color=r;let n=aA(this._color);if(null==n){this._setNullColor();return}this._rgbColor=n,this._isValid=!0}static mix(t,r,n){var i,o;n=Math.min(1,Math.max(0,n));let s=new e(t).toRgb(),a=new e(r).toRgb(),l=null!=(i=s.a)?i:1,u=null!=(o=a.a)?o:1;return new e({r:(a.r-s.r)*n+s.r,g:(a.g-s.g)*n+s.g,b:(a.b-s.b)*n+s.b,a:(u-l)*n+l})}static getContrastRatio(t,r){let n=new e(t).getLuminance(),i=new e(r).getLuminance();return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){let{r:e,g:t,b:r,a:n=1}=this.toRgb(),i=n<1;return`rgb${i?"a":""}(${e},${t},${r}${i?`,${n}`:""})`}toString(){return this.toRgbString()}toHexString(e){let{r:t,g:r,b:n,a:i=1}=this.toRgb(),o=i<1,s=[aR(Math.round(t).toString(16)),aR(Math.round(r).toString(16)),aR(Math.round(n).toString(16)),aR(Math.round(255*i).toString(16))];return e&&s[0][0]===s[0][1]&&s[1][0]===s[1][1]&&s[2][0]===s[2][1]&&s[3][0]===s[3][1]?o?`#${s[0][0]}${s[1][0]}${s[2][0]}${s[3][0]}`:`#${s[0][0]}${s[1][0]}${s[2][0]}`:o?`#${s[0]}${s[1]}${s[2]}${s[3]}`:`#${s[0]}${s[1]}${s[2]}`}toHsv(){return aM(this.toRgb())}toHsl(){return aL(this.toRgb())}lighten(t=10){let r=this.toHsl();return r.l+=t,r.l=Math.min(Math.max(r.l,0),100),new e(r)}darken(t=10){let r=this.toHsl();return r.l-=t,r.l=Math.min(Math.max(r.l,0),100),new e(r)}setAlpha(t){return new e({...this._rgbColor,a:t})}getLuminance(){let{r:e,g:t,b:r}=this.toRgb();return Number((.2126*(e=aT(e))+.7152*(t=aT(t))+.0722*(r=aT(r))).toFixed(3))}getBrightness(){let{r:e,g:t,b:r}=this.toRgb();return(299*e+587*t+114*r)/1e3}getAlpha(){var e;return null!=(e=this._color.a)?e:1}isDark(){return 128>this.getBrightness()}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}};e7(av,"ColorKit");let ab=av,aR=/* @__PURE__ */e7(e=>1===e.length?`0${e}`:e,"pad2"),aT=/* @__PURE__ */e7(e=>(e/=255)<=.03928?e/12.92:((e+.055)/1.055)**2.4,"rgbNormalize"),aI=/* @__PURE__ */e7(e=>{if(aP(e)){if("r"in e){let t={r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)};return void 0!==e.a&&(t.a=e.a),t}if("l"in e){let t={h:Math.round(e.h),s:e.s,l:e.l};return void 0!==e.a&&(t.a=e.a),t}let t={h:Math.round(e.h),s:e.s,v:e.v};return void 0!==e.a&&(t.a=e.a),t}let t=e.trim();if(aE[t]){let e=aE[t],r={r:Math.round(e[0]),g:Math.round(e[1]),b:Math.round(e[2])};return r.a=e[3]||1,r}return t.startsWith("#")?aC(t):t.startsWith("rgb")?aS(t):t.startsWith("hsl")?ax(t):t.startsWith("hsv")?aO(t):void 0},"toColor"),aC=/* @__PURE__ */e7(e=>{let t=e.substring(1),r=RegExp(`.{1,${t.length>=6?2:1}}`,"g"),n=t.match(r);if(!n||n.length<3)throw Error(`The color '${e}' is illegal hex color`);1===n[0].length&&(n=n.map(e=>e+e));let i={r:Number.parseInt(n[0],16),g:Number.parseInt(n[1],16),b:Number.parseInt(n[2],16)};return n.length>3&&(i.a=Number.parseInt(n[3],16)/255),i},"hexToColor"),aS=/* @__PURE__ */e7(e=>{let t=e.indexOf("(");if(-1===t)throw Error(`The color '${e}' is illegal rgb color`);let r=e.substring(t+1,e.length-1).split(",");if(r.length<3)throw Error(`The color '${e}' is illegal rgb color`);let n={r:Number.parseInt(r[0],10),g:Number.parseInt(r[1],10),b:Number.parseInt(r[2],10)};return r.length>3&&(n.a=Number.parseFloat(r[3])),n},"rgbToColor"),ax=/* @__PURE__ */e7(e=>{let t=e.indexOf("(");if(-1===t)throw Error(`The color '${e}' is illegal hsl color`);let r=e.substring(t+1,e.length-1).split(",");if(r.length<3)throw Error(`The color '${e}' is illegal hsl color`);let n={h:Number.parseInt(r[0],10),s:Number.parseFloat(r[1]),l:Number.parseFloat(r[2])};return r.length>3&&(n.a=Number.parseFloat(r[3])),n},"hslToColor"),aO=/* @__PURE__ */e7(e=>{let t=e.indexOf("(");if(-1===t)throw Error(`The color '${e}' is illegal hsv color`);let r=e.substring(t+1,e.length-1).split(",");if(r.length<3)throw Error(`The color '${e}' is illegal hsv color`);let n={h:Number.parseInt(r[0],10),s:Number.parseFloat(r[1]),v:Number.parseFloat(r[2])};return r.length>3&&(n.a=Number.parseFloat(r[3])),n},"hsvToColor"),aA=/* @__PURE__ */e7(e=>{let t=aI(e);if(null!=t)return"r"in t?t:"l"in t?aN(t):aD(t)},"toRgbColor"),aw=/* @__PURE__ */e7((e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e),"hue2Rgb"),aN=/* @__PURE__ */e7(e=>{let{h:t,s:r,l:n}=e;t/=360,r/=100,n/=100;let i=0,o=0,s=0;if(0===r)i=o=s=n;else{let e=n<.5?n*(1+r):n+r-n*r,a=2*n-e;i=aw(a,e,t+1/3),o=aw(a,e,t),s=aw(a,e,t-1/3)}let a={r:Math.round(255*i),g:Math.round(255*o),b:Math.round(255*s)};return void 0!==e.a&&(a.a=e.a),a},"hsl2Rgb"),aD=/* @__PURE__ */e7(e=>{let{h:t,s:r,v:n}=e;t=t/360*6,r/=100,n/=100;let i=Math.floor(t),o=t-i,s=n*(1-r),a=n*(1-o*r),l=n*(1-(1-o)*r),u=i%6,c={r:255*[n,a,s,s,l,n][u],g:255*[l,n,n,a,s,s][u],b:255*[s,s,l,n,n,a][u]};return void 0!==e.a&&(c.a=e.a),c},"hsv2Rgb"),aL=/* @__PURE__ */e7(e=>{let t,r,{r:n,g:i,b:o}=e,s=Math.max(n/=255,i/=255,o/=255),a=Math.min(n,i,o),l=(s+a)/2;if(s===a)t=r=0;else{let e=s-a;switch(r=l>.5?e/(2-s-a):e/(s+a),s){case n:t=(i-o)/e+(i<o?6:0);break;case i:t=(o-n)/e+2;break;default:t=(n-i)/e+4}t/=6}let u={h:Math.round(360*t),s:Math.round(100*r),l:Math.round(100*l)};return void 0!==e.a&&(u.a=e.a),u},"rgb2Hsl"),aM=/* @__PURE__ */e7(e=>{let t,{r,g:n,b:i}=e,o=Math.max(r/=255,n/=255,i/=255),s=Math.min(r,n,i),a=o-s;if(o===s)t=0;else{switch(o){case r:t=(n-i)/a+(n<i?6:0);break;case n:t=(i-r)/a+2;break;default:t=(r-n)/a+4}t/=6}let l={h:Math.round(360*t),s:Math.round(100*(0===o?0:a/o)),v:Math.round(100*o)};return void 0!==e.a&&(l.a=e.a),l},"rgb2Hsv"),aU=/* @__PURE__ */e7(e=>null==e,"isUndefinedOrNull"),aP=/* @__PURE__ */e7(e=>!aU(e)&&"object"==typeof e,"isObject");function ak(e){return!!(/^#(?:[Ff]{3}|[Ff]{6})\b/.test(e)||/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/.test(e)||/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e)||/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/.test(e)||/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e))}e7(function(e){return!!(/^#(?:[0]{3}|[0]{6})\b/.test(e)||/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/.test(e)||/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e)||/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/.test(e)||/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/.test(e))},"isBlackColor"),e7(ak,"isWhiteColor");var aF=((B=aF||{})[B.COVER=0]="COVER",B[B.REPLACE=1]="REPLACE",B[B.INTERSECTION=2]="INTERSECTION",B);function aj(e){return e&&(void 0!==e.s||void 0!==e.p||void 0!==e.v||void 0!==e.t||void 0!==e.f||void 0!==e.si||void 0!==e.custom)}function aB(e){return void 0!==e.t?e.t:"string"==typeof e.v?sK.STRING:"number"==typeof e.v?sK.NUMBER:"boolean"==typeof e.v?sK.BOOLEAN:void 0}function aH(e){if(null==e)return!0;let{v:t,f:r,si:n,p:i,s:o,custom:s}=e;return!(!(null==t||"string"==typeof t&&0===t.length)||null!=r&&r.length>0||null!=n&&n.length>0||null!=i||null!=s)}function aV(e){return null!=e&&("string"==typeof e||"number"==typeof e||"boolean"==typeof e)}e7(aj,"isICellData"),e7(aB,"getCellValueType"),e7(aH,"isNullCell"),e7(aV,"isCellV");var a$=((H=a$||{})[H.NORMAL=0]="NORMAL",H[H.ROW=1]="ROW",H[H.COLUMN=2]="COLUMN",H[H.ALL=3]="ALL",H),aG=((V=aG||{})[V.NONE=0]="NONE",V[V.ROW=1]="ROW",V[V.COLUMN=2]="COLUMN",V[V.ALL=3]="ALL",V);function aW(e){return[e.startRow,e.startColumn,e.endRow,e.endColumn]}e7(aW,"selectionToArray");var az=(($=az||{}).NONE="none",$.BACKWARD="backward",$.FORWARD="forward",$),aY=((G=aY||{}).RECT="RECT",G.TEXT="TEXT",G);function aK(e,t,r){let n=!1,i=!1,o=e,s=t,a=e,l=t;if(null==r)return{actualRow:e,actualColumn:t,isMergedMainCell:i,isMerged:n,endRow:o,endColumn:s,startRow:a,startColumn:l};for(let u=0;u<r.length;u++){let{startRow:c,endRow:h,startColumn:d,endColumn:p}=r[u];if(e===c&&t===d){o=h,s=p,a=c,l=d,i=!0;break}if(e>=c&&e<=h&&t>=d&&t<=p){o=h,s=p,a=c,l=d,n=!0;break}}return{actualRow:e,actualColumn:t,isMergedMainCell:i,isMerged:n,endRow:o,endColumn:s,startRow:a,startColumn:l}}function aX(e){let{actualRow:t,actualColumn:r,isMerged:n,isMergedMainCell:i,mergeInfo:o}=e,{startY:s,endY:a,startX:l,endX:u}=e,c=t,h=r,d=t,p=r;if(n&&o){let{startRow:e,startColumn:t,endRow:r,endColumn:n,startY:i,endY:f,startX:g,endX:m}=o;c=e,h=t,d=r,p=n,s=i,a=f,l=g,u=m}return i&&(s=o.startY,a=o.endY,l=o.startX,u=o.endX,d=o.endRow,p=o.endColumn),{startRow:c,startColumn:h,endRow:d,endColumn:p,startY:s,endY:a,startX:l,endX:u}}function aq(e){if(!e)return;let{actualRow:t,actualColumn:r,isMerged:n,isMergedMainCell:i,startRow:o,startColumn:s,endRow:a,endColumn:l}=e,u=t,c=r,h=t,d=r;return(n||i)&&(u=o,c=s,h=a,d=l),{startRow:u,startColumn:c,endRow:h,endColumn:d}}function aJ(e){var t;return!e||0===((null==(t=null==e?void 0:e.v)?void 0:t.toString())||"").length&&!e.p}function aQ(e){return aJ(e)&&(null==e?void 0:e.coverable)!==!1}function aZ(e){if(e){if(e.rgb)return e.rgb;if(e.th)return new ah().setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function a0(e){return ai.isString(e)&&"="===e.substring(0,1)&&e.length>1}function a1(e){return ai.isString(e)&&e.length>0}function a2(e,t=!1){var r;let n="",i=/* @__PURE__ */new Map([["ff",()=>{e.ff&&(n+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let t=e.fs;e.va&&(t/=2),n+=`font-size: ${t}pt; `}}],["it",()=>{e.it&&(n+="font-style: italic; ")}],["bl",()=>{e.bl&&(n+="font-weight: bold; ")}],["ul",()=>{var t;null!=(t=e.ul)&&t.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(e,t)=>`${t} underline`):n+="text-decoration: underline; ",e.ul.cl&&-1===n.indexOf("text-decoration-color")&&(n+=`text-decoration-color: ${aZ(e.ul.cl)}; `),e.ul.t&&-1===n.indexOf("text-decoration-style")&&(n+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var t;null!=(t=e.st)&&t.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(e,t)=>`${t} line-through`):n+="text-decoration-line: line-through; ",e.st.cl&&-1===n.indexOf("text-decoration-color")&&(n+=`text-decoration-color: ${aZ(e.st.cl)}; `),e.st.t&&-1===n.indexOf("text-decoration-style")&&(n+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var t;null!=(t=e.ol)&&t.s&&(n.indexOf("text-decoration-line")>-1?n=n.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(e,t)=>`${t} overline`):n+="text-decoration-line: overline; ",e.ol.cl&&-1===n.indexOf("text-decoration-color")&&(n+=`text-decoration-color: ${aZ(e.ol.cl)}; `),e.ol.t&&-1===n.indexOf("text-decoration-style")&&(n+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{e.bg&&(n+=`background: ${aZ(e.bg)}; `)}],["bd",()=>{var t,r,i,o,s,a,l,u,c,h,d,p;null!=(t=e.bd)&&t.b&&(n+=`border-bottom: ${a5(null==(r=e.bd)?void 0:r.b.s)} ${null!=(i=aZ(e.bd.b.cl))?i:""}; `),null!=(o=e.bd)&&o.t&&(n+=`border-top: ${a5(null==(s=e.bd)?void 0:s.t.s)} ${null!=(a=aZ(e.bd.t.cl))?a:""}; `),null!=(l=e.bd)&&l.r&&(n+=`border-right: ${a5(null==(u=e.bd)?void 0:u.r.s)} ${null!=(c=aZ(e.bd.r.cl))?c:""}; `),null!=(h=e.bd)&&h.l&&(n+=`border-left: ${a5(null==(d=e.bd)?void 0:d.l.s)} ${null!=(p=aZ(e.bd.l.cl))?p:""}; `)}],["cl",()=>{e.cl&&(n+=`color: ${aZ(e.cl)}; `)}],["va",()=>{e.va===sz.SUBSCRIPT?n+="vertical-align: sub; ":e.va===sz.SUPERSCRIPT&&(n+="vertical-align: super; ")}],["td",()=>{e.td===sj.LEFT_TO_RIGHT?n+="direction: ltr; ":e.td===sj.RIGHT_TO_LEFT&&(n+="direction: rtl; ")}],["tr",()=>{var t,r,i;e.tr&&(n+=`--data-rotate: (${null==(t=e.tr)?void 0:t.a}deg${null!=(r=e.tr)&&r.v?` ,${null==(i=e.tr)?void 0:i.v}`:""});`)}],["ht",()=>{e.ht===sH.LEFT?n+="text-align: left; ":e.ht===sH.RIGHT?n+="text-align: right; ":e.ht===sH.CENTER?n+="text-align: center; ":e.ht===sH.JUSTIFIED&&(n+="text-align: justify; ")}],["vt",()=>{e.vt===sV.BOTTOM?n+="vertical-align: bottom; ":e.vt===sV.TOP?n+="vertical-align: top; ":e.vt===sV.MIDDLE&&(n+="vertical-align: middle; ")}],["tb",()=>{e.tb===s$.CLIP?n+="white-space: nowrap; overflow-x: hidden; ":e.tb===s$.WRAP&&(n+="white-space: normal;")}],["pd",()=>{var t,r,i,o,s,a,l,u;let c=`${null==(t=e.pd)?void 0:t.b}pt`,h=`${null==(r=e.pd)?void 0:r.t}pt`,d=`${null==(i=e.pd)?void 0:i.l}pt`,p=`${null==(o=e.pd)?void 0:o.r}pt`;null!=(s=e.pd)&&s.b&&(n+=`padding-bottom: ${c}; `),null!=(a=e.pd)&&a.t&&(n+=`padding-top: ${h}; `),null!=(l=e.pd)&&l.l&&(n+=`padding-left: ${d}; `),null!=(u=e.pd)&&u.r&&(n+=`padding-right: ${p}; `)}]]),o=["bd","tr","tb"];for(let n in e)t&&o.includes(n)||null==(r=i.get(n))||r();return n}function a5(e){let t="";return e===sE.NONE?t="none":e===sE.THIN?t="0.5pt solid":e===sE.HAIR?t="0.5pt double":e===sE.DOTTED?t="0.5pt dotted":e===sE.DASHED||e===sE.DASH_DOT?t="0.5pt dashed":e===sE.DASH_DOT_DOT?t="0.5pt dotted":e===sE.DOUBLE?t="0.5pt double":e===sE.MEDIUM?t="1pt solid":e===sE.MEDIUM_DASHED||e===sE.MEDIUM_DASH_DOT?t="1pt dashed":e===sE.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===sE.SLANT_DASH_DOT?t="0.5pt dashed":e===sE.THICK&&(t="1.5pt solid"),t}function a3(e){let t=0;if("none"===(e=e.trim()))t=sE.NONE;else if("0.5pt solid"===e)t=sE.THIN;else if("0.5pt double"===e)t=sE.HAIR;else if("0.5pt dotted"===e)t=sE.DOTTED;else if("0.5pt dashed"===e)t=sE.DASHED;else if("1pt solid"===e)t=sE.MEDIUM;else if("1pt dashed"===e)t=sE.MEDIUM_DASHED;else if("1pt dotted"===e)t=sE.MEDIUM_DASH_DOT_DOT;else if("1.5pt solid"===e)t=sE.THICK;else{if(e.includes("none"))return sE.NONE;t=sE.THIN}return t}function a6(e,t){let{startRow:r,endRow:n,startColumn:i,endColumn:o,rangeType:s}=e;if(r<0||i<0||n<0||o<0||!(Number.isNaN(r)&&Number.isNaN(n))&&s===a$.COLUMN||!(Number.isNaN(i)&&Number.isNaN(o))&&s===a$.ROW||s!==a$.ROW&&s!==a$.COLUMN&&(Number.isNaN(i)||Number.isNaN(r)||Number.isNaN(o)||Number.isNaN(n)))return!1;if(t){let e=t.getRowCount(),r=t.getColumnCount();if(n>=e||o>=r)return!1}return!0}function a4(e,t){return{startRow:e,endRow:e,startColumn:t,endColumn:t}}function a9(e,t){return Object.prototype.toString.call(e)===Object.prototype.toString.call(t)&&("[object Object]"===Object.prototype.toString.call(e)||"[object Array]"===Object.prototype.toString.call(e)?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every(r=>a9(e[r],t[r])):e===t)}function a8(e,t){let r=e.ts||{},n=t.ts||{};return e.sId===t.sId&&a9(r,n)}function a7(e,t){return t.some(t=>e.indexOf(t)>-1)}function le(e,t,r,n){if(e>t&&([e,t]=[t,e]),r>n&&([r,n]=[n,r]),t<r||n<e)return[e,t];r<e&&(r=e),n>t&&(n=t);let i=n-r+1;return e===r?[n+1-i,t-i]:t===n?[e,r-1]:[e,t-i]}function lt(e){var t;return!(null==e||(null==e.indentStart||0===e.indentStart.v)&&null==e.hanging||(null==(t=e.hanging)?void 0:t.v)===0)}function lr(e,t,r){return e.slice(0,t)+r+e.slice(t)}function ln(e,t,r){return t>r?e:e.slice(0,t)+e.slice(r)}e7(aK,"getCellInfoInMergeData"),e7(aX,"makeCellToSelection"),e7(aq,"makeCellRangeToRangeData"),e7(aJ,"isEmptyCell"),e7(aQ,"isCellCoverable"),e7(aZ,"getColorStyle"),e7(a0,"isFormulaString"),e7(a1,"isFormulaId"),e7(a2,"handleStyleToString"),e7(a5,"getBorderStyle"),e7(a3,"getBorderStyleType"),e7(function(e,t){let r=e.body;if(t){let{headers:n,footers:i}=e;null!=n&&n[t]?r=n[t].body:null!=i&&i[t]&&(r=i[t].body)}return r},"getDocsUpdateBody"),e7(a6,"isValidRange"),e7(a4,"cellToRange"),e7(a9,"deepCompare"),e7(a8,"isSameStyleTextRun"),e7(a7,"checkForSubstrings"),e7(le,"horizontalLineSegmentsSubtraction"),e7(function(e){if(null==e)return!1;let t=e.bullet;return(null==t?void 0:t.listId)!=null},"checkParagraphHasBullet"),e7(function(e){return null!=e&&lt(e.paragraphStyle)},"checkParagraphHasIndent"),e7(lt,"checkParagraphHasIndentByStyle"),e7(lr,"insertTextToContent"),e7(ln,"deleteContent");let li=/\s/g;function lo(e){return null!==e&&""!==e.toString().replace(li,"")&&"boolean"!=typeof e&&!isNaN(e)}function ls(e){let t=0;for(let r=0;r<e.length;r++)t=e.charCodeAt(r)+(t<<6)+(t<<16)-t;return t>>>0}e7(lo,"isRealNum"),e7(ls,"hashAlgorithm");let la=Symbol("newer"),ll=Symbol("older"),lu=class{constructor(e){te(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[la],{done:!1,value:e.key}):{done:!0,value:void 0}}};e7(lu,"KeyIterator");let lc=class{constructor(e){te(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[la],{done:!1,value:e.value}):{done:!0,value:void 0}}};e7(lc,"ValueIterator");let lh=class{constructor(e){te(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[la],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}};e7(lh,"EntryIterator");let ld=class{constructor(e,t){te(this,"key"),te(this,"value"),te(this,la),te(this,ll),this.key=e,this.value=t,this[la]=void 0,this[ll]=void 0}toJSON(){return{key:this.key,value:this.value}}};e7(ld,"Entry");let lp=class{constructor(...e){if(te(this,"_keymap"),te(this,"size",0),te(this,"limit"),te(this,"oldest"),te(this,"newest"),te(this,"_onShiftListeners",[]),lm.hasLength(e,1)){if(lm.isNumber(e[0])){let t=e[0];this._initialize(t,void 0);return}if(lm.isIterable(e[0])){let t=e[0];this._initialize(0,t)}return}if(lm.hasLength(e,2)){let t=e[0],r=e[1];this._initialize(t,r)}}onShift(e){if(-1===this._onShiftListeners.indexOf(e))return this._onShiftListeners.push(e),oX(()=>nY(this._onShiftListeners,e));throw Error("[LRUMap]: the listener has been registered!")}_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=/* @__PURE__ */new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[la]&&(e===this.oldest&&(this.oldest=e[la]),e[la][ll]=e[ll]),e[ll]&&(e[ll][la]=e[la]),e[la]=void 0,e[ll]=this.newest,this.newest&&(this.newest[la]=e),this.newest=e)}assign(e){let t,r=this.limit||Number.MAX_VALUE;this._keymap.clear();let n=e[Symbol.iterator]();for(let e=n.next();!e.done;e=n.next()){let n=new ld(e.value[0],e.value[1]);if(this._keymap.set(n.key,n),t?(t[la]=n,n[ll]=t):this.oldest=n,t=n,0==r--)throw Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let r=this._keymap.get(e);return r?(r.value=t,this._markEntryAsUsed(r)):(this._keymap.set(e,r=new ld(e,t)),this.newest?(this.newest[la]=r,r[ll]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift()),this}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[la]?(this.oldest=this.oldest[la],this.oldest[ll]=void 0):(this.oldest=void 0,this.newest=void 0),e[la]=e[ll]=void 0,this._keymap.delete(e.key),--this.size,this._onShiftListeners.forEach(t=>t(e)),[e.key,e.value]}get(e){let t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(t)return this._keymap.delete(t.key),t[la]&&t[ll]?(t[ll][la]=t[la],t[la][ll]=t[ll]):t[la]?(t[la][ll]=void 0,this.oldest=t[la]):t[ll]?(t[ll][la]=void 0,this.newest=t[ll]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new lu(this.oldest)}values(){return new lc(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new lh(this.oldest)}forEach(e,t){"object"!=typeof t&&(t=this);let r=this.oldest;for(;r;)e.call(t,r.value,r.key,this),r=r[la]}toJSON(){let e=Array(this.size),t=0,r=this.oldest;for(;r;)e[t++]={key:r.key,value:r.value},r=r[la];return e}toString(){let e="",t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,(t=t[la])&&(e+=" < ");return e}};e7(lp,"LRUMap");let lf=lp,lg=class{static hasLength(e,t){return e.length===t}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isIterable(e){return null!=e[Symbol.iterator]}static isNumber(e){return"[object Number]"===this.getValueType(e)}};e7(lg,"LRUHelper");let lm=lg;var l_="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof e?e:"u">typeof self?self:{};function ly(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}e7(ly,"getDefaultExportFromCjs");var lE={exports:{}};"u">typeof self&&self,uT=function(){return function(){var e={d:/* @__PURE__ */e7(function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},"d"),o:/* @__PURE__ */e7(function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},"o")},t={};e.d(t,{default:/* @__PURE__ */e7(function(){return eh},"default")});var r={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"};let n=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,i={},o={group:" ",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"∞",ampm:["AM","PM"],mmmm6:["Muharram","Safar","Rabiʻ I","Rabiʻ II","Jumada I","Jumada II","Rajab","Shaʻban","Ramadan","Shawwal","Dhuʻl-Qiʻdah","Dhuʻl-Hijjah"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhuʻl-Q.","Dhuʻl-H."],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};function s(e){let t=n.exec(e);if(!t)throw SyntaxError("Malformed locale: ".concat(e));return{lang:t[1]+(t[2]?"_"+t[2]:""),language:t[1],territory:t[2]||"",codeset:t[3]||"",modifier:t[4]||""}}function a(e){if("number"==typeof e)return r[65535&e]||null;let t=parseInt(e,16);return isFinite(t)&&r[65535&t]?r[65535&t]||null:n.test(e)?e:null}function l(e){let t=a(e),r=null;if(t){let e=s(t);r=i[e.lang]||i[e.language]||null}return r}function u(e){return Object.assign({},o,e)}function c(e,t){let r="object"==typeof t?t:s(t);return i[r.lang]=u(e),r.language===r.lang||i[r.language]||(i[r.language]=u(e)),i[r.lang]}e7(s,"s"),e7(a,"o"),e7(l,"l"),e7(u,"d"),e7(c,"m");let h=u({group:","});function d(e,t){if("number"!=typeof e)return e;if(e<0)return-d(-e,t);if(t){let r=10**(t||0)||1;return d(e*r,0)/r}return Math.round(e)}function p(e,t,r){let n=e<0?-1:1,i=10**(t||2),o=10**(r||2),s,a,l=Math.abs(e),u=0,c=0,h=0,d=1;if((e=l)%1==0)a=[e*n,1];else if(e<1e-19)a=[n,1e19];else if(e>1e19)a=[1e19*n,1];else{do if(l=1/(l-Math.floor(l)),s=d,d=d*Math.floor(l)+u,u=s,c=h,(h=Math.floor(e*d+.5))>=i||d>=o)return[n*c,u];while(Math.abs(e-h/d)>=1e-10&&l!==Math.floor(l))a=[n*h,d]}return a}e7(d,"c"),h.isDefault=!0,c({group:",",ampm:["上午","下午"],mmmm:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["周日","周一","周二","周三","周四","周五","周六"]},"zh_CN"),c({group:",",nan:"非數值",ampm:["上午","下午"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ddd:["週日","週一","週二","週三","週四","週五","週六"]},"zh_TW"),c({group:",",ampm:["午前","午後"],mmmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],mmm:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dddd:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ddd:["日","月","火","水","木","金","土"]},"ja"),c({group:",",ampm:["오전","오후"],mmmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],mmm:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dddd:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],ddd:["일","월","화","수","목","금","토"]},"ko"),c({group:",",ampm:["ก่อนเที่ยง","หลังเที่ยง"],mmmm:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],mmm:["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],dddd:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],ddd:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},"th"),c({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","února","března","dubna","května","června","července","srpna","září","října","listopadu","prosince"],mmm:["led","úno","bře","dub","kvě","čvn","čvc","srp","zář","říj","lis","pro"],dddd:["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],ddd:["ne","po","út","st","čt","pá","so"]},"cs"),c({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"da"),c({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl"),c({group:","},"en"),c({decimal:",",nan:"epäluku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kesäkuuta","heinäkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kesäk.","heinäk.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi"),c({group:" ",decimal:",",mmmm:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],mmm:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr"),c({group:".",decimal:",",mmmm:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de"),c({group:".",decimal:",",ampm:["π.μ.","μ.μ."],mmmm:["Ιανουαρίου","Φεβρουαρίου","Μαρτίου","Απριλίου","Μαΐου","Ιουνίου","Ιουλίου","Αυγούστου","Σεπτεμβρίου","Οκτωβρίου","Νοεμβρίου","Δεκεμβρίου"],mmm:["Ιαν","Φεβ","Μαρ","Απρ","Μαΐ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],dddd:["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],ddd:["Κυρ","Δευ","Τρί","Τετ","Πέμ","Παρ","Σάβ"]},"el"),c({decimal:",",ampm:["de.","du."],mmmm:["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],mmm:["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],dddd:["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu"),c({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["janúar","febrúar","mars","apríl","maí","júní","júlí","ágúst","september","október","nóvember","desember"],mmm:["jan.","feb.","mar.","apr.","maí","jún.","júl.","ágú.","sep.","okt.","nóv.","des."],dddd:["sunnudagur","mánudagur","þriðjudagur","miðvikudagur","fimmtudagur","föstudagur","laugardagur"],ddd:["sun.","mán.","þri.","mið.","fim.","fös.","lau."]},"is"),c({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id"),c({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it"),c({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],ddd:["søn.","man.","tir.","ons.","tor.","fre.","lør."]},"nb"),c({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],dddd:["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],ddd:["niedz.","pon.","wt.","śr.","czw.","pt.","sob."]},"pl"),c({group:".",decimal:",",mmmm:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","sáb."]},"pt"),c({decimal:",",nan:"не число",mmmm:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],mmm:["янв.","февр.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],dddd:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],ddd:["вс","пн","вт","ср","чт","пт","сб"]},"ru"),c({decimal:",",mmmm:["januára","februára","marca","apríla","mája","júna","júla","augusta","septembra","októbra","novembra","decembra"],mmm:["jan","feb","mar","apr","máj","jún","júl","aug","sep","okt","nov","dec"],dddd:["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],ddd:["ne","po","ut","st","št","pi","so"]},"sk"),c({group:".",decimal:",",ampm:["a. m.","p. m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ddd:["dom.","lun.","mar.","mié.","jue.","vie.","sáb."]},"es"),c({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],ddd:["sön","mån","tis","ons","tors","fre","lör"]},"sv"),c({group:".",decimal:",",ampm:["ÖÖ","ÖS"],mmmm:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],mmm:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"]},"tr"),e7(p,"p");let f={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},g=Object.assign({},f);function m(e){if(null===e&&(e=f),e){for(let t in e)if(t in f){let r=e[t];g[t]=null==r?f[t]:r}}return{...g}}e7(m,"h");let _={"#":"",0:"0","?":" "},y={"@":"text","-":"minus","+":"plus"},E=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],v=["¤","$","£","¥","֏","؋","৳","฿","៛","₡","₦","₩","₪","₫","€","₭","₮","₱","₲","₴","₸","₹","₺","₼","₽","₾","₿"],b=RegExp("["+v.join("")+"]");function R(e,t,r){return t[r+"_max"]=e.length,t[r+"_min"]=e.replace(/#/g,"").length,t}e7(R,"M");let T={};function I(e){if(!(e in T)){let t=[],r=e.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,e=>"?".repeat(e.length));for(let e=0;e<r.length;e++){let n=r.charAt(e);t[e]=n in _?_[n]:n}T[e]=t.join("")}return T[e]}function C(e,t){"string"==typeof e&&(e={type:"string",value:e=e.replace(/ /g,_["?"])}),t.push(e)}function S(e){let t=[],r={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:1,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:t},n=e+"",i="int",o=!1,s=null,l=[],u,c,h=!1;for(;n&&!o;){if(u=/^General/i.exec(n))r.general=!0,C({type:"general"},t);else if("int"===i&&(u=/^[#?0]+(?:,[#?0]+)*/.exec(n))||"den"===i&&(u=/^[#?\d]+/.exec(n))||(u=/^[#?0]+/.exec(n)))r[i+"_pattern"].push(u[0]),C(s={type:i,num:u[0]},t);else if((u=/^\//.exec(n))&&r[i+"_pattern"].length){if(!s)throw SyntaxError("Missing a numerator in pattern ".concat(e));r.fractions=!0,r.num_pattern.push(r[i+"_pattern"].pop()),s.type="num",i="den",C({type:"div"},t)}else if(u=/^,+/.exec(n)){let e=n.charAt(1)in _;c.slice(-1)in _&&(u[0].length>1||!e)?r.scale=.001**u[0].length:r.dec_fractions||C(u[0],t)}else{if(u=/^;/.exec(n)){o=!0;break}if(u=/^[@+-]/.exec(n))"@"===u[0]&&(r.text=!0),C({type:y[u[0]]},t);else if(u=/^(?:\[(h+|m+|s+)\])/i.exec(n)){let e=u[1].toLowerCase(),n=e[0],i={type:"",size:0,date:1,raw:u[0],pad:e.length};"h"===n?(i.size=16,i.type="hour-elap"):"m"===n?(i.size=32,i.type="min-elap"):(i.size=64,i.type="sec-elap"),r.date=r.date|i.size,l.push(i),C(i,t)}else if(u=/^(?:B2)/i.exec(n))h||(r.date_system=6);else if(u=/^(?:B1)/i.exec(n))h||(r.date_system=1);else if(u=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(n)){let e={type:"",size:0,date:1,raw:u[0]},n=u[0].toLowerCase(),i=n[0];if("y"===n||"yy"===n)e.size=2,e.type="year-short";else if("y"===i||"e"===i)e.size=2,e.type="year";else if("b"===n||"bb"===n)e.size=2,e.type="b-year-short";else if("b"===i)e.size=2,e.type="b-year";else if("d"===n||"dd"===n)e.size=8,e.type="day",e.pad=/dd/.test(n);else if("ddd"===n)e.size=8,e.type="weekday-short";else if("d"===i)e.size=8,e.type="weekday";else if("h"===i)e.size=16,e.type="hour",e.pad=/hh/i.test(n);else if("m"===i){3===n.length?(e.size=4,e.type="monthname-short"):5===n.length?(e.size=4,e.type="monthname-single"):n.length>=4&&(e.size=4,e.type="monthname");let t=l[l.length-1];!e.type&&t&&!t.used&&80&t.size&&(t.used=!0,e.size=32,e.type="min",e.pad=/mm/.test(n)),e.type||(e.size=4,e.type="month",e.pad=/mm/.test(n),e.indeterminate=!0)}else if("s"===i){e.size=64,e.type="sec",e.pad=/ss/.test(n);let t=l[l.length-1];t&&32&t.size?e.used=!0:t&&t.indeterminate&&(delete t.indeterminate,t.size=32,t.type="min",e.used=!0)}r.date=r.date|e.size,r.date_eval=!0,l.push(e),C(e,t)}else if(u=/^(?:AM\/PM|am\/pm|A\/P)/.exec(n))r.clock=12,r.date=16|r.date,r.date_eval=!0,C({type:"am",short:"A/P"===u[0]},t);else if(r.date&&(u=/^\.0{1,3}/i.exec(n))){let e=u[0].length-1,n=[64,128,256,512][e];r.date=r.date|n,r.date_eval=!0,r.sec_decimals=Math.max(r.sec_decimals,e),C({type:"subsec",size:n,decimals:e,date:1,raw:u[0]},t)}else if((u=/^\\(.)/.exec(n))||(u=/^"([^"]*?)"/.exec(n)))C(u[1],t);else if(u=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(n))r.condition=[u[1],parseFloat(u[2],10)];else if(u=/^\[\$([^\]]+)\]/.exec(n)){let e=u[1].split("-"),n=e.length<2?"":e[e.length-1],i=e[0];i&&C(i,t);let o=a(n);o&&(r.locale=o);let s=parseInt(n,16);isFinite(s)&&0xff0000&s&&(s>>16&255)==6&&(r.date_system=6),h=!0}else if(u=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(n))r.color=u[2]?E[parseInt(u[2],10)]||"#000":u[1].toLowerCase();else if(!(u=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(n))){if(u=/^%/.exec(n))r.scale=100,r.percent=!0,C("%",t);else if(u=/^_(\\.|.)/.exec(n))C(" ",t);else if(u=/^\./.exec(n))C({type:"point",value:u[0]},t),r.dec_fractions=!0,i="frac";else if(u=/^[Ee]([+-]?|(?=[0#?]))/.exec(n))r.exponential=!0,r.exp_plus="+"===u[1],i="man",C({type:"exp",plus:"+"===u[1]},t);else if(!(u=/^\*(\\.|.)/.exec(n))){if(u=/^[BENn[]/.exec(n))throw SyntaxError("Unexpected char ".concat(n.charAt(0)," in pattern ").concat(e));"("===n[0]&&(r.parens=!0),C((u=[n[0]])[0],t)}}}c=u[0],n=n.slice(u?u[0].length:1)}if(r.pattern=e.slice(0,e.length-n.length),/^((?:\[[^\]]+\])+)(;|$)/.test(r.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(r.pattern)&&C({type:"text"},t),r.fractions&&r.dec_fractions||r.fractions&&r.exponential)throw SyntaxError("Invalid pattern: ".concat(r.pattern));let d=r.int_pattern.join("");if(r.grouping=d.indexOf(",")>=0,r.grouping){let e=d.split(","),t=e.length;2===t?(r.group_pri=e[1].length,r.group_sec=r.group_pri):t>2&&(r.group_pri=e[t-1].length,r.group_sec=e[t-2].length)}else r.group_pri=0,r.group_sec=0;R(d.replace(/[,]/g,""),r,"int"),R(r.frac_pattern.join(""),r,"frac"),R(r.man_pattern.join(""),r,"man");let p=r.num_pattern.join(""),f=r.den_pattern.join(""),g=/\?/.test(f)||/\?/.test(p);return f=f.replace(/\d/g,g?"?":"#"),g&&(f=f.replace(/#$/g,"?")),R(p,r,"num"),R(f,r,"den"),g&&(p=p.replace(/#$/g,"?")),r.int_padding=I(r.int_pattern.join("")),r.man_padding=I(r.man_pattern.join("")),r.num_padding=I(p),r.den_padding=I(f),r.den_pattern.length&&(r.denominator=parseInt(r.den_pattern.join("").replace(/\D/g,""),10)),r.integer=!!r.int_pattern.join("").length,r.fractions&&t.forEach((e,r)=>{let n=t[r+1];"string"===e.type&&n&&("num"===n.type?e.rule="num+int":"div"===n.type?e.rule="num":"den"===n.type&&(e.rule="den"))}),r}e7(I,"x"),e7(C,"F"),e7(S,"z");let x=/* @__PURE__ */e7(e=>{let t=e.condition;t&&t[1]<0&&("<"===t[0]||"<="===t[0]||"="===t[0])||e.tokens.unshift({type:"minus",volatile:!0})},"w");function O(e){let t=[],r,n=!1,i=null,o=e,s=0,l=!1,u=0,c=0;do{if(((l=S(o)).date||l.general)&&(l.int_pattern.length||l.frac_pattern.length||1!==l.scale||l.text))throw Error("Illegal format");if(l.condition&&(c++,n=!0),l.text){if(i)throw Error("Unexpected partition");i=l}l.locale&&(r=a(l.locale)),t.push(l),s=";"===o.charAt(l.pattern.length)?1:0,o=o.slice(l.pattern.length+s),u++}while(s&&u<4&&c<3)if(s)throw Error("Unexpected partition");if(c>2)throw Error("Unexpected condition");let h=t[3];if(h&&(h.int_pattern.length||h.frac_pattern.length||h.date))throw Error("Unexpected partition");if(n){let e=t.length;if(1===e&&(t[1]=S("General"),t[1].generated=!0),e<3){let e=t[0],r=t[1];if(x(e),r.condition)x(r);else{let t=e.condition;("="===t[0]||t[1]>=0&&(">"===t[0]||">="===t[0]))&&r.tokens.unshift({type:"minus",volatile:!0})}}else t.forEach(x)}else{if(t.length<4&&i)for(let e=0,r=t.length;e<r;e++)t[e]===i&&t.splice(e,1);if(t.length<1&&i&&(t[0]=S("General"),t[0].generated=!0),t.length<2){let e=S(t[0].pattern);e.tokens.unshift({type:"minus",volatile:!0}),e.generated=!0,t.push(e)}if(t.length<3){let e=S(t[0].pattern);e.generated=!0,t.push(e)}if(t.length<4){if(i)t.push(i);else{let e=S("@");e.generated=!0,t.push(e)}}t[0].condition=[">",0],t[1].condition=["<",0],t[2].condition=null}return{pattern:e,partitions:t,locale:r}}e7(O,"D");let A=Math.floor;function w(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e>=0){if(0===e)return[1900,1,0];if(60===e)return[1900,2,29];if(e<60)return[1900,e<32?1:2,(e-1)%31+1]}let t=e+68569+2415019,r=A(4*t/146097);t-=A((146097*r+3)/4);let n=A(4e3*(t+1)/1461001);t=t-A(1461*n/4)+31;let i=A(80*t/2447),o=t-A(2447*i/80);t=A(i/11);let s=i+2-12*t;return[0|100*(r-49)+n+t,0|s,0|o]}function N(e){return w(e+1462)}function D(e){if(60===e)throw Error("#VALUE!");if(e<=1)return[1317,8,29];if(e<60)return[1317,e<32?9:10,1+(e-2)%30];let t=10631/30,r=e+466935,n=A(r/10631),i=A(((r-=10631*n)-.1335)/t);r-=A(i*t+.1335);let o=A((r+28.5001)/29.5);return 13===o?[30*n+i,12,30]:[30*n+i,o,r-A(29.5001*o-29)]}function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=A(e);return 6===t?D(n):-1===t?N(n):w(n,r)}e7(w,"C"),e7(N,"E"),e7(D,"A"),e7(L,"Y");let M=Math.floor;function U(e,t){let r=null;if(Array.isArray(e)){let[t,n,i,o,s,a]=e;r=Date.UTC(t,null==n?0:n-1,null!=i?i:1,o||0,s||0,a||0)}else if(e instanceof Date&&(r=1*e,!t||!t.ignoreTimezone)){let t=/* @__PURE__ */new Date;t.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t.setUTCHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r=1*t}if(null!=r&&isFinite(r)){let e=r/864e5;return e-(e<=-25509?-25568:-25569)}return e}function P(e,t){let r=0|e,n=86400*(e-r),i=M(n);n-i>.9999&&86400===(i+=1)&&(i=0,r+=1);let o=i<0?86400+i:i,[s,a,l]=L(e,0,t&&t.leap1900),u=M(o/60/60)%60,c=M(o/60)%60,h=M(o)%60;if(t&&t.nativeDate){let e=/* @__PURE__ */new Date(0);return e.setUTCFullYear(s,a-1,l),e.setUTCHours(u,c,h),e}return[s,a,l,u,c,h]}function k(e){return!!(e[0]&&e[0].percent||e[1]&&e[1].percent||e[2]&&e[2].percent||e[3]&&e[3].percent)}function F(e){return!!(e[0]&&e[0].date||e[1]&&e[1].date||e[2]&&e[2].date||e[3]&&e[3].date)}function j(e){let[t,r,n,i]=e;return!(t&&!t.generated||r&&!r.generated||n&&!n.generated||!i||!i.text||i.generated)}e7(U,"P"),e7(P,"I"),e7(k,"O"),e7(F,"J"),e7(j,"L");let B={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},H=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]],V={total:1,sign:0,period:0,int:1,frac:0},$=/* @__PURE__ */e7((e,t)=>e.replace(/\./,t.decimal),"H");function G(e,t,r,n){let i=0|r;if("string"==typeof r)e.push(r);else if(r===i)e.push(Math.abs(i));else{let t=Math.abs(r),i=t?Math.floor(Math.log10(t)):0,o=i<0?t*10**-i:t/10**i;10===o&&(o=1,i++);let s=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=Math.abs(e);if(!r)return V;let n=t&&e<0?1:0,i=Math.floor(r),o=Math.floor(Math.log10(r)+1),s=0,a=0;if(i!==r){s=1;let e=String(d(o<0?r*10**-o:r/10**o,15)),t=e.length,n=!0,i=0;for(;i<=e.length;){if("."===e[i]){t--;break}"0"===e[i]&&n?t--:n=!1,i++}(a=t-o)<0&&(a=0,s=0)}return{total:n+Math.max(o,1)+s+a,digits:Math.max(o,0)+a,sign:n,period:s,int:Math.max(o,1),frac:a}}(t),a=/* @__PURE__ */e7(()=>{let t;let r=Math.abs(i);t=1===o?o:d(o,5),e.push($(t+"",n),n.exponent,i<0?n.negative:n.positive,r<10?"0":"",r)},"o");if(i>=-4&&i<=-1){let r=t.toPrecision(10+i).replace(/\.?0+$/,"");e.push($(r,n))}else if(10===i){let r=t.toFixed(10).slice(0,12).replace(/\.$/,"");e.push($(r,n))}else if(9>=Math.abs(i)){if(s.total<=11){let r=d(t,9).toFixed(s.frac);e.push($(r,n))}else 9===i?e.push(Math.floor(t)):i>=0&&i<9?e.push(d(t,9-i)):a()}else s.total>=12?a():Math.floor(t)===t?e.push(Math.floor(t)):e.push($(d(t,9).toFixed(s.frac),n))}return e}e7(G,"B");let W={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},z=/* @__PURE__ */e7(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Math.floor(Math.log10(e));return t>1?Math.floor(r/t)*t:r},"Z");function Y(e,t,r,n){var i,o;let s="",a="",l="",u="",c="",f=0,g=0|e,m=0,y=0,E=1,v=0,b=0,R=0,T=0,I=0,C=0,S=n||h;if(!t.text&&isFinite(t.scale)&&1!==t.scale&&(e=function(e){if(0===e)return e;let t=Math.ceil(Math.log10(e<0?-e:e)),r=10**(16-Math.floor(t));return Math.round(e*r)/r}(e*t.scale)),t.exponential){let r=Math.abs(e);if(r){let e=10**-z(r,t.int_max);f=z(d(r*e,t.frac_max)/e,t.int_max)}r/=10**f,e=e<0?-r:r,s+=Math.abs(f)}if(t.integer){let r=Math.abs(d(e,t.fractions?1:t.frac_max));c+=r<1?"":Math.floor(r)}if(t.grouping){let e="",r=c.length;for(r>t.group_pri&&(r-=t.group_pri,e=S.group+c.slice(r,r+t.group_pri)+e);r>t.group_sec;)r-=t.group_sec,e=S.group+c.slice(r,r+t.group_sec)+e;c=r?c.slice(0,r)+e:e}t.dec_fractions&&(u=String(d(e,t.frac_max)).split(".")[1]||"");let x=!1;if(t.fractions){let r=Math.abs(t.integer?e%1:e);if(r){if(x=!0,isFinite(t.denominator))l+=t.denominator,"0"===(a+=d(r*t.denominator))&&(a="",l="",x=!1,c||(c="0"));else{let e=p(r,t.integer?t.num_max:1/0,t.den_max);a+=e[0],l+=e[1],t.integer&&"0"===a&&(c||(c="0"),a="",l="",x=!1)}}}if(t.date){g=Math.trunc(e);let n=86400*(e-g);if(m=Math.floor(n),1e-6>Math.abs(C=n-m)?C=0:C>.9999&&(C=0,86400===(m+=1)&&(m=0,g+=1)),C){let e=512&t.date||256&t.date||128&t.date;(512===e&&C>.9995||256===e&&C>.995||128===e&&C>.95||!e&&C>=.5)&&(m++,C=0)}if(g||t.date_system){let n=L(e,t.date_system,r.leap1900);y=n[0],E=n[1],v=n[2]}if(m){let e=m<0?86400+m:m;I=Math.floor(e)%60,T=Math.floor(e/60)%60,R=Math.floor(e/60/60)%60}if(b=(6+g)%7,t.date_eval&&(i=e,o=g+m/86400,r.dateSpanLarge?i<-694324||o>=0x222ba13:i<0||o>=2958466)){if(r.dateErrorThrows)throw Error("Date out of bounds");return r.dateErrorNumber?G(e<0?[S.negative]:[],0,e,S).join(""):r.overflow}}if(t.int_padding&&(c=1===t.int_padding.length?c||t.int_padding:t.int_padding.substring(0,t.int_padding.length-c.length)+c),t.num_padding&&(a=1===t.num_padding.length?a||t.num_padding:t.num_padding.substring(0,t.num_padding.length-a.length)+a),t.den_padding&&(l=1===t.den_padding.length?l||t.den_padding:l+t.den_padding.slice(l.length)),t.man_padding){let e=t.exp_plus?"+":"";s=1===t.man_padding.length?(f<0?"-":e)+(s||t.man_padding):(f<0?"-":e)+t.man_padding.slice(0,t.man_padding.length-s.length)+s}let O=[],A=0,w={int:0,frac:0,man:0,num:0,den:0};for(let i=0,o=t.tokens.length;i<o;i++){let o=t.tokens[i],h=o.num?o.num.length:0;if("string"===o.type)o.rule?"num"===o.rule?x?O.push(o.value):(t.num_min>0||t.den_min>0)&&O.push(o.value.replace(/./g,_["?"])):"num+int"===o.rule?x&&c?O.push(o.value):t.den_min>0&&(c||t.num_min)&&O.push(o.value.replace(/./g,_["?"])):"den"===o.rule&&(x?O.push(o.value):(t.den_min>0||t.den_min>0)&&O.push(o.value.replace(/./g,_["?"]))):O.push(o.value);else if("error"===o.type)O.push(r.invalid);else if("point"===o.type)O.push(t.date?o.value:S.decimal);else if("general"===o.type)G(O,0,e,S);else if("exp"===o.type)O.push(S.exponent);else if("minus"===o.type)o.volatile&&t.date||o.volatile&&(e>=0||"number"!=typeof e)||(o.volatile&&!t.fractions&&(t.integer||t.dec_fractions)?(e<0&&c&&"0"!==c||u)&&O.push(S.negative):O.push(S.negative));else if("plus"===o.type)O.push(S.positive);else if("text"===o.type)O.push(e);else if("div"===o.type)x?O.push("/"):t.num_min>0||t.den_min>0?O.push(_["?"]):O.push(_["#"]);else if("int"===o.type){if(1===t.int_pattern.length)O.push(c);else{let e=A?t.int_pattern.join("").length-w.int:1/0,r=A===t.int_pattern.length-1?0:t.int_pattern.join("").length-(w.int+o.num.length);O.push(c.substring(c.length-e,c.length-r)),A++,w.int+=o.num.length}}else if("frac"===o.type){let e=w.frac;for(let t=0;t<h;t++)O.push(u[t+e]||_[o.num[t]]);w.frac+=h}else if(o.type in W)1===t[o.type+"_pattern"].length?("int"===o.type&&O.push(c),"frac"===o.type&&O.push(u),"man"===o.type&&O.push(s),"num"===o.type&&O.push(a),"den"===o.type&&O.push(l)):(O.push(W[o.type].slice(w[o.type],w[o.type]+h)),w[o.type]+=h);else if("year"===o.type)y<0&&O.push(S.negative),O.push(String(Math.abs(y)).padStart(4,"0"));else if("year-short"===o.type){let e=y%100;O.push(e<10?"0":"",e)}else if("month"===o.type)O.push(o.pad&&E<10?"0":"",E);else if("monthname-single"===o.type)6===t.date_system?O.push(S.mmmm6[E-1].charAt(0)):O.push(S.mmmm[E-1].charAt(0));else if("monthname-short"===o.type)6===t.date_system?O.push(S.mmm6[E-1]):O.push(S.mmm[E-1]);else if("monthname"===o.type)6===t.date_system?O.push(S.mmmm6[E-1]):O.push(S.mmmm[E-1]);else if("weekday-short"===o.type)O.push(S.ddd[b]);else if("weekday"===o.type)O.push(S.dddd[b]);else if("day"===o.type)O.push(o.pad&&v<10?"0":"",v);else if("hour"===o.type){let e=R%t.clock||(t.clock<24?t.clock:0);O.push(o.pad&&e<10?"0":"",e)}else if("min"===o.type)O.push(o.pad&&T<10?"0":"",T);else if("sec"===o.type)O.push(o.pad&&I<10?"0":"",I);else if("subsec"===o.type){O.push(S.decimal);let e=C.toFixed(t.sec_decimals);O.push(e.slice(2,2+o.decimals))}else if("am"===o.type){let e=R<12?0:1;o.short&&!n?O.push("AP"[e]):O.push(S.ampm[e])}else if("hour-elap"===o.type){e<0&&O.push(S.negative);let t=24*g+Math.floor(Math.abs(m)/3600);O.push(String(Math.abs(t)).padStart(o.pad,"0"))}else if("min-elap"===o.type){e<0&&O.push(S.negative);let t=1440*g+Math.floor(Math.abs(m)/60);O.push(String(Math.abs(t)).padStart(o.pad,"0"))}else if("sec-elap"===o.type){e<0&&O.push(S.negative);let t=86400*g+Math.abs(m);O.push(String(Math.abs(t)).padStart(o.pad,"0"))}else if("b-year"===o.type)O.push(y+543);else if("b-year-short"===o.type){let e=(y+543)%100;O.push(e<10?"0":"",e)}}return r.nbsp?O.join(""):O.join("").replace(/\u00a0/g," ")}function K(e,t){for(let r=0;r<3;r++){let n=t[r];if(n){let t;if(n.condition){let r=n.condition[0],i=n.condition[1];"="===r?t=e===i:">"===r?t=e>i:"<"===r?t=e<i:">="===r?t=e>=i:"<="===r?t=e<=i:"<>"===r&&(t=e!==i)}else t=!0;if(t)return n}}}e7(Y,"K"),e7(K,"q");let X=S("@"),q="black",J={};function Q(e,t){if(e){let r=e[0];t[r]=t[r]||{},Q(e.slice(1),t[r])}else t.$=!0}e7(Q,"ee"),["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"].forEach(e=>{Q(e,J),Q(e+" x",J),Q(e+" l",J),Q(e+" l x",J),Q("l "+e,J),Q("l "+e+" x",J),Q(e+" D",J),Q(e+" D x",J),Q("D "+e,J),Q("D "+e+" x",J)});let Z={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},ee={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},et={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},er=/* @__PURE__ */new Date().getUTCFullYear();function en(e){let t=RegExp("^([\\s+%"+v.join("")+"(-]*)(((?:(?:\\d[\\d,]*)(?:\\.\\d*)?|(?:\\.\\d+)))([eE][+-]?\\d+)?)([\\s%"+v.join("")+")]*)$").exec(e);if(t){let[,e,r,n,i,o]=t,s=1,a="",l=!1,u=!1,c=!1,h=!1,d=!1,p=null,f=!1,g=parseFloat(r.replace(/,/g,""));if(!isFinite(g))return null;for(let t=0;t<e.length;t++){let r=e[t];if("-"===r){if(l||u)return null;l=!0,s=-1}else if(b.test(r)){if(d)return null;d=!0,p=r}else if("("===r){if(u||l)return null;u=!0,s=-1}else if("%"===r){if(h)return null;h=!0}}for(let e=0;e<o.length;e++){let t=o[e];if(b.test(t)){if(d)return null;d=!0,p=t,f=!0}else if(")"===t){if(c||!u)return null;c=!0}else if("%"===t){if(h)return null;h=!0}}if(i){if(h||d)return null;a="0.00E+00"}else if(h){if(d)return null;a=n.includes(".")?"0.00%":"0%",g*=.01}else if(d){let e=n.includes(".")?"#,##0.00":"#,##0";a=f?e+p:p+e}else n.includes(",")&&(a=n.includes(".")?"#,##0.00":"#,##0");let m={v:g*s};return a&&(m.z=a),m}}e7(en,"ie");let ei=/* @__PURE__ */e7((e,t,r)=>{let n=r.path||"",i=Object.keys(t);for(let o=0;o<i.length;o++){let s;let a=i[o];if(t[a]){if("$"===a||"€"===a)e||(s=r);else if("-"===a){let i=/^(\s*([./-]|,\s)\s*|\s+)/.exec(e);if(i){let o="-"===i[1]||"/"===i[1]||"."===i[1]?i[1]:" ";if(!r.sep||r.sep===o){let l=i[0].replace(/\s+/g," ");s=ei(e.slice(i[0].length),t[a],{...r,sep:o,path:n+l})}}}else if(" "===a){let i=/^[,.]?\s+/.exec(e);if(i){let o=i[0].replace(/\s+/g," ");s=ei(e.slice(i[0].length),t[a],{...r,path:n+o})}}else if("j"===a||"d"===a){let i=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(e);i&&(s=ei(e.slice(i[0].length),t[a],{...r,day:i[0],path:n+a}))}else if("n"===a||"m"===a){let i=/^(0?[1-9]|1[012])\b/.exec(e);i&&(s=ei(e.slice(i[0].length),t[a],{...r,month:+i[0],_mon:i[0],path:n+a}))}else if("F"===a||"M"===a){let i=/^([a-z]{3,9})\b/i.exec(e),o=i&&("F"===a?ee:Z)[i[0].toLowerCase()];o&&(s=ei(e.slice(i[0].length),t[a],{...r,month:o,_mon:i[0],path:n+a}))}else if("l"===a||"D"===a){let i=/^([a-z]{3,9})\b/i.exec(e);(i&&et[i[0].toLowerCase()])===a&&(s=ei(e.slice(i[0].length),t[a],{...r,path:n+a}))}else if("y"===a){let i=/^\d\d\b/.exec(e);if(i){let o=+i[0]>=30?+i[0]+1900:+i[0]+2e3;s=ei(e.slice(i[0].length),t[a],{...r,year:o,path:n+a})}}else if("Y"===a){let i=/^\d\d\d\d\b/.exec(e);i&&(s=ei(e.slice(i[0].length),t[a],{...r,year:+i[0],path:n+a}))}else{if("x"!==a)throw Error('Unknown date token "'.concat(a,'"'));{let i=es(e);i&&(s=ei("",t[a],{...r,time:i.v,tf:i.z,path:n+a}))}}if(s)return s}}},"se");function eo(e,t){let r=ei(e.trim(),J,{path:""});if(r){var n;if("."===r.sep&&3===r.path.length)return null;let e=+(null!==(n=r.year)&&void 0!==n?n:er);if(r.day||(r.day=1),!function(e,t,r){if(r<1||t<1||t>12)return!1;if(2===t){if(r>(e%4==0&&e%100!=0||e%400==0||1900===e?29:28))return!1}else if((4===t||6===t||9===t||11===t)&&r>30||(1===t||3===t||5===t||7===t||8===t||10===t||12===t)&&r>31)return!1;return!0}(e,r.month,r.day))return null;let i=-1/0;if(e<1900)return null;e<=1900&&r.month<=2?i=25568:e<1e4&&(i=25569);let o=Date.UTC(e,r.month-1,r.day)/864e5+i+(r.time||0);if(o>=0&&o<=2958465){let e="0"===r._mon[0]||"0"===r.day[0]||2===r._mon.length&&2===r.day.length,n=r.path.replace(/[jdlDnmMFyYx-]/g,t=>"j"===t||"d"===t?e?"dd":"d":"D"===t?"ddd":"l"===t?"dddd":"n"===t||"m"===t?e?"mm":"m":"M"===t?"mmm":"F"===t?"mmmm":"y"===t?"yy":"x"===t?r.tf||"":"Y"===t?"yyyy":t);return t&&t.nativeDate?{v:P(o,t),z:n}:{v:o,z:n}}}return null}function es(e){let t=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(e);if(t){let[,e,r,n,i,o]=t;if(i&&!n||!o&&!r&&!n)return null;let s=1*(e||0);if(o){if(s>=13)return null;"p"!==o[0]&&"P"!==o[0]||(s+=12)}return{v:(60*s*60+1*(r||0)*60+1*(n||0)+1*(i||0))/86400,z:(2===e.length?"hh":"h")+":mm"+(n?":ss":"")+(o?" AM/PM":"")}}return null}function ea(e){return/^\s*true\s*$/i.test(e)?{v:!0}:/^\s*false\s*$/i.test(e)?{v:!1}:null}e7(eo,"oe"),e7(es,"le"),e7(ea,"de");let el={};function eu(e,t){let{pattern:r,partitions:n,locale:i}=e,o=/* @__PURE__ */e7(e=>{let r=Object.assign({},m(),t,e);return i&&(r.locale=i),r},"i"),s=/* @__PURE__ */e7((e,t)=>{let r=o(t);return function(e,t,r){let n=l(r.locale),i=t[3]?t[3]:X;if("boolean"==typeof e&&(e=e?"TRUE":"FALSE"),null==e)return"";if("number"!=typeof e)return Y(e,i,r,n);if(!isFinite(e)){let t=n||h;return isNaN(e)?t.nan:(e<0?t.negative:"")+t.infinity}let o=K(e,t);return o?Y(e,o,r,n):r.overflow}(U(e,r),n,r)},"s");s.color=(e,t)=>(function(e,t){if("number"!=typeof e||!isFinite(e))return(t[3]?t[3].color:X.color)||q;let r=K(e,t);return r&&r.color||q})(U(e,o(t)),n);let a=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,[n,i]=e,o=n.frac_max,s={type:"general",isDate:F(e),isText:j(e),isPercent:k(e),maxDecimals:n.general?9:o,scale:null!==(t=n.scale)&&void 0!==t?t:1,color:0,parentheses:0,grouped:n.grouping?1:0,_partitions:e},a=!s.isDate&&!s.isText&&!n.error&&n.tokens.some(e=>"string"===e.type&&(r?e.value===r:b.test(e.value))),l="G",u=o>=0?Math.min(15,o):"",c="",h="";if(i&&i.color&&(h="-",s.color=1),n.parens&&(c="()",s.parentheses=1),a)l="C",s.type="currency";else if(n.error)s.type="error",s.maxDecimals=0;else if(s.isDate){let e=0,t=0,r="";n.tokens.forEach(n=>{let i=n.type;/^(b-)?year/.test(i)?(r+="Y",t++):i.startsWith("month")?(r+="M",t++):/^(week)?day/.test(i)?(r+="D",t++):"hour"!==i&&"min"!==i&&"sec"!==i&&"am"!==i||(r+=i[0],e++)}),s.type="date",t&&e?s.type="datetime":!t&&e&&(s.type="time");let i=H.find(e=>r.startsWith(e[0]));l=i?"D":"G",u=i?i[1]:""}else s.isText?(l="G",s.type="text",u="",s.maxDecimals=0):n.general?(l="G",s.type="general",u=""):n.fractions?(l="G",s.type="fraction",u=""):n.exponential?(l="S",s.type="scientific"):s.isPercent?(l="P",s.type="percent"):n.grouping?(l=",",s.type="grouped"):(n.int_max||o)&&(l="F",s.type="number");return s.code=l+u+h+c,s.level=B[s.type],Object.freeze(s)}(n,(t||{}).currency)||SyntaxError();return s.info=a,s.dateInfo=function(e){let[t]=e;return{year:!!(2&t.date),month:!!(4&t.date),day:!!(8&t.date),hours:!!(16&t.date),minutes:!!(32&t.date),seconds:!!(64&t.date),clockType:12===t.clock?12:24}}(n),s.isPercent=()=>!!a.isPercent,s.isDate=()=>!!a.isDate,s.isText=()=>!!a.isText,s.pattern=r,e.error&&(s.error=e.error),s.options=o,s.locale=i||t&&t.locale||"",Object.freeze(s)}function ec(e,t){e||(e="General");let r=null;return el[e]?r=el[e]:(r=Object.assign({},m(),t).throws?O(e):function(e){try{return O(e)}catch(r){let t={tokens:[{type:"error"}],error:r.message};return{pattern:e,partitions:[t,t,t,t],error:r.message,locale:null}}}(e)).error||(el[e]=r),eu(r,t)}e7(eu,"ue"),e7(ec,"ce"),ec.isDate=e=>ec(e,{throws:!1}).isDate(),ec.isPercent=e=>ec(e,{throws:!1}).isPercent(),ec.isText=e=>ec(e,{throws:!1}).isText(),ec.getInfo=(e,t)=>ec(e,{...t,throws:!1}).info,ec.getDateInfo=(e,t)=>ec(e,{...t,throws:!1}).dateInfo,ec.dateToSerial=U,ec.dateFromSerial=P,ec.options=m,ec.dec2frac=p,ec.round=d,ec.codeToLocale=r,ec.parseLocale=s,ec.getLocale=l,ec.addLocale=(e,t)=>{let r=s(t);return delete el[r.lang],delete el[r.language],c(e,r)},ec.format=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r&&"object"==typeof r?r:{locale:r,throws:!n};return ec(e,i)(U(t,i),i)},ec.is_date=ec.isDate,ec.parseNumber=en,ec.parseDate=eo,ec.parseTime=es,ec.parseBool=ea,ec.parseValue=function(e,t){var r,n,i;return null!==(r=null!==(n=null!==(i=en(e))&&void 0!==i?i:eo(e,t))&&void 0!==n?n:es(e))&&void 0!==r?r:ea(e)};var eh=ec;return t.default}()},lE.exports=uT();let lv=/* @__PURE__ */ly(lE.exports);function lb(e){let t=0;for(let r of Object.keys(e))t=Math.max(t,Number(r));return t+1}function lR(e,t,r){let n=lb(r);for(let t=n-1;t>=e;t--)r[t+1]=r[t];r[e]=t}function lT(e,t,r){let n=Object.keys(r).reduce((e,t)=>Math.max(e,Number.parseInt(t)),0)+1;for(let i=e;i<n;i++)i<e+t?delete r[i]:void 0!==r[i]&&(r[i-t]=r[i],delete r[i])}function lI(e,t){let r=Object.keys(e),n=r.length,i=Object.keys(t),o=i.length,s={},a=0;for(let t=0;t<n;t++,a++){let n=r[t];s[a]=e[n]}for(let e=0;e<o;e++,a++){let r=i[e];s[a]=t[r]}return s}function lC(e,t,r){if(lb(r)>0){let n={},i=0;for(let o=e;o<=t;o++)r[o]&&(n[i]=r[o],i++);return n}return{}}function lS(e,t,r,n){let i=e>r;if(!i&&e+t>r)throw Error("Invalid move operation");i?lx(e,t,r,n):lO(e,t,r,n)}function lx(e,t,r,n){let i=[];for(let r=e;r<e+t;r++)i.push(n[r]);for(let i=e-1;i>=r;i--){let e=n[i];n[i+t]=e,void 0===e&&delete n[i+t]}i.forEach((e,t)=>{n[r+t]=e,void 0===e&&delete n[r+t]})}function lO(e,t,r,n){let i=[];for(let r=e;r<e+t;r++)i.push(n[r]);for(let i=e+t;i<r;i++){let e=n[i];n[i-t]=e,void 0===e&&delete n[i-t]}i.forEach((e,i)=>{n[r+i-t]=e,void 0===e&&delete n[r+i-t]})}e7(lb,"getArrayLength"),e7(lR,"insertMatrixArray"),e7(lT,"spliceArray"),e7(lI,"concatMatrixArray"),e7(lC,"sliceMatrixArray"),e7(lS,"moveMatrixArray"),e7(lx,"_moveBackward"),e7(lO,"_moveForward");let lA=class e{constructor(e={}){te(this,"_matrix"),this._setOriginValue(e)}static MakeObjectMatrixSize(t){return new e({[t-1]:{}})}getMatrix(){return this._matrix}forEach(e){let t=this._matrix;for(let r of Object.keys(t)){let n=Number(r),i=t[n];if(!1===e(n,i))break}return this}forRow(e){let t=this._matrix;for(let r of Object.keys(t)){let n=Number(r),i=t[n];if(!1===e(n,Object.keys(i).map(e=>Number(e))))break}return this}forValue(e){let t=this._matrix;for(let r of Object.keys(t)){let n=Number(r),i=t[n];if(i){for(let t of Object.keys(i))if(!1===e(n,Number(t),i[Number(t)]))return this}}return this}swapRow(e,t){let r=this._matrix[e],n=this._matrix[t];this._matrix[e]=n,this._matrix[t]=r}getRow(e){return this._matrix[e]}getRowOrCreate(e){let t=this.getRow(e);return null==t&&(t={},this._matrix[e]=t),t}reset(){this._setOriginValue({})}hasValue(){let e=this._matrix,t=Object.keys(e);if(0===t.length)return!1;for(let r of t)if(Object.keys(e[Number(r)]).length>0)return!0;return!1}getValue(e,t){var r,n;return null==(n=null==(r=this._matrix)?void 0:r[e])?void 0:n[t]}setValue(e,t,r){this.getRowOrCreate(e)[t]=r}deleteValue(e,t){var r,n;null==(n=null==(r=this._matrix)?void 0:r[e])||delete n[t]}realDeleteValue(e,t){var r,n,i;if(null==(n=null==(r=this._matrix)?void 0:r[e])||delete n[t],this.getRow(e)){let t=this.getRow(e);if(null==t)return;0===Object.keys(t).length&&(null==(i=this._matrix)||delete i[e])}}setRow(e,t){this._matrix[e]=t}moveRows(e,t,r){lS(e,t,r,this._matrix)}moveColumns(e,t,r){this.forEach((n,i)=>{lS(e,t,r,i)})}insertRows(e,t){for(let r=e;r<e+t;r++)lR(r,{},this._matrix)}insertColumns(e,t){for(let r=e;r<e+t;r++)this.forEach((e,t)=>{t&&lR(r,void 0,t)})}removeRows(e,t){lT(e,t,this._matrix)}removeColumns(e,t){this.forEach((r,n)=>{n&&lT(e,t,n)})}getFragment(t,r,n,i){let o=new e,s=0;for(let e=t;e<=r;e++){let t={},r=0;for(let o=n;o<=i;o++){let n=this.getValue(e,o);t[r]=n,r++}o.setRow(s,t),s++}return o}getSlice(t,r,n,i){let o=new e;for(let e=t;e<=r;e++)for(let t=n;t<=i;t++){let r=this.getValue(e,t);r&&o.setValue(e,t,ai.deepClone(r))}return o}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return lb(this._matrix)}getRange(){let e=this.getLength()-1,t=0,r=this.getLength();for(let e=0;e<r;e++){let r=this.getRow(e);if(r){let e=lb(r)-1;t=e>t?e:t}}return{startRow:0,startColumn:0,endRow:e,endColumn:t}}toNativeArray(){let e=[];return this.forValue((t,r,n)=>{e.push(n)}),e}toArray(){let e=[];return this.forRow((t,r)=>{null==e[t]&&(e[t]=[]),r.forEach(r=>{e[t][r]=this.getValue(t,r)})}),e}toFullArray(){let{endColumn:e,endRow:t}=this.getRange(),r=[];for(let n=0;n<=t;n++){let t=Array(e+1).fill(void 0);r.push(t)}return this.forValue((e,t,n)=>{r[e][t]=n}),r}toJSON(){return this._matrix}clone(){return JSON.parse(JSON.stringify(this._matrix))}getData(){return JSON.parse(JSON.stringify(this._matrix))}getArrayData(){let t=0,r=0,n=!1,i=!1,o=new e;return this.forEach((e,s)=>{n||(n=!0,t=e),Object.keys(s).forEach(n=>{let s=Number(n);i?s<r&&(r=s):(i=!0,r=s);let a=this.getValue(e,s);o.setValue(e-t,s-r,a)})}),o.getData()}getStartEndScope(){let e=1/0,t=-1/0,r=1/0,n=-1/0,i=Object.keys(this._matrix);for(let o of(i.length>0&&(e=+i[0],t=+i[i.length-1]),i)){let e=Object.keys(this._matrix[o]);e.length>0&&(r=Math.min(r,+e[0]),n=Math.max(n,+e[e.length-1]))}return{startRow:e,endRow:t,startColumn:r,endColumn:n}}getDataRange(){let e=0,t=0,r=0,n=-1,i=!1,o=!1;return this.forEach((s,a)=>{if(i||(i=!0,e=s),null==a)return;let l=lb(a)-1;l>r&&(r=l),Object.keys(a).forEach(e=>{let r=Number(e);o?r<t&&(t=r):(o=!0,t=r)}),s>n&&(n=s)}),{startRow:e,startColumn:t,endRow:n,endColumn:r}}getDiscreteRanges(){let e=[];return this.forEach((t,r)=>{Object.keys(r).forEach(r=>{let n=Number(r),i=!1;for(let r of e)if(t>=r.startRow&&t<=r.endRow+1&&n>=r.startColumn&&n<=r.endColumn+1){r.endRow=Math.max(t,r.endRow),r.endColumn=Math.max(n,r.endColumn),i=!0;break}i||e.push({startRow:t,endRow:t,startColumn:n,endColumn:n})})}),e}merge(e){this.forValue((t,r)=>{let n=e.getValue(t,r);null!=n&&this.setValue(t,r,n)})}_setOriginValue(e={}){this._matrix=e}};e7(lA,"ObjectMatrix");let lw=lA,lN={ff:"Arial",fs:11,it:sY.FALSE,bl:sY.FALSE,ul:{s:sY.FALSE},st:{s:sY.FALSE},ol:{s:sY.FALSE},tr:{a:0,v:sY.FALSE},td:sj.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:sH.UNSPECIFIED,vt:sV.UNSPECIFIED,tb:s$.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null},lD={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};var lL=((W=lL||{}).ARRAY_CONVERTOR="ARRAY_CONVERTOR",W.MATRIX_CONVERTOR="MATRIX_CONVERTOR",W);function lM(e,t){let{textRuns:r=[]}=t,n=0;for(let t of r){let{ts:r={},st:i,ed:o}=t;if(null==r[e])return sY.FALSE;switch(e){case"bl":case"it":if(r[e]===sY.FALSE)return sY.FALSE;break;case"ul":case"st":if(r[e].s===sY.FALSE)return sY.FALSE;break;default:throw Error(`unknown style key: ${e} in IStyleBase`)}n+=o-i}return t.dataStream.indexOf(`\r
`)===n?sY.TRUE:sY.FALSE}e7(lM,"isAllFormatInTextRuns");let lU=class e{constructor(e,t,r){te(this,"_range"),te(this,"_worksheet"),this._deps=r,this._range=t,this._worksheet=e}static foreach(e,t){let{startRow:r,startColumn:n,endRow:i,endColumn:o}=e;for(let e=r;e<=i;e++)for(let r=n;r<=o;r++)t(e,r)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){let{startRow:e,endRow:t,startColumn:r,endColumn:n}=this._range,i=[];for(let o=e;o<=t;o++){let e=[];for(let t=r;t<=n;t++)e.push(this.getMatrix().getValue(o,t)||null);i.push(e)}return i}getMatrix(){let{startRow:e,endRow:t,startColumn:r,endColumn:n}=this._range,i=this._worksheet.getCellMatrix(),o=new lw;for(let s=e;s<=t;s++)for(let e=r;e<=n;e++)o.setValue(s,e,i.getValue(s,e)||null);return o}getMatrixObject(){let{startRow:e,endRow:t,startColumn:r,endColumn:n}=this._range,i=this._worksheet.getCellMatrix(),o=new lw;for(let s=e;s<=t;s++)for(let t=r;t<=n;t++)o.setValue(s-e,t-r,i.getValue(s,t)||{});return o}getA1Notation(){let e,t;let{startRow:r,endRow:n,startColumn:i,endColumn:o}=this._range;return i<o?(e=ai.numToWord(i+1)+(r+1),t=ai.numToWord(o+1)+(n+1)):(e=ai.numToWord(o+1)+(n+1),t=ai.numToWord(i+1)+(r+1)),e===t?`${e}`:`${e}:${t}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){let e=this._deps.getStyles();return this.getValues().map(t=>t.map(t=>{var r;let n=e.getStyleByCell(t);return(null==(r=null==n?void 0:n.bg)?void 0:r.rgb)||lN.bg.rgb}))}getCell(t,r){let{startRow:n,startColumn:i}=this._range;return new e(this._worksheet,{startRow:n+t,endRow:n+t,startColumn:i+r,endColumn:i+r},this._deps)}getColumn(){return this._range.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){var t;let{startRow:r,endRow:n,startColumn:i,endColumn:o}=this._range,s=this._worksheet.getCellMatrix().getFragment(r,n,i,o).getData();if(e.isIncludeStyle){let e=this._deps.getStyles();for(let a=0;a<=n-r;a++)for(let r=0;r<=o-i;r++){if(null==s||(null==(t=null==s?void 0:s[a])?void 0:t[r])==null)continue;let n=s[a][r].s;n&&(s[a][r].s=e.get(n))}}return s}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){let e=this._deps.getStyles();return this.getValues().map(t=>t.map(t=>{var r;let n=e.getStyleByCell(t);return(null==(r=null==n?void 0:n.cl)?void 0:r.rgb)||lN.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?lM("ul",r.body)===sY.TRUE?{s:sY.TRUE}:{s:sY.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?lM("st",r.body)===sY.TRUE?{s:sY.TRUE}:{s:sY.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var e,t;let r=(null==(e=this.getValue())?void 0:e.p)||{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0&&r.body.textRuns.some(e=>{var t;return(null==(t=null==e?void 0:e.ts)?void 0:t.fs)!=null})?Math.max(...r.body.textRuns.map(e=>{var t;return(null==(t=null==e?void 0:e.ts)?void 0:t.fs)||0})):this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?lM("it",r.body)===sY.TRUE?sG.ITALIC:sG.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var e,t;let{p:r}=null!=(e=this.getValue())?e:{};return r&&Array.isArray(null==(t=r.body)?void 0:t.textRuns)&&r.body.textRuns.length>0?lM("bl",r.body)===sY.TRUE?sW.BOLD:sW.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){let{_range:e,_worksheet:t}=this,{startRow:r,endRow:n}=e,i=0;for(let e=0;e<=n-r;e++)i+=t.getRowHeight(e);return i}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){let{startColumn:e,endColumn:t}=this._range;return t-e+1}getNumRows(){let{startRow:e,endRow:t}=this._range;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(e=>(null==e?void 0:e.p)||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){let e=this._deps.getStyles();return this.getValues().map(t=>t.map(t=>e.getStyleByCell(t)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){let{_range:e,_worksheet:t}=this,{startColumn:r,endColumn:n}=e,i=0;for(let e=0;e<=n-r;e++)i+=t.getColumnWidth(e);return i}getWrap(){return this.getWrapStrategy()===s$.WRAP?sY.TRUE:sY.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(t){e.foreach(this._range,t)}_getStyles(e){let t=this._deps.getStyles();return this.getValues().map(r=>r.map(r=>{let n=t&&t.getStyleByCell(r);return n&&n[e]||lN[e]}))}};e7(lU,"Range"),te(lU,"transformRange",/* @__PURE__ */e7((e,t)=>{let r=t.getMaxColumns()-1,n=t.getMaxRows()-1;return e.rangeType===a$.ALL?{startColumn:0,startRow:0,endColumn:r,endRow:n}:e.rangeType===a$.COLUMN?{startRow:0,endRow:n,startColumn:e.startColumn,endColumn:e.endColumn}:e.rangeType===a$.ROW?{startColumn:0,endColumn:r,startRow:e.startRow,endRow:e.endRow}:{startColumn:e.startColumn,endColumn:Math.min(e.endColumn,r),startRow:e.startRow,endRow:Math.min(e.endRow,n)}},"transformRange"));let lP=lU;function lk(e,t,r,n=!1){if(0===t&&0===r)return e;let i={...e},o=i.startAbsoluteRefType||aG.NONE,s=i.endAbsoluteRefType||aG.NONE,a=i.rangeType||a$.NORMAL;if(!n&&o===aG.ALL&&s===aG.ALL)return i;let l=lF(i.startRow,r,i.startColumn,t,a),u=lF(i.endRow,r,i.endColumn,t,a);return n||o===aG.NONE&&s===aG.NONE?i={...i,startRow:l.row,startColumn:l.column,endRow:u.row,endColumn:u.column}:(o===aG.NONE?i={...i,startRow:l.row,startColumn:l.column}:o===aG.COLUMN?i={...i,startRow:l.row}:o===aG.ROW&&(i={...i,startColumn:l.column}),s===aG.NONE?i={...i,endRow:u.row,endColumn:u.column}:s===aG.COLUMN?i={...i,endRow:u.row}:s===aG.ROW&&(i={...i,endColumn:u.column}),i)}function lF(e,t,r,n,i){return i===a$.NORMAL?{row:e+t,column:r+n}:i===a$.ROW?{row:e+t,column:r}:i===a$.COLUMN?{row:e,column:r+n}:{row:e,column:r}}function lj(e){let t=/* @__PURE__ */new Set,r=/* @__PURE__ */new Set;for(let n of e)t.add(n.startColumn),t.add(n.endColumn+1),r.add(n.startRow),r.add(n.endRow+1);let n=Array.from(t).sort((e,t)=>e-t),i=Array.from(r).sort((e,t)=>e-t);e.sort((e,t)=>e.startRow-t.startRow||e.startColumn-t.startColumn);let o=[];for(let t=0;t<i.length-1;t++)for(let r=0;r<n.length-1;r++){let s=n[r],a=n[r+1]-1,l=i[t],u=i[t+1]-1;for(let t of e){if(t.startRow>u)break;if(t.startRow<=l&&t.endRow>=u&&t.startColumn<=s&&t.endColumn>=a){o.push({startColumn:s,endColumn:a,startRow:l,endRow:u});break}}}return o}function lB(e){e.sort((e,t)=>e.startRow-t.startRow||e.startColumn-t.startColumn);let t={};for(let r of e)t[r.startRow]||(t[r.startRow]=[]),t[r.startRow].push(r);let r=[];for(let e in t){let n=t[+e];n.sort((e,t)=>e.startColumn-t.startColumn);let i=n[0];for(let e=1;e<n.length;e++){let t=n[e];t.startColumn<=i.endColumn+1&&t.startRow===i.startRow&&t.endRow===i.endRow?i.endColumn=Math.max(i.endColumn,t.endColumn):(r.push(i),i=t)}r.push(i)}return r}function lH(e){e.sort((e,t)=>e.startColumn-t.startColumn||e.startRow-t.startRow);let t={};for(let r of e)t[r.startColumn]||(t[r.startColumn]=[]),t[r.startColumn].push(r);let r=[];for(let e in t){let n=t[+e];n.sort((e,t)=>e.startRow-t.startRow);let i=n[0];for(let e=1;e<n.length;e++){let t=n[e];t.startRow<=i.endRow+1&&t.startColumn===i.startColumn&&t.endColumn===i.endColumn?i.endRow=Math.max(i.endRow,t.endRow):(r.push(i),i=t)}r.push(i)}return r}function lV(e){return lH(lB(lj(e)))}function l$(e,t){let r=[];return e.forEach(e=>{r.push(...lX.subtract(e,t))}),lX.mergeRanges(r)}function lG(e,t){let r=lW(e.startRow,e.endRow,t.startRow,t.endRow),n=lW(e.startColumn,e.endColumn,t.startColumn,t.endColumn);if(!r||!n)return null;let[i,o]=r,[s,a]=n,l=lz(e.rangeType,t.rangeType,i,o,s,a);return{startRow:i,endRow:o,startColumn:s,endColumn:a,rangeType:l}}function lW(e,t,r,n){let i=isNaN(e)?-1/0:e,o=isNaN(t)?1/0:t,s=isNaN(r)?-1/0:r,a=isNaN(n)?1/0:n,l=Math.max(i,s),u=Math.min(o,a);return l<=u?[l===-1/0?Number.NaN:l,u===1/0?Number.NaN:u]:null}function lz(e,t,r,n,i,o){let s=void 0!==e?e:lY(r,n,i,o),a=void 0!==t?t:lY(r,n,i,o);return s===a$.ALL||a===a$.ALL?s===a?s:s===a$.ALL?a:s:s===a?s:(s===a$.NORMAL||a$.NORMAL,a$.NORMAL)}function lY(e,t,r,n){let i=!isNaN(e)&&!isNaN(t),o=!isNaN(r)&&!isNaN(n);return i&&o?a$.NORMAL:i?a$.ROW:o?a$.COLUMN:a$.ALL}e7(lk,"moveRangeByOffset"),e7(lF,"moveRangeByRangeType"),e7(lj,"splitIntoGrid"),e7(lB,"mergeHorizontalRanges"),e7(lH,"mergeVerticalRanges"),e7(lV,"mergeRanges$1"),e7(l$,"multiSubtractSingleRange"),e7(lG,"getIntersectRange"),e7(lW,"getOverlap1D"),e7(lz,"determineRangeType"),e7(lY,"inferRangeType");let lK=class e{static clone(e){return void 0!==e.rangeType?{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}static equals(e,t){return null!=e&&null!=t&&e.endRow===t.endRow&&e.endColumn===t.endColumn&&e.startRow===t.startRow&&e.startColumn===t.startColumn&&(e.rangeType===t.rangeType||void 0===e.rangeType&&t.rangeType===a$.NORMAL||void 0===t.rangeType&&e.rangeType===a$.NORMAL)}static simpleRangesIntersect(e,t){let{startRow:r,endRow:n,startColumn:i,endColumn:o}=e,{startRow:s,endRow:a,startColumn:l,endColumn:u}=t;return r<=a&&n>=s&&i<=u&&o>=l}static intersects(e,t){if(e.rangeType===a$.ROW&&t.rangeType===a$.COLUMN||e.rangeType===a$.COLUMN&&t.rangeType===a$.ROW)return!0;if(e.rangeType===a$.ROW&&t.rangeType===a$.ROW)return e.startRow<=t.endRow&&e.endRow>=t.startRow;if(e.rangeType===a$.COLUMN&&t.rangeType===a$.COLUMN)return e.startColumn<=t.endColumn&&e.endColumn>=t.startColumn;let r=Math.floor(Number.MAX_SAFE_INTEGER/10),n=Number.isNaN(e.startRow)?0:e.startRow,i=Number.isNaN(e.endRow)?r:e.endRow,o=Number.isNaN(e.startColumn)?0:e.startColumn,s=Number.isNaN(e.endColumn)?r:e.endColumn,a=Number.isNaN(t.startRow)?0:t.startRow,l=Number.isNaN(t.endRow)?r:t.endRow,u=Number.isNaN(t.startColumn)?0:t.startColumn,c=Number.isNaN(t.endColumn)?r:t.endColumn,h=Math.abs(n+i-a-l),d=Math.abs(n-i)+Math.abs(a-l);return Math.abs(o+s-u-c)<=Math.abs(o-s)+Math.abs(u-c)&&h<=d}static getIntersects(e,t){let r,n,i;let o=e.startRow,s=e.endRow,a=e.startColumn,l=e.endColumn,u=t.startRow,c=t.endRow,h=t.startColumn,d=t.endColumn;return u<=s&&(n=u>=o?u:o,c>=o&&(i=c>=s?s:c,h<=l&&(r=h>a?h:a,d>=a)))?{startRow:n,endRow:i,startColumn:r,endColumn:d>=l?l:d,rangeType:a$.NORMAL}:null}static contains(e,t){return e.startRow<=t.startRow&&e.endRow>=t.endRow&&e.startColumn<=t.startColumn&&e.endColumn>=t.endColumn}static realContain(t,r){return e.contains(t,r)&&(t.startRow<r.startRow||t.endRow>r.endRow||t.startColumn<r.startColumn||t.endColumn>r.endColumn)}static union(...e){return e.reduce((e,t)=>({startRow:Math.min(e.startRow,t.startRow),startColumn:Math.min(e.startColumn,t.startColumn),endRow:Math.max(e.endRow,t.endRow),endColumn:Math.max(e.endColumn,t.endColumn),rangeType:a$.NORMAL}),e[0])}static realUnion(...t){let r=t.some(e=>e.rangeType===a$.COLUMN),n=t.some(e=>e.rangeType===a$.ROW),i=e.union(...t);return{startColumn:n?Number.NaN:i.startColumn,endColumn:n?Number.NaN:i.endColumn,startRow:r?Number.NaN:i.startRow,endRow:r?Number.NaN:i.endRow,rangeType:n?a$.ROW:r?a$.COLUMN:a$.NORMAL}}static subtract(e,t){if(t.startRow>e.endRow||t.endRow<e.startRow||t.startColumn>e.endColumn||t.endColumn<e.startColumn)return[e];let r=[];t.startRow>=e.startRow&&r.push({startRow:e.startRow,startColumn:e.startColumn,endRow:t.startRow-1,endColumn:e.endColumn}),t.endRow<=e.endRow&&r.push({startRow:t.endRow+1,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn});let n=Math.max(e.startRow,t.startRow),i=Math.min(e.endRow,t.endRow);return t.startColumn>=e.startColumn&&r.push({startRow:n,startColumn:e.startColumn,endRow:i,endColumn:t.startColumn-1}),t.endColumn<=e.endColumn&&r.push({startRow:n,startColumn:t.endColumn+1,endRow:i,endColumn:e.endColumn}),r.filter(e=>e.startRow<=e.endRow&&e.startColumn<=e.endColumn)}static mergeRanges(e){return lV(e)}static subtractMulti(e,t){if(!t.length)return e;let r=e;return t.forEach(e=>{r=l$(r,e)}),r}static hasIntersectionBetweenTwoRect(e,t){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}static getIntersectionBetweenTwoRect(e,t){let r=Math.max(e.left,t.left),n=Math.min(e.right,t.right),i=Math.max(e.top,t.top),o=Math.min(e.bottom,t.bottom);return n<=r||o<=i?null:{left:r,right:n,top:i,bottom:o,width:n-r,height:o-i}}static sort(e){return e.sort((e,t)=>e.startRow-t.startRow||e.startColumn-t.startColumn)}};e7(lK,"Rectangle"),te(lK,"getRelativeRange",/* @__PURE__ */e7((e,t)=>({startRow:e.startRow-t.startRow,endRow:e.endRow-e.startRow,startColumn:e.startColumn-t.startColumn,endColumn:e.endColumn-e.startColumn}),"getRelativeRange")),te(lK,"getPositionRange",/* @__PURE__ */e7((e,t,r)=>({...r||{},startRow:r&&[aG.ROW,aG.ALL].includes(r.startAbsoluteRefType||0)?r.startRow:e.startRow+t.startRow,endRow:r&&[aG.ROW,aG.ALL].includes(r.endAbsoluteRefType||0)?r.endRow:e.endRow+e.startRow+t.startRow,startColumn:r&&[aG.COLUMN,aG.ALL].includes(r.startAbsoluteRefType||0)?r.startColumn:e.startColumn+t.startColumn,endColumn:r&&[aG.COLUMN,aG.ALL].includes(r.endAbsoluteRefType||0)?r.endColumn:e.endColumn+e.startColumn+t.startColumn}),"getPositionRange")),te(lK,"moveHorizontal",/* @__PURE__ */e7((e,t=0,r=0)=>({...e,startColumn:e.startColumn+t,endColumn:e.endColumn+t+r}),"moveHorizontal")),te(lK,"moveVertical",/* @__PURE__ */e7((e,t=0,r=0)=>({...e,startRow:e.startRow+t,endRow:e.endRow+t+r}),"moveVertical")),te(lK,"moveOffset",/* @__PURE__ */e7((e,t,r)=>({...e,startRow:e.startRow+r,endRow:e.endRow+r,startColumn:e.startColumn+t,endColumn:e.endColumn+t}),"moveOffset"));let lX=lK;function lq(e,t){if(0===e.length||0===e[0].length)return null;let r=Array(e[0].length).fill(0),n=0,i=null;for(let o=0;o<e.length;o++){for(let n=0;n<e[0].length;n++)r[n]=t(e[o][n])?r[n]+1:0;let s=lJ(r);s.area>n&&(n=s.area,i={startColumn:s.start,startRow:o-s.height+1,endColumn:s.end,endRow:o})}return i}function lJ(e){let t=[],r=0,n={area:0,height:0,start:0,end:0},i=0;for(;i<e.length;)if(0===t.length||e[i]>=e[t[t.length-1]])t.push(i++);else{let o=e[t.pop()],s=0===t.length?i:i-t[t.length-1]-1;o*s>r&&(n={area:r=o*s,height:o,start:0===t.length?0:t[t.length-1]+1,end:i-1})}for(;t.length>0;){let o=e[t.pop()],s=0===t.length?i:i-t[t.length-1]-1;o*s>r&&(n={area:r=o*s,height:o,start:0===t.length?0:t[t.length-1]+1,end:i-1})}return n}function lQ(e,t){lP.foreach(t,(t,r)=>{e[t][r]=void 0})}function lZ(e,t){let r=e.toFullArray(),n=[];for(;;){let e=lq(r,t);if(!e)break;n.push(e),lQ(r,e)}return n}function l0(e,t,r,n){return{forEach(i){for(let o=e;o<=t;o++)for(let e=r;e<=n;e++)i(o,e)}}}function l1(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function l2(e,t){let r="";for(;t>0;)r+=e,t--;return r}function l5(e,t=!1){let r=97;return t&&(r=65),l2(String.fromCharCode(e%26+r),Math.floor(e/26)+1)}function l3(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function l6(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}function l4(e="index",t=1){return(r,n)=>r[e]>n[e]?t:r[e]===n[e]?0:-t}e7(lq,"maximalRectangle"),e7(lJ,"largestRectangleArea"),e7(lQ,"resetMatrix"),e7(lZ,"queryObjectMatrix"),e7(class{constructor(e,t){te(this,"_values",[]),te(this,"_keys",[]),te(this,"_keyMaps",/* @__PURE__ */new Map),this._values=e,this._keys=t,e.forEach(e=>{this._initKeyMap(e)})}_initKeyMap(e){this._keys.forEach(t=>{let r=e[t],n=this._keyMaps.get(t)||/* @__PURE__ */new Map;n.set(r,e),this._keyMaps.set(t,n)})}getValue(e,t){let r=t||this._keys;for(let t=0;t<r.length;t++){let n=this._keyMaps.get(r[t]);if(null!=n&&n.has(e))return n.get(e)}return null}hasValue(e){for(let t=0;t<this._keys.length;t++){let r=this._keyMaps.get(this._keys[t]);if(null!=r&&r.has(e))return!0}return!1}addValue(e){this._values.push(e),this._initKeyMap(e)}setValue(e,t,r){let n=this.getValue(e);n&&Object.keys(n).includes(t)&&(n[t]=r)}deleteValue(e){let t=this.getValue(e);if(t){this._keys.forEach(e=>{let r=this._keyMaps.get(e),n=t[e];null==r||r.delete(n)});let e=this._values.findIndex(e=>e===t);this._values.splice(e,1)}}getValues(){return this._values}getKeyMap(e){var t;return[...(null==(t=this._keyMaps.get(e))?void 0:t.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}},"RefAlias"),e7(l0,"createRowColIter"),e7(function(e){if(null==e||0===e.length)return Number.NaN;let t=e.toLowerCase().split(""),r=t.length,n=/* @__PURE__ */e7(e=>e.charCodeAt(0)-96,"getCharNumber"),i=0;for(let e=0;e<r;e++)i+=n(t[e])*26**(r-e-1);return 0===i?Number.NaN:i-1},"ABCToNumber"),e7(l1,"numberToABC"),e7(l2,"repeatStringNumTimes"),e7(l5,"numberToListABC"),e7(l3,"sortRules"),e7(l6,"sortRulesByDesc"),e7(l4,"sortRulesFactory");var l9=((z=l9||{})[z.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",z[z.UNIVER_DOC=1]="UNIVER_DOC",z[z.UNIVER_SHEET=2]="UNIVER_SHEET",z[z.UNIVER_SLIDE=3]="UNIVER_SLIDE",z[z.UNIVER_PROJECT=4]="UNIVER_PROJECT",z[z.UNRECOGNIZED=-1]="UNRECOGNIZED",z),l8=((Y=l8||{})[Y.Reader=0]="Reader",Y[Y.Editor=1]="Editor",Y[Y.Owner=2]="Owner",Y[Y.UNRECOGNIZED=-1]="UNRECOGNIZED",Y),l7=((K=l7||{})[K.SomeCollaborator=0]="SomeCollaborator",K[K.AllCollaborator=1]="AllCollaborator",K[K.OneSelf=2]="OneSelf",K[K.UNRECOGNIZED=-1]="UNRECOGNIZED",K);let ue=class extends oZ{};e7(ue,"UnitModel");let ut=ue;function ur(e=ai.generateRandomId(6),t=sN.EN_US,r=""){return{id:e,locale:t,title:r,body:{dataStream:`\r
`,textRuns:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},marginTop:50,marginBottom:50,marginRight:40,marginLeft:40,renderConfig:{vertexAngle:0,centerAngle:0}},settings:{}}}e7(ur,"getEmptySnapshot$1");var un={},ui={},uo={};function us(e,t){if(Array.isArray(t))return!1;for(let r in e)if(!ul(e[r],t[r]))return!1;for(let r in t)if(void 0===e[r])return!1;return!0}function ua(e,t){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!ul(e[r],t[r]))return!1;return!0}function ul(e,t){return e===t||null!==e&&null!==t&&"object"==typeof e&&"object"==typeof t&&(Array.isArray(e)?ua(e,t):us(e,t))}Object.defineProperty(uo,"__esModule",{value:!0}),e7(us,"eqObj"),e7(ua,"eqArr"),e7(ul,"deepEqual"),uo.default=ul;var uu={};function uc(e){if(null===e)return null;if(Array.isArray(e))return e.map(uc);if("object"!=typeof e)return e;{let t={};for(let r in e)t[r]=uc(e[r]);return t}}Object.defineProperty(uu,"__esModule",{value:!0}),e7(uc,"deepClone"),uu.default=uc;var uh={};!function(e){function t(e,t){if(!e)throw Error(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.eachChildOf=e.advancer=e.readCursor=e.writeCursor=e.WriteCursor=e.ReadCursor=e.isValidPathItem=void 0,e7(t,"assert");let r=/* @__PURE__ */e7(e=>null!=e&&"object"==typeof e&&!Array.isArray(e),"isObject"),n=/* @__PURE__ */e7((e,t)=>typeof e==typeof t?e>t:"string"==typeof e&&"number"==typeof t,"isGreaterKey");function i(e,t){for(let r in e)t.write(r,e[r])}e7(i,"copyAll"),e.isValidPathItem=e=>"number"==typeof e||"string"==typeof e&&"__proto__"!==e;let o=class{constructor(e=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=e}ascend(){t(this.parents.length===this.indexes.length/2),0===this.idx?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(t(this.idx>0),this.idx--,r(this.container[this.idx])&&this.idx--)}getPath(){let e=[],t=this.container,n=this.parents.length-1,i=this.idx;for(;i>=0;)e.unshift(t[i]),0===i?(i=this.indexes[2*n],t=this.parents[n--]):i-=r(t[i-1])?2:1;return e}};e7(o,"Cursor");let s=o,a=class e extends s{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return t(null!=this.container,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let e;return this.container&&this.container.length>this.idx+1&&r(e=this.container[this.idx+1])?e:null}descendFirst(){let e=this.idx+1;if(!this.container||e>=this.container.length||r(this.container[e])&&e+1>=this.container.length)return!1;r(this.container[e])&&e++;let t=this.container[e];return Array.isArray(t)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(e),this.idx=0,this.container=t):this.idx=e,!0}nextSibling(){if(t(this.parents.length===this.indexes.length/2),this.idx>0||0===this.parents.length)return!1;let e=this.indexes[this.indexes.length-1]+1,r=this.parents[this.parents.length-1];return!(e>=r.length)&&(t(!isNaN(e)),this.indexes[this.indexes.length-1]=e,this.container=r[e],!0)}_init(e,t,r,n){this.container=e,this.idx=t,this.parents=r.slice(),this.indexes=n.slice()}clone(){let t=new e;return t._init(this.container,this.idx,this.parents,this.indexes),t}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling())this.ascend()}}traverse(e,t){let r=this.getComponent();for(let n of(r&&t(r,e),this))e&&e.descend(n),this.traverse(e,t),e&&e.ascend()}eachPick(e,t){this.traverse(e,(e,r)=>{null!=e.p&&t(e.p,r)})}eachDrop(e,t){this.traverse(e,(e,r)=>{null!=e.d&&t(e.d,r)})}};e7(a,"ReadCursor"),e.ReadCursor=a;let l=class extends s{constructor(e=null){super(e),this.pendingDescent=[],this._op=e}flushDescent(){t(this.parents.length===this.indexes.length/2),null===this.container&&(this._op=this.container=[]);for(let e=0;e<this.pendingDescent.length;e++){let i=this.pendingDescent[e],o=this.idx+1;if(o<this.container.length&&r(this.container[o])&&o++,t(o===this.container.length||!r(this.container[o])),o===this.container.length)this.container.push(i),this.idx=o;else if(this.container[o]===i)this.idx=o;else{if(!Array.isArray(this.container[o])){let e=this.container.splice(o,this.container.length-o);this.container.push(e),this.lcIdx>-1&&(this.lcIdx=o)}for(this.indexes.push(this.idx),this.parents.push(this.container),-1!==this.lcIdx&&(t(n(i,this.container[this.lcIdx][0])),o=this.lcIdx+1,this.lcIdx=-1);o<this.container.length&&n(i,this.container[o][0]);)o++;if(this.indexes.push(o),this.idx=0,o<this.container.length&&this.container[o][0]===i)this.container=this.container[o];else{let e=[i];this.container.splice(o,0,e),this.container=e}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();let e=this.idx+1;if(e<this.container.length&&r(this.container[e]))return this.container[e];{let t={};return this.container.splice(e,0,t),t}}write(e,r){let n=this.getComponent();t(null==n[e]||n[e]===r,"Internal consistency error: Overwritten component. File a bug"),n[e]=r}get(){return this._op}descend(t){if(!e.isValidPathItem(t))throw Error("Invalid JSON key");this.pendingDescent.push(t)}descendPath(e){return this.pendingDescent.push(...e),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(e,r=i){if(null===e)return;if(t(Array.isArray(e)),e===this._op)throw Error("Cannot merge into my own tree");let n=this.lcIdx,o=this.parents.length,s=0;for(let t=0;t<e.length;t++){let n=e[t];"string"==typeof n||"number"==typeof n?(s++,this.descend(n)):Array.isArray(n)?this.mergeTree(n,r):"object"==typeof n&&r(n,this)}for(;s--;)this.ascend();this.lcIdx=this.parents.length===o?n:-1}at(e,t){this.descendPath(e),t(this);for(let t=0;t<e.length;t++)this.ascend();return this}writeAtPath(e,t,r){return this.at(e,()=>this.write(t,r)),this.reset(),this}writeMove(e,t,r=0){return this.writeAtPath(e,"p",r).writeAtPath(t,"d",r)}getPath(){let e=super.getPath();return e.push(...this.pendingDescent),e}};function u(e,t,r){let i,o;function s(i){let s;for(;o;){let a=s=e.getKey();if(null!=i){let r=!1;if(t&&"number"==typeof a&&(s=t(a,e.getComponent()))<0&&(s=~s,r=!0),n(s,i))return null;if(s===i&&!r)return e}r&&"number"==typeof s&&r(s,e.getComponent()),o=e.nextSibling()}return null}return o=i=!!e&&e.descendFirst(),e7(s,"adv"),s.end=()=>{i&&e.ascend()},s}function c(e,t,r){let i,o,s,a;for(i=o=e&&e.descendFirst(),s=a=t&&t.descendFirst();i||s;){let o=i?e.getKey():null,a=s?t.getKey():null;null!==o&&null!==a&&(n(a,o)?a=null:o!==a&&(o=null)),r(null==o?a:o,null!=o?e:null,null!=a?t:null),null!=o&&i&&(i=e.nextSibling()),null!=a&&s&&(s=t.nextSibling())}o&&e.ascend(),a&&t.ascend()}e7(l,"WriteCursor"),e.WriteCursor=l,e.writeCursor=()=>new l,e.readCursor=e=>new a(e),e7(u,"advancer"),e.advancer=u,e7(c,"eachChildOf"),e.eachChildOf=c}(uh);var ud={};Object.defineProperty(ud,"__esModule",{value:!0}),ud.ConflictType=void 0,(uI=ud.ConflictType||(ud.ConflictType={}))[uI.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",uI[uI.DROP_COLLISION=2]="DROP_COLLISION",uI[uI.BLACKHOLE=3]="BLACKHOLE";var up,uf,ug,um,u_,uy,uE,uv,ub,uR,uT,uI,uC,uS,ux,uO,uA,uw={},uN={};function uD(){return uA||(uA=1,Object.defineProperty(uN,"__esModule",{value:!0}),uN.uniToStrPos=uN.strPosToUni=void 0,uN.strPosToUni=(e,t=e.length)=>{let r=0,n=0;for(;n<t;n++){let t=e.charCodeAt(n);t>=55296&&t<=57343&&(r++,n++)}if(n!==t)throw Error("Invalid offset - splits unicode bytes");return n-r},uN.uniToStrPos=(e,t)=>{let r=0;for(;t>0;t--){let t=e.charCodeAt(r);r+=t>=55296&&t<=57343?2:1}return r}),uN}e7(uD,"requireUnicount");var uL,uM={};function uU(){return uL||(uL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniSlice=e.dlen=e.eachOp=void 0;let t=uD(),r=/* @__PURE__ */e7(t=>{if(!Array.isArray(t))throw Error("Op must be an array of components");let r=null;for(let n=0;n<t.length;n++){let i=t[n];switch(typeof i){case"object":if("number"!=typeof i.d&&"string"!=typeof i.d)throw Error("Delete must be number or string");if(0>=e.dlen(i.d))throw Error("Deletes must not be empty");break;case"string":if(!(i.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(i>0))throw Error("Skip components must be >0");if("number"==typeof r)throw Error("Adjacent skip components should be combined")}r=i}if("number"==typeof r)throw Error("Op has a trailing skip")},"checkOp");function n(r,n){let i=0,o=0;for(let s=0;s<r.length;s++){let a=r[s];switch(n(a,i,o),typeof a){case"object":i+=e.dlen(a.d);break;case"string":o+=t.strPosToUni(a);break;case"number":i+=a,o+=a}}}function i(e,t){let r=[],i=a(r);return n(e,(e,r,n)=>{i(t(e,r,n))}),h(r)}e7(n,"eachOp"),e.eachOp=n,e7(i,"mapOp");let o=/* @__PURE__ */e7(e=>e,"id"),s=/* @__PURE__ */e7(e=>i(e,o),"normalize");e.dlen=e=>"number"==typeof e?e:t.strPosToUni(e);let a=/* @__PURE__ */e7(t=>r=>{if(!(!r||0===r.d||""===r.d)){if(0===t.length)t.push(r);else if(typeof r==typeof t[t.length-1]){if("object"==typeof r){let n=t[t.length-1];n.d="string"==typeof n.d&&"string"==typeof r.d?n.d+r.d:e.dlen(n.d)+e.dlen(r.d)}else t[t.length-1]+=r}else t.push(r)}},"makeAppend"),l=/* @__PURE__ */e7(e=>"number"==typeof e?e:"string"==typeof e?t.strPosToUni(e):"number"==typeof e.d?e.d:t.strPosToUni(e.d),"componentLength");e.uniSlice=(e,r,n)=>{let i=t.uniToStrPos(e,r),o=null==n?1/0:t.uniToStrPos(e,n);return e.slice(i,o)};let u=/* @__PURE__ */e7((t,r,n)=>"number"==typeof t?null==n?t-r:Math.min(t,n)-r:e.uniSlice(t,r,n),"dslice"),c=/* @__PURE__ */e7(r=>{let n=0,i=0;return{take:/* @__PURE__ */e7((o,s)=>{let a;if(n===r.length)return -1===o?null:o;let l=r[n];if("number"==typeof l)return -1===o||l-i<=o?(a=l-i,++n,i=0,a):(i+=o,o);if("string"==typeof l){if(-1===o||"i"===s||t.strPosToUni(l.slice(i))<=o)return a=l.slice(i),++n,i=0,a;{let e=i+t.uniToStrPos(l.slice(i),o);return a=l.slice(i,e),i=e,a}}if(-1===o||"d"===s||e.dlen(l.d)-i<=o)return a={d:u(l.d,i)},++n,i=0,a;{let e=u(l.d,i,i+o);return i+=o,{d:e}}},"take"),peek:/* @__PURE__ */e7(()=>r[n],"peek")}},"makeTake"),h=/* @__PURE__ */e7(e=>(e.length>0&&"number"==typeof e[e.length-1]&&e.pop(),e),"trim");function d(n,i,o){let s;if("left"!==o&&"right"!==o)throw Error("side ("+o+") must be 'left' or 'right'");r(n),r(i);let u=[],d=a(u),{take:p,peek:f}=c(n);for(let r=0;r<i.length;r++){let n,s;let a=i[r];switch(typeof a){case"number":for(n=a;n>0;)d(s=p(n,"i")),"string"!=typeof s&&(n-=l(s));break;case"string":"left"===o&&"string"==typeof f()&&d(p(-1)),d(t.strPosToUni(a));break;case"object":for(n=e.dlen(a.d);n>0;)switch(typeof(s=p(n,"i"))){case"number":n-=s;break;case"string":d(s);break;case"object":n-=e.dlen(s.d)}}}for(;s=p(-1);)d(s);return h(u)}function p(n,i){let o;r(n),r(i);let s=[],d=a(s),{take:p}=c(n);for(let r=0;r<i.length;r++){let n,o;let s=i[r];switch(typeof s){case"number":for(n=s;n>0;)d(o=p(n,"d")),"object"!=typeof o&&(n-=l(o));break;case"string":d(s);break;case"object":n=e.dlen(s.d);let a=0;for(;a<n;)switch(typeof(o=p(n-a,"d"))){case"number":d({d:u(s.d,a,a+o)}),a+=o;break;case"string":a+=t.strPosToUni(o);break;case"object":d(o)}}}for(;o=p(-1);)d(o);return h(s)}e7(d,"transform"),e7(p,"compose");let f=/* @__PURE__ */e7((r,n)=>{let i=0;for(let o=0;o<n.length&&r>i;o++){let s=n[o];switch(typeof s){case"number":i+=s;break;case"string":let a=t.strPosToUni(s);i+=a,r+=a;break;case"object":r-=Math.min(e.dlen(s.d),r-i)}}return r},"transformPosition"),g=/* @__PURE__ */e7((e,t)=>"number"==typeof e?f(e,t):e.map(e=>f(e,t)),"transformSelection");function m(e,t,r){return i(e,(e,n)=>"object"==typeof e&&"number"==typeof e.d?{d:r.slice(t,n,n+e.d)}:e)}function _(e){return i(e,e=>{switch(typeof e){case"object":if("number"==typeof e.d)throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return e.d;case"string":return{d:e};case"number":return e}})}function y(e){return i(e,e=>"object"==typeof e&&"string"==typeof e.d?{d:t.strPosToUni(e.d)}:e)}function E(e){let t=!0;return n(e,e=>{"object"==typeof e&&"number"==typeof e.d&&(t=!1)}),t}function v(t){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:h,normalize:s,checkOp:r,create(e=""){if("string"!=typeof e)throw Error("Initial data must be a string");return t.create(e)},apply(n,i){r(i);let o=t.builder(n);for(let t=0;t<i.length;t++){let r=i[t];switch(typeof r){case"number":o.skip(r);break;case"string":o.append(r);break;case"object":o.del(e.dlen(r.d))}}return o.build()},transform:d,compose:p,transformPosition:f,transformSelection:g,isInvertible:E,makeInvertible:(e,r)=>m(e,r,t),stripInvertible:y,invert:_,invertWithDoc:(e,r)=>_(m(e,r,t)),isNoop:/* @__PURE__ */e7(e=>0===e.length,"isNoop")}}e7(m,"makeInvertible"),e7(_,"invert"),e7(y,"stripInvertible"),e7(E,"isInvertible"),e7(v,"makeType"),e.default=v}(uM)),uM}e7(uU,"requireType");var uP,uk={};function uF(){if(uP)return uk;uP=1,Object.defineProperty(uk,"__esModule",{value:!0});let e=uU(),t=uD();function r(r,n){return{get:r,getLength:()=>r().length,insert:(e,i,o)=>n([t.strPosToUni(r(),e),i],o),remove:(e,i,o)=>n([t.strPosToUni(r(),e),{d:i}],o),_onOp(t){e.eachOp(t,(t,r,n)=>{switch(typeof t){case"string":this.onInsert&&this.onInsert(n,t);break;case"object":let i=e.dlen(t.d);this.onRemove&&this.onRemove(n,i)}})},onInsert:null,onRemove:null}}return e7(r,"api$1"),uk.default=r,r.provides={text:!0},uk}function uj(){return h5||(h5=1,function(e){var t=l_&&l_.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:/* @__PURE__ */e7(function(){return t[r]},"get")})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=l_&&l_.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=l_&&l_.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&t(n,e,i);return r(n,e),n},i=l_&&l_.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.remove=e.insert=void 0;let o=uD(),s=n(uU()),a=i(uF()),l={create:e=>e,toString:e=>e,builder(e){if("string"!=typeof e)throw Error("Invalid document snapshot: "+e);let t=[];return{skip(r){let n=o.uniToStrPos(e,r);if(n>e.length)throw Error("The op is too long for this document");t.push(e.slice(0,n)),e=e.slice(n)},append(e){t.push(e)},del(t){e=e.slice(o.uniToStrPos(e,t))},build:()=>t.join("")+e}},slice:s.uniSlice},u=Object.assign(Object.assign({},s.default(l)),{api:a.default});e.type=u,e.insert=(e,t)=>0===t.length?[]:0===e?[t]:[e,t],e.remove=(e,t)=>0===s.dlen(t)?[]:0===e?[{d:t}]:[e,{d:t}];var c=uU();Object.defineProperty(e,"makeType",{enumerable:!0,get:/* @__PURE__ */e7(function(){return c.default},"get")})}(uw)),uw}e7(uF,"requireApi"),e7(uj,"requireDist"),function(e){var t=l_&&l_.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.editOp=e.replaceOp=e.insertOp=e.moveOp=e.removeOp=e.type=void 0,t(uo);let r=t(uu);function n(e,t){if(!e)throw Error(t)}e7(n,"assert"),e.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:uh.readCursor,writeCursor:uh.writeCursor,create:/* @__PURE__ */e7(e=>e,"create"),isNoop:/* @__PURE__ */e7(e=>null==e,"isNoop"),setDebug(e){},registerSubtype:f,checkValidOp:R,normalize:T,apply:I,transformPosition:C,compose:S,tryTransform:D,transform:M,makeInvertible:A,invert:x,invertWithDoc:w,RM_UNEXPECTED_CONTENT:ud.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:ud.ConflictType.DROP_COLLISION,BLACKHOLE:ud.ConflictType.BLACKHOLE,transformNoConflict:/* @__PURE__ */e7((e,t,r)=>k(()=>!0,e,t,r),"transformNoConflict"),typeAllowingConflictsPred:/* @__PURE__ */e7(t=>Object.assign(Object.assign({},e.type),{transform:/* @__PURE__ */e7((e,r,n)=>k(t,e,r,n),"transform")}),"typeAllowingConflictsPred")};let i=/* @__PURE__ */e7(e=>e?e.getComponent():null,"getComponent");function o(e){return e&&"object"==typeof e&&!Array.isArray(e)}e7(o,"isObject");let s=/* @__PURE__ */e7(e=>Array.isArray(e)?e.slice():null!==e&&"object"==typeof e?Object.assign({},e):e,"shallowClone"),a=/* @__PURE__ */e7(e=>e&&(null!=e.p||void 0!==e.r),"hasPick"),l=/* @__PURE__ */e7(e=>e&&(null!=e.d||void 0!==e.i),"hasDrop");function u(e,t){return n(null!=e),"number"==typeof t?(n(Array.isArray(e),"Invalid key - child is not an array"),(e=e.slice()).splice(t,1)):(n(o(e),"Invalid key - child is not an object"),delete(e=Object.assign({},e))[t]),e}function c(e,t,r){return"number"==typeof t?(n(null!=e,"Container is missing for key"),n(Array.isArray(e),"Cannot use numerical key for object container"),n(e.length>=t,"Cannot insert into out of bounds index"),e.splice(t,0,r)):(n(o(e),"Cannot insert into missing item"),n(void 0===e[t],"Trying to overwrite value at key. Your op needs to remove it first"),e[t]=r),r}e7(u,"removeChild"),e7(c,"insertChildMut"),e.removeOp=(e,t=!0)=>uh.writeCursor().writeAtPath(e,"r",t).get(),e.moveOp=(e,t)=>uh.writeCursor().writeMove(e,t).get(),e.insertOp=(e,t)=>uh.writeCursor().writeAtPath(e,"i",t).get(),e.replaceOp=(e,t,r)=>uh.writeCursor().at(e,e=>{e.write("r",t),e.write("i",r)}).get(),e.editOp=(e,t,r,n=!1)=>uh.writeCursor().at(e,e=>E(e,t,r,n)).get();let h=/* @__PURE__ */e7((e,t)=>null!=e&&("number"==typeof t?Array.isArray(e):"object"==typeof e),"isValidKey"),d=/* @__PURE__ */e7((e,t)=>h(e,t)?e[t]:void 0,"maybeGetChild"),p={};function f(e){let t=e.type?e.type:e;t.name&&(p[t.name]=t),t.uri&&(p[t.uri]=t)}e7(f,"registerSubtype");let g=/* @__PURE__ */e7(e=>{let t=p[e];if(t)return t;throw Error("Missing type: "+e)},"typeOrThrow");f(uj());let m=/* @__PURE__ */e7((e,t)=>e+t,"add");f({name:"number",apply:m,compose:m,invert:/* @__PURE__ */e7(e=>-e,"invert"),transform:/* @__PURE__ */e7(e=>e,"transform")});let _=/* @__PURE__ */e7(e=>null==e?null:e.et?g(e.et):e.es?p["text-unicode"]:null!=e.ena?p.number:null,"getEditType"),y=/* @__PURE__ */e7(e=>e.es?e.es:null!=e.ena?e.ena:e.e,"getEdit"),E=/* @__PURE__ */e7((e,t,r,n=!1)=>{let[i,o]="string"==typeof t?[g(t),t]:[t,t.name];!n&&i.isNoop&&i.isNoop(r)||("number"===o?e.write("ena",r):"text-unicode"===o?e.write("es",r):(e.write("et",o),e.write("e",r)))},"writeEdit");function v(e){n("number"==typeof e),n(e>=0),n(e===(0|e))}function b(e){"number"==typeof e?v(e):n("string"==typeof e)}function R(e){if(null===e)return;let t=/* @__PURE__ */new Set,r=/* @__PURE__ */new Set,i=/* @__PURE__ */e7(e=>{let i=!0,o=!1;for(let s in e){let a=e[s];if(i=!1,n("p"===s||"r"===s||"d"===s||"i"===s||"e"===s||"es"===s||"ena"===s||"et"===s,"Invalid component item '"+s+"'"),"p"===s)v(a),n(!t.has(a)),t.add(a),n(void 0===e.r);else if("d"===s)v(a),n(!r.has(a)),r.add(a),n(void 0===e.i);else if("e"===s||"es"===s||"ena"===s){n(!o),o=!0;let t=_(e);n(t,"Missing type in edit"),t.checkValidOp&&t.checkValidOp(y(e))}}n(!i)},"checkComponent"),o=/* @__PURE__ */e7((e,t,r)=>{if(!Array.isArray(e))throw Error("Op must be null or a list");if(0===e.length)throw Error("Empty descent");t||b(e[0]);let s=1,a=0,l=0;for(let t=0;t<e.length;t++){let r=e[t];if(n(null!=r),Array.isArray(r)){let e=o(r,!1);if(a){let t=typeof l,r=typeof e;t===r?n(l<e,"descent keys are not in order"):n("number"===t&&"string"===r)}l=e,a++,s=3}else"object"==typeof r?(n(1===s,`Prev not scalar - instead ${s}`),i(r),s=2):(n(3!==s),b(r),n(uh.isValidPathItem(r),"Invalid path key"),s=1)}return n(1!==a,"Operation makes multiple descents. Remove some []"),n(2===s||3===s),e[0]},"checkDescent");o(e,!0),n(t.size===r.size,"Mismatched picks and drops in op");for(let e=0;e<t.size;e++)n(t.has(e)),n(r.has(e))}function T(e){let t=0,r=[],n=uh.writeCursor();return n.mergeTree(e,(e,n)=>{var i;let o=_(e);if(o){let t=y(e);E(n,o,o.normalize?o.normalize(t):t)}for(let o of["r","p","i","d"])if(void 0!==e[o]){let s="p"===o||"d"===o?(null==r[i=e[o]]&&(r[i]=t++),r[i]):e[o];n.write(o,s)}}),n.get()}function I(e,t){if(R(t),null===t)return e;let r=[];return /* @__PURE__ */e7(function e(t,i){let o=t,a=0,l={root:t},u=0,p=l,f="root";function g(){for(;u<a;u++){let e=i[u];"object"!=typeof e&&(n(h(p,f)),p=p[f]=s(p[f]),f=e)}}for(e7(g,"mut");a<i.length;a++){let t=i[a];if(Array.isArray(t)){let r=e(o,t);r!==o&&void 0!==r&&(g(),o=p[f]=r)}else if("object"==typeof t){null!=t.d?(g(),o=c(p,f,r[t.d])):void 0!==t.i&&(g(),o=c(p,f,t.i));let e=_(t);if(e)g(),o=p[f]=e.apply(o,y(t));else if(void 0!==t.e)throw Error("Subtype "+t.et+" undefined")}else o=d(o,t)}return l.root},"drop")(e=/* @__PURE__ */e7(function e(t,i){var o,l;let c=[],h=0;for(;h<i.length;h++){let e=i[h];if(Array.isArray(e))break;"object"!=typeof e&&(c.push(t),t=d(t,e))}for(let r=i.length-1;r>=h;r--)t=e(t,i[r]);for(--h;h>=0;h--){let e=i[h];if("object"!=typeof e){let r=c.pop();t=t===d(r,e)?r:void 0===t?u(r,e):(l=t,(o=s(o=r))[e]=l,o)}else a(e)&&(n(void 0!==t,"Cannot pick up or remove undefined"),null!=e.p&&(r[e.p]=t),t=void 0)}return t},"pick")(e,t),t)}function C(e,t){e=e.slice(),R(t);let r=uh.readCursor(t),n,o,s=!1,u=[];for(let t=0;;t++){let i=e[t],l=r.getComponent();if(l&&(void 0!==l.r?s=!0:null!=l.p&&(s=!1,n=l.p,o=t)),t>=e.length)break;let c=0,h=uh.advancer(r,void 0,(e,t)=>{a(t)&&c++});u.unshift(h);let d=h(i);if("number"==typeof i&&(e[t]-=c),!d)break}if(u.forEach(e=>e.end()),s)return null;let c=/* @__PURE__ */e7(()=>{let t=0;if(null!=n){let n=r.getPath();t=n.length,e=n.concat(e.slice(o))}for(;t<e.length;t++){let n=e[t],o=i(r),s=_(o);if(s){let r=y(o);s.transformPosition&&(e[t]=s.transformPosition(e[t],r));break}let a=0,u=uh.advancer(r,(e,t)=>l(t)?~(e-a):e-a,(e,t)=>{l(t)&&a++})(n);if("number"==typeof n&&(e[t]+=a),!u)break}},"handleDrop");return null!=n?r.eachDrop(null,e=>{e===n&&c()}):c(),e}function S(e,t){if(R(e),R(t),null==e)return t;if(null==t)return e;let r=uh.readCursor(e),n=uh.readCursor(t),i=uh.writeCursor(),o=[],s=[],a=[],l=[],u=[],c=[],h=/* @__PURE__ */new Set;r.traverse(null,e=>{null!=e.p&&(a[e.p]=r.clone())}),n.traverse(null,e=>{null!=e.d&&(l[e.d]=n.clone())});let d=uh.writeCursor();return /* @__PURE__ */r.clone(),n.clone(),i.reset(),i.mergeTree(d.get()),i.reset(),i.get(),o.map(e=>e.get()),s.map(e=>e.get()),r.traverse(i,(e,t)=>{let r=e.p;if(null!=r){let e=u[r];null!=e&&t.write("p",e);let n=o[r];n&&n.get(),n&&t.mergeTree(n.get())}else void 0!==e.r&&t.write("r",e.r)}),i.reset(),i.get(),n.traverse(i,(e,t)=>{let r=e.d;if(null!=r){let e=c[r];null!=e&&t.write("d",e);let n=s[r];n&&t.mergeTree(n.get())}else void 0!==e.i&&t.write("i",e.i);let n=_(e);n&&!h.has(e)&&E(t,n,y(e))}),i.get()}function x(e){let t;if(null==e)return null;let r=new uh.ReadCursor(e),n=new uh.WriteCursor,i=[];return /* @__PURE__ */t&&(n.reset(),/* @__PURE__ */r.clone(),i.length&&(n.reset(),r.traverse(n,(e,t)=>{let r=e.p;if(null!=r){let e=i[r];e&&e.get(),e&&t.mergeTree(e.get())}}))),n.get()}e7(v,"checkNonNegInteger"),e7(b,"checkScalar"),e7(R,"checkValidOp"),e7(T,"normalize"),e7(I,"apply"),e7(C,"transformPosition"),e7(S,"compose"),e7(x,"invert");let O=/* @__PURE__ */e7((e,t)=>e.some(e=>"object"==typeof e&&(Array.isArray(e)?O(e,t):t(e))),"anyComponent");function A(e,t){if(null==e||!O(e,e=>{var t;return void 0!==e.r||(null===(t=_(e))||void 0===t?void 0:t.makeInvertible)!=null}))return e;let i=new uh.ReadCursor(e),o=new uh.WriteCursor,a=!1,l=[],c=[],h=/* @__PURE__ */e7((e,t,i)=>{let o=e.getComponent(),p=!1;if(o){null!=o.d&&t.write("d",o.d),void 0!==o.i&&t.write("i",o.i);let r=o.p;if(null!=r&&(l[r]=e.clone(),n(void 0!==i,"Operation picks up at an invalid key"),c[r]=i,t.write("p",o.p)),void 0!==o.r&&void 0===i)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");let s=_(o);s&&(s.makeInvertible?a=!0:E(t,s,y(o),!0))}let f=0;for(let r of e){t.descend(r);let n="number"==typeof r?r-f:r,o=d(i,n),a=h(e,t,o);o!==a&&(p||(p=!0,i=s(i)),void 0===a?(i=u(i,n),"number"==typeof r&&f++):i[n]=a),t.ascend()}return o&&(void 0!==o.r?(t.write("r",r.default(i)),i=void 0):null!=o.p&&(i=void 0)),i},"traversePick");return h(i,o,t),o.get(),a&&(o.reset(),/* @__PURE__ */i.clone()),o.get()}function w(e,t){return x(A(e,t))}e7(A,"makeInvertible"),e7(w,"invertWithDoc");let N=/* @__PURE__ */e7(e=>{if(null==e)return null;let t=e.slice();for(let r=0;r<e.length;r++){let e=t[r];Array.isArray(e)&&(t[r]=N(e))}return t},"shallowCloneOp");function D(e,t,r){n("left"===r||"right"===r,"Direction must be left or right");let i="left"===r?0:1;if(null==t)return{ok:!0,result:e};R(e),R(t);let o=null,s=[],a=[],l=[],u=[],c=[],h=[],d=[],p=[],f=[],g=[],m=uh.readCursor(e),_=uh.readCursor(t),y=uh.writeCursor();if(/* @__PURE__ *//* @__PURE__ */_.clone(),u.map(e=>e&&e.get()),o)return{ok:!1,conflict:o};h.map(e=>!!e),/* @__PURE__ */_.clone(),y.reset();let E=[];if(/* @__PURE__ */m.clone(),_.clone(),o)return{ok:!1,conflict:o};y.reset();let v=/* @__PURE__ */e7((e,t,r)=>e.traverse(t,(t,n)=>{null!=t.d&&r(t.d,e,n)}),"eachDrop");(c.length||d.length)&&(v(_,y,(e,t,r)=>{c[e]&&!h[e]&&r.write("r",!0),d[e]&&r.mergeTree(d[e].get())}),y.reset());let b=[],T=[];if((p.length||c.length)&&!o){let e=uh.readCursor(N(y.get()));if(v(e,null,(e,t)=>{b[e]=t.clone()}),p.forEach(e=>{e&&v(uh.readCursor(e.get()),null,(e,t)=>{b[e]=t.clone()})}),/* @__PURE__ */e.clone(),y.reset(),o)return{ok:!1,conflict:o};if(y.get(),T.length){let e=T.map(e=>e?e.get():null);if(v(uh.readCursor(N(y.get())),y,(t,r,n)=>{let i=e[t];i&&(n.mergeTree(i),e[t]=null)}),e.find(e=>e)){let t=uh.writeCursor(),r=uh.writeCursor(),n=0,h=0;e.forEach(e=>{null!=e&&v(uh.readCursor(e),null,e=>{let o=E[e];t.writeMove(s[o].getPath(),a[o].getPath(),n++);let d=g[o];d&&d.forEach(e=>{c[e]||1!==i&&null!=f[e]||r.writeMove(l[e].getPath(),u[e].getPath(),h++)})})}),o={type:ud.ConflictType.BLACKHOLE,op1:t.get(),op2:r.get()}}}}return o?{ok:!1,conflict:o}:{ok:!0,result:y.get()}}e7(D,"tryTransform");let L=/* @__PURE__ */e7(e=>{let t=Error("Transform detected write conflict");throw t.conflict=e,t.type=t.name="writeConflict",t},"throwConflictErr");function M(e,t,r){let n=D(e,t,r);if(n.ok)return n.result;L(n.conflict)}e7(M,"transform");let U=/* @__PURE__ */e7(e=>{let t=uh.writeCursor();return uh.readCursor(e).traverse(t,(e,t)=>{(l(e)||_(e))&&t.write("r",!0)}),t.get()},"opThatRemovesDE"),P=/* @__PURE__ */e7((e,t)=>{let{type:r,op1:n,op2:i}=e;switch(r){case ud.ConflictType.DROP_COLLISION:return"left"===t?[null,U(i)]:[U(n),null];case ud.ConflictType.RM_UNEXPECTED_CONTENT:let o=!1;return uh.readCursor(n).traverse(null,e=>{void 0!==e.r&&(o=!0)}),o?[null,U(i)]:[U(n),null];case ud.ConflictType.BLACKHOLE:return[U(n),U(i)];default:throw Error("Unrecognised conflict: "+r)}},"resolveConflict");function k(e,t,r,n){let i=null;for(;;){let o=D(t,r,n);if(o.ok)return S(i,o.result);{let{conflict:s}=o;e(s)||L(s);let[a,l]=P(s,n);t=S(T(t),a),r=S(T(r),l),i=S(i,l)}}}e7(k,"transformWithConflictsPred")}(ui),h1=l_&&l_.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:/* @__PURE__ */e7(function(){return t[r]},"get")})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),h2=l_&&l_.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||h1(t,e,r)},Object.defineProperty(un,"__esModule",{value:!0}),h2(ui,un),Object.defineProperty(un,"ReadCursor",{enumerable:!0,get:/* @__PURE__ */e7(function(){return uh.ReadCursor},"get")}),Object.defineProperty(un,"WriteCursor",{enumerable:!0,get:/* @__PURE__ */e7(function(){return uh.WriteCursor},"get")}),Object.defineProperty(un,"ConflictType",{enumerable:!0,get:/* @__PURE__ */e7(function(){return ud.ConflictType},"get")});var uB=((X=uB||{}).RETAIN="r",X.INSERT="i",X.DELETE="d",X),uH=((q=uH||{}).PARAGRAPH="PARAGRAPH",q.SECTION_BREAK="SECTION_BREAK",q.TABLE="TABLE",q.TABLE_ROW="TABLE_ROW",q.TABLE_CELL="TABLE_CELL",q.CUSTOM_BLOCK="CUSTOM_BLOCK",q),uV=((J=uV||{}).PARAGRAPH="\r",J.SECTION_BREAK=`
`,J.TABLE_START="\x1a",J.TABLE_ROW_START="\x1b",J.TABLE_CELL_START="\x1c",J.TABLE_CELL_END="\x1d",J.TABLE_ROW_END="\x0e",J.TABLE_END="\x0f",J.CUSTOM_RANGE_START="\x1f",J.CUSTOM_RANGE_END="\x1e",J.COLUMN_BREAK="\v",J.PAGE_BREAK="\f",J.DOCS_END="\0",J.TAB="	",J.CUSTOM_BLOCK="\b",J.LETTER="",J.SPACE=" ",J);e7(function(e){return`${e}`},"makeCustomRangeStream");var u$=((Q=u$||{})[Q.character=0]="character",Q[Q.paragraph=1]="paragraph",Q[Q.table=2]="table",Q[Q.numbering=3]="numbering",Q),uG=((Z=uG||{})[Z.TAB=0]="TAB",Z[Z.SPACE=1]="SPACE",Z[Z.NOTHING=2]="NOTHING",Z),uW=((ee=uW||{})[ee.BULLET=0]="BULLET",ee[ee.NONE=1]="NONE",ee[ee.DECIMAL=2]="DECIMAL",ee[ee.DECIMAL_ZERO=3]="DECIMAL_ZERO",ee[ee.UPPER_LETTER=4]="UPPER_LETTER",ee[ee.LOWER_LETTER=5]="LOWER_LETTER",ee[ee.UPPER_ROMAN=6]="UPPER_ROMAN",ee[ee.LOWER_ROMAN=7]="LOWER_ROMAN",ee[ee.ORDINAL=8]="ORDINAL",ee[ee.CARDINAL_TEXT=9]="CARDINAL_TEXT",ee[ee.ORDINAL_TEXT=10]="ORDINAL_TEXT",ee[ee.HEX=11]="HEX",ee[ee.CHICAGO=12]="CHICAGO",ee[ee.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",ee[ee.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",ee[ee.AIUEO=15]="AIUEO",ee[ee.IROHA=16]="IROHA",ee[ee.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",ee[ee.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",ee[ee.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",ee[ee.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",ee[ee.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",ee[ee.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",ee[ee.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",ee[ee.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",ee[ee.GANADA=25]="GANADA",ee[ee.CHOSUNG=26]="CHOSUNG",ee[ee.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",ee[ee.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",ee[ee.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",ee[ee.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",ee[ee.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",ee[ee.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",ee[ee.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",ee[ee.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",ee[ee.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",ee[ee.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",ee[ee.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",ee[ee.CHINESE_COUNTING=38]="CHINESE_COUNTING",ee[ee.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",ee[ee.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",ee[ee.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",ee[ee.KOREAN_COUNTING=42]="KOREAN_COUNTING",ee[ee.KOREAN_LEGAL=43]="KOREAN_LEGAL",ee[ee.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",ee[ee.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",ee[ee.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",ee[ee.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",ee[ee.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",ee[ee.HEBREW1=49]="HEBREW1",ee[ee.HEBREW2=50]="HEBREW2",ee[ee.ARABIC_ALPHA=51]="ARABIC_ALPHA",ee[ee.ARABIC_ABJAD=52]="ARABIC_ABJAD",ee[ee.HINDI_VOWELS=53]="HINDI_VOWELS",ee[ee.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",ee[ee.HINDI_NUMBERS=55]="HINDI_NUMBERS",ee[ee.HINDI_COUNTING=56]="HINDI_COUNTING",ee[ee.THAI_LETTERS=57]="THAI_LETTERS",ee[ee.THAI_NUMBERS=58]="THAI_NUMBERS",ee[ee.THAI_COUNTING=59]="THAI_COUNTING",ee[ee.CUSTOM=60]="CUSTOM",ee),uz=((et=uz||{})[et.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",et[et.START=1]="START",et[et.CENTER=2]="CENTER",et[et.END=3]="END",et[et.BOTH=4]="BOTH",et),uY=((er=uY||{})[er.HYPERLINK=0]="HYPERLINK",er[er.FIELD=1]="FIELD",er[er.SDT=2]="SDT",er[er.BOOKMARK=3]="BOOKMARK",er[er.COMMENT=4]="COMMENT",er[er.CUSTOM=5]="CUSTOM",er[er.MENTION=6]="MENTION",er[er.UNI_FORMULA=7]="UNI_FORMULA",er),uK=((en=uK||{})[en.COMMENT=0]="COMMENT",en),uX=((ei=uX||{})[ei.DRAWING=0]="DRAWING",ei[ei.CUSTOM=1]="CUSTOM",ei),uq=((eo=uq||{})[eo.UNSPECIFIED=0]="UNSPECIFIED",eo[eo.TRADITIONAL=1]="TRADITIONAL",eo[eo.MODERN=2]="MODERN",eo),uJ=((es=uJ||{})[es.DEFAULT=0]="DEFAULT",es[es.LINES=1]="LINES",es[es.LINES_AND_CHARS=2]="LINES_AND_CHARS",es[es.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",es),uQ=((ea=uQ||{})[ea.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",ea[ea.CONTINUOUS=1]="CONTINUOUS",ea[ea.NEXT_PAGE=2]="NEXT_PAGE",ea[ea.EVEN_PAGE=3]="EVEN_PAGE",ea[ea.ODD_PAGE=4]="ODD_PAGE",ea),uZ=((el=uZ||{})[el.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",el[el.NONE=1]="NONE",el[el.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",el),u0=((eu=u0||{})[eu.NORMAL=0]="NORMAL",eu[eu.TBRL=1]="TBRL",eu[eu.LRTBV=2]="LRTBV",eu),u1=((ec=u1||{})[ec.TEXT_RUN=0]="TEXT_RUN",ec[ec.AUTO_TEXT=1]="AUTO_TEXT",ec[ec.PAGE_BREAK=2]="PAGE_BREAK",ec[ec.COLUMN_BREAK=3]="COLUMN_BREAK",ec[ec.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",ec[ec.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",ec[ec.EQUATION=6]="EQUATION",ec[ec.DRAWING=7]="DRAWING",ec[ec.PERSON=8]="PERSON",ec[ec.RICH_LINK=9]="RICH_LINK",ec),u2=((eh=u2||{})[eh.BOTH_SIDES=0]="BOTH_SIDES",eh[eh.LEFT=1]="LEFT",eh[eh.RIGHT=2]="RIGHT",eh[eh.LARGEST=3]="LARGEST",eh),u5=((ed=u5||{})[ed.INLINE=0]="INLINE",ed[ed.WRAP_NONE=1]="WRAP_NONE",ed[ed.WRAP_POLYGON=2]="WRAP_POLYGON",ed[ed.WRAP_SQUARE=3]="WRAP_SQUARE",ed[ed.WRAP_THROUGH=4]="WRAP_THROUGH",ed[ed.WRAP_TIGHT=5]="WRAP_TIGHT",ed[ed.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",ed),u3=((ep=u3||{})[ep.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",ep[ep.NORMAL_TEXT=1]="NORMAL_TEXT",ep[ep.TITLE=2]="TITLE",ep[ep.SUBTITLE=3]="SUBTITLE",ep[ep.HEADING_1=4]="HEADING_1",ep[ep.HEADING_2=5]="HEADING_2",ep[ep.HEADING_3=6]="HEADING_3",ep[ep.HEADING_4=7]="HEADING_4",ep[ep.HEADING_5=8]="HEADING_5",ep[ep.HEADING_6=9]="HEADING_6",ep),u6=((ef=u6||{})[ef.AUTO=0]="AUTO",ef[ef.AT_LEAST=1]="AT_LEAST",ef[ef.EXACT=2]="EXACT",ef),u4=((eg=u4||{})[eg.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",eg[eg.SOLID=1]="SOLID",eg[eg.DOT=2]="DOT",eg[eg.DASH=3]="DASH",eg),u9=((em=u9||{})[em.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",em[em.START=1]="START",em[em.CENTER=2]="CENTER",em[em.END=3]="END",em),u8=((e_=u8||{})[e_.UNSPECIFIED=0]="UNSPECIFIED",e_[e_.SPECIFIED=1]="SPECIFIED",e_),u7=((ey=u7||{})[ey.START=0]="START",ey[ey.CENTER=1]="CENTER",ey[ey.END=2]="END",ey),ce=((eE=ce||{})[eE.AUTO_FIT=0]="AUTO_FIT",eE[eE.FIXED=1]="FIXED",eE),ct=((ev=ct||{})[ev.NONE=0]="NONE",ev[ev.WRAP=1]="WRAP",ev),cr=((eb=cr||{})[eb.AUTO=0]="AUTO",eb[eb.AT_LEAST=1]="AT_LEAST",eb[eb.EXACT=2]="EXACT",eb),cn=((eR=cn||{})[eR.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",eR[eR.BOTH=1]="BOTH",eR[eR.TOP=2]="TOP",eR[eR.CENTER=3]="CENTER",eR[eR.BOTTOM=4]="BOTTOM",eR),ci=((eT=ci||{}).NORMAL="normal",eT.BOLD="bold",eT.ITALIC="italic",eT),co=((eI=co||{})[eI.PAGE=0]="PAGE",eI[eI.COLUMN=1]="COLUMN",eI[eI.CHARACTER=2]="CHARACTER",eI[eI.MARGIN=3]="MARGIN",eI[eI.INSIDE_MARGIN=4]="INSIDE_MARGIN",eI[eI.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",eI[eI.LEFT_MARGIN=6]="LEFT_MARGIN",eI[eI.RIGHT_MARGIN=7]="RIGHT_MARGIN",eI),cs=((eC=cs||{})[eC.PAGE=0]="PAGE",eC[eC.PARAGRAPH=1]="PARAGRAPH",eC[eC.LINE=2]="LINE",eC[eC.MARGIN=3]="MARGIN",eC[eC.TOP_MARGIN=4]="TOP_MARGIN",eC[eC.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",eC[eC.INSIDE_MARGIN=6]="INSIDE_MARGIN",eC[eC.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",eC),ca=((eS=ca||{})[eS.POINT=0]="POINT",eS[eS.LINE=1]="LINE",eS[eS.CHARACTER=2]="CHARACTER",eS[eS.PIXEL=3]="PIXEL",eS[eS.PERCENT=4]="PERCENT",eS),cl=((ex=cl||{})[ex.CENTER=0]="CENTER",ex[ex.INSIDE=1]="INSIDE",ex[ex.LEFT=2]="LEFT",ex[ex.OUTSIDE=3]="OUTSIDE",ex[ex.RIGHT=4]="RIGHT",ex[ex.BOTH=5]="BOTH",ex[ex.DISTRIBUTE=6]="DISTRIBUTE",ex),cu=((eO=cu||{})[eO.BOTTOM=0]="BOTTOM",eO[eO.CENTER=1]="CENTER",eO[eO.INSIDE=2]="INSIDE",eO[eO.OUTSIDE=3]="OUTSIDE",eO[eO.TOP=4]="TOP",eO),cc=((eA=cc||{})[eA.compressPunctuation=0]="compressPunctuation",eA[eA.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",eA[eA.doNotCompress=2]="doNotCompress",eA),ch=((ew=ch||{})[ew.PORTRAIT=0]="PORTRAIT",ew[ew.LANDSCAPE=1]="LANDSCAPE",ew),cd=((eN=cd||{})[eN.forward=0]="forward",eN[eN.backward=1]="backward",eN[eN.front=2]="front",eN[eN.back=3]="back",eN),cp=((eD=cp||{})[eD.UNRECOGNIZED=-1]="UNRECOGNIZED",eD[eD.DRAWING_IMAGE=0]="DRAWING_IMAGE",eD[eD.DRAWING_SHAPE=1]="DRAWING_SHAPE",eD[eD.DRAWING_CHART=2]="DRAWING_CHART",eD[eD.DRAWING_TABLE=3]="DRAWING_TABLE",eD[eD.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",eD[eD.DRAWING_VIDEO=5]="DRAWING_VIDEO",eD[eD.DRAWING_GROUP=6]="DRAWING_GROUP",eD[eD.DRAWING_UNIT=7]="DRAWING_UNIT",eD[eD.DRAWING_DOM=8]="DRAWING_DOM",eD),cf=((eL=cf||{}).ORDER_LIST_QUICK_1="1.",eL.ORDER_LIST_QUICK_2="a)",eL.ORDER_LIST_QUICK_3="a.",eL.ORDER_LIST_QUICK_4="i.",eL.ORDER_LIST_QUICK_5="A.",eL.ORDER_LIST_QUICK_6="I.",eL.ORDER_LIST_QUICK_7="01.",eL),cg=((eM=cg||{}).BULLET_LIST="BULLET_LIST",eM.BULLET_LIST_1="BULLET_LIST_1",eM.BULLET_LIST_2="BULLET_LIST_2",eM.BULLET_LIST_3="BULLET_LIST_3",eM.BULLET_LIST_4="BULLET_LIST_4",eM.BULLET_LIST_5="BULLET_LIST_5",eM.ORDER_LIST="ORDER_LIST",eM.ORDER_LIST_1="ORDER_LIST_1",eM.ORDER_LIST_2="ORDER_LIST_2",eM.ORDER_LIST_3="ORDER_LIST_3",eM.ORDER_LIST_4="ORDER_LIST_4",eM.ORDER_LIST_5="ORDER_LIST_5",eM.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",eM.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",eM.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",eM.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",eM.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",eM.CHECK_LIST="CHECK_LIST",eM.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",eM);let cm={"a)":{glyphFormat:"%1)",glyphType:uW.DECIMAL},"1.":{glyphFormat:"%1.",glyphType:uW.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:uW.LOWER_LETTER},"A.":{glyphFormat:"%1.",glyphType:uW.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:uW.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:uW.UPPER_LETTER}},c_=/* @__PURE__ */e7(e=>[...e,...e,...e].map((e,t)=>({glyphFormat:` %${t+1}`,glyphSymbol:e,bulletAlignment:uz.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*t}}})),"bulletListFactory"),cy=/* @__PURE__ */e7(e=>e.map((e,t)=>({...e,bulletAlignment:uz.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*t}}})),"orderListFactory"),cE=/* @__PURE__ */e7((e,t)=>Array(9).fill(0).map((r,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:e,bulletAlignment:uz.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n},textStyle:t}})),"checkListFactory"),cv={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:c_(["●","○","■"])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:c_(["❖","➢","■"])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:c_(["✔","●","◆"])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:c_(["■","◆","○"])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:c_(["✧","○","■"])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:c_(["➢","○","◆"])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:cy([{glyphFormat:"%1.",glyphType:uW.DECIMAL},{glyphFormat:"%2.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%3.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:uW.DECIMAL},{glyphFormat:"%5.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%6.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:uW.DECIMAL},{glyphFormat:"%8.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%9.",glyphType:uW.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:cy([{glyphFormat:"%1)",glyphType:uW.DECIMAL},{glyphFormat:"%2)",glyphType:uW.LOWER_LETTER},{glyphFormat:"%3)",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:uW.DECIMAL},{glyphFormat:"%5)",glyphType:uW.LOWER_LETTER},{glyphFormat:"%6)",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:uW.DECIMAL},{glyphFormat:"%8)",glyphType:uW.LOWER_LETTER},{glyphFormat:"%9)",glyphType:uW.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:cy(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(e=>({glyphFormat:e,glyphType:uW.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:cy([{glyphFormat:"%1.",glyphType:uW.UPPER_LETTER},{glyphFormat:"%2.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%3.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:uW.UPPER_LETTER},{glyphFormat:"%5.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%6.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:uW.UPPER_LETTER},{glyphFormat:"%8.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%9.",glyphType:uW.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:cy([{glyphFormat:"%1.",glyphType:uW.UPPER_LETTER},{glyphFormat:"%2.",glyphType:uW.DECIMAL},{glyphFormat:"%3.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:uW.UPPER_LETTER},{glyphFormat:"%5.",glyphType:uW.DECIMAL},{glyphFormat:"%6.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:uW.UPPER_LETTER},{glyphFormat:"%8.",glyphType:uW.DECIMAL},{glyphFormat:"%9.",glyphType:uW.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:cy([{glyphFormat:"%1.",glyphType:uW.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%3.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:uW.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%6.",glyphType:uW.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:uW.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:uW.LOWER_LETTER},{glyphFormat:"%9.",glyphType:uW.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:cE("☐")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:cE("☑",{st:{s:sY.TRUE}})}},cb=/* @__PURE__ */e7(e=>{let{glyphFormat:t,glyphType:r}=e,n=ai.deepClone(cv.ORDER_LIST);return n.nestingLevel[0].glyphFormat=t,n.nestingLevel[0].glyphType=r,n},"generateOrderList");Object.assign(cv,{ORDER_LIST_QUICK_2:cb(cm["a)"]),ORDER_LIST_QUICK_3:cb(cm["a."]),ORDER_LIST_QUICK_4:cb(cm["i."]),ORDER_LIST_QUICK_6:cb(cm["I."])});let cR={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5"};function cT(e){let t=[];for(let r of e){let{st:e,ed:n,ts:i}=r;if(void 0===r.sId&&delete r.sId,e===n||ai.isEmptyObject(i)&&null==r.sId)continue;if(0===t.length){t.push(r);continue}let o=t.pop();a8(r,o)&&ai.hasIntersectionBetweenTwoRanges(o.st,o.ed,r.st,r.ed)?t.push({...r,st:o.st,ed:n}):t.push(o,r)}return t}function cI(e,t,r,n){var i;let{textRuns:o}=e;if(null==o)return;let s=[],a=o.length,l=!1,u=null!=(i=t.textRuns)?i:[];if(u.length)for(let e of u)e.st+=n,e.ed+=n;for(let e=0;e<a;e++){let t=o[e],{st:i,ed:a}=t;if(a<=n)s.push(t);else if(n>i&&n<a){l=!0;let e={...t,ed:n};s.push(e),u.length&&s.push(...u);let i={...t,st:n+r,ed:a+r};s.push(i)}else t.st+=r,t.ed+=r,l||(l=!0,s.push(...u)),s.push(t)}l||(l=!0,s.push(...u)),e.textRuns=cT(s)}function cC(e,t,r,n){let{paragraphs:i}=e;if(null==i)return;let{paragraphs:o}=t,s=[];for(let e=0,t=i.length;e<t;e++){let t=i[e],{startIndex:o}=t;o>=n&&(t.startIndex+=r),s.push(t.startIndex)}let a=-1;if(o){for(let e=0,t=o.length;e<t;e++){let t=o[e];t.startIndex+=n;let r=t.startIndex;a=s.indexOf(r)}-1!==a&&i.splice(a,1),i.push(...o),i.sort(l4("startIndex"))}}function cS(e,t,r,n){let{sectionBreaks:i}=e;if(null==i)return;for(let e=0,t=i.length;e<t;e++){let t=i[e],{startIndex:o}=t;o>=n&&(t.startIndex+=r)}let o=t.sectionBreaks;if(o){for(let e=0,t=o.length;e<t;e++){let t=o[e];t.startIndex+=n}i.push(...o),i.sort(l4("startIndex"))}}function cx(e,t,r,n){let{customBlocks:i}=e;if(null==i)return;for(let e=0,t=i.length;e<t;e++){let t=i[e],{startIndex:o}=t;o>=n&&(t.startIndex+=r)}let o=t.customBlocks;if(o){for(let e=0,t=o.length;e<t;e++){let t=o[e];t.startIndex+=n}i.push(...o),i.sort(l4("startIndex"))}}function cO(e,t,r,n){let{tables:i}=e;if(null==i)return;for(let e=0,t=i.length;e<t;e++){let t=i[e],{startIndex:o,endIndex:s}=t;o>n?(t.startIndex+=r,t.endIndex+=r):s>n&&(t.endIndex+=r)}let o=t.tables;if(o){for(let e=0,t=o.length;e<t;e++){let t=o[e];t.startIndex+=n,t.endIndex+=n}i.push(...o),i.sort(l4("startIndex"))}}function cA(e,t,r,n){e.customRanges||(e.customRanges=[]);let{customRanges:i}=e,o={};for(let e=0,t=i.length;e<t;e++){let t=i[e];o[t.rangeId]=t;let{startIndex:s,endIndex:a}=t;s>=n?(t.startIndex+=r,t.endIndex+=r):a>n-1&&(t.endIndex+=r)}if(i.find(e=>e.startIndex>n&&e.endIndex<n))return;let s=[];if(t.customRanges){for(let r=0,i=t.customRanges.length;r<i;r++){let i=t.customRanges[r],a=o[i.rangeId];if(i.startIndex+=n,i.endIndex+=n,a){if(a.startIndex<=i.startIndex&&a.endIndex>=i.endIndex)continue;if(e.dataStream[a.startIndex]===uV.CUSTOM_RANGE_START&&e.dataStream[a.endIndex]===uV.CUSTOM_RANGE_END){s.push(i);continue}if(e.dataStream[a.startIndex]===uV.CUSTOM_RANGE_START){a.endIndex=i.endIndex;continue}if(e.dataStream[a.endIndex]===uV.CUSTOM_RANGE_END){a.startIndex=i.startIndex;continue}}s.push(i)}i.push(...s),i.sort(l4("startIndex"))}}function cw(e){e.sort((e,t)=>e.startIndex-t.startIndex);let t=[],r=e[0];for(let n=1;n<e.length;n++)r.endIndex+1>=e[n].startIndex?r.endIndex=Math.max(r.endIndex,e[n].endIndex):(t.push(r),r=e[n]);return t.push(r),t}function cN(e){let t={};for(let r=0,n=e.length;r<n;r++){let n=e[r],i=t[n.id];t[n.id]=[...null!=i?i:[],n]}return Object.keys(t).forEach(e=>{let r=cw(t[e]);t[e]=r}),Object.values(t).flat()}function cD(e,t,r,n){e.customDecorations||(e.customDecorations=[]);let{customDecorations:i}=e;if(r>0)for(let e=0,t=i.length;e<t;e++){let t=i[e],{startIndex:o,endIndex:s}=t;o>=n?(t.startIndex+=r,t.endIndex+=r):s>n-1&&(t.endIndex+=r)}if(t.customDecorations){let r=[];for(let e=0,i=t.customDecorations.length;e<i;e++){let i=t.customDecorations[e];r.push(i),i.startIndex+=n,i.endIndex+=n}i.push(...r),e.customDecorations=cN(i),e.customDecorations.sort(l4("startIndex"))}}function cL(e,t,r){let{textRuns:n}=e,i=r+t,o=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{st:l,ed:u}=a;if(r<=l&&i>=u){o.push({...a,st:l-r,ed:u-r});continue}l<=r&&u>=i?(o.push({...a,st:r-r,ed:i-r}),a.ed-=t):r>=l&&r<u?(o.push({...a,st:r-r,ed:u-r}),a.ed=r):i>l&&i<=u?(o.push({...a,st:l-r,ed:i-r}),a.st=i-t,a.ed-=t):l>=i&&(a.st-=t,a.ed-=t),s.push(a)}e.textRuns=s}return 0===o.length&&o.push({st:0,ed:t,ts:{}}),o}function cM(e,t,r){let{paragraphs:n}=e,i=r+t,o=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l}=a;if(l>=r&&l<i){o.push({...a,startIndex:l-r});continue}l>=i&&(a.startIndex-=t),s.push(a)}e.paragraphs=s}return o}function cU(e,t,r){let{sectionBreaks:n}=e,i=r+t-1,o=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l}=a;if(l>=r&&l<=i){o.push({...a,startIndex:l-r});continue}l>i&&(a.startIndex-=t),s.push(a)}e.sectionBreaks=s}return o}function cP(e,t,r){let{customBlocks:n}=e,i=r+t-1,o=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l}=a;if(l>=r&&l<=i){o.push({...a,startIndex:l-r});continue}l>i&&(a.startIndex-=t),s.push(a)}e.customBlocks=s}return o}function ck(e,t,r){let{tables:n}=e,i=r+t-1,o=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l,endIndex:u}=a;if(r<=l&&i>=u){o.push({...a,startIndex:l-r,endIndex:u-r});continue}if(l<=r&&u>=i){let e=le(l,u,r,i);if(a.startIndex=e[0],a.endIndex=e[1],a.startIndex===a.endIndex)continue}else i<l&&(a.startIndex-=t,a.endIndex-=t);s.push(a)}e.tables=s}return o}function cF(e,t,r){let{customRanges:n}=e,i=r+t-1,o=[];if(n){let s=[];for(let e=0,a=n.length;e<a;e++){let a=n[e],{startIndex:l,endIndex:u}=a;if(r<=l&&i>=l){o.push({...a,startIndex:l-r,endIndex:u-r});continue}if(l<=r&&u>=i){let e=le(l,u,r,i);a.startIndex=e[0],a.endIndex=e[1]}else i<l&&(a.startIndex-=t,a.endIndex-=t);s.push(a)}e.customRanges=s}return o}function cj(e,t,r,n=!0){let{customDecorations:i}=e,o=r+t-1,s=[];if(i){let a=[];for(let e=0,l=i.length;e<l;e++){let l=i[e],{startIndex:u,endIndex:c}=l;if(u>=r&&c<=o){s.push(l);continue}if(Math.max(r,u)<=Math.min(o,c)){let e=le(u,c,r,o);l.startIndex=e[0],l.endIndex=e[1]}else o<u&&n&&(l.startIndex-=t,l.endIndex-=t);a.push(l)}e.customDecorations=a}return s}function cB(e,t,r,n,i){let o=cH(e,t,r,n,i),s=c$(e,t,r,n,i),a=cG(e,t,r,n,i),l=cW(e,t,r,n,i);return{dataStream:"",textRuns:o,paragraphs:s,sectionBreaks:a,customBlocks:l,tables:cz(e,t,r,n,i),customRanges:cY(e,t,r,n,i),customDecorations:cK(e,t,r,n,i)}}function cH(e,t,r,n,i){let{textRuns:o}=e,{textRuns:s}=t;if(null==o||null==s)return;let a=cL(e,r,n);if(i!==aF.REPLACE){let e=cV(s,a,i);t.textRuns=e}return cI(e,t,r,n),a}function cV(e,t,r){if(0===t.length)return e;e=ai.deepClone(e),t=ai.deepClone(t);let n=[],i=e.length,o=t.length,s=0,a=0,l=null;function u(){return!!l&&(n.push(l),l=null,!0)}for(e7(u,"pushPendingAndReturnStatus");s<i&&a<o;){let i;let{st:o,ed:c,ts:h}=e[s],{st:d,ed:p,ts:f,sId:g}=t[a];if(i=r===aF.COVER?{...f,...h}:{...h,...f},c<d)u()||n.push(e[s]),s++;else if(p<o)u()||n.push(t[a]),a++;else{let r={st:Math.min(o,d),ed:Math.max(o,d),ts:o<d?{...h}:{...f},sId:o<d?void 0:g};r.ed>r.st&&n.push(r),n.push({st:Math.max(o,d),ed:Math.min(c,p),ts:i,sId:g}),c<p?(s++,t[a].st=c,t[a].st===t[a].ed&&a++):(a++,e[s].st=p,e[s].st===e[s].ed&&s++);let u={st:Math.min(c,p),ed:Math.max(c,p),ts:c<p?{...f}:{...h},sId:c<p?g:void 0};l=u.ed>u.st?u:null}}u();let c=n[n.length-1],h=e[i-1],d=t[o-1];return c&&c.ed!==Math.max(h.ed,d.ed)&&(h.ed>d.ed?n.push(h):n.push(d)),cT(n)}function c$(e,t,r,n,i){let{paragraphs:o}=e,{paragraphs:s}=t;if(null==o||null==s)return;let a=cM(e,r,n);if(i!==aF.REPLACE){let e=[];for(let t of s){let{startIndex:r,paragraphStyle:n,bullet:o}=t,s=[];for(let e of a){let t,a;let{startIndex:l,paragraphStyle:u,bullet:c}=e;if(i===aF.COVER?(t={...u,...n},a={listId:"",listType:cg.BULLET_LIST,nestingLevel:0,textStyle:{},...c,...o}):(t={...n,...u},a={listId:"",listType:cg.BULLET_LIST,nestingLevel:0,textStyle:{},...o,...c}),r===l){s.push({startIndex:r,paragraphStyle:t,bullet:a});break}}e.push(...s),s=[]}t.paragraphs=e}return cC(e,t,r,n),a}function cG(e,t,r,n,i){let{sectionBreaks:o}=e,{sectionBreaks:s}=t;if(null==o||null==s)return;let a=cU(e,r,n);if(i!==aF.REPLACE){let e=[];for(let t of s){let{startIndex:r}=t,n=[];for(let e of a){let{startIndex:o}=e;if(r===o){i===aF.COVER?n.push({...e,...t}):n.push({...t,...e});break}}e.push(...n),n=[]}t.sectionBreaks=e}return cS(e,t,r,n),a}function cW(e,t,r,n,i){let{customBlocks:o}=e,{customBlocks:s}=t;if(null==o||null==s)return;let a=cP(e,r,n);if(i!==aF.REPLACE){let e=[];for(let t of s){let{startIndex:r}=t,n=[];for(let e of a){let{startIndex:o}=e;if(r===o){i===aF.COVER?n.push({...e,...t}):n.push({...t,...e});break}}e.push(...n),n=[]}t.customBlocks=e}return cx(e,t,r,n),a}function cz(e,t,r,n,i){let{tables:o}=e,{tables:s}=t;if(null==o||null==s)return;let a=ck(e,r,n);if(i!==aF.REPLACE){let e=[];for(let t of s){let{startIndex:r,endIndex:n}=t,o=[];for(let e of a){let{startIndex:s,endIndex:a}=e;if(s>=r&&a<=n){i===aF.COVER?o.push({...e,...t}):o.push({...t,...e});break}}e.push(...o),o=[]}t.tables=e}return cO(e,t,r,n),a}function cY(e,t,r,n,i){e.customRanges||(e.customRanges=[]);let{customRanges:o}=e,{customRanges:s}=t;if(null==o||null==s)return;let a=[];return i===aF.REPLACE&&(a=cF(e,r,n)),cA(e,t,0,n),a}function cK(e,t,r,n,i){e.customDecorations||(e.customDecorations=[]);let o=[];return i===aF.REPLACE&&(o=cj(e,r,n,!1)),cD(e,t,0,n),o}e7(cT,"normalizeTextRuns"),e7(cI,"insertTextRuns"),e7(cC,"insertParagraphs"),e7(cS,"insertSectionBreaks"),e7(cx,"insertCustomBlocks"),e7(cO,"insertTables"),e7(cA,"insertCustomRanges"),e7(cw,"mergeRanges"),e7(cN,"mergeDecorations"),e7(cD,"insertCustomDecorations"),e7(cL,"deleteTextRuns"),e7(cM,"deleteParagraphs"),e7(cU,"deleteSectionBreaks"),e7(cP,"deleteCustomBlocks"),e7(ck,"deleteTables"),e7(cF,"deleteCustomRanges"),e7(cj,"deleteCustomDecorations"),e7(cB,"updateAttribute"),e7(cH,"updateTextRuns"),e7(cV,"coverTextRuns"),e7(c$,"updateParagraphs"),e7(cG,"updateSectionBreaks"),e7(cW,"updateCustomBlocks"),e7(cz,"updateTables"),e7(cY,"updateCustomRanges"),e7(cK,"updateCustomDecorations");var cX=((eU=cX||{})[eU.copy=0]="copy",eU[eU.cut=1]="cut",eU);function cq(e,t,r,n=!1,i=1){let{dataStream:o,textRuns:s=[],paragraphs:a=[],customBlocks:l=[],tables:u=[],sectionBreaks:c=[]}=e,h={dataStream:o.slice(t,r)},d=[];for(let e of s){let n=ai.deepClone(e),{st:i,ed:o}=n;ai.hasIntersectionBetweenTwoRanges(i,o,t,r)&&(t>=i&&t<=o?d.push({...n,st:t,ed:Math.min(r,o)}):r>=i&&r<=o?d.push({...n,st:Math.max(t,i),ed:r}):d.push(n))}d.length?h.textRuns=d.map(e=>{let{st:r,ed:n}=e;return{...e,st:r-t,ed:n-t}}):n&&(h.textRuns=[{st:0,ed:r-t,ts:{}}]);let p=[];for(let e of u){let n=ai.deepClone(e),{startIndex:i,endIndex:o}=n;i>=t&&o<=r&&p.push({...n,startIndex:i-t,endIndex:o-t})}p.length&&(h.tables=p);let f=[];for(let e of a){let{startIndex:n}=e;n>=t&&n<r&&f.push(ai.deepClone(e))}f.length&&(h.paragraphs=f.map(e=>({...e,startIndex:e.startIndex-t})));let g=[];for(let e of c){let{startIndex:n}=e;n>=t&&n<=r&&g.push(ai.deepClone(e))}g.length&&(h.sectionBreaks=g.map(e=>({...e,startIndex:e.startIndex-t}))),1===i&&(h.customDecorations=cZ(e,t,r));let{customRanges:m}=cQ(e,t,r);h.customRanges=m;let _=[];for(let e of l){let{startIndex:n}=e;n>=t&&n<=r&&_.push(ai.deepClone(e))}return _.length&&(h.customBlocks=_.map(e=>({...e,startIndex:e.startIndex-t}))),h}function cJ(e){let{dataStream:t,textRuns:r,paragraphs:n,customRanges:i,customDecorations:o,tables:s}=e,a=0,l=0;null==i||i.forEach(e=>{e.startIndex<0&&(a=Math.max(a,-e.startIndex)),e.endIndex>t.length-1&&(l=Math.max(l,e.endIndex-t.length+1))});let u=`${uV.CUSTOM_RANGE_START.repeat(a)}${t}${uV.CUSTOM_RANGE_END.repeat(l)}`;return r&&(r[0]&&(r[0].st=r[0].st-a),r[r.length-1]&&(r[r.length-1].ed=r[r.length-1].ed+l)),null==r||r.forEach(e=>{e.st+=a,e.ed+=a}),null==n||n.forEach(e=>{e.startIndex+=a}),null==i||i.forEach(e=>{e.startIndex+=a,e.endIndex+=a}),null==o||o.forEach(e=>{e.startIndex+=a,e.endIndex+=l}),null==s||s.forEach(e=>{e.startIndex+=a,e.endIndex+=l}),{...e,dataStream:u,textRuns:r,paragraphs:n,customRanges:i,customDecorations:o,tables:s}}function cQ(e,t,r){let{customRanges:n=[]}=e,i=0,o=0,s=n.filter(e=>Math.max(e.startIndex,t)<=Math.min(e.endIndex,r-1)).map(e=>({...e,startIndex:e.startIndex,endIndex:e.endIndex}));if(s.length){s.forEach(e=>{e.startIndex<t&&(i+=1),e.endIndex>r-1&&(o+=1)});for(let e=0;e<i;e++)s[e].startIndex=t-i+e;if(o){let e=[...s].sort((e,t)=>t.endIndex-e.endIndex);for(let t=0;t<o;t++)e[t].endIndex=r+o-t-1}}return{customRanges:s.map(e=>({...e,startIndex:e.startIndex-t,endIndex:e.endIndex-t})),leftOffset:i,rightOffset:o}}function cZ(e,t,r){let{customDecorations:n=[]}=e,i=[];return n.forEach(e=>{if(Math.max(e.startIndex,t)<=Math.min(e.endIndex,r-1)){let n=ai.deepClone(e);i.push({...n,startIndex:Math.max(n.startIndex-t,0),endIndex:Math.min(n.endIndex,r)-t})}}),i}function c0(e,t,r=aF.COVER){if(""!==t.dataStream)throw Error("Cannot compose other body with non-empty dataStream");let n={dataStream:e.dataStream},{textRuns:i=[],paragraphs:o=[]}=e,{textRuns:s=[],paragraphs:a=[]}=t,l=cV(s,i,r);l.length&&(n.textRuns=l);let u=[],c=0,h=0;for(;c<o.length&&h<a.length;){let e=o[c],t=a[h],{startIndex:r}=e,{startIndex:n}=t;r===n?(u.push(ai.deepMerge(e,t)),c++,h++):r<n?(u.push(ai.deepClone(e)),c++):(u.push(ai.deepClone(t)),h++)}return c<o.length&&u.push(...o.slice(c)),h<a.length&&u.push(...a.slice(h)),u.length&&(n.paragraphs=u),n}function c1(e){let{body:t}=e;if(null==t)return!0;let{textRuns:r=[],paragraphs:n=[],customRanges:i=[],customBlocks:o=[],customDecorations:s=[]}=t;return 0===r.length&&0===n.length&&0===i.length&&0===o.length&&0===s.length}e7(cq,"getBodySlice"),e7(cJ,"normalizeBody"),e7(cQ,"getCustomRangeSlice"),e7(cZ,"getCustomDecorationSlice"),e7(c0,"composeBody"),e7(c1,"isUselessRetainAction");let c2=class{constructor(e){te(this,"_index",0),te(this,"_offset",0),this._actions=e}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(e){e||(e=Number.POSITIVE_INFINITY);let t=this._actions[this._index];if(!t)return{t:uB.RETAIN,len:Number.POSITIVE_INFINITY};{let r=this._offset,n=t.len;return e>=n-r?(e=n-r,this._index+=1,this._offset=0):this._offset+=e,t.t===uB.DELETE||t.t===uB.RETAIN&&null==t.body?ai.deepClone({...t,len:e}):ai.deepClone({...t,len:e,body:cq(t.body,r,r+e)})}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){let e=this._actions[this._index];return e?e.t:uB.RETAIN}rest(){if(!this.hasNext())return[];if(0===this._offset)return this._actions.slice(this._index);{let e=this._offset,t=this._index,r=this.next(),n=this._actions.slice(this._index);return this._offset=e,this._index=t,[r].concat(n)}}};function c5(e,t,r){let{dataStream:n}=e,i=r+t,o=cL(e,t,r),s=cM(e,t,r),a=cU(e,t,r),l=cP(e,t,r),u=ck(e,t,r),c=cF(e,t,r),h=cj(e,t,r),d="";return n&&(e.dataStream=ln(n,r,i),d=n.slice(r,i)),{dataStream:d,textRuns:o,paragraphs:s,sectionBreaks:a,customBlocks:l,tables:u,customRanges:c,customDecorations:h}}function c3(e,t,r,n){e.dataStream=lr(e.dataStream,n,t.dataStream),cI(e,t,r,n),cC(e,t,r,n),cS(e,t,r,n),cx(e,t,r,n),cO(e,t,r,n),cA(e,t,r,n),cD(e,t,r,n)}function c6(e,t,r,n,i=aF.COVER){return cB(e,t,r,n,i)}function c4(e,t,r){return t<=0?{dataStream:""}:c5(e,t,r)}function c9(e,t,r,n){0!==r&&c3(e,t,r,n)}function c8(e,t){let r=new ow;return r.reset(),t.forEach(t=>{let n=ai.deepClone(t);switch(n.t){case uB.RETAIN:{let{coverType:t,body:i,len:o}=n;null!=i&&c6(e,i,o,r.cursor,t),r.moveCursor(o);break}case uB.INSERT:{let{body:t,len:i}=n;c9(e,t,i,r.cursor),r.moveCursor(i);break}case uB.DELETE:{let{len:t}=n;c4(e,t,r.cursor);break}default:throw Error(`Unknown action type for action: ${n}.`)}}),e}function c7(e,t,r){if(0===e.length)return t;t=ai.deepClone(t),e=ai.deepClone(e);let n=[],i=t.length,o=e.length,s=0,a=0,l=null;function u(){return!!l&&(n.push(l),l=null,!0)}for(e7(u,"pushPendingAndReturnStatus");s<i&&a<o;){let{st:i,ed:o,ts:c}=t[s],{st:h,ed:d,ts:p,sId:f}=e[a],g={};if(0===r)g={...c};else if(g={...c},p)for(let e of Object.keys(p))g[e]&&delete g[e];if(o<h)u()||n.push(t[s]),s++;else if(d<i)u()||n.push(e[a]),a++;else{let r={st:Math.min(i,h),ed:Math.max(i,h),ts:i<h?{...c}:{...p},sId:i<h?void 0:f};r.ed>r.st&&n.push(),n.push({st:Math.max(i,h),ed:Math.min(o,d),ts:g,sId:f}),o<d?(s++,e[a].st=o,e[a].st===e[a].ed&&a++):(a++,t[s].st=d,t[s].st===t[s].ed&&s++);let u={st:Math.min(o,d),ed:Math.max(o,d),ts:o<d?{...p}:{...c},sId:o<d?f:void 0};l=u.ed>u.st?u:null}}u();let c=n[n.length-1],h=t[i-1],d=e[o-1];return c.ed!==Math.max(h.ed,d.ed)&&(h.ed>d.ed?n.push(h):n.push(d)),cT(n)}function he(e,t,r,n=aF.COVER){if(0===e.length)return ai.deepClone(t);if(n===aF.REPLACE)return 1===r?ai.deepClone(e):ai.deepClone(t);throw Error("CustomRanges is only supported in replace mode.")}function ht(e,t,r,n=aF.COVER){let i={startIndex:t.startIndex};if(t.paragraphStyle){if(null==e.paragraphStyle)i.paragraphStyle={...t.paragraphStyle};else if(n===aF.REPLACE)i.paragraphStyle=1===r?{...e.paragraphStyle}:{...t.paragraphStyle};else if(i.paragraphStyle={...t.paragraphStyle},1===r)for(let t of Object.keys(e.paragraphStyle))i.paragraphStyle[t]&&delete i.paragraphStyle[t]}if(t.bullet){if(null==e.bullet)i.bullet={...t.bullet};else if(n===aF.REPLACE)i.bullet=1===r?{...e.bullet}:{...t.bullet};else throw Error("Bullet is only supported in replace mode.")}return i}function hr(e,t,r=!1){let{body:n,coverType:i}=e,{body:o,coverType:s}=t;if(null==n||""!==n.dataStream||null==o||""!==o.dataStream)throw Error("Data stream is not supported in retain transform.");if(i!==s)throw Error("Cover type is not consistent.");let a={dataStream:""},{textRuns:l=[],paragraphs:u=[],customRanges:c=[]}=n,{textRuns:h=[],paragraphs:d=[],customRanges:p=[]}=o,f=[];(f=r?c7(l,h,1):c7(l,h,0)).length&&(a.textRuns=f);let g=[];(g=r?he(c,p,1,i):he(c,p,0,i)).length&&(a.customRanges=g);let m=[],_=0,y=0;for(;_<u.length&&y<d.length;){let e=u[_],t=d[y],{startIndex:n}=e,{startIndex:o}=t;if(n===o){let o={startIndex:n};o=r?ht(e,t,1,i):ht(e,t,0,i),m.push(o),_++,y++}else n<o?_++:(m.push(ai.deepClone(t)),y++)}return y<d.length&&m.push(...d.slice(y)),m.length&&(a.paragraphs=m),a}function hn(e){return 1===Object.keys(e).length}e7(c2,"ActionIterator"),e7(c5,"updateAttributeByDelete"),e7(c3,"updateAttributeByInsert"),e7(c6,"updateApply"),e7(c4,"deleteApply"),e7(c9,"insertApply"),e7(c8,"textXApply"),e7(c7,"transformTextRuns"),e7(he,"transformCustomRanges"),e7(ht,"transformParagraph"),e7(hr,"transformBody"),e7(hn,"onlyHasDataStream");let hi=class e{constructor(){te(this,"_actions",[])}static apply(e,t){return c8(e,t)}static compose(t,r){let n=new c2(t),i=new c2(r),o=new e;for(;n.hasNext()||i.hasNext();)if(i.peekType()===uB.INSERT)o.push(i.next());else if(n.peekType()===uB.DELETE)o.push(n.next());else{let e=Math.min(n.peekLength(),i.peekLength()),t=n.next(e),r=i.next(e);t.t===uB.INSERT&&r.t===uB.RETAIN?null==r.body?o.push(t):o.push({...t,body:c0(t.body,r.body,r.coverType)}):t.t===uB.RETAIN&&r.t===uB.RETAIN?null==t.body&&null==r.body?o.push(t.len!==Number.POSITIVE_INFINITY?t:r):t.body&&r.body?o.push({...t,body:c0(t.body,r.body,r.coverType)}):o.push(t.body?t:r):t.t===uB.RETAIN&&r.t===uB.DELETE?o.push(r):t.t===uB.INSERT&&(r.t,uB.DELETE)}return o.trimEndUselessRetainAction(),o.serialize()}static transform(e,t,r="right"){return this._transform(t,e,"left"===r?"right":"left")}static _transform(t,r,n="right"){let i=new c2(t),o=new c2(r),s=new e;for(;i.hasNext()||o.hasNext();)if(i.peekType()===uB.INSERT&&("left"===n||o.peekType()!==uB.INSERT)){let e=i.next();s.retain(e.len)}else if(o.peekType()===uB.INSERT)s.push(o.next());else{let e=Math.min(i.peekLength(),o.peekLength()),t=i.next(e),r=o.next(e);if(t.t===uB.DELETE)continue;if(r.t===uB.DELETE){s.push(r);continue}null==t.body||null==r.body?s.push(r):s.push({...r,body:hr(t,r,"left"===n)})}return s.trimEndUselessRetainAction(),s.serialize()}static transformPosition(e,t,r=!1){let n=new c2(e),i=0;for(;n.hasNext()&&i<=t;){let e=n.peekLength(),o=n.peekType();if(n.next(),o===uB.DELETE){t-=Math.min(e,t-i);continue}o===uB.INSERT&&(i<t||!r)&&(t+=e),i+=e}return t}static isNoop(e){return 0===e.length}static invert(e){let t=[];for(let r of e)if(r.t===uB.INSERT)t.push({t:uB.DELETE,len:r.len,body:r.body});else if(r.t===uB.DELETE){if(null==r.body)throw Error("Can not invert DELETE action without body property, makeInvertible must be called first.");t.push({t:uB.INSERT,body:r.body,len:r.len})}else if(null!=r.body){if(null==r.oldBody)throw Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");t.push({t:uB.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:aF.REPLACE})}else t.push(r);return t}static makeInvertible(e,t){let r=[],n=0;for(let i of e){if(i.t===uB.DELETE&&null==i.body){let e=cq(t,n,n+i.len,!1);i.len=e.dataStream.length,i.body=e}if(i.t===uB.RETAIN&&null!=i.body){let e=cq(t,n,n+i.len,!0);i.oldBody={...e,dataStream:""},i.len=e.dataStream.length}r.push(i),i.t!==uB.INSERT&&(n+=i.len)}return r}insert(e,t){let r={t:uB.INSERT,body:t,len:e};return this.push(r),this}retain(e,t,r){let n={t:uB.RETAIN,len:e};return null!=t&&(n.body=t),null!=r&&(n.coverType=r),this.push(n),this}delete(e){let t={t:uB.DELETE,len:e};return this.push(t),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...e){if(e.length>1){for(let t of e)this.push(t);return this}let t=this._actions.length,r=this._actions[t-1],n=ai.deepClone(e[0]);if(n.t===uB.RETAIN&&0===n.len&&null==n.body)return this;if("object"==typeof r){if(r.t===uB.DELETE&&n.t===uB.DELETE)return r.len+=n.len,this;if(r.t===uB.DELETE&&n.t===uB.INSERT&&(t-=1,null==(r=this._actions[t-1])))return this._actions.unshift(n),this;if(r.t===uB.RETAIN&&n.t===uB.RETAIN&&null==r.body&&null==n.body)return r.len+=n.len,this;if(r.t===uB.INSERT&&hn(r.body)&&n.t===uB.INSERT&&hn(n.body))return r.len+=n.len,r.body.dataStream+=n.body.dataStream,this}return t===this._actions.length?this._actions.push(n):this._actions.splice(t,0,n),this}trimEndUselessRetainAction(){let e=this._actions[this._actions.length-1];for(;e&&e.t===uB.RETAIN&&c1(e);)this._actions.pop(),e=this._actions[this._actions.length-1];return this}};e7(hi,"TextX"),te(hi,"id","text-x"),te(hi,"uri","https://github.com/dream-num/univer#text-x");let ho=hi;Object.defineProperty(ho,"name",{value:"text-x"});let hs=class e{static registerSubtype(e){var t;null==e||this._subTypes.has(e.name)&&(null==(t=this._subTypes.get(e.name))?void 0:t.id)!==ho.id||(this._subTypes.set(e.name,e),un.type.registerSubtype(e))}static apply(e,t){if(!un.type.isNoop(t))return un.type.apply(e,t)}static compose(e,t){return un.type.compose(e,t)}static transform(e,t,r){return un.type.transform(e,t,r)}static transformPosition(e,t,r="right"){return e&&2===e.length&&"body"===e[0]&&e[1].et===ho.name?ho.transformPosition(e[1].e,t,"left"===r):t}static invertWithDoc(e,t){return un.type.invertWithDoc(e,t)}static isNoop(e){return un.type.isNoop(e)}static getInstance(){return null==this._instance&&(this._instance=new e),this._instance}removeOp(e,t){return un.removeOp(e,t)}moveOp(e,t){return un.moveOp(e,t)}insertOp(e,t){return un.insertOp(e,t)}replaceOp(e,t,r){return un.replaceOp(e,t,r)}editOp(e,t=["body"]){return un.editOp(t,ho.name,e)}};e7(hs,"JSONX"),te(hs,"uri","https://github.com/dream-num/univer#json-x"),te(hs,"_subTypes",/* @__PURE__ */new Map),te(hs,"_instance",null);let ha=hs;ha.registerSubtype(ho);let hl={id:"default_doc",documentStyle:{}},hu=class extends ut{constructor(e){var t;super(),te(this,"type",l9.UNIVER_DOC),te(this,"_name$",new eY.BehaviorSubject("")),te(this,"name$",this._name$.asObservable()),te(this,"snapshot"),this.snapshot={...hl,...e},this._name$.next(null!=(t=this.snapshot.title)?t:"No Title")}getUnitId(){throw Error("Method not implemented.")}getRev(){var e;return null!=(e=this.snapshot.rev)?e:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(e){this.snapshot.rev=e}setName(e){this.snapshot.title=e,this._name$.next(e)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var e;return(null==(e=this.snapshot.settings)?void 0:e.zoomRatio)||1}resetDrawing(e,t){this.snapshot.drawings=e,this.snapshot.drawingsOrder=t}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var e;let t=null!=(e=this.snapshot.lists)?e:{};return{...cv,...t}}updateDocumentId(e){this.snapshot.id=e}updateDocumentRenderConfig(e){let{documentStyle:t}=this.snapshot;null==t.renderConfig?t.renderConfig=e:t.renderConfig={...t.renderConfig,...e}}updateDocumentStyle(e){null==this.snapshot.documentStyle?this.snapshot.documentStyle=e:this.snapshot.documentStyle={...this.snapshot.documentStyle,...e}}updateDocumentDataMargin(e){let{t,l:r,b:n,r:i}=e,{documentStyle:o}=this.snapshot;null!=t&&(o.marginTop=t),null!=r&&(o.marginLeft=r),null!=n&&(o.marginBottom=n),null!=i&&(o.marginRight=i)}updateDocumentDataPageSize(e,t){let{documentStyle:r}=this.snapshot;if(!r.pageSize){e=null!=e?e:Number.POSITIVE_INFINITY,t=null!=t?t:Number.POSITIVE_INFINITY,r.pageSize={width:e,height:t};return}void 0!==e&&(r.pageSize.width=e),void 0!==t&&(r.pageSize.height=t)}updateDrawing(e,t){let{drawings:r}=this,{width:n,height:i,left:o,top:s}=t,a=null==r?void 0:r[e];if(!a)return;let l=a.docTransform;l.size.width=n,l.size.height=i,l.positionH.posOffset=o,l.positionV.posOffset=s}setZoomRatio(e=1){null==this.snapshot.settings?this.snapshot.settings={zoomRatio:e}:this.snapshot.settings.zoomRatio=1}};e7(hu,"DocumentDataModelSimple");let hc=hu,hh=class e extends hc{constructor(e){var t,r;super(ai.isEmptyObject(e)?ur():e),te(this,"_unitId"),te(this,"headerModelMap",/* @__PURE__ */new Map),te(this,"footerModelMap",/* @__PURE__ */new Map),this._unitId=null!=(t=this.snapshot.id)?t:ai.generateRandomId(6),this._initializeHeaderFooterModel(),this._name$.next(null!=(r=this.snapshot.title)?r:"")}dispose(){super.dispose(),this.headerModelMap.forEach(e=>{e.dispose()}),this.footerModelMap.forEach(e=>{e.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var e;return null==(e=this.snapshot.body)?void 0:e.customRanges}getCustomDecorations(){var e;return null==(e=this.snapshot.body)?void 0:e.customDecorations}getSettings(){return this.snapshot.settings}reset(e){if(e.id&&e.id!==this._unitId)throw Error("Cannot reset a document model with a different unit id!");this.snapshot={...hl,...e},this._initializeHeaderFooterModel()}getSelfOrHeaderFooterModel(e){if(null!=e){if(this.headerModelMap.has(e))return this.headerModelMap.get(e);if(this.footerModelMap.has(e))return this.footerModelMap.get(e)}return this}getUnitId(){return this._unitId}apply(e){if(!ha.isNoop(e))return this.snapshot=ha.apply(this.snapshot,e),null!=e&&e.some(e=>Array.isArray(e)&&((null==e?void 0:e[0])==="headers"||(null==e?void 0:e[0])==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.snapshot}sliceBody(e,t,r=cX.copy){let n=this.getBody();if(null!=n)return cq(n,e,t,!1,r)}_initializeHeaderFooterModel(){let{headers:t,footers:r}=this.getSnapshot();if(t)for(let r in t){let n=t[r];this.headerModelMap.set(r,new e(n)),this.headerModelMap.get(r).updateDocumentId(this.getUnitId())}if(r)for(let t in r){let n=r[t];this.footerModelMap.set(t,new e(n)),this.footerModelMap.get(t).updateDocumentId(this.getUnitId())}}updateDocumentId(e){super.updateDocumentId(e),this._unitId=e}};e7(hh,"DocumentDataModel");let hd=hh;function hp(e){return e===uV.CUSTOM_RANGE_END||e===uV.CUSTOM_RANGE_START}function hf(e,t,r,n){return e<=r&&t>=r||e>=r&&e<=n}function hg(e,t,r,n){let i=n.slice(r.startIndex+1,r.endIndex),o=Math.max(e-(r.startIndex+1),0),s=e+t-1-(r.startIndex+1);if(s<0)return!1;if(0===o&&s>=i.length)return!0;let a=i.slice(0,o)+i.slice(o+t);for(let e=0,t=a.length;e<t;e++)if(!hp(a[e]))return!1;return!0}function hm(e,t){let r=[];for(let n=0,i=t.length;n<i;n++){let i=t[n];e.collapsed?i.startIndex<e.startOffset&&e.startOffset<=i.endIndex&&r.push(i):hf(e.startOffset,e.endOffset-1,i.startIndex,i.endIndex)&&r.push(i)}return r}function h_(e){return{...ai.deepClone(e),rangeId:ao()}}function hy(e,t){let r=[],n=e[0];for(let i of t)i<e[0]||i>e[1]||(n<i&&r.push([n,i-1]),n=i+1);return n<=e[1]&&r.push([n,e[1]]),r}e7(hp,"isCustomRangeSplitSymbol"),e7(hf,"isIntersecting"),e7(hg,"shouldDeleteCustomRange"),e7(hm,"getCustomRangesInterestsWithSelection"),e7(h_,"copyCustomRange"),e7(hy,"excludePointsFromRange");let hE=/* @__PURE__ */e7(e=>{var t,r,n;let{paragraphs:i,segmentId:o,document:s}=e,a=e.listType,l=null!=(r=null==(t=s.getSelfOrHeaderFooterModel(o).getBody())?void 0:t.paragraphs)?r:[],u=i.every(e=>{var t;return(null==(t=e.bullet)?void 0:t.listType.indexOf(a))===0}),c=ai.generateRandomId(6);if(1===i.length){let e=l.indexOf(i[0]),t=l[e-1],r=l[e+1];t&&t.bullet&&0===t.bullet.listType.indexOf(a)?(c=t.bullet.listId,a!==cg.CHECK_LIST&&(a=t.bullet.listType)):r&&r.bullet&&0===r.bullet.listType.indexOf(a)&&(c=r.bullet.listId,a!==cg.CHECK_LIST&&(a=r.bullet.listType))}let h=new ow;h.reset();let d=new ho;for(let e of i){let{startIndex:t,paragraphStyle:r={},bullet:i}=e;d.push({t:uB.RETAIN,len:t-h.cursor}),d.push({t:uB.RETAIN,len:1,body:{dataStream:"",paragraphs:[u?{paragraphStyle:r,startIndex:0}:{startIndex:0,paragraphStyle:{...r},bullet:{nestingLevel:null!=(n=null==i?void 0:i.nestingLevel)?n:0,textStyle:{fs:20},listType:a,listId:c}}]},coverType:aF.REPLACE}),h.moveCursorTo(t+1)}return d},"switchParagraphBullet"),hv=/* @__PURE__ */e7(e=>{var t;let{paragraphIndex:r,segmentId:n,document:i}=e,o=null==(t=i.getSelfOrHeaderFooterModel(n).getBody())?void 0:t.paragraphs;if(null==o)return!1;let s=o.find(e=>e.startIndex===r);if(!(null!=s&&s.bullet)||-1===s.bullet.listType.indexOf(cg.CHECK_LIST))return!1;let a=new ow;a.reset();let l=new ho,{startIndex:u,paragraphStyle:c={}}=s,h=s.bullet.listType===cg.CHECK_LIST?cg.CHECK_LIST_CHECKED:cg.CHECK_LIST;return l.push({t:uB.RETAIN,len:u-a.cursor}),l.push({t:uB.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...s,paragraphStyle:c,startIndex:0,bullet:{...s.bullet,listType:h}}]},coverType:aF.REPLACE}),a.moveCursorTo(u+1),l},"toggleChecklistParagraph"),hb=/* @__PURE__ */e7(e=>{var t,r;let{paragraphs:n,listType:i,segmentId:o,document:s}=e;if((null==(t=s.getSelfOrHeaderFooterModel(o).getBody())?void 0:t.paragraphs)==null)return!1;let a=ai.generateRandomId(6),l=new ow;l.reset();let u=new ho;for(let e of n){let{startIndex:t,paragraphStyle:n={},bullet:o}=e;u.push({t:uB.RETAIN,len:t-l.cursor}),u.push({t:uB.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:n,bullet:{nestingLevel:null!=(r=null==o?void 0:o.nestingLevel)?r:0,textStyle:(null==o?void 0:o.listType)===i?o.textStyle:{fs:20},listType:i,listId:a}}]},coverType:aF.REPLACE}),l.moveCursorTo(t+1)}return u},"setParagraphBullet");function hR(e,t){return t.some(t=>e.startIndex>t.startIndex&&e.startIndex<t.endIndex)}e7(hR,"hasParagraphInTable");let hT=/* @__PURE__ */e7(e=>{var t,r,n;let{paragraphs:i,segmentId:o,document:s,type:a}=e,l=new ow;l.reset();let u=new ho,c=null!=(t=s.getSnapshot().lists)?t:{},h=null!=(n=null==(r=s.getBody())?void 0:r.tables)?n:[],d={...cv,...c};for(let e of i){let{startIndex:t,paragraphStyle:r={},bullet:n}=e,i=hR(e,h);if(u.push({t:uB.RETAIN,len:t-l.cursor}),n){let e=d[n.listType].nestingLevel.length-1;i&&(e=Math.min(e,2)),u.push({t:uB.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...r},bullet:{...n,nestingLevel:Math.max(Math.min(n.nestingLevel+a,e),0)}}]},coverType:aF.REPLACE})}else u.push({t:uB.RETAIN,len:1});l.moveCursorTo(t+1)}return u},"changeParagraphBulletNestLevel");var hI=((eP=hI||{})[eP.SLIDE=0]="SLIDE",eP[eP.MASTER=1]="MASTER",eP[eP.LAYOUT=2]="LAYOUT",eP[eP.HANDOUT_MASTER=3]="HANDOUT_MASTER",eP[eP.NOTES_MASTER=4]="NOTES_MASTER",eP),hC=((ek=hC||{})[ek.SHAPE=0]="SHAPE",ek[ek.IMAGE=1]="IMAGE",ek[ek.TEXT=2]="TEXT",ek[ek.SPREADSHEET=3]="SPREADSHEET",ek[ek.DOCUMENT=4]="DOCUMENT",ek[ek.SLIDE=5]="SLIDE",ek),hS=((eF=hS||{})[eF.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",eF[eF.NEXT_SLIDE=1]="NEXT_SLIDE",eF[eF.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",eF[eF.FIRST_SLIDE=3]="FIRST_SLIDE",eF[eF.LAST_SLIDE=4]="LAST_SLIDE",eF);let hx=[uV.TABLE_START,uV.TABLE_ROW_START,uV.TABLE_CELL_START,uV.TABLE_CELL_END,uV.TABLE_ROW_END,uV.TABLE_END,uV.CUSTOM_RANGE_START,uV.CUSTOM_RANGE_END,uV.CUSTOM_BLOCK],hO=/* @__PURE__ */e7(e=>{let t=e.endsWith(`\r
`)?e.slice(0,-2):e;return hx.reduce((e,t)=>e.replaceAll(t,""),t)},"getPlainText"),hA=/* @__PURE__ */e7(e=>!e||""===hO(e).replaceAll("\r",""),"isEmptyDocument"),hw=/* @__PURE__ */e7(e=>{let t=e.replace(/\n/g,"\r"),r=[],n=[],i=0,o="",s=0,a=/* @__PURE__ */e7((a,l=!0)=>{let u=t.slice(i,a);if(ai.isLegalUrl(u)){let t=ao(),c=`${uV.CUSTOM_RANGE_START}${u}${uV.CUSTOM_RANGE_END}`,h={startIndex:i+2*s,endIndex:i+2*s+c.length-1,rangeId:t,rangeType:uY.HYPERLINK,properties:{url:e}};n.push(h),o+=c,i=a+1,s++,l&&(o+="\r",r.push({startIndex:a+2*s}))}else o+=t.slice(i,a+1),i=a+1,l&&r.push({startIndex:a+2*s})},"loopParagraph"),l=0;for(let e=0;e<t.length;e++)"\r"===t[e]&&(a(e),l=e);return l!==t.length-1&&a(t.length,!1),{dataStream:o,paragraphs:r,customRanges:n}},"fromPlainText");function hN(e,t){if(typeof t>"u")return{startOffset:e,endOffset:e,collapsed:!0};if(t<e)throw Error(`Cannot make a doc selection when endOffset ${t} is less than startOffset ${e}.`);return{startOffset:e,endOffset:t,collapsed:e===t}}function hD(e){let{startOffset:t,endOffset:r,collapsed:n}=e;return{startOffset:Math.min(t,r),endOffset:Math.max(t,r),collapsed:n}}function hL(e,t){let{startOffset:r,endOffset:n}=hD(e);for(;t.dataStream[r-1]===uV.CUSTOM_RANGE_START;)r-=1;for(;t.dataStream[r]===uV.CUSTOM_RANGE_END;)r+=1;for(;t.dataStream[n]===uV.CUSTOM_RANGE_END;)n+=1;for(;t.dataStream[n-1]===uV.CUSTOM_RANGE_START;)n-=1;return{startOffset:r,endOffset:n}}function hM(e,t,r=sI.LEFT){var n;let{startOffset:i,endOffset:o,collapsed:s}=hD(e);if(s){if(r===sI.LEFT)for(;hp(t.dataStream[i-1]);)o-=1,i-=1;else for(;hp(t.dataStream[i]);)o+=1,i+=1}else{let r=hL(e,t);i=r.startOffset,o=r.endOffset}s=i===o;let a=null==(n=t.customRanges)?void 0:n.filter(e=>!!e.wholeEntity&&(!(i<=e.startIndex)||!(o>e.endIndex))&&hk(i,s?o:o-1,e.startIndex,e.endIndex));return null!=a&&a.length&&a.forEach(e=>{i=Math.min(e.startIndex,i),o=Math.max(e.endIndex+1,o)}),{...e,startOffset:i,endOffset:o,collapsed:i===o}}function hU(e,t){let{startOffset:r,endOffset:n,collapsed:i}=hD(e);if(!i)return{...e,...hL(e,t),collapsed:!1};for(;t.dataStream[n]===uV.CUSTOM_RANGE_END;)n+=1,r+=1;for(;t.dataStream[n-1]===uV.CUSTOM_RANGE_START;)n-=1,r-=1;return{...e,startOffset:r,endOffset:n,collapsed:i}}function hP(e,t){if(e.startOffset===e.endOffset)return null;let r=t.customRanges;if(!r)return hD(e);let{startOffset:n,endOffset:i}=hL(e,t);for(;hp(t.dataStream[n]);){if(t.dataStream[n]===uV.CUSTOM_RANGE_START){let e=r.find(e=>e.startIndex===n);if(!e)throw Error("No custom-range matched");if(e.endIndex===i-1)return{startOffset:n,endOffset:i,collapsed:!1};if(e.endIndex<i-1)break}n+=1}for(;hp(t.dataStream[i-1]);){if(t.dataStream[n]===uV.CUSTOM_RANGE_END){let e=r.find(e=>e.endIndex===i-1);if(!e)throw Error("No custom-range matched");if(e.startIndex===n)return{startOffset:n,endOffset:i,collapsed:!1};if(e.startIndex>n)break}i-=1}return i<=n?null:{startOffset:n,endOffset:i,collapsed:!1}}function hk(e,t,r,n){return Math.max(e,r)<=Math.min(t,n)}function hF(e,t="",r,n){var i;let{startOffset:o,endOffset:s}=e,a=[],l=o-r,u=s-r,c=n.dataStream,h=null==(i=n.customRanges)?void 0:i.filter(e=>hf(e.startIndex,e.endIndex,o,s-1)),d=new Set(null==h?void 0:h.filter(e=>hg(o,s-o,e,c))),p=/* @__PURE__ */new Set;null==h||h.forEach(e=>{d.has(e)||(e.startIndex-r>=l&&e.startIndex-r<u&&e.endIndex-r>=u&&p.add(e.startIndex),e.endIndex-r>=l&&e.endIndex-r<u&&e.startIndex-r<l&&p.add(e.endIndex))}),l>0&&a.push({t:uB.RETAIN,len:l});let f=[...p].sort((e,t)=>e-t),g=l;return f.forEach(e=>{let t=e-g;t>0&&a.push({t:uB.DELETE,len:t}),a.push({t:uB.RETAIN,len:1}),g=e+1}),g<u&&(a.push({t:uB.DELETE,len:u-g}),g=u+1),{dos:a,cursor:g,retain:p.size}}function hj(e,t){var r,n;let{rangeId:i,segmentId:o,documentDataModel:s,insert:a,textRange:l}=t,u=null==(n=null==(r=s.getSelfOrHeaderFooterModel(o).getBody())?void 0:r.customRanges)?void 0:n.find(e=>e.rangeId===i);if(!u)return!1;let{startIndex:c,endIndex:h}=u,d=new ho,p=h-c+1;return c>0&&d.push({t:uB.RETAIN,len:c}),d.push({t:uB.DELETE,len:1}),l&&l.index>c&&l.index--,p-2>0&&d.push({t:uB.RETAIN,len:p-2}),d.push({t:uB.DELETE,len:1}),l&&l.index>h&&l.index--,a&&(d.push({body:a,t:uB.INSERT,len:a.dataStream.length}),l&&l.index>h&&(l.index+=a.dataStream.length)),d}function hB(e){var t,r;let{range:n,rangeId:i,rangeType:o,segmentId:s,wholeEntity:a,properties:l,body:u}=e,c=hP(n,u);if(!c||!u)return!1;let{startOffset:h,endOffset:d}=c,p=null!=(t=u.customRanges)?t:[],f=0,g=new ho,m=/* @__PURE__ */e7((e,t,r)=>{let n=[];for(let r=0,i=p.length;r<i;r++){let i=p[r];if(i.rangeType===o&&Math.max(i.startIndex,e)<=Math.min(i.endIndex,t)&&n.push({...i}),i.startIndex>t)break}let s=n.map(e=>[e.startIndex,e.endIndex]).flat().sort((e,t)=>e-t),u=s.length?{startOffset:Math.min(s[0],e),endOffset:Math.max(s[s.length-1]+1,t+1)}:{startOffset:e,endOffset:t+1};u.startOffset!==f&&(g.push({t:uB.RETAIN,len:u.startOffset-f}),f=u.startOffset),g.push({t:uB.INSERT,body:{dataStream:uV.CUSTOM_RANGE_START},len:1}),s.forEach(e=>{e!==f&&(g.push({t:uB.RETAIN,len:e-f}),f=e),g.push({t:uB.DELETE,len:1}),f++}),f!==u.endOffset&&(g.push({t:uB.RETAIN,len:u.endOffset-f}),f=u.endOffset),g.push({t:uB.INSERT,body:{dataStream:uV.CUSTOM_RANGE_END,customRanges:[{rangeId:r?`${i}-${r}`:i,rangeType:o,startIndex:-(u.endOffset-u.startOffset-s.length+1),endIndex:0,wholeEntity:a,properties:{...l}}]},len:1})},"addCustomRange"),_=(null!=(r=u.paragraphs)?r:[]).filter(e=>e.startIndex<d&&e.startIndex>h);return hy([h,d-1],_.map(e=>e.startIndex)).forEach(([e,t],r)=>m(e,t,r)),g}function hH(e,t,r="",n=0,i=!0){var o;let{startOffset:s,endOffset:a}=hM(e,t),l=[],{paragraphs:u=[],dataStream:c}=t,h=s-n,d=a-n,p=null==u?void 0:u.find(e=>e.startIndex-n>=h&&e.startIndex-n<d),f=null==(o=t.customRanges)?void 0:o.filter(e=>hf(e.startIndex,e.endIndex,s,a-1)),g=new Set(null==f?void 0:f.filter(e=>hg(s,a-s,e,c))),m=/* @__PURE__ */new Set;if(null==f||f.forEach(e=>{g.has(e)||(e.startIndex-n>=h&&e.startIndex-n<=d&&e.endIndex-n>d&&m.add(e.startIndex),e.endIndex-n>=h&&e.endIndex-n<=d&&e.startIndex<h&&m.add(e.endIndex))}),h>0&&l.push({t:uB.RETAIN,len:h}),i&&p&&p.startIndex-n>h){let e=p.startIndex-n;m.add(e)}let _=[...m].sort((e,t)=>e-t),y=h;if(_.forEach(e=>{let t=e-y;t>0&&l.push({t:uB.DELETE,len:t}),l.push({t:uB.RETAIN,len:1}),y=e+1}),y<d&&(l.push({t:uB.DELETE,len:d-y}),y=d),!i){let e=u.find(e=>e.startIndex-n>=d);e&&(e.startIndex>y&&(l.push({t:uB.RETAIN,len:e.startIndex-y}),y=e.startIndex),l.push({t:uB.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...e,startIndex:0,bullet:null==p?void 0:p.bullet}]},coverType:aF.REPLACE}))}return l}e7(hN,"makeSelection"),e7(hD,"normalizeSelection"),e7(hL,"getSelectionWithSymbolMax"),e7(hM,"getDeleteSelection"),e7(hU,"getInsertSelection"),e7(hP,"getSelectionForAddCustomRange"),e7(hk,"isSegmentIntersects"),e7(hF,"getRetainAndDeleteFromReplace"),e7(hj,"deleteCustomRangeTextX"),e7(hB,"addCustomRangeTextX"),e7(hH,"getRetainAndDeleteAndExcludeLineBreak");let hV=/* @__PURE__ */e7(e=>{var t;let{selection:r,body:n,doc:i}=e,o=r.segmentId,s=null==(t=i.getSelfOrHeaderFooterModel(o))?void 0:t.getBody();if(!s)return!1;let a=new ho,l=hH(r,s,o);return l.length&&a.push(...l),a.push({t:uB.INSERT,body:n,len:n.dataStream.length}),a},"replaceSelectionTextX"),h$=class{};e7(h$,"BuildTextUtils"),te(h$,"customRange",{add:hB,delete:hj,copyCustomRange:h_,getCustomRangesInterestsWithSelection:hm,shouldDeleteCustomRange:hg,isIntersecting:hf}),te(h$,"selection",{replace:hV,makeSelection:hN,normalizeSelection:hD,getDeleteSelection:hM,getInsertSelection:hU,getDeleteActions:hF,getDeleteExcludeLastLineBreakActions:hH}),te(h$,"range",{isIntersects:hk}),te(h$,"transform",{getPlainText:hO,fromPlainText:hw,isEmptyDocument:hA}),te(h$,"paragraph",{bullet:{set:hb,switch:hE,toggleChecklist:hv,changeNestLevel:hT}});let hG=h$;e7(function(e,t,r){let n;if(""===t)return e;let i=new hd({id:"mock-id",body:e,documentStyle:{}}),o=t.length;for(;(n=i.getBody().dataStream.indexOf(t))>=0;){let e=new ho,t=ha.getInstance();if(n>0&&e.retain(n),r.length>0){let t=i.sliceBody(n,n+o),s={dataStream:r};Array.isArray(null==t?void 0:t.textRuns)&&t.textRuns.length&&(s.textRuns=[{...t.textRuns[0],st:0,ed:r.length}]),e.insert(r.length,s)}e.delete(o),i.apply(t.editOp(e.serialize()))}let s=i.getBody();return i.dispose(),s},"replaceInDocumentBody");let hW=class{constructor(){te(this,"skipNextObservers",!1),te(this,"lastReturnValue"),te(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}};e7(hW,"EventState");let hz=class extends e5.Subject{constructor(){super(...arguments),te(this,"_sortedObservers",[])}subscribe(){throw Error("[EventSubject]: please use `subscribeEvent` instead of `subscribe` method for `EventSubject`.")}next(){throw Error("[EventSubject]: please use `emitEvent` instead of `next` method for `EventSubject`.")}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(e){let t;t="function"==typeof e?{next:/* @__PURE__ */e7(([t,r])=>e(t,r),"next")}:e;let r=super.subscribe(t);return this._sortedObservers.push(t),this._sortedObservers.sort((e,t)=>{var r,n;return(null!=(r=e.priority)?r:0)-(null!=(n=t.priority)?n:0)}),r.add(()=>this._sortedObservers=this._sortedObservers.filter(e=>e!==t)),r}clearObservers(){this._sortedObservers.forEach(e=>{var t;return null==(t=e.complete)?void 0:t.call(e)}),this._sortedObservers.length=0}emitEvent(e){var t;if(!this.closed){let r=new hW;for(let n of(r.lastReturnValue=e,this._sortedObservers)){let i=null==(t=n.next)?void 0:t.call(n,[e,r]);if(r.lastReturnValue=i,r.skipNextObservers)return{handled:!0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}throw Error("[EventSubject]: cannot emit event on a closed subject.")}};e7(hz,"EventSubject");let hY=hz;function hK(e){return new e0.Observable(t=>{let r=e.subscribeEvent(e=>{t.next(e)});return()=>r.unsubscribe()})}e7(hK,"fromEventSubject");let hX=iy("core.resource-manager.service"),hq={[l8.Editor]:"Editor",[l8.Owner]:"Owner",[l8.Reader]:"Reader",[l8.UNRECOGNIZED]:"UNRECOGNIZED"},hJ=/* @__PURE__ */e7(e=>e?{userID:`${hq[e]}_${ai.generateRandomId(8)}`,name:hq[e],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},"createDefaultUser"),hQ=/* @__PURE__ */e7((e,t)=>e.startsWith(hq[t]),"isDevRole"),hZ=class{constructor(){te(this,"_model",/* @__PURE__ */new Map),te(this,"_userChange$",new e5.Subject),te(this,"userChange$",this._userChange$.asObservable()),te(this,"_currentUser$",new eY.BehaviorSubject(hJ())),te(this,"currentUser$",this._currentUser$.asObservable())}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(e){this.addUser(e),this._currentUser$.next(e)}addUser(e){this._model.set(e.userID,e),this._userChange$.next({type:"add",user:e})}getUser(e,t){let r=this._model.get(e);if(r)return r;t&&t()}delete(e){let t=this.getUser(e);this._model.delete(e),t&&this._userChange$.next({type:"delete",user:t})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}};e7(hZ,"UserManagerService");let h0=hZ;var h1,h2,h5,h3,h6=Object.defineProperty,h4=Object.getOwnPropertyDescriptor,h9=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?h4(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&h6(t,r,o),o},"__decorateClass$6"),h8=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$6");let h7=(h3=class{constructor(e,t){te(this,"_permissionMap",/* @__PURE__ */new Map([])),this._resourceManagerService=e,this._userManagerService=t,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){let e=this._userManagerService.getCurrentUser();e&&e.userID||this._userManagerService.setCurrentUser(hJ(l8.Owner))}_getRole(e){let t=this._userManagerService.getCurrentUser();return!!t&&hQ(t.userID,e)}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:/* @__PURE__ */e7(e=>JSON.stringify([...this._permissionMap.keys()].reduce((e,t)=>{let r=this._permissionMap.get(t);return e[t]=r,e},{})),"toJson"),parseJson:/* @__PURE__ */e7(e=>JSON.parse(e),"parseJson"),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[l9.UNIVER_SHEET,l9.UNIVER_DOC,l9.UNIVER_SLIDE],onLoad:/* @__PURE__ */e7((e,t)=>{for(let e in t)this._permissionMap.set(e,t[e])},"onLoad"),onUnLoad:/* @__PURE__ */e7(()=>{this._permissionMap.clear()},"onUnLoad")})}async create(e){return ao(8)}async allowed(e){return Promise.resolve([])}async batchAllowed(e){return Promise.resolve([])}async list(e){let t=[];return e.objectIDs.forEach(r=>{let n=this._permissionMap.get(r);if(n){let i={objectID:r,unitID:e.unitID,objectType:n.objectType,name:n.name,shareOn:!1,shareRole:l8.Owner,shareScope:-1,scope:{read:l7.AllCollaborator,edit:l7.AllCollaborator},creator:hJ(l8.Owner),strategies:[{action:6,role:1},{action:16,role:1},{action:17,role:1},{action:18,role:1},{action:19,role:1},{action:33,role:1},{action:34,role:1},{action:35,role:1},{action:36,role:1},{action:37,role:1},{action:38,role:1},{action:39,role:1},{action:40,role:1}],actions:e.actions.map(e=>({action:e,allowed:this._getRole(l8.Owner)||this._getRole(l8.Editor)}))};t.push(i)}}),t}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(e){}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(e){}},e7(h3,"AuthzIoLocalService"),h3);h7=h9([h8(0,hX),h8(1,ix(h0))],h7);let de=iy("IAuthzIoIoService"),dt=iy("univer.config-service"),dr=class{constructor(){te(this,"_configChanged$",new e5.Subject),te(this,"configChanged$",this._configChanged$.asObservable()),te(this,"_config",/* @__PURE__ */new Map)}dispose(){this._configChanged$.complete()}getConfig(e){return this._config.get(e)}setConfig(e,t,r){var n;let{merge:i=!1}=r||{},o=null!=(n=this._config.get(e))?n:{};o=i?ai.deepMerge(o,t):t,this._config.set(e,o),this._configChanged$.next({[e]:o})}deleteConfig(e){return this._config.delete(e)}subscribeConfigValue$(e){return new e0.Observable(t=>{Object.prototype.hasOwnProperty.call(this._config,e)&&t.next(this._config.get(e));let r=this.configChanged$.pipe((0,eJ.filter)(t=>Object.prototype.hasOwnProperty.call(t,e))).subscribe(r=>t.next(r[e]));return()=>r.unsubscribe()})}};e7(dr,"ConfigService");let dn="FOCUSING_UNIT",di="FOCUSING_SHEET",ds="FOCUSING_DOC",da="FOCUSING_SLIDE",dl="FOCUSING_EDITOR_BUT_HIDDEN",du="EDITOR_ACTIVATED",dc="FOCUSING_EDITOR_INPUT_FORMULA",dh="FOCUSING_FX_BAR_EDITOR",dd="FOCUSING_UNIVER_EDITOR",dp="FOCUSING_EDITOR_INPUT_FORMULA",df="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",dg="FOCUSING_COMMON_DRAWINGS",dm="FORMULA_EDITOR_ACTIVATED",d_=class extends oZ{constructor(){super(...arguments),te(this,"_error$",new e5.Subject),te(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(e){this._error$.next({errorKey:e})}};e7(d_,"ErrorService");let dy=d_;function dE(e="",t=sN.ZH_CN,r=""){return{id:e,sheetOrder:[],name:r,appVersion:"0.4.2",locale:t,styles:{},sheets:{},resources:[]}}e7(dE,"getEmptySnapshot");let dv=class{constructor(e={}){te(this,"_styles"),te(this,"_cacheMap",new lf(1e5)),this._styles=e,this._generateCacheMap()}each(e){return Object.entries(this._styles).forEach(e),this}search(e,t){return this._cacheMap.has(t)?this._cacheMap.get(t):this._getExistingStyleId(e)||"-1"}get(e){return"string"!=typeof e?e:(e=String(e),this._styles[e])}add(e,t){let r=ai.generateRandomId(6);return this._styles[r]=e,this._cacheMap.set(t,r),r}setValue(e){if(null==e)return;let t=JSON.stringify(e),r=this.search(e,t);return"-1"!==r?r:this.add(e,t)}toJSON(){return this._styles}getStyleByCell(e){let t;t=e&&ai.isObject(e.s)?e.s:(null==e?void 0:e.s)&&this.get(e.s);let r=null==e?void 0:e.interceptorStyle;return r?{...t,...r}:t}_generateCacheMap(){let{_styles:e,_cacheMap:t}=this;for(let r in e){let n=JSON.stringify(e[r]);t.set(n,r)}}_getExistingStyleId(e){let{_styles:t}=this;for(let r in t)if(ai.diffValue(t[r],e))return r;return null}};e7(dv,"Styles");let db=class{constructor(e,t){te(this,"_columnData",{}),this._config=e,this._columnData=t}getColumnData(){return this._columnData}getColVisible(e){let{_columnData:t}=this,r=t[e];return!r||r.hd!==sY.TRUE}getColumnStyle(e){var t;return null==(t=this._columnData[e])?void 0:t.s}setColumnStyle(e,t){this.getColumnOrCreate(e).s=t}getHiddenCols(e=0,t=this.getSize()-1){let r=[],n=!1,i=-1;for(let o=e;o<=t;o++){let e=this.getColVisible(o);n&&e?(n=!1,r.push({rangeType:a$.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):n||e||(n=!0,i=o)}return n&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:t,rangeType:a$.COLUMN}),r}getVisibleCols(e=0,t=this.getSize()-1){let r=[],n=!1,i=-1;for(let o=e;o<=t;o++){let e=this.getColVisible(o);n&&!e?(n=!1,r.push({rangeType:a$.COLUMN,startColumn:i,endColumn:o-1,startRow:0,endRow:0})):!n&&e&&(n=!0,i=o)}return n&&r.push({startRow:0,endRow:0,startColumn:i,endColumn:t,rangeType:a$.COLUMN}),r}getColumnDatas(e,t){let r={},n=0;for(let i=e;i<e+t;i++){let e=this.getColumnOrCreate(i);r[n]=e,n++}return r}getSize(){return lb(this._columnData)}getColumnWidth(e){let{_columnData:t}=this,r=this._config;return(t[e]||{hd:sY.FALSE,w:r.defaultColumnWidth}).w||r.defaultColumnWidth}getColumn(e){let t=this._columnData[e];if(t)return t}removeColumn(e){delete this._columnData[e]}getColumnOrCreate(e){let{_columnData:t}=this,r=t[e];if(r)return r;let n={};return this._columnData[e]=n,n}};e7(db,"ColumnManager");let dR=class{constructor(e,t,r){te(this,"_rowData"),this._config=e,this._viewModel=t,this._rowData=r}getRowData(){return this._rowData}getRowStyle(e){var t;return null==(t=this._rowData[e])?void 0:t.s}setRowStyle(e,t){this.getRowOrCreate(e).s=t}getRowDatas(e,t){let r={},n=0;for(let i=e;i<e+t;i++){let e=this.getRowOrCreate(i);r[n]=e,n++}return r}getRowHeight(e,t=1){let{_rowData:r}=this,n=this._config,i=0;for(let o=0;o<t;o++){let{ia:t,ah:s,h:a=n.defaultRowHeight}=r[o+e]||{hd:sY.FALSE,h:n.defaultRowHeight};i+=(null==t||t===sY.TRUE)&&"number"==typeof s?s:a}return i}getRow(e){return this._rowData[e]}removeRow(e){delete this._rowData[e]}getRowOrCreate(e){let{_rowData:t}=this,r=t[e];if(r)return r;let n={};return t[e]=n,n}getHiddenRows(e=0,t=this.getSize()-1){let r=[],n=!1,i=-1;for(let o=e;o<=t;o++){let e=this.getRowRawVisible(o);n&&e?(n=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:a$.ROW})):n||e||(n=!0,i=o)}return n&&r.push({startRow:i,endRow:t,startColumn:0,endColumn:0,rangeType:a$.ROW}),r}getVisibleRows(e=0,t=this.getSize()-1){let r=[],n=!1,i=-1;for(let o=e;o<=t;o++){let e=this.getRowRawVisible(o);n&&!e?(n=!1,r.push({startRow:i,endRow:o-1,startColumn:0,endColumn:0,rangeType:a$.ROW})):!n&&e&&(n=!0,i=o)}return n&&r.push({startRow:i,endRow:t,startColumn:0,endColumn:0,rangeType:a$.ROW}),r}getRowRawVisible(e){let t=this.getRow(e);return!t||t.hd!==sY.TRUE}getSize(){return lb(this._rowData)}};e7(dR,"RowManager");let dT=24,dI="DEFAULT_WORKSHEET_COLUMN_WIDTH",dC=88;function dS(e){let t={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:sY.FALSE,rowCount:1e3,columnCount:20,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:dC,defaultRowHeight:dT,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:sY.TRUE,rowHeader:{width:46,hidden:sY.FALSE},columnHeader:{height:20,hidden:sY.FALSE},rightToLeft:sY.FALSE};return Object.keys(t).forEach(r=>{typeof e[r]>"u"&&(e[r]=t[r])}),e}e7(dS,"mergeWorksheetSnapshotWithDefault");let dx=class extends oZ{constructor(e){super(),te(this,"_cellCache",/* @__PURE__ */new Map),te(this,"_rowCache",/* @__PURE__ */new Map),te(this,"_columnCache",/* @__PURE__ */new Map),te(this,"_hasRow",!1),te(this,"_hasColumn",!1),te(this,"_hasAll",!1),te(this,"_allIndex",-1),te(this,"_mergeData"),te(this,"_rangeMap",new lf(5e4)),te(this,"_skeletonCache",new lf(5e4)),this._init(e.concat())}_init(e){this._mergeData=e,this._createCache(e)}_clearCache(){this._cellCache.clear(),this._rowCache.clear(),this._columnCache.clear(),this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._skeletonCache.clear(),this._hasColumn=!1,this._hasRow=!1}_createCache(e){let t=0;for(let r of e){let{rangeType:e}=r;e===a$.ROW?this._createRowCache(r,t):e===a$.COLUMN?this._createColumnCache(r,t):e===a$.ALL?this._createCellAllCache(t):this._createCellCache(r,t),t++}}rebuild(e){this._clearCache(),this._init(e.concat())}_createRowCache(e,t){let{startRow:r,endRow:n}=e;for(let e=r;e<=n;e++)this._rowCache.set(e,t),this._hasRow=!0}_createColumnCache(e,t){let{startColumn:r,endColumn:n}=e;for(let e=r;e<=n;e++)this._columnCache.set(e,t),this._hasColumn=!0}_createCellAllCache(e){this._hasAll=!0,this._allIndex=e}_createCellCache(e,t){for(let r=e.startRow;r<=e.endRow;r++){let n=this._cellCache.get(r);null==n&&(n=/* @__PURE__ */new Map,this._cellCache.set(r,n));for(let r=e.startColumn;r<=e.endColumn;r++)n.set(r,t)}}add(e){this._mergeData.push(e),this._clearCache(),this._createCache(this._mergeData)}remove(e,t){let r=this._getMergeDataIndex(e,t);-1!==r&&(this._mergeData.splice(r,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(e,t){let r=this._getMergeDataIndex(e,t);return -1!==r?this._mergeData[r]:null}getMergeDataIndex(e,t){return this._getMergeDataIndex(e,t)}isRowContainsMergedCell(e){return!!this._hasAll||!ai.isEmptyObject(this._columnCache)||this._mergeData.some(t=>t.startRow<=e&&e<=t.endRow)}isColumnContainsMergedCell(e){return!!this._hasAll||!ai.isEmptyObject(this._rowCache)||this._mergeData.some(t=>t.startColumn<=e&&e<=t.endColumn)}getMergedCellRange(e,t,r,n){let i=[],o=`${e}-${t}-${r}-${n}`;if(this._rangeMap.has(o))return this._getRangeFromCache(o);let s=0,a=[];for(let o of this._mergeData||[])lX.intersects(o,{startRow:e,endRow:r,startColumn:t,endColumn:n})&&(i.push({...o}),a.push(s)),s++;return this._rangeMap.set(o,a),i}getMergedCellRangeForSkeleton(e,t,r,n){let i=[],o=this._mergeData,s=`${e}-${t}-${r}-${n}`;if(this._skeletonCache.has(s))return this._getSkeletonRangeFromCache(s);let a=[];for(let s=0;s<o.length;s++){let{startRow:l,endRow:u,startColumn:c,endColumn:h}=o[s];for(let o=e;o<=r;o++){let e=!1;for(let r=t;r<=n;r++)if(o>=l&&o<=u&&r>=c&&r<=h){i.push({startRow:l,endRow:u,startColumn:c,endColumn:h}),a.push(s),e=!0;break}if(e)break}}return this._skeletonCache.set(s,a),i}_getRangeFromCache(e){let t=this._rangeMap.get(e)||[],r=[];for(let e of t)r.push({...this._mergeData[e]});return r}_getSkeletonRangeFromCache(e){let t=this._skeletonCache.get(e)||[],r=[];for(let e of t)r.push({...this._mergeData[e]});return r}_getMergeDataIndex(e,t){var r;if(this._hasAll)return this._allIndex;if(this._hasRow){let t=this._rowCache.get(e);if(void 0!==t)return t}if(this._hasColumn){let e=this._columnCache.get(t);if(void 0!==e)return e}let n=null==(r=this._cellCache.get(e))?void 0:r.get(t);return void 0!==n?n:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}};e7(dx,"SpanModel");let dO=class extends oZ{constructor(e){super(),te(this,"_cellContentInterceptor",null),te(this,"_rowFilteredInterceptor",null),this.getRawCell=e}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(e,t){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,t,oI.Value|oI.Style):this.getRawCell(e,t)}getCellValueOnly(e,t){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,t,oI.Value):this.getRawCell(e,t)}getCellStyleOnly(e,t){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,t,oI.Style):this.getRawCell(e,t)}getRowFiltered(e){var t,r;return null!=(r=null==(t=this._rowFilteredInterceptor)?void 0:t.getRowFiltered(e))&&r}registerCellContentInterceptor(e){if(this._cellContentInterceptor)throw Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=e,oX(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(e){if(this._rowFilteredInterceptor)throw Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=e,oX(()=>this._rowFilteredInterceptor=null)}};e7(dO,"SheetViewModel");let dA=class e{constructor(e,t,r){var n;te(this,"_sheetId"),te(this,"_snapshot"),te(this,"_cellData"),te(this,"_rowManager"),te(this,"_columnManager"),te(this,"_viewModel"),te(this,"_spanModel"),this.unitId=e,this._styles=r,this._snapshot=dS(t);let{columnData:i,rowData:o,cellData:s}=this._snapshot;this._sheetId=null!=(n=this._snapshot.id)?n:ai.generateRandomId(6),this._cellData=new lw(s),this._viewModel=new dO((e,t)=>this.getCellRaw(e,t)),this._rowManager=new dR(this._snapshot,this._viewModel,o),this._columnManager=new db(this._snapshot,i),this._spanModel=new dx(this._snapshot.mergeData)}__interceptViewModel(e){e(this._viewModel)}getSnapshot(){return this._snapshot}setMergeData(e){this._snapshot.mergeData=e,this.getSpanModel().rebuild(e)}getSpanModel(){return this._spanModel}getColumnStyle(e,t=!1){return t?this._columnManager.getColumnStyle(e):this._styles.get(this._columnManager.getColumnStyle(e))}setColumnStyle(e,t){this._columnManager.setColumnStyle(e,t)}getRowStyle(e,t=!1){return t?this._rowManager.getRowStyle(e):this._styles.get(this._rowManager.getRowStyle(e))}setRowStyle(e,t){this._rowManager.setRowStyle(e,t)}mixinDefaultStyleToCellRaw(e,t,r,n){let i=this.getColumnStyle(t),o=this.getRowStyle(e),s=this.getDefaultCellStyleInternal();if(s||i||o){let e=null==r?void 0:r.s;"string"==typeof e&&(e=this._styles.get(e));let t=n?as(s,i,o,e):as(s,o,i,e);r||(r={}),r.s=t}}getDefaultCellStyle(){return this._snapshot.defaultStyle}getDefaultCellStyleInternal(){let e=this._snapshot.defaultStyle;return this._styles.get(e)}setDefaultCellStyle(e){this._snapshot.defaultStyle=e}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){let e=this.getCellMatrix(),t=this.getMergeData(),r=-1,n=-1,i=-1,o=-1,s=!1,a=!1;return e.forEach((t,l)=>{Object.keys(l).forEach(l=>{let u=+l,c=e.getValue(t,u),h=null!=c&&c.s?this._styles.get(c.s):null,d=(null==h?void 0:h.bd)&&(h.bd.b||h.bd.l||h.bd.r||h.bd.t||h.bd.bc_tr||h.bd.bl_tr||h.bd.ml_tr||h.bd.tl_bc||h.bd.tl_br||h.bd.tl_mr);(c&&(c.v||c.p)||null!=h&&h.bg||d)&&(s?r=Math.min(r,t):(r=t,s=!0),n=Math.max(n,t),a?i=Math.min(i,u):(a=!0,i=u),o=Math.max(o,u))})}),t.forEach(e=>{s?r=Math.min(r,e.startRow):(r=e.startRow,s=!0),n=Math.max(n,e.endRow),a?i=Math.min(i,e.startColumn):(i=e.startColumn,s=!0),o=Math.max(o,e.endColumn)}),s&&a?{startColumn:i,startRow:r,endColumn:o,endRow:n}:null}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){let{_snapshot:t}=this,r=ai.deepClone(t);return new e(this.unitId,r,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(e,t){return this._spanModel.getMergedCell(e,t)}getMergedCellRange(e,t,r,n){return this._spanModel.getMergedCellRange(e,t,r,n)}isRowContainsMergedCell(e){return this._spanModel.isRowContainsMergedCell(e)}isColumnContainsMergedCell(e){return this._spanModel.isColumnContainsMergedCell(e)}getCellInfoInMergeData(e,t){let r=this.getMergedCell(e,t),n=!1,i=!1,o=e,s=t,a=e,l=t;if(r){let{startRow:u,endRow:c,startColumn:h,endColumn:d}=r;e===u&&t===h?(o=c,s=d,a=u,l=h,i=!0):e>=u&&e<=c&&t>=h&&t<=d&&(o=c,s=d,a=u,l=h,n=!0)}return{actualRow:e,actualColumn:t,isMergedMainCell:i,isMerged:n,endRow:o,endColumn:s,startRow:a,startColumn:l}}getCell(e,t){return e<0||t<0?null:this._viewModel.getCell(e,t)}getCellValueOnly(e,t){return e<0||t<0?null:this._viewModel.getCellValueOnly(e,t)}getCellStyleOnly(e,t){return e<0||t<0?null:this._viewModel.getCellStyleOnly(e,t)}getCellRaw(e,t){return this.getCellMatrix().getValue(e,t)}getRowFiltered(e){return this._viewModel.getRowFiltered(e)}getMatrixWithMergedCells(e,t,r,n,i=!1){let o=this.getCellMatrix(),s=this._spanModel.getMergedCellRange(e,t,r,n),a=new lw;return l0(e,r,t,n).forEach((e,t)=>{let r=i?this.getCellRaw(e,t):this.getCell(e,t);r&&a.setValue(e,t,r)}),s.forEach(e=>{let{startColumn:t,startRow:r,endColumn:n,endRow:i}=e;l0(r,i,t,n).forEach((e,s)=>{e===r&&s===t&&a.setValue(e,s,{...o.getValue(e,s),rowSpan:i-r+1,colSpan:n-t+1}),(e!==r||s!==t)&&a.realDeleteValue(e,s)})}),a}getRange(e,t,r,n){return"object"==typeof e?new lP(this,e,{getStyles:/* @__PURE__ */e7(()=>this._styles,"getStyles")}):new lP(this,{startRow:e,startColumn:t,endColumn:n||t,endRow:r||e},{getStyles:/* @__PURE__ */e7(()=>this._styles,"getStyles")})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){let{_snapshot:e}=this,{columnCount:t}=e;return t}getMaxRows(){let{_snapshot:e}=this,{rowCount:t}=e;return t}getRowCount(){return this._snapshot.rowCount}setRowCount(e){this._snapshot.rowCount=e}getColumnCount(){return this._snapshot.columnCount}setColumnCount(e){this._snapshot.columnCount=e}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){let{_snapshot:e}=this,{showGridlines:t}=e;return 0===t}getTabColor(){let{_snapshot:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this._viewModel.getRowFiltered(e)?0:this.getRowManager().getRowHeight(e)}isRowFiltered(e){return this._viewModel.getRowFiltered(e)}getRowVisible(e){return!this.isRowFiltered(e)&&this.getRowRawVisible(e)}getRowRawVisible(e){return this.getRowManager().getRowRawVisible(e)}getHiddenRows(e,t){let r=this.getMaxColumns()-1,n=this._rowManager.getHiddenRows(e,t);return n.forEach(e=>e.endColumn=r),n}getColVisible(e){return this._columnManager.getColVisible(e)}getHiddenCols(e,t){let r=this.getMaxRows()-1,n=this._columnManager.getHiddenCols(e,t);return n.forEach(e=>e.endRow=r),n}getVisibleRows(){let e=this.getRowCount();return this._rowManager.getVisibleRows(0,e-1)}getVisibleCols(){let e=this.getColumnCount();return this._columnManager.getVisibleCols(0,e-1)}isRightToLeft(){let{_snapshot:e}=this,{rightToLeft:t}=e;return t}getLastRowWithContent(){return this._cellData.getLength()-1}getLastColumnWithContent(){return this._cellData.getRange().endColumn}cellHasValue(e){return e&&(void 0!==e.v||void 0!==e.f||void 0!==e.p)}iterateByRow(e,t=!0){let{startRow:r,startColumn:n,endRow:i,endColumn:o}=e,s=this;return{[Symbol.iterator]:()=>{let e=r,a=n;return{next(){for(;;){if(a>o&&(e+=1,a=n),e>i)return{done:!0,value:void 0};let r=s.getCell(e,a),l=!r,u=s.getMergedCell(e,a);if(u){if(e!==u.startRow||a!==u.startColumn||l&&t){a=u.endColumn+1;continue}let n={row:e,col:a,value:r};return n.colSpan=u.endColumn-u.startColumn+1,n.rowSpan=u.endRow-u.startRow+1,a=u.endColumn+1,{done:!1,value:n}}if(l&&t)a+=1;else{let t={row:e,col:a,value:r};return a+=1,{done:!1,value:t}}}}}}}}iterateByColumn(e,t=!0,r=!0){let{startRow:n,startColumn:i,endRow:o,endColumn:s}=e,a=this;return{[Symbol.iterator]:()=>{let e=n,l=i;return{next(){for(;;){if(e>o&&(l+=1,e=n),l>s)return{done:!0,value:void 0};let i=a.getMergedCell(e,l);if(i){let n=e!==i.startRow,o=n||l!==i.startColumn;if(r&&o||!r&&n){e=i.endRow+1;continue}let s=a.getCell(i.startRow,i.startColumn);if(!s&&t){e=i.endRow+1;continue}let u={row:e,col:i.startColumn,value:s};return u.colSpan=i.endColumn-i.startColumn+1,u.rowSpan=i.endRow-i.startRow+1,e=i.endRow+1,{done:!1,value:u}}let u=a.getCell(e,l);if(!u&&t)e+=1;else{let t={row:e,col:l,value:u};return e+=1,{done:!1,value:t}}}}}}}}};function dw(e){var t,r;if(!e)return"";let n=null==(r=null==(t=e.p)?void 0:t.body)?void 0:r.dataStream;if(n)return hG.transform.getPlainText(n);let i=e.v;return"string"==typeof i?e.t===sK.BOOLEAN?i.toUpperCase():i.replace(/[\r\n]/g,""):"number"==typeof i?e.t===sK.BOOLEAN?i?"TRUE":"FALSE":i.toString():"boolean"==typeof i?i?"TRUE":"FALSE":""}function dN(e){if(null===e)return"";if(null!=e&&e.p){let t=null==e?void 0:e.p.body;if(null==t)return"";let r=t.dataStream;return hG.transform.getPlainText(r)}return null==e?void 0:e.v}e7(dA,"Worksheet"),e7(dw,"extractPureTextFromCell"),e7(dN,"getOriginCellValue");var dD=Object.defineProperty,dL=Object.getOwnPropertyDescriptor,dM=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dL(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dD(t,r,o),o},"__decorateClass$5"),dU=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$5");e7(function(e,t){return`${e.getUnitId()}|${t.getSheetId()}`},"getWorksheetUID");let dP=(e7(dY=class extends ut{constructor(e={},t){super(),te(this,"type",l9.UNIVER_SHEET),te(this,"_sheetCreated$",new e5.Subject),te(this,"sheetCreated$",this._sheetCreated$.asObservable()),te(this,"_sheetDisposed$",new e5.Subject),te(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),te(this,"_activeSheet$",new eY.BehaviorSubject(null)),te(this,"activeSheet$",this._activeSheet$.asObservable()),te(this,"_worksheets"),te(this,"_styles"),te(this,"_snapshot"),te(this,"_unitId"),te(this,"_count"),te(this,"_name$"),te(this,"name$"),this._logService=t;let r=dE();ai.isEmptyObject(e)?this._snapshot=r:this._snapshot=ai.commonExtend(r,e);let{styles:n}=this._snapshot;(null==this._snapshot.id||0===this._snapshot.id.length)&&(this._snapshot.id=ai.generateRandomId(6)),this._unitId=this._snapshot.id,this._styles=new dv(n),this._count=1,this._worksheets=/* @__PURE__ */new Map,this._name$=new eY.BehaviorSubject(e.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(e){return"string"==typeof e||"startRow"in e||"row"in e}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete()}save(){return ai.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(e){this._name$.next(e),this._snapshot.name=e}getUnitId(){return this._unitId}getRev(){var e;return null!=(e=this._snapshot.rev)?e:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(e){this._snapshot.rev=e}addWorksheet(e,t,r){let{sheets:n,sheetOrder:i}=this._snapshot;if(n[e])return!1;n[e]=r,i.splice(t,0,e);let o=new dA(this._unitId,r,this._styles);return this._worksheets.set(e,o),this._sheetCreated$.next(o),!0}getSheetOrders(){return this._snapshot.sheetOrder}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getConfig(){return this._snapshot}getIndexBySheetId(e){let{sheetOrder:t}=this._snapshot;return t.findIndex(t=>t===e)}getActiveSheet(e){if(!this._activeSheet&&typeof e>"u")throw Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){let e=this._activeSheet;if(e)return e;let t=this._snapshot.sheetOrder;for(let e=0,r=t.length;e<r;e++){let r=this._worksheets.get(t[e]);if(r&&r.isSheetHidden()!==sY.TRUE)return this.setActiveSheet(r),r}let r=this._worksheets.get(t[0]);return this.setActiveSheet(r),r}setActiveSheet(e){this._activeSheet$.next(e)}removeSheet(e){let t=this._worksheets.get(e);return!!t&&(this._worksheets.delete(e),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(e),1),delete this._snapshot.sheets[e],this._sheetDisposed$.next(t),!0)}getActiveSheetIndex(){let{sheetOrder:e}=this._snapshot;return e.findIndex(e=>this._worksheets.get(e)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){let{sheetOrder:e}=this._snapshot;return e.map(e=>this._worksheets.get(e))}getSheetsName(){let{sheetOrder:e}=this._snapshot,t=[];return e.forEach(e=>{let r=this._worksheets.get(e);r&&t.push(r.getName())}),t}getSheetIndex(e){let{sheetOrder:t}=this._snapshot;return t.findIndex(t=>e.getSheetId()===t)}getSheetBySheetName(e){let{sheetOrder:t}=this._snapshot,r=t.find(t=>this._worksheets.get(t).getName()===e);return this._worksheets.get(r)}getSheetBySheetId(e){return this._worksheets.get(e)}getSheetByIndex(e){let{sheetOrder:t}=this._snapshot;return this._worksheets.get(t[e])}getHiddenWorksheets(){return this.getSheets().filter(e=>e.getConfig().hidden===sY.TRUE).map(e=>e.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(e=>e.getConfig().hidden!==sY.TRUE).map(e=>e.getConfig().id)}load(e){this._snapshot=e}checkSheetName(e){return this.getSheetsName().includes(e)}uniqueSheetName(e="Sheet1"){let t=e;for(;this.checkSheetName(t);)t=e+this._count,this._count++;return t}generateNewSheetName(e){let t=e+this._count;for(;this.checkSheetName(t);)t=e+this._count,this._count++;return t}_parseWorksheetSnapshots(){let{_snapshot:e,_worksheets:t}=this,{sheets:r,sheetOrder:n}=e;if(ai.isEmptyObject(r)){let e=ai.generateRandomId();r[e]={id:e}}for(let e in r){let i=r[e],{name:o}=i;i.name=this.uniqueSheetName(o),i.name!==o&&this._logService.debug("[Workbook]",`The worksheet name ${o} is duplicated, we changed it to ${i.name}. Please fix the problem in your snapshot.`);let s=new dA(this._unitId,i,this._styles);t.set(e,s),n.includes(e)||n.push(e)}this.ensureActiveSheet()}},"Workbook"),dY);dP=dM([dU(1,o6)],dP);let dk=class extends ut{constructor(e){var t;super(),te(this,"type",l9.UNIVER_SLIDE),te(this,"_activePage$",new eY.BehaviorSubject(null)),te(this,"activePage$",this._activePage$.asObservable()),te(this,"_name$"),te(this,"name$"),te(this,"_snapshot"),te(this,"_unitId"),this._snapshot={...lD,...e},this._unitId=null!=(t=this._snapshot.id)?t:ai.generateRandomId(6),this._name$=new eY.BehaviorSubject(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var e,t;let r=this._activePage$.getValue();if(!r){let r=null==(e=this.getPageOrder())?void 0:e[0];return r?null==(t=this.getPages())?void 0:t[r]:null}return r}setName(e){var t;this._snapshot.title=e,this._name$.next(e),this._unitId=null!=(t=this._snapshot.id)?t:ao(6)}getRev(){return 0}incrementRev(){}setRev(e){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return null==(e=this._snapshot.body)?void 0:e.pages}getPageOrder(){var e;return null==(e=this._snapshot.body)?void 0:e.pageOrder}getPage(e){let t=this.getPages();return null==t?void 0:t[e]}getElementsByPage(e){var t;return null==(t=this.getPage(e))?void 0:t.pageElements}getElement(e,t){var r;return null==(r=this.getElementsByPage(e))?void 0:r[t]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){let e=ao(6);return{id:e,pageType:hI.SLIDE,zIndex:10,title:e,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(e){this._activePage$.next(e)}getActivePage(){return this._activePage}updatePage(e,t){this._snapshot.body&&(this._snapshot.body.pages[e]=t)}appendPage(e){var t;if(!this._snapshot.body)return;this._snapshot.body.pages[e.id]=e;let r=this._activePage,n=this._snapshot.body.pageOrder.indexOf(null!=(t=null==r?void 0:r.id)?t:"");this._snapshot.body.pageOrder.splice(n+1,0,e.id)}};e7(dk,"SlideDataModel");let dF=dk;var dj=Object.defineProperty,dB=Object.getOwnPropertyDescriptor,dH=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dB(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dj(t,r,o),o},"__decorateClass$4"),dV=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$4");let d$=iy("univer.current"),dG=(dK=class extends oZ{constructor(e,t){super(),te(this,"_unitsByType",/* @__PURE__ */new Map),te(this,"_createHandler"),te(this,"_ctorByType",/* @__PURE__ */new Map),te(this,"_currentUnits",/* @__PURE__ */new Map),te(this,"_currentUnits$",new eY.BehaviorSubject(this._currentUnits)),te(this,"currentUnits$",this._currentUnits$.asObservable()),te(this,"_unitAdded$",new e5.Subject),te(this,"unitAdded$",this._unitAdded$.asObservable()),te(this,"_unitDisposed$",new e5.Subject),te(this,"unitDisposed$",this._unitDisposed$.asObservable()),te(this,"_focused$",new eY.BehaviorSubject(null)),te(this,"focused$",this._focused$.asObservable()),this._injector=e,this._contextService=t}dispose(){super.dispose(),this._focused$.complete()}__setCreateHandler(e){this._createHandler=e}createUnit(e,t,r){return this._createHandler(e,t,this._ctorByType.get(e),r)}registerCtorForType(e,t){return this._ctorByType.set(e,t),{dispose:/* @__PURE__ */e7(()=>{this._ctorByType.delete(e)},"dispose")}}getCurrentTypeOfUnit$(e){return this.currentUnits$.pipe((0,eQ.map)(t=>{var r;return null!=(r=t.get(e))?r:null}),(0,eq.distinctUntilChanged)())}getCurrentUnitForType(e){return this._currentUnits.get(e)}setCurrentUnitForType(e){let t=this._getUnitById(e);if(!t)throw Error(`[UniverInstanceService]: no document with unitId ${e}!`);this._currentUnits.set(t[1],t[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(e){return this._unitAdded$.pipe((0,eJ.filter)(t=>t.type===e))}__addUnit(e,t){var r;let n=e.type;this._unitsByType.has(n)||this._unitsByType.set(n,[]);let i=this._unitsByType.get(n),o=e.getUnitId();if(-1!==i.findIndex(e=>e.getUnitId()===o))throw Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${o}.`);i.push(e),this._unitAdded$.next(e),(null==(r=null==t?void 0:t.makeCurrent)||r)&&this.setCurrentUnitForType(e.getUnitId())}getTypeOfUnitDisposed$(e){return this.unitDisposed$.pipe((0,eJ.filter)(t=>t.type===e))}getUnit(e,t){var r;let n=null==(r=this._getUnitById(e))?void 0:r[0];return t&&(null==n?void 0:n.type)!==t?null:n}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(l9.UNIVER_DOC)}getUniverDocInstance(e){return this.getUnit(e,l9.UNIVER_DOC)}getUniverSheetInstance(e){return this.getUnit(e,l9.UNIVER_SHEET)}getAllUnitsForType(e){var t;return null!=(t=this._unitsByType.get(e))?t:[]}changeDoc(e,t){let r=this.getAllUnitsForType(l9.UNIVER_DOC),n=r.find(t=>t.getUnitId()===e);if(null!=n){let e=r.indexOf(n);r.splice(e,1)}this.__addUnit(t)}get focused(){var e;let t=this._focused$.getValue();return t?null==(e=this._getUnitById(t))?void 0:e[0]:null}focusUnit(e){this._focused$.next(e),this.focused instanceof dP?(this._contextService.setContextValue(dn,!0),this._contextService.setContextValue(ds,!1),this._contextService.setContextValue(di,!0),this._contextService.setContextValue(da,!1),this.setCurrentUnitForType(e)):this.focused instanceof hd?(this._contextService.setContextValue(dn,!0),this._contextService.setContextValue(ds,!0),this._contextService.setContextValue(di,!1),this._contextService.setContextValue(da,!1),this.setCurrentUnitForType(e)):this.focused instanceof dF?(this._contextService.setContextValue(dn,!0),this._contextService.setContextValue(ds,!1),this._contextService.setContextValue(di,!1),this._contextService.setContextValue(da,!0),this.setCurrentUnitForType(e)):(this._contextService.setContextValue(dn,!1),this._contextService.setContextValue(ds,!1),this._contextService.setContextValue(di,!1),this._contextService.setContextValue(da,!1))}getFocusedUnit(){return this.focused}getUnitType(e){let t=this._getUnitById(e);return t?t[1]:l9.UNRECOGNIZED}disposeUnit(e){let t=this._getUnitById(e);if(!t)return!1;let[r,n]=t,i=this._unitsByType.get(n),o=i.indexOf(r);return i.splice(o,1),this._tryRemoveCurrentUnitForType(e,n),this._tryBlurUnitOnRemoval(e),this._unitDisposed$.next(r),!0}_tryRemoveCurrentUnitForType(e,t){let r=this.getCurrentUnitForType(t);(null==r?void 0:r.getUnitId())===e&&(this._currentUnits.set(t,null),this._currentUnits$.next(this._currentUnits))}_tryBlurUnitOnRemoval(e){var t;(null==(t=this.focused)?void 0:t.getUnitId())===e&&this._focused$.next(null)}_getUnitById(e){for(let[t,r]of this._unitsByType){let n=r.find(t=>t.getUnitId()===e);if(n)return[n,t]}}},e7(dK,"UniverInstanceService"),dK);dG=dH([dV(0,ix(i4)),dV(1,o2)],dG);var dW=((ej=dW||{})[ej.Starting=0]="Starting",ej[ej.Ready=1]="Ready",ej[ej.Rendered=2]="Rendered",ej[ej.Steady=3]="Steady",ej);let dz={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"};var dY,dK,dX,dq=Object.defineProperty,dJ=Object.getOwnPropertyDescriptor,dQ=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?dJ(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&dq(t,r,o),o},"__decorateClass$3"),dZ=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$3");let d0=(e7(dX=class extends oZ{constructor(e){super(),te(this,"_lifecycle$",new eY.BehaviorSubject(dW.Starting)),te(this,"lifecycle$",this._lifecycle$.asObservable()),te(this,"_lock",!1),this._logService=e,this._reportProgress(dW.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(e){if(this._lock)throw Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(e<this.stage)throw Error("[LifecycleService]: lifecycle stage cannot go backward!");e!==this.stage&&(this._lock=!0,this._reportProgress(e),this._lifecycle$.next(e),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}subscribeWithPrevious(){return(0,eZ.merge)(d1(this.stage),this._lifecycle$.pipe((0,e2.skip)(1))).pipe(sh(e=>e===dW.Steady))}_reportProgress(e){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${dz[e]}".`)}},"LifecycleService"),dX);function d1(e){switch(e){case dW.Starting:return(0,e1.of)(dW.Starting);case dW.Ready:return(0,e1.of)(dW.Starting,dW.Ready);case dW.Rendered:return(0,e1.of)(dW.Starting,dW.Ready,dW.Rendered);default:return(0,e1.of)(dW.Starting,dW.Ready,dW.Rendered,dW.Steady)}}d0=dQ([dZ(0,o6)],d0),e7(d1,"getLifecycleStagesAndBefore");let d2=iy("ILocalStorageService"),d5=class extends oZ{constructor(){super(),te(this,"_currentLocale$",new eY.BehaviorSubject(sN.ZH_CN)),te(this,"currentLocale$",this._currentLocale$.asObservable()),te(this,"_locales",null),te(this,"localeChanged$",new e5.Subject),te(this,"t",/* @__PURE__ */e7((e,...t)=>{if(!this._locales)throw Error("[LocaleService]: Locale not initialized");let r=e.split("."),n=this.resolveKeyPath(this._locales[this._currentLocale],r);if("string"!=typeof n)return e;{let e=n;return t.forEach((t,r)=>{e=e.replace(`{${r}}`,t)}),e}},"t")),this.disposeWithMe(oX(()=>this.localeChanged$.complete()))}get _currentLocale(){return this._currentLocale$.value}load(e){var t;this._locales=ai.deepMerge(null!=(t=this._locales)?t:{},e)}setLocale(e){this._currentLocale$.next(e),this.localeChanged$.next()}getLocales(){var e;return null==(e=this._locales)?void 0:e[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(e,t){let r=t.shift();if(r&&e&&r in e){let n=e[r];return t.length>0&&("object"==typeof n||Array.isArray(n))?this.resolveKeyPath(n,t):n}return null}};e7(d5,"LocaleService");let d3=d5;var d6=((eB=d6||{}).INIT="init",eB.FETCHING="fetching",eB.DONE="done",eB);let d4=iy("univer.permission-service"),d9=class extends oZ{constructor(){super(...arguments),te(this,"_permissionPointMap",/* @__PURE__ */new Map),te(this,"_permissionPointUpdate$",new e5.Subject),te(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable()),te(this,"_showComponents",!0)}setShowComponents(e){this._showComponents=e}getShowComponents(){return this._showComponents}deletePermissionPoint(e){let t=this._permissionPointMap.get(e);t&&(t.complete(),this._permissionPointMap.delete(e))}addPermissionPoint(e){let t=e instanceof eY.BehaviorSubject,r=t?e.getValue():e;if(!r.id)return!1;if(this._permissionPointMap.get(r.id))throw Error(`${r.id} PermissionPoint already exists`);return this._permissionPointMap.set(r.id,t?e:new eY.BehaviorSubject(r)),this._permissionPointUpdate$.next(r),!0}updatePermissionPoint(e,t){let r=this._permissionPointMap.get(e);if(!r)return;let n=r.getValue();n.value=t,n.status=d6.DONE,r.next(n),this._permissionPointUpdate$.next(n)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(e){let t=this._permissionPointMap.get(e);if(t)return t.getValue()}getPermissionPoint$(e){let t=this._permissionPointMap.get(e);if(t)return t}composePermission$(e){let t=e.map(e=>{var t;let r=null==(t=this._permissionPointMap)?void 0:t.get(e);if(!r)throw Error(`[PermissionService]: ${e} permissionPoint does not exist!`);return r.asObservable()});return(0,eK.combineLatest)(t).pipe((0,eQ.map)(e=>e))}composePermission(e){return e.map(e=>{var t;let r=null==(t=this._permissionPointMap)?void 0:t.get(e);if(!r)throw Error(`[PermissionService]: ${e} permissionPoint does not exist!`);return r.getValue()})}getAllPermissionPoint(){let e=/* @__PURE__ */new Map;return this._permissionPointMap.forEach((t,r)=>{e.set(r,t)}),e}};e7(d9,"PermissionService");let d8=Symbol("DependentOn"),d7=class extends oZ{onStarting(){}onReady(){}onRendered(){}onSteady(){}getUniverInstanceType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}};e7(d7,"Plugin"),te(d7,"pluginName"),te(d7,"type",l9.UNIVER_UNKNOWN);let pe=d7,pt=class{constructor(){te(this,"_plugins",[])}addPlugin(e){this._plugins.push(e)}removePlugins(){let e=this._plugins.slice();return this._plugins.length=0,e}forEachPlugin(e){this._plugins.forEach(e)}};e7(pt,"PluginStore");let pr=class{constructor(){te(this,"_pluginsRegistered",[])}registerPlugin(e,t){this._pluginsRegistered.push({plugin:e,options:t})}getRegisterPlugins(){return this._pluginsRegistered.slice()}removePlugins(){this._pluginsRegistered=[]}};e7(pr,"PluginRegistry");var pn=Object.defineProperty,pi=Object.getOwnPropertyDescriptor,po=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?pi(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pn(t,r,o),o},"__decorateClass$2"),ps=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$2");function pa(...e){return function(t){t[d8]=e}}e7(pa,"DependentOn");let pl=(e7(p7=class{constructor(e){te(this,"_pluginHolderForUniver"),te(this,"_pluginHoldersForTypes",/* @__PURE__ */new Map),te(this,"_seenPlugins",/* @__PURE__ */new Set),te(this,"_flushTimer"),this._injector=e,this._pluginHolderForUniver=this._injector.createInstance(pu,this._checkPluginSeen.bind(this),this._immediateInitPlugin.bind(this)),this._pluginHoldersForTypes.set(l9.UNIVER_UNKNOWN,this._pluginHolderForUniver),this._pluginHolderForUniver.start()}dispose(){for(let e of(this._clearFlushTimer(),this._pluginHoldersForTypes.values()))e.dispose();this._pluginHolderForUniver.dispose()}registerPlugin(e,t){this._assertPluginValid(e),this._scheduleInitPlugin();let{type:r}=e;r===l9.UNIVER_UNKNOWN?(this._pluginHolderForUniver.register(e,t),this._pluginHolderForUniver.flush()):this._ensurePluginHolderForType(r).register(e,t)}startPluginForType(e){this._ensurePluginHolderForType(e).start()}_ensurePluginHolderForType(e){if(!this._pluginHoldersForTypes.has(e)){let t=this._injector.createInstance(pu,this._checkPluginSeen.bind(this),this._immediateInitPlugin.bind(this));return this._pluginHoldersForTypes.set(e,t),t}return this._pluginHoldersForTypes.get(e)}_immediateInitPlugin(e){this._seenPlugins.add(e.pluginName),this._ensurePluginHolderForType(e.type).immediateInitPlugin(e)}_checkPluginSeen(e){return this._seenPlugins.has(e.pluginName)}_assertPluginValid(e){let{type:t,pluginName:r}=e;if(t===l9.UNRECOGNIZED)throw Error(`[PluginService]: invalid plugin type for ${e.name}. Please assign a "type" to your plugin.`);if(!r)throw Error(`[PluginService]: no plugin name for ${e.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(r))throw Error(`[PluginService]: duplicated plugin name for "${r}". Maybe a plugin that dependents on "${r} has already registered it. In that case please register "${r}" before the that plugin.`);this._seenPlugins.add(e.pluginName)}_scheduleInitPlugin(){void 0===this._flushTimer&&(this._flushTimer=setTimeout(()=>{this._pluginHolderForUniver.started||this._pluginHolderForUniver.start(),this._flushPlugins(),this._clearFlushTimer()},4))}_clearFlushTimer(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=void 0)}_flushPlugins(){for(let[e,t]of(this._pluginHolderForUniver.flush(),this._pluginHoldersForTypes))t.started&&t.flush()}},"PluginService"),p7);pl=po([ps(0,ix(i4))],pl);let pu=(fe=class extends oZ{constructor(e,t,r,n,i){super(),te(this,"_started",!1),te(this,"_warnedAboutOnStartingDeprecation",!1),te(this,"_pluginRegistry",new pr),te(this,"_pluginStore",new pt),te(this,"_pluginsInBatches",[]),this._checkPluginRegistered=e,this._registerPlugin=t,this._logService=r,this._injector=n,this._lifecycleService=i,this.disposeWithMe(this._lifecycleService.lifecycle$.pipe((0,e2.skip)(1)).subscribe(e=>{this._pluginsInBatches.forEach(t=>this._runStage(t,e))}))}get started(){return this._started}dispose(){super.dispose(),this._pluginStore.forEachPlugin(e=>e.dispose()),this._pluginStore.removePlugins(),this._pluginRegistry.removePlugins(),this._pluginsInBatches.length=0}register(e,t){this._pluginRegistry.registerPlugin(e,t)}immediateInitPlugin(e){let t=this._initPlugin(e,void 0);this._pluginsRunLifecycle([t])}start(){this._started||(this._started=!0,this.flush())}flush(){if(!this._started)return;let e=this._pluginRegistry.getRegisterPlugins().map(({plugin:e,options:t})=>this._initPlugin(e,t));e.length&&(this._pluginsRunLifecycle(e),this._pluginRegistry.removePlugins())}_initPlugin(e,t){let r=e[d8];if(r){let t=/* @__PURE__ */e7(()=>{let t=r.find(e=>!this._checkPluginRegistered(e));return!!t&&(this._logService.debug("[PluginService]",`Plugin "${e.pluginName}" depends on "${t.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._registerPlugin(t,void 0),!0)},"exhaustUnregisteredDependents");for(;t(););}let n=this._injector.createInstance(e,t);return this._pluginStore.addPlugin(n),this._logService.debug("[PluginService]",`Plugin "${n.getPluginName()}" registered.`),n}_pluginsRunLifecycle(e){d1(this._lifecycleService.stage).subscribe(t=>this._runStage(e,t)),this._pluginsInBatches.push(e)}_runStage(e,t){e.forEach(e=>{switch(t){case dW.Starting:e.onStarting();break;case dW.Ready:e.onReady();break;case dW.Rendered:e.onRendered();break;case dW.Steady:e.onSteady()}})}},e7(fe,"PluginHolder"),fe);function pc(e,t){if(!t)return e;let r=[];for(let n of e){let e=t.find(([e])=>e===n[0]);if(e){if(null===e[1])continue;r.push([n[0],e[1]])}else r.push(n)}return r}pu=po([ps(2,o6),ps(3,ix(i4)),ps(4,ix(d0))],pu),e7(pc,"mergeOverrideWithDependencies");let ph=iy("resource-loader-service"),pd=class extends oZ{constructor(){super(...arguments),te(this,"_resourceMap",/* @__PURE__ */new Map),te(this,"_register$",new e5.Subject),te(this,"register$",this._register$.asObservable())}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(e,t){return t?this.getResourcesByType(e,t):this.getAllResourceHooks().map(t=>{let r=t.toJson(e);return{name:t.pluginName,data:r}})}getResourcesByType(e,t){return this.getAllResourceHooks().filter(e=>e.businesses.includes(t)).map(t=>{let r=t.toJson(e);return{name:t.pluginName,data:r}})}registerPluginResource(e){let t=e.pluginName;if(this._resourceMap.has(t))throw Error(`the pluginName is registered {${t}}`);return this._resourceMap.set(t,e),this._register$.next(e),oX(()=>this._resourceMap.delete(t))}disposePluginResource(e){this._resourceMap.delete(e)}loadResources(e,t){this.getAllResourceHooks().forEach(r=>{var n;let i=null==(n=null==t?void 0:t.find(e=>e.name===r.pluginName))?void 0:n.data;if(i)try{let t=r.parseJson(i);r.onLoad(e,t)}catch{console.error("LoadResources Error!")}})}unloadResources(e){this.getAllResourceHooks().forEach(t=>{t.onUnLoad(e)})}dispose(){this._register$.complete(),this._resourceMap.clear()}};e7(pd,"ResourceManagerService");let pp=class extends oZ{constructor(){super(),te(this,"_currentTheme"),te(this,"_currentTheme$",new eY.BehaviorSubject({})),te(this,"currentTheme$",this._currentTheme$.asObservable()),this.disposeWithMe(oX(()=>this._currentTheme$.complete()))}getCurrentTheme(){if(!this._currentTheme)throw Error("[ThemeService]: current theme is not set!");return this._currentTheme}setTheme(e){this._currentTheme=e,this._currentTheme$.next(e)}};e7(pp,"ThemeService");let pf=pp;var pg=Object.defineProperty,pm=Object.getOwnPropertyDescriptor,p_=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?pm(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&pg(t,r,o),o},"__decorateClass$1"),py=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam$1");let pE=iy("univer.undo-redo.service"),pv=class{dispose(){}async dispatchToHandlers(){return!1}};e7(pv,"MultiImplementationCommand");let pb=pv,pR="univer.command.redo",pT="univer.command.undo",pI=new class extends pb{constructor(){super(...arguments),te(this,"type",st.COMMAND),te(this,"id",pT)}async handler(e){let t=e.get(pE),r=t.pitchTopUndoElement();if(!r)return!1;let n=e.get(sr);return!!sl(r.undoMutations,n)&&(t.popUndoToRedo(),!0)}},pC=new class extends pb{constructor(){super(...arguments),te(this,"type",st.COMMAND),te(this,"id",pR)}async handler(e){let t=e.get(pE),r=t.pitchTopRedoElement();if(!r)return!1;let n=e.get(sr);return!!sl(r.redoMutations,n)&&(t.popRedoToUndo(),!0)}},pS=(ft=class extends oZ{constructor(e,t,r){super(),te(this,"undoRedoStatus$"),te(this,"_undoRedoStatus$",new eY.BehaviorSubject({undos:0,redos:0})),te(this,"_undoStacks",/* @__PURE__ */new Map),te(this,"_redoStacks",/* @__PURE__ */new Map),te(this,"_batchingStatus",/* @__PURE__ */new Map),this._univerInstanceService=e,this._commandService=t,this._contextService=r,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(pI)),this.disposeWithMe(this._commandService.registerCommand(pC)),this.disposeWithMe(oX(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(oX(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(e){let{unitID:t}=e,r=this._getRedoStack(t,!0),n=this._getUndoStack(t,!0);if(r.length=0,this._batchingStatus.has(e.unitID)){let t=this._batchingStatus.get(e.unitID),r=this._pitchUndoElement(e.unitID);0!==t&&r?this._tryBatchingElements(r,e):(i(e),this._batchingStatus.set(e.unitID,1))}else i(e);function i(e){n.push(e),n.length>20&&n.splice(0,1)}e7(i,"appendNewItem"),this._updateStatus()}clearUndoRedo(e){let t=this._getRedoStack(e);t&&(t.length=0);let r=this._getUndoStack(e);r&&(r.length=0),this._updateStatus()}pitchTopUndoElement(){let e=this._getFocusedUnitId();return this._pitchUndoElement(e)}pitchTopRedoElement(){let e=this._getFocusedUnitId();return this._pitchRedoElement(e)}_pitchUndoElement(e){let t=this._getUndoStack(e);return null!=t&&t.length?t[t.length-1]:null}_pitchRedoElement(e){let t=this._getRedoStack(e);return null!=t&&t.length?t[t.length-1]:null}popUndoToRedo(){let e=this._getUndoStackForFocused().pop();e&&(this._getRedoStackForFocused().push(e),this._updateStatus())}popRedoToUndo(){let e=this._getRedoStackForFocused().pop();e&&(this._getUndoStackForFocused().push(e),this._updateStatus())}__tempBatchingUndoRedo(e){if(this._batchingStatus.has(e))throw Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(e,0),oX(()=>this._batchingStatus.delete(e))}_updateStatus(){var e,t;let r=this._getFocusedUnitId(),n=r&&(null==(e=this._undoStacks.get(r))?void 0:e.length)||0,i=r&&(null==(t=this._redoStacks.get(r))?void 0:t.length)||0;this._undoRedoStatus$.next({undos:n,redos:i})}_getUndoStack(e,t=!1){let r=this._undoStacks.get(e);return!r&&t&&(r=[],this._undoStacks.set(e,r)),r||null}_getRedoStack(e,t=!1){let r=this._redoStacks.get(e);return!r&&t&&(r=[],this._redoStacks.set(e,r)),r||null}_getUndoStackForFocused(){let e=this._getFocusedUnitId();if(!e)throw Error("No focused univer instance!");return this._getUndoStack(e,!0)}_getRedoStackForFocused(){let e=this._getFocusedUnitId();if(!e)throw Error("No focused univer instance!");return this._getRedoStack(e,!0)}_tryBatchingElements(e,t){e.redoMutations.push(...t.redoMutations),e.undoMutations.push(...t.undoMutations)}_getFocusedUnitId(){var e,t,r,n;let i=this._contextService.getContextValue(di),o=this._contextService.getContextValue(dh),s=this._contextService.getContextValue(du);return i?o?nQ:s?nJ:null!=(t=null==(e=this._univerInstanceService.getFocusedUnit())?void 0:e.getUnitId())?t:"":null!=(n=null==(r=this._univerInstanceService.getFocusedUnit())?void 0:r.getUnitId())?n:""}},e7(ft,"LocalUndoRedoService"),ft);function px(e){return!(0===e.length||e.length>31||e.startsWith("'")||e.endsWith("'")||/[:\\\/\?\*\[\]]/.test(e))}pS=p_([py(0,d$),py(1,sr),py(2,o2)],pS),e7(px,"nameCharacterCheck"),e7(function(e){return new Promise(t=>setTimeout(t,e))},"awaitTime");let pO=/* @__PURE__ */e7((e,t)=>t.length===e.length&&!e.some(e=>t.some(t=>!lX.equals(t,e))),"isRangesEqual"),pA=(/* @__PURE__ */(e,t)=>t.length===e.length&&e.every((e,r)=>{let n=t[r];return n.unitId===e.unitId&&n.sheetId===e.sheetId&&lX.equals(e.range,n.range)}),["script","style","meta","comment","link"]);var pw=((eH=pw||{})[eH.INFO=0]="INFO",eH[eH.STOP=1]="STOP",eH[eH.WARNING=2]="WARNING",eH),pN=((eV=pN||{})[eV.DISABLED=0]="DISABLED",eV[eV.FULL_ALPHA=1]="FULL_ALPHA",eV[eV.FULL_HANGUL=2]="FULL_HANGUL",eV[eV.FULL_KATAKANA=3]="FULL_KATAKANA",eV[eV.HALF_ALPHA=4]="HALF_ALPHA",eV[eV.HALF_HANGUL=5]="HALF_HANGUL",eV[eV.HALF_KATAKANA=6]="HALF_KATAKANA",eV[eV.HIRAGANA=7]="HIRAGANA",eV[eV.NO_CONTROL=8]="NO_CONTROL",eV[eV.OFF=9]="OFF",eV[eV.ON=10]="ON",eV),pD=((e$=pD||{}).BETWEEN="between",e$.EQUAL="equal",e$.GREATER_THAN="greaterThan",e$.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",e$.LESS_THAN="lessThan",e$.LESS_THAN_OR_EQUAL="lessThanOrEqual",e$.NOT_BETWEEN="notBetween",e$.NOT_EQUAL="notEqual",e$),pL=((eG=pL||{})[eG.TEXT=0]="TEXT",eG[eG.ARROW=1]="ARROW",eG[eG.CUSTOM=2]="CUSTOM",eG),pM=((eW=pM||{}).VALID="valid",eW.INVALID="invalid",eW.VALIDATING="validating",eW),pU=((ez=pU||{}).CUSTOM="custom",ez.LIST="list",ez.LIST_MULTIPLE="listMultiple",ez.NONE="none",ez.TEXT_LENGTH="textLength",ez.DATE="date",ez.TIME="time",ez.WHOLE="whole",ez.DECIMAL="decimal",ez.CHECKBOX="checkbox",ez.ANY="any",ez);let pP=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],pk=class e{static from(t){if(!(t instanceof ArrayBuffer))throw Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(t,0,2);if(219!==r)throw Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(1!==i)throw Error(`Got v${i} data when expected v1.`);let o=pP[15&n];if(!o)throw Error("Unrecognized array type.");let[s]=new Uint16Array(t,2,1),[a]=new Uint32Array(t,4,1);return new e(a,s,o,t)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let i=pP.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(i<0)throw Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+s+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){let e=this._pos>>1;if(e!==this.numItems)throw Error(`Added ${e} items when expected ${this.numItems}.`);return pF(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:s}=this,a=[0,i.length-1,0],l=[];for(;a.length;){let u=a.pop()||0,c=a.pop()||0,h=a.pop()||0;if(c-h<=s){for(let s=h;s<=c;s++){let a=o[2*s],u=o[2*s+1];a>=e&&a<=r&&u>=t&&u<=n&&l.push(i[s])}continue}let d=h+c>>1,p=o[2*d],f=o[2*d+1];p>=e&&p<=r&&f>=t&&f<=n&&l.push(i[d]),(0===u?e<=p:t<=f)&&(a.push(h),a.push(d-1),a.push(1-u)),(0===u?r>=p:n>=f)&&(a.push(d+1),a.push(c),a.push(1-u))}return l}within(e,t,r){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");let{ids:n,coords:i,nodeSize:o}=this,s=[0,n.length-1,0],a=[],l=r*r;for(;s.length;){let u=s.pop()||0,c=s.pop()||0,h=s.pop()||0;if(c-h<=o){for(let r=h;r<=c;r++)pV(i[2*r],i[2*r+1],e,t)<=l&&a.push(n[r]);continue}let d=h+c>>1,p=i[2*d],f=i[2*d+1];pV(p,f,e,t)<=l&&a.push(n[d]),(0===u?e-r<=p:t-r<=f)&&(s.push(h),s.push(d-1),s.push(1-u)),(0===u?e+r>=p:t+r>=f)&&(s.push(d+1),s.push(c),s.push(1-u))}return a}};function pF(e,t,r,n,i,o){if(i-n<=r)return;let s=n+i>>1;pj(e,t,s,n,i,o),pF(e,t,r,n,s-1,1-o),pF(e,t,r,s+1,i,1-o)}function pj(e,t,r,n,i,o){for(;i>n;){if(i-n>600){let s=i-n+1,a=r-n+1,l=Math.log(s),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(s-u)/s)*(a-s/2<0?-1:1),h=Math.max(n,Math.floor(r-a*u/s+c)),d=Math.min(i,Math.floor(r+(s-a)*u/s+c));pj(e,t,r,h,d,o)}let s=t[2*r+o],a=n,l=i;for(pB(e,t,n,r),t[2*i+o]>s&&pB(e,t,n,i);a<l;){for(pB(e,t,a,l),a++,l--;t[2*a+o]<s;)a++;for(;t[2*l+o]>s;)l--}t[2*n+o]===s?pB(e,t,n,l):pB(e,t,++l,i),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function pB(e,t,r,n){pH(e,r,n),pH(t,2*r,2*n),pH(t,2*r+1,2*n+1)}function pH(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function pV(e,t,r,n){let i=e-r,o=t-n;return i*i+o*o}function p$(e,t,r=0,n=e.length-1,i=pW){for(;n>r;){if(n-r>600){let o=n-r+1,s=t-r+1,a=Math.log(o),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1),c=Math.max(r,Math.floor(t-s*l/o+u)),h=Math.min(n,Math.floor(t+(o-s)*l/o+u));p$(e,t,c,h,i)}let o=e[t],s=r,a=n;for(pG(e,r,t),i(e[n],o)>0&&pG(e,r,n);s<a;){for(pG(e,s,a),s++,a--;0>i(e[s],o);)s++;for(;i(e[a],o)>0;)a--}0===i(e[r],o)?pG(e,r,a):pG(e,++a,n),a<=t&&(r=a+1),t<=a&&(n=a-1)}}function pG(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function pW(e,t){return e<t?-1:e>t?1:0}e7(pk,"KDBush"),e7(pF,"sort"),e7(pj,"select"),e7(pB,"swapItem"),e7(pH,"swap$1"),e7(pV,"sqDist"),e7(p$,"quickselect"),e7(pG,"swap"),e7(pW,"defaultCompare");let pz=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data,r=[];if(!p3(e,t))return r;let n=this.toBBox,i=[];for(;t;){for(let o=0;o<t.children.length;o++){let s=t.children[o],a=t.leaf?n(s):s;p3(e,a)&&(t.leaf?r.push(s):p5(e,a)?this._all(s,r):i.push(s))}t=i.pop()}return r}collides(e){let t=this.data;if(!p3(e,t))return!1;let r=[];for(;t;){for(let n=0;n<t.children.length;n++){let i=t.children[n],o=t.leaf?this.toBBox(i):i;if(p3(e,o)){if(t.leaf||p5(e,o))return!0;r.push(i)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length){if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){let e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=p6([]),this}remove(e,t){let r,n,i;if(!e)return this;let o=this.data,s=this.toBBox(e),a=[],l=[];for(;o||a.length;){if(o||(o=a.pop(),n=a[a.length-1],r=l.pop(),i=!0),o.leaf){let r=pY(e,o.children,t);if(-1!==r)return o.children.splice(r,1),a.push(o),this._condense(a),this}!i&&!o.leaf&&p5(o,s)?(a.push(o),l.push(r),r=0,n=o,o=o.children[0]):n?(r++,o=n.children[r],i=!1):o=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){let r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,n){let i=r-t+1,o=this._maxEntries,s;if(i<=o)return pK(s=p6(e.slice(t,r+1)),this.toBBox),s;n||(n=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/Math.pow(o,n-1))),(s=p6([])).leaf=!1,s.height=n;let a=Math.ceil(i/o),l=a*Math.ceil(Math.sqrt(o));p4(e,t,r,l,this.compareMinX);for(let i=t;i<=r;i+=l){let t=Math.min(i+l-1,r);p4(e,i,t,a,this.compareMinY);for(let r=i;r<=t;r+=a){let i=Math.min(r+a-1,t);s.children.push(this._build(e,r,i,n-1))}}return pK(s,this.toBBox),s}_chooseSubtree(e,t,r,n){for(;n.push(t),!(t.leaf||n.length-1===r);){let r=1/0,n=1/0,i;for(let o=0;o<t.children.length;o++){let s=t.children[o],a=pZ(s),l=p1(e,s)-a;l<n?(n=l,r=a<r?a:r,i=s):l===n&&a<r&&(r=a,i=s)}t=i||t.children[0]}return t}_insert(e,t,r){let n=r?e:this.toBBox(e),i=[],o=this._chooseSubtree(n,this.data,t,i);for(o.children.push(e),pq(o,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)}_split(e,t){let r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);let o=this._chooseSplitIndex(r,i,n),s=p6(r.children.splice(o,r.children.length-o));s.height=r.height,s.leaf=r.leaf,pK(r,this.toBBox),pK(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(r,s)}_splitRoot(e,t){this.data=p6([e,t]),this.data.height=e.height+1,this.data.leaf=!1,pK(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let n,i=1/0,o=1/0;for(let s=t;s<=r-t;s++){let t=pX(e,0,s,this.toBBox),a=pX(e,s,r,this.toBBox),l=p2(t,a),u=pZ(t)+pZ(a);l<i?(i=l,n=s,o=u<o?u:o):l===i&&u<o&&(o=u,n=s)}return n||r-t}_chooseSplitAxis(e,t,r){let n=e.leaf?this.compareMinX:pJ,i=e.leaf?this.compareMinY:pQ;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);let i=this.toBBox,o=pX(e,0,t,i),s=pX(e,r-t,r,i),a=p0(o)+p0(s);for(let n=t;n<r-t;n++){let t=e.children[n];pq(o,e.leaf?i(t):t),a+=p0(o)}for(let n=r-t-1;n>=t;n--){let t=e.children[n];pq(s,e.leaf?i(t):t),a+=p0(s)}return a}_adjustParentBBoxes(e,t,r){for(let n=r;n>=0;n--)pq(t[n],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():pK(e[t],this.toBBox)}};function pY(e,t,r){if(!r)return t.indexOf(e);for(let n=0;n<t.length;n++)if(r(e,t[n]))return n;return -1}function pK(e,t){pX(e,0,e.children.length,t,e)}function pX(e,t,r,n,i){i||(i=p6(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=t;o<r;o++){let t=e.children[o];pq(i,e.leaf?n(t):t)}return i}function pq(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function pJ(e,t){return e.minX-t.minX}function pQ(e,t){return e.minY-t.minY}function pZ(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function p0(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p1(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function p2(e,t){let r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY);return Math.max(0,Math.min(e.maxX,t.maxX)-r)*Math.max(0,Math.min(e.maxY,t.maxY)-n)}function p5(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p3(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p6(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p4(e,t,r,n,i){let o=[t,r];for(;o.length;){if((r=o.pop())-(t=o.pop())<=n)continue;let s=t+Math.ceil((r-t)/n/2)*n;p$(e,s,t,r,i),o.push(t,s,s,r)}}e7(pz,"RBush"),e7(pY,"findItem"),e7(pK,"calcBBox"),e7(pX,"distBBox"),e7(pq,"extend"),e7(pJ,"compareNodeMinX"),e7(pQ,"compareNodeMinY"),e7(pZ,"bboxArea"),e7(p0,"bboxMargin"),e7(p1,"enlargedArea"),e7(p2,"intersectionArea"),e7(p5,"contains"),e7(p3,"intersects"),e7(p6,"createNode"),e7(p4,"multiSelect");let p9=class{constructor(e=!1){te(this,"_tree",/* @__PURE__ */new Map),te(this,"_oneCellCache",/* @__PURE__ */new Map),te(this,"_kdTree",/* @__PURE__ */new Map),te(this,"_kdTreeSearchState",!1),this._enableOneCellCache=e}dispose(){this.clear()}getTree(e,t){return this._tree.has(e)||this._tree.set(e,/* @__PURE__ */new Map),this._tree.get(e).has(t)||this._tree.get(e).set(t,new pz),this._tree.get(e).get(t)}_getOneCellCache(e,t,r,n){return this._oneCellCache.has(e)||this._oneCellCache.set(e,/* @__PURE__ */new Map),this._oneCellCache.get(e).has(t)||this._oneCellCache.get(e).set(t,/* @__PURE__ */new Map),this._oneCellCache.get(e).get(t).has(r)||this._oneCellCache.get(e).get(t).set(r,/* @__PURE__ */new Map),this._oneCellCache.get(e).get(t).get(r).has(n)||this._oneCellCache.get(e).get(t).get(r).set(n,/* @__PURE__ */new Set),this._oneCellCache.get(e).get(t).get(r).get(n)}_removeOneCellCache(e,t,r,n,i){let o=this._oneCellCache.get(e);if(!o)return;let s=o.get(t);if(!s)return;let a=s.get(r);if(!a)return;let l=a.get(n);l&&l.delete(i)}_insertOneCellCache(e,t,r,n,i){this._getOneCellCache(e,t,r,n).add(i)}_getRdTreeItems(e){let t=[];for(let[r,n]of e)for(let[e,i]of n)t.push({x:e,y:r,ids:i});return t}_searchByOneCellCache(e){var t;let{unitId:r,sheetId:n,range:i}=e,{startRow:o,startColumn:s,endRow:a,endColumn:l}=i,u=null==(t=this._kdTree.get(r))?void 0:t.get(n);if(!u)return[];let{tree:c,items:h}=u,d=c.range(s,o,l,a),p=[];for(let e of d){let t=h[e];p.push(...Array.from(t.ids))}return p}openKdTree(){var e;for(let[t,r]of(this._kdTreeSearchState=!0,this._oneCellCache))for(let[n,i]of(this._kdTree.has(t)||this._kdTree.set(t,/* @__PURE__ */new Map),r)){let r=this._getRdTreeItems(i),o=new pk(r.length);for(let i of(null==(e=this._kdTree.get(t))||e.set(n,{tree:o,items:r}),r))o.add(i.x,i.y);o.finish()}}closeKdTree(){var e;for(let[t,r]of(this._kdTreeSearchState=!1,this._oneCellCache))for(let[n,i]of r)null==(e=this._kdTree.get(t))||e.set(n,void 0)}insert(e){let{unitId:t,sheetId:r,range:n,id:i}=e;if(!t||0===t.length)return;let{startRow:o,endRow:s,startColumn:a,endColumn:l}=n;if(this._enableOneCellCache&&o===s&&a===l){this._insertOneCellCache(t,r,o,a,i);return}let u=this.getTree(t,r);Number.isNaN(o)&&(o=0),Number.isNaN(a)&&(a=0),Number.isNaN(s)&&(s=Number.POSITIVE_INFINITY),Number.isNaN(l)&&(l=Number.POSITIVE_INFINITY),u.insert({minX:a,minY:o,maxX:l,maxY:s,id:i})}bulkInsert(e){for(let t of e)this.insert(t)}search(e){var t;let{unitId:r,sheetId:n,range:i}=e,o=[];if(this._enableOneCellCache&&this._enableOneCellCache)for(let t of this._searchByOneCellCache(e))o.push(t);let s=null==(t=this._tree.get(r))?void 0:t.get(n);if(!s)return o;for(let e of s.search({minX:i.startColumn,minY:i.startRow,maxX:i.endColumn,maxY:i.endRow}))o.push(e.id);return o}bulkSearch(e){let t=/* @__PURE__ */new Set;for(let r of e)for(let e of this.search(r))t.add(e);return t}removeById(e,t){var r,n;t?(null==(r=this._tree.get(e))||r.delete(t),null==(n=this._oneCellCache.get(e))||n.delete(t)):(this._tree.delete(e),this._oneCellCache.delete(e))}remove(e){let{unitId:t,sheetId:r,range:n,id:i}=e,o=this.getTree(t,r);this._removeOneCellCache(t,r,n.startRow,n.startColumn,i),o.remove({minX:n.startColumn,minY:n.startRow,maxX:n.endColumn,maxY:n.endRow,id:i})}bulkRemove(e){for(let t of e)this.remove(t)}clear(){this._tree.clear(),this._oneCellCache.clear()}toJSON(){let e={};return this._tree.forEach((t,r)=>{e[r]={},t.forEach((t,n)=>{e[r][n]=t.toJSON()})}),e}fromJSON(e){for(let t in this._tree.clear(),e)for(let r in this._tree.set(t,/* @__PURE__ */new Map),e[t]){let n=new pz;n.fromJSON(e[t][r]),this._tree.get(t).set(r,n)}}};e7(p9,"RTree");let p8=p9;var p7,fe,ft,fr,fn=Object.defineProperty,fi=Object.getOwnPropertyDescriptor,fo=/* @__PURE__ */e7((e,t,r,n)=>{for(var i,o=n>1?void 0:n?fi(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&fn(t,r,o),o},"__decorateClass"),fs=/* @__PURE__ */e7((e,t)=>(r,n)=>t(r,n,e),"__decorateParam");let fa=(fr=class extends oZ{constructor(e,t){super(),this._resourceManagerService=e,this._univerInstanceService=t,this._init()}_init(){let e=/* @__PURE__ */e7(e=>{e.businesses.forEach(t=>{switch(t){case l9.UNRECOGNIZED:case l9.UNIVER_UNKNOWN:case l9.UNIVER_SLIDE:case l9.UNIVER_DOC:this._univerInstanceService.getAllUnitsForType(l9.UNIVER_DOC).forEach(t=>{let r=(t.getSnapshot().resources||[]).find(t=>t.name===e.pluginName);if(r)try{let n=e.parseJson(r.data);e.onLoad(t.getUnitId(),n)}catch{console.error(`Load Document{${t.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}});break;case l9.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(l9.UNIVER_SHEET).forEach(t=>{let r=(t.getSnapshot().resources||[]).find(t=>t.name===e.pluginName);if(r)try{let n=e.parseJson(r.data);e.onLoad(t.getUnitId(),n)}catch{console.error(`Load Workbook{${t.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}})}})},"handleHookAdd");this._resourceManagerService.getAllResourceHooks().forEach(t=>e(t)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(t=>e(t))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(l9.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(l9.UNIVER_DOC).subscribe(e=>{n5(e.getUnitId())||this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(l9.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId())})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(l9.UNIVER_DOC).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId())}))}saveUnit(e){let t=this._univerInstanceService.getUnit(e);if(!t)return null;let r=this._resourceManagerService.getResources(e,t.type),n=ai.deepClone(t.getSnapshot());return n.resources=r,n}},e7(fr,"ResourceLoaderService"),fr);fa=fo([fs(0,ix(hX)),fs(1,ix(d$))],fa);let fl=class{constructor(e={},t){te(this,"_startedTypes",/* @__PURE__ */new Set),te(this,"_injector");let r=this._injector=fc(t,null==e?void 0:e.override),{theme:n,locale:i,locales:o,logLevel:s}=e;n&&this._injector.get(pf).setTheme(n),o&&this._injector.get(d3).load(o),i&&this._injector.get(d3).setLocale(i),s&&this._injector.get(o6).setLogLevel(s),this._init(r)}get _univerInstanceService(){return this._injector.get(d$)}get _pluginService(){return this._injector.get(pl)}__getInjector(){return this._injector}dispose(){this._injector.dispose()}setLocale(e){this._injector.get(d3).setLocale(e)}createUnit(e,t){return this._univerInstanceService.createUnit(e,t)}createUniverSheet(e){return this._injector.get(o6).warn("[Univer]: Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(l9.UNIVER_SHEET,e)}createUniverDoc(e){return this._injector.get(o6).warn("[Univer]: Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(l9.UNIVER_DOC,e)}createUniverSlide(e){return this._injector.get(o6).warn("[Univer]: Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(l9.UNIVER_SLIDE,e)}_init(e){this._univerInstanceService.registerCtorForType(l9.UNIVER_SHEET,dP),this._univerInstanceService.registerCtorForType(l9.UNIVER_DOC,hd),this._univerInstanceService.registerCtorForType(l9.UNIVER_SLIDE,dF);let t=e.get(d$);t.__setCreateHandler((r,n,i,o)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginForType(r),this._startedTypes.add(r);let s=e.createInstance(i,n);return t.__addUnit(s,o),this._tryProgressToReady(),s}let s=e.createInstance(i,n);return t.__addUnit(s,o),s})}_tryProgressToReady(){this._injector.get(d0).stage<dW.Ready&&(this._injector.get(d0).stage=dW.Ready)}registerPlugin(e,t){this._pluginService.registerPlugin(e,t)}};e7(fl,"Univer");let fu=fl;function fc(e,t){let r=pc([[dy],[d3],[pf],[d0],[pl],[h0],[d$,{useClass:dG}],[d4,{useClass:d9}],[o6,{useClass:o4,lazy:!0}],[sr,{useClass:so}],[pE,{useClass:pS,lazy:!0}],[dt,{useClass:dr}],[o2,{useClass:o5}],[hX,{useClass:pd,lazy:!0}],[ph,{useClass:fa,lazy:!0}],[de,{useClass:h7,lazy:!0}]],t),n=e?e.createChild(r):new i4(r);return ob(n,[[h0],[ph]]),n}e7(fc,"createUniverInjector"),tt()}),o("5LPkb",function(e,r){t(e.exports,"BehaviorSubject",function(){return o});var n=i("1a7ft"),o=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return r.closed||t.next(this._value),r},t.prototype.getValue=function(){var e=this.hasError,t=this.thrownError,r=this._value;if(e)throw t;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(i("1mjSk").Subject)}),o("1a7ft",function(e,r){t(e.exports,"__extends",function(){return i}),t(e.exports,"__awaiter",function(){return o}),t(e.exports,"__generator",function(){return s}),t(e.exports,"__values",function(){return a}),t(e.exports,"__read",function(){return l}),t(e.exports,"__spreadArray",function(){return u}),t(e.exports,"__await",function(){return c}),t(e.exports,"__asyncGenerator",function(){return h}),t(e.exports,"__asyncValues",function(){return d});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})}function s(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function u(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function c(e){return this instanceof c?(this.v=e,this):new c(e)}function h(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof c?Promise.resolve(r.value.v).then(l,u):h(o[0][2],r)}catch(e){h(o[0][3],e)}}function l(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function d(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=a(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}}"function"==typeof SuppressedError&&SuppressedError}),o("1mjSk",function(e,r){t(e.exports,"Subject",function(){return c});var n=i("1a7ft"),o=i("1O3Nt"),s=i("e1VZ5"),a=i("c6P6i"),l=i("hFN8R"),u=i("dIjnd"),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,n.__extends)(t,e),t.prototype.lift=function(e){var t=new h(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new a.ObjectUnsubscribedError},t.prototype.next=function(e){var t=this;(0,u.errorContext)(function(){var r,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=(0,n.__values)(t.currentObservers),s=o.next();!s.done;s=o.next())s.value.next(e)}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}})},t.prototype.error=function(e){var t=this;(0,u.errorContext)(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}})},t.prototype.complete=function(){var e=this;(0,u.errorContext)(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this.hasError,n=this.isStopped,i=this.observers;return r||n?s.EMPTY_SUBSCRIPTION:(this.currentObservers=null,i.push(e),new s.Subscription(function(){t.currentObservers=null,(0,l.arrRemove)(i,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this.hasError,r=this.thrownError,n=this.isStopped;t?e.error(r):n&&e.complete()},t.prototype.asObservable=function(){var e=new o.Observable;return e.source=this,e},t.create=function(e,t){return new h(e,t)},t}(o.Observable),h=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return(0,n.__extends)(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:s.EMPTY_SUBSCRIPTION},t}(c)}),o("1O3Nt",function(e,r){t(e.exports,"Observable",function(){return h});var n=i("lftZl"),o=i("e1VZ5"),s=i("eDMxo"),a=i("1hKfX"),l=i("laEi0"),u=i("3IQI0"),c=i("dIjnd"),h=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var i,s=this,a=(i=e)&&i instanceof n.Subscriber||i&&(0,u.isFunction)(i.next)&&(0,u.isFunction)(i.error)&&(0,u.isFunction)(i.complete)&&(0,o.isSubscription)(i)?e:new n.SafeSubscriber(e,t,r);return(0,c.errorContext)(function(){var e=s.operator,t=s.source;a.add(e?e.call(a,t):t?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=d(t))(function(t,i){var o=new n.SafeSubscriber({next:function(t){try{e(t)}catch(e){i(e),o.unsubscribe()}},error:i,complete:t});r.subscribe(o)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[s.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,a.pipeFromArray)(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})},e.create=function(t){return new e(t)},e}();function d(e){var t;return null!==(t=null!=e?e:l.config.Promise)&&void 0!==t?t:Promise}}),o("lftZl",function(e,r){t(e.exports,"Subscriber",function(){return p}),t(e.exports,"SafeSubscriber",function(){return _});var n=i("1a7ft"),o=i("3IQI0"),s=i("e1VZ5"),a=i("laEi0"),l=i("ghA1h"),u=i("f1euv"),c=i("6x7Ga"),h=i("caYEJ"),d=i("dIjnd"),p=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,(0,s.isSubscription)(t)&&t.add(r)):r.destination=v,r}return(0,n.__extends)(t,e),t.create=function(e,t,r){return new _(e,t,r)},t.prototype.next=function(e){this.isStopped?E((0,c.nextNotification)(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?E((0,c.errorNotification)(e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?E(c.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(s.Subscription),f=Function.prototype.bind;function g(e,t){return f.call(e,t)}var m=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){y(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){y(e)}else y(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){y(e)}},e}(),_=function(e){function t(t,r,n){var i,s,l=e.call(this)||this;return(0,o.isFunction)(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:l&&a.config.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return l.unsubscribe()},i={next:t.next&&g(t.next,s),error:t.error&&g(t.error,s),complete:t.complete&&g(t.complete,s)}):i=t,l.destination=new m(i),l}return(0,n.__extends)(t,e),t}(p);function y(e){a.config.useDeprecatedSynchronousErrorHandling?(0,d.captureError)(e):(0,l.reportUnhandledError)(e)}function E(e,t){var r=a.config.onStoppedNotification;r&&(0,h.timeoutProvider).setTimeout(function(){return r(e,t)})}var v={closed:!0,next:u.noop,error:function(e){throw e},complete:u.noop}}),o("3IQI0",function(e,r){t(e.exports,"isFunction",function(){return n});function n(e){return"function"==typeof e}}),o("e1VZ5",function(e,r){t(e.exports,"Subscription",function(){return l}),t(e.exports,"EMPTY_SUBSCRIPTION",function(){return u}),t(e.exports,"isSubscription",function(){return c});var n=i("1a7ft"),o=i("3IQI0"),s=i("iftTV"),a=i("hFN8R"),l=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e,t,r,i,a,l=this._parentage;if(l){if(this._parentage=null,Array.isArray(l))try{for(var u=(0,n.__values)(l),c=u.next();!c.done;c=u.next())c.value.remove(this)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}else l.remove(this)}var d=this.initialTeardown;if((0,o.isFunction)(d))try{d()}catch(e){a=e instanceof s.UnsubscriptionError?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var f=(0,n.__values)(p),g=f.next();!g.done;g=f.next()){var m=g.value;try{h(m)}catch(e){a=null!=a?a:[],e instanceof s.UnsubscriptionError?a=(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(a)),(0,n.__read)(e.errors)):a.push(e)}}}catch(e){r={error:e}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}if(a)throw new s.UnsubscriptionError(a)}},t.prototype.add=function(e){var r;if(e&&e!==this){if(this.closed)h(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,a.arrRemove)(t,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&(0,a.arrRemove)(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}(),u=l.EMPTY;function c(e){return e instanceof l||e&&"closed"in e&&(0,o.isFunction)(e.remove)&&(0,o.isFunction)(e.add)&&(0,o.isFunction)(e.unsubscribe)}function h(e){(0,o.isFunction)(e)?e():e.unsubscribe()}}),o("iftTV",function(e,r){t(e.exports,"UnsubscriptionError",function(){return n});var n=(0,i("bfFMS").createErrorClass)(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})}),o("bfFMS",function(e,r){t(e.exports,"createErrorClass",function(){return n});function n(e){var t=e(function(e){Error.call(e),e.stack=Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}}),o("hFN8R",function(e,r){t(e.exports,"arrRemove",function(){return n});function n(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}}),o("laEi0",function(e,r){t(e.exports,"config",function(){return n});var n={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}}),o("ghA1h",function(e,r){t(e.exports,"reportUnhandledError",function(){return s});var n=i("laEi0"),o=i("caYEJ");function s(e){(0,o.timeoutProvider).setTimeout(function(){var t=n.config.onUnhandledError;if(t)t(e);else throw e})}}),o("caYEJ",function(e,r){t(e.exports,"timeoutProvider",function(){return o});var n=i("1a7ft"),o={setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var s=o.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,(0,n.__spreadArray)([e,t],(0,n.__read)(r))):setTimeout.apply(void 0,(0,n.__spreadArray)([e,t],(0,n.__read)(r)))},clearTimeout:function(e){var t=o.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}}),o("f1euv",function(e,r){t(e.exports,"noop",function(){return n});function n(){}}),o("6x7Ga",function(e,r){t(e.exports,"COMPLETE_NOTIFICATION",function(){return n}),t(e.exports,"errorNotification",function(){return i}),t(e.exports,"nextNotification",function(){return o});var n=s("C",void 0,void 0);function i(e){return s("E",void 0,e)}function o(e){return s("N",e,void 0)}function s(e,t,r){return{kind:e,value:t,error:r}}}),o("dIjnd",function(e,r){t(e.exports,"errorContext",function(){return s}),t(e.exports,"captureError",function(){return a});var n=i("laEi0"),o=null;function s(e){if(n.config.useDeprecatedSynchronousErrorHandling){var t=!o;if(t&&(o={errorThrown:!1,error:null}),e(),t){var r=o,i=r.errorThrown,s=r.error;if(o=null,i)throw s}}else e()}function a(e){n.config.useDeprecatedSynchronousErrorHandling&&o&&(o.errorThrown=!0,o.error=e)}}),o("eDMxo",function(e,r){t(e.exports,"observable",function(){return n});var n="function"==typeof Symbol&&Symbol.observable||"@@observable"}),o("1hKfX",function(e,r){t(e.exports,"pipe",function(){return o}),t(e.exports,"pipeFromArray",function(){return s});var n=i("2N6l4");function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(e)}function s(e){return 0===e.length?n.identity:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}}),o("2N6l4",function(e,r){t(e.exports,"identity",function(){return n});function n(e){return e}}),o("c6P6i",function(e,r){t(e.exports,"ObjectUnsubscribedError",function(){return n});var n=(0,i("bfFMS").createErrorClass)(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})}),o("5K4WI",function(e,r){t(e.exports,"combineLatest",function(){return p}),t(e.exports,"combineLatestInit",function(){return f});var n=i("1O3Nt"),o=i("6obID"),s=i("fz1T5"),a=i("2N6l4"),l=i("h319C"),u=i("4xvfD"),c=i("TccoZ"),h=i("iNetn"),d=i("99A8K");function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,u.popScheduler)(e),i=(0,u.popResultSelector)(e),h=(0,o.argsArgArrayOrObject)(e),d=h.args,p=h.keys;if(0===d.length)return(0,s.from)([],r);var g=new n.Observable(f(d,r,p?function(e){return(0,c.createObject)(p,e)}:a.identity));return i?g.pipe((0,l.mapOneOrManyArgs)(i)):g}function f(e,t,r){return void 0===r&&(r=a.identity),function(n){g(t,function(){for(var i=e.length,o=Array(i),a=i,l=i,u=function(i){g(t,function(){var u=(0,s.from)(e[i],t),c=!1;u.subscribe((0,h.createOperatorSubscriber)(n,function(e){o[i]=e,!c&&(c=!0,l--),l||n.next(r(o.slice()))},function(){--a||n.complete()}))},n)},c=0;c<i;c++)u(c)},n)}}function g(e,t,r){e?(0,d.executeSchedule)(r,e,t):t()}}),o("6obID",function(e,r){t(e.exports,"argsArgArrayOrObject",function(){return a});var n=Array.isArray,i=Object.getPrototypeOf,o=Object.prototype,s=Object.keys;function a(e){if(1===e.length){var t=e[0];if(n(t))return{args:t,keys:null};if(t&&"object"==typeof t&&i(t)===o){var r=s(t);return{args:r.map(function(e){return t[e]}),keys:r}}}return{args:e,keys:null}}}),o("fz1T5",function(e,r){t(e.exports,"from",function(){return s});var n=i("3ESKv"),o=i("b7gpN");function s(e,t){return t?(0,n.scheduled)(e,t):(0,o.innerFrom)(e)}}),o("3ESKv",function(e,r){t(e.exports,"scheduled",function(){return _});var n=i("HWDtl"),o=i("kx7NJ"),s=i("61w6q"),a=i("3kNl0"),l=i("1jutQ"),u=i("5BIEa"),c=i("jWdZ8"),h=i("bLVFn"),d=i("6woc9"),p=i("aewtS"),f=i("729in"),g=i("fdiCB"),m=i("dvjJq");function _(e,t){if(null!=e){if((0,u.isInteropObservable)(e))return(0,n.scheduleObservable)(e,t);if((0,h.isArrayLike)(e))return(0,s.scheduleArray)(e,t);if((0,c.isPromise)(e))return(0,o.schedulePromise)(e,t);if((0,p.isAsyncIterable)(e))return(0,l.scheduleAsyncIterable)(e,t);if((0,d.isIterable)(e))return(0,a.scheduleIterable)(e,t);if((0,g.isReadableStreamLike)(e))return(0,m.scheduleReadableStreamLike)(e,t)}throw(0,f.createInvalidObservableTypeError)(e)}}),o("HWDtl",function(e,r){t(e.exports,"scheduleObservable",function(){return a});var n=i("b7gpN"),o=i("jHEit"),s=i("bQ23s");function a(e,t){return(0,n.innerFrom)(e).pipe((0,s.subscribeOn)(t),(0,o.observeOn)(t))}}),o("b7gpN",function(e,r){t(e.exports,"innerFrom",function(){return m});var n=i("1a7ft"),o=i("bLVFn"),s=i("jWdZ8"),a=i("1O3Nt"),l=i("5BIEa"),u=i("aewtS"),c=i("729in"),h=i("6woc9"),d=i("fdiCB"),p=i("3IQI0"),f=i("ghA1h"),g=i("eDMxo");function m(e){if(e instanceof a.Observable)return e;if(null!=e){if((0,l.isInteropObservable)(e))return new a.Observable(function(t){var r=e[0,g.observable]();if((0,p.isFunction)(r.subscribe))return r.subscribe(t);throw TypeError("Provided object does not correctly implement Symbol.observable")});if((0,o.isArrayLike)(e))return new a.Observable(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()});if((0,s.isPromise)(e))return new a.Observable(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,f.reportUnhandledError)});if((0,u.isAsyncIterable)(e))return _(e);if((0,h.isIterable)(e))return new a.Observable(function(t){var r,i;try{for(var o=(0,n.__values)(e),s=o.next();!s.done;s=o.next()){var a=s.value;if(t.next(a),t.closed)return}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}t.complete()});if((0,d.isReadableStreamLike)(e))return _((0,d.readableStreamLikeToAsyncGenerator)(e))}throw(0,c.createInvalidObservableTypeError)(e)}function _(e){return new a.Observable(function(t){(function(e,t){var r,i,o,s;return(0,n.__awaiter)(this,void 0,void 0,function(){var a;return(0,n.__generator)(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=(0,n.__asyncValues)(e),l.label=1;case 1:return[4,r.next()];case 2:if((i=l.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o={error:l.sent()},[3,11];case 6:if(l.trys.push([6,,9,10]),!(i&&!i.done&&(s=r.return)))return[3,8];return[4,s.call(r)];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}}),o("bLVFn",function(e,r){t(e.exports,"isArrayLike",function(){return n});var n=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}}),o("jWdZ8",function(e,r){t(e.exports,"isPromise",function(){return o});var n=i("3IQI0");function o(e){return(0,n.isFunction)(null==e?void 0:e.then)}}),o("5BIEa",function(e,r){t(e.exports,"isInteropObservable",function(){return s});var n=i("eDMxo"),o=i("3IQI0");function s(e){return(0,o.isFunction)(e[n.observable])}}),o("aewtS",function(e,r){t(e.exports,"isAsyncIterable",function(){return o});var n=i("3IQI0");function o(e){return Symbol.asyncIterator&&(0,n.isFunction)(null==e?void 0:e[Symbol.asyncIterator])}}),o("729in",function(e,r){t(e.exports,"createInvalidObservableTypeError",function(){return n});function n(e){return TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}}),o("6woc9",function(e,r){t(e.exports,"isIterable",function(){return s});var n=i("kZq5V"),o=i("3IQI0");function s(e){return(0,o.isFunction)(null==e?void 0:e[n.iterator])}}),o("kZq5V",function(e,r){t(e.exports,"iterator",function(){return n});var n="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}),o("fdiCB",function(e,r){t(e.exports,"readableStreamLikeToAsyncGenerator",function(){return s}),t(e.exports,"isReadableStreamLike",function(){return a});var n=i("1a7ft"),o=i("3IQI0");function s(e){return(0,n.__asyncGenerator)(this,arguments,function(){var t,r,i;return(0,n.__generator)(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,(0,n.__await)(t.read())];case 3:if(i=(r=o.sent()).value,!r.done)return[3,5];return[4,(0,n.__await)(void 0)];case 4:return[2,o.sent()];case 5:return[4,(0,n.__await)(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function a(e){return(0,o.isFunction)(null==e?void 0:e.getReader)}}),o("jHEit",function(e,r){t(e.exports,"observeOn",function(){return a});var n=i("99A8K"),o=i("jSzwf"),s=i("iNetn");function a(e,t){return void 0===t&&(t=0),(0,o.operate)(function(r,i){r.subscribe((0,s.createOperatorSubscriber)(i,function(r){return(0,n.executeSchedule)(i,e,function(){return i.next(r)},t)},function(){return(0,n.executeSchedule)(i,e,function(){return i.complete()},t)},function(r){return(0,n.executeSchedule)(i,e,function(){return i.error(r)},t)}))})}}),o("99A8K",function(e,r){t(e.exports,"executeSchedule",function(){return n});function n(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var o=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(o),!i)return o}}),o("jSzwf",function(e,r){t(e.exports,"operate",function(){return o});var n=i("3IQI0");function o(e){return function(t){if((0,n.isFunction)(null==t?void 0:t.lift))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw TypeError("Unable to lift unknown Observable type")}}}),o("iNetn",function(e,r){t(e.exports,"createOperatorSubscriber",function(){return o});var n=i("1a7ft");function o(e,t,r,n,i){return new s(e,t,r,n,i)}var s=function(e){function t(t,r,n,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,n.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),r||null===(t=this.onFinalize)||void 0===t||t.call(this)}},t}(i("lftZl").Subscriber)}),o("bQ23s",function(e,r){t(e.exports,"subscribeOn",function(){return o});var n=i("jSzwf");function o(e,t){return void 0===t&&(t=0),(0,n.operate)(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}}),o("kx7NJ",function(e,r){t(e.exports,"schedulePromise",function(){return a});var n=i("b7gpN"),o=i("jHEit"),s=i("bQ23s");function a(e,t){return(0,n.innerFrom)(e).pipe((0,s.subscribeOn)(t),(0,o.observeOn)(t))}}),o("61w6q",function(e,r){t(e.exports,"scheduleArray",function(){return o});var n=i("1O3Nt");function o(e,t){return new n.Observable(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}}),o("3kNl0",function(e,r){t(e.exports,"scheduleIterable",function(){return l});var n=i("1O3Nt"),o=i("kZq5V"),s=i("3IQI0"),a=i("99A8K");function l(e,t){return new n.Observable(function(r){var n;return(0,a.executeSchedule)(r,t,function(){n=e[0,o.iterator](),(0,a.executeSchedule)(r,t,function(){var e,t,i;try{t=(e=n.next()).value,i=e.done}catch(e){r.error(e);return}i?r.complete():r.next(t)},0,!0)}),function(){return(0,s.isFunction)(null==n?void 0:n.return)&&n.return()}})}}),o("1jutQ",function(e,r){t(e.exports,"scheduleAsyncIterable",function(){return s});var n=i("1O3Nt"),o=i("99A8K");function s(e,t){if(!e)throw Error("Iterable cannot be null");return new n.Observable(function(r){(0,o.executeSchedule)(r,t,function(){var n=e[Symbol.asyncIterator]();(0,o.executeSchedule)(r,t,function(){n.next().then(function(e){e.done?r.complete():r.next(e.value)})},0,!0)})})}}),o("dvjJq",function(e,r){t(e.exports,"scheduleReadableStreamLike",function(){return s});var n=i("1jutQ"),o=i("fdiCB");function s(e,t){return(0,n.scheduleAsyncIterable)((0,o.readableStreamLikeToAsyncGenerator)(e),t)}}),o("h319C",function(e,r){t(e.exports,"mapOneOrManyArgs",function(){return a});var n=i("1a7ft"),o=i("hciHF"),s=Array.isArray;function a(e){return(0,o.map)(function(t){return s(t)?e.apply(void 0,(0,n.__spreadArray)([],(0,n.__read)(t))):e(t)})}}),o("hciHF",function(e,r){t(e.exports,"map",function(){return s});var n=i("jSzwf"),o=i("iNetn");function s(e,t){return(0,n.operate)(function(r,n){var i=0;r.subscribe((0,o.createOperatorSubscriber)(n,function(r){n.next(e.call(t,r,i++))}))})}}),o("4xvfD",function(e,r){t(e.exports,"popResultSelector",function(){return a}),t(e.exports,"popScheduler",function(){return l}),t(e.exports,"popNumber",function(){return u});var n=i("3IQI0"),o=i("4tjBj");function s(e){return e[e.length-1]}function a(e){return(0,n.isFunction)(s(e))?e.pop():void 0}function l(e){return(0,o.isScheduler)(s(e))?e.pop():void 0}function u(e,t){return"number"==typeof s(e)?e.pop():t}}),o("4tjBj",function(e,r){t(e.exports,"isScheduler",function(){return o});var n=i("3IQI0");function o(e){return e&&(0,n.isFunction)(e.schedule)}}),o("TccoZ",function(e,r){t(e.exports,"createObject",function(){return n});function n(e,t){return e.reduce(function(e,r,n){return e[r]=t[n],e},{})}}),o("bXJOC",function(e,r){t(e.exports,"debounceTime",function(){return a});var n=i("jaZjQ"),o=i("jSzwf"),s=i("iNetn");function a(e,t){return void 0===t&&(t=n.asyncScheduler),(0,o.operate)(function(r,n){var i=null,o=null,a=null,l=function(){if(i){i.unsubscribe(),i=null;var e=o;o=null,n.next(e)}};function u(){var r=a+e,o=t.now();if(o<r){i=this.schedule(void 0,r-o),n.add(i);return}l()}r.subscribe((0,s.createOperatorSubscriber)(n,function(r){o=r,a=t.now(),i||(i=t.schedule(u,e),n.add(i))},function(){l(),n.complete()},void 0,function(){o=i=null}))})}}),o("jaZjQ",function(e,r){t(e.exports,"asyncScheduler",function(){return o}),t(e.exports,"async",function(){return s});var n=i("aTfYm"),o=new(i("7GTYN")).AsyncScheduler(n.AsyncAction),s=o}),o("aTfYm",function(e,r){t(e.exports,"AsyncAction",function(){return l});var n=i("1a7ft"),o=i("iSRzt"),s=i("ic7D4"),a=i("hFN8R"),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return(0,n.__extends)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r,n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),(0,s.intervalProvider).setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&(0,s.intervalProvider).clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,a.arrRemove)(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(o.Action)}),o("iSRzt",function(e,r){t(e.exports,"Action",function(){return o});var n=i("1a7ft"),o=function(e){function t(t,r){return e.call(this)||this}return(0,n.__extends)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(i("e1VZ5").Subscription)}),o("ic7D4",function(e,r){t(e.exports,"intervalProvider",function(){return o});var n=i("1a7ft"),o={setInterval:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var s=o.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,(0,n.__spreadArray)([e,t],(0,n.__read)(r))):setInterval.apply(void 0,(0,n.__spreadArray)([e,t],(0,n.__read)(r)))},clearInterval:function(e){var t=o.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0}}),o("7GTYN",function(e,r){t(e.exports,"AsyncScheduler",function(){return s});var n=i("1a7ft"),o=i("gDW7u"),s=function(e){function t(t,r){void 0===r&&(r=o.Scheduler.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return(0,n.__extends)(t,e),t.prototype.flush=function(e){var t,r=this.actions;if(this._active){r.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=r.shift())if(this._active=!1,t){for(;e=r.shift();)e.unsubscribe();throw t}},t}(o.Scheduler)}),o("gDW7u",function(e,r){t(e.exports,"Scheduler",function(){return o});var n=i("O2Flc"),o=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=n.dateTimestampProvider.now,e}()}),o("O2Flc",function(e,r){t(e.exports,"dateTimestampProvider",function(){return n});var n={now:function(){return(n.delegate||Date).now()},delegate:void 0}}),o("arCqp",function(e,r){t(e.exports,"distinctUntilChanged",function(){return a});var n=i("2N6l4"),o=i("jSzwf"),s=i("iNetn");function a(e,t){return void 0===t&&(t=n.identity),e=null!=e?e:l,(0,o.operate)(function(r,n){var i,o=!0;r.subscribe((0,s.createOperatorSubscriber)(n,function(r){var s=t(r);(o||!e(i,s))&&(o=!1,i=s,n.next(r))}))})}function l(e,t){return e===t}}),o("lMvMU",function(e,r){t(e.exports,"filter",function(){return s});var n=i("jSzwf"),o=i("iNetn");function s(e,t){return(0,n.operate)(function(r,n){var i=0;r.subscribe((0,o.createOperatorSubscriber)(n,function(r){return e.call(t,r,i++)&&n.next(r)}))})}}),o("i54iF",function(e,r){t(e.exports,"merge",function(){return u});var n=i("gpa4f"),o=i("b7gpN"),s=i("gL4uk"),a=i("4xvfD"),l=i("fz1T5");function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,a.popScheduler)(e),i=(0,a.popNumber)(e,1/0);return e.length?1===e.length?(0,o.innerFrom)(e[0]):(0,n.mergeAll)(i)((0,l.from)(e,r)):s.EMPTY}}),o("gpa4f",function(e,r){t(e.exports,"mergeAll",function(){return s});var n=i("97m73"),o=i("2N6l4");function s(e){return void 0===e&&(e=1/0),(0,n.mergeMap)(o.identity,e)}}),o("97m73",function(e,r){t(e.exports,"mergeMap",function(){return function e(t,r,i){return(void 0===i&&(i=1/0),(0,l.isFunction)(r))?e(function(e,i){return(0,n.map)(function(t,n){return r(e,t,i,n)})((0,o.innerFrom)(t(e,i)))},i):("number"==typeof r&&(i=r),(0,s.operate)(function(e,r){return(0,a.mergeInternals)(e,r,t,i)}))}});var n=i("hciHF"),o=i("b7gpN"),s=i("jSzwf"),a=i("c8eGQ"),l=i("3IQI0")}),o("c8eGQ",function(e,r){t(e.exports,"mergeInternals",function(){return a});var n=i("b7gpN"),o=i("99A8K"),s=i("iNetn");function a(e,t,r,i,a,l,u,c){var h=[],d=0,p=0,f=!1,g=function(){!f||h.length||d||t.complete()},m=function(e){return d<i?_(e):h.push(e)},_=function(e){l&&t.next(e),d++;var c=!1;(0,n.innerFrom)(r(e,p++)).subscribe((0,s.createOperatorSubscriber)(t,function(e){null==a||a(e),l?m(e):t.next(e)},function(){c=!0},void 0,function(){if(c)try{for(d--;h.length&&d<i;)!function(){var e=h.shift();u?(0,o.executeSchedule)(t,u,function(){return _(e)}):_(e)}();g()}catch(e){t.error(e)}}))};return e.subscribe((0,s.createOperatorSubscriber)(t,m,function(){f=!0,g()})),function(){null==c||c()}}}),o("gL4uk",function(e,r){t(e.exports,"EMPTY",function(){return n});var n=new(i("1O3Nt")).Observable(function(e){return e.complete()})}),o("3yupB",function(e,r){t(e.exports,"of",function(){return s});var n=i("4xvfD"),o=i("fz1T5");function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,n.popScheduler)(e);return(0,o.from)(e,r)}}),o("9GqS8",function(e,r){t(e.exports,"skip",function(){return o});var n=i("lMvMU");function o(e){return(0,n.filter)(function(t,r){return e<=r})}}),o("b7wVW",function(e,r){t(e.exports,"tap",function(){return l});var n=i("3IQI0"),o=i("jSzwf"),s=i("iNetn"),a=i("2N6l4");function l(e,t,r){var i=(0,n.isFunction)(e)||t||r?{next:e,error:t,complete:r}:e;return i?(0,o.operate)(function(e,t){null===(r=i.subscribe)||void 0===r||r.call(i);var r,n=!0;e.subscribe((0,s.createOperatorSubscriber)(t,function(e){var r;null===(r=i.next)||void 0===r||r.call(i,e),t.next(e)},function(){var e;n=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()},function(e){var r;n=!1,null===(r=i.error)||void 0===r||r.call(i,e),t.error(e)},function(){var e,t;n&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)}))}):a.identity}}),o("aMpZj",function(e,r){t(e.exports,"timer",function(){return l});var n=i("1O3Nt"),o=i("jaZjQ"),s=i("4tjBj"),a=i("hdn9Z");function l(e,t,r){void 0===e&&(e=0),void 0===r&&(r=o.async);var i=-1;return null!=t&&((0,s.isScheduler)(t)?r=t:i=t),new n.Observable(function(t){var n=(0,a.isValidDate)(e)?+e-r.now():e;n<0&&(n=0);var o=0;return r.schedule(function(){t.closed||(t.next(o++),0<=i?this.schedule(void 0,i):t.complete())},n)})}}),o("hdn9Z",function(e,r){t(e.exports,"isValidDate",function(){return n});function n(e){return e instanceof Date&&!isNaN(e)}}),o("bDEN0",function(e,r){t(e.exports,"first",function(){return c});var n=i("aXqMV"),o=i("lMvMU"),s=i("9z4na"),a=i("gSl4p"),l=i("aRjCl"),u=i("2N6l4");function c(e,t){var r=arguments.length>=2;return function(i){return i.pipe(e?(0,o.filter)(function(t,r){return e(t,r,i)}):u.identity,(0,s.take)(1),r?(0,a.defaultIfEmpty)(t):(0,l.throwIfEmpty)(function(){return new n.EmptyError}))}}}),o("aXqMV",function(e,r){t(e.exports,"EmptyError",function(){return n});var n=(0,i("bfFMS").createErrorClass)(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})}),o("9z4na",function(e,r){t(e.exports,"take",function(){return a});var n=i("gL4uk"),o=i("jSzwf"),s=i("iNetn");function a(e){return e<=0?function(){return n.EMPTY}:(0,o.operate)(function(t,r){var n=0;t.subscribe((0,s.createOperatorSubscriber)(r,function(t){++n<=e&&(r.next(t),e<=n&&r.complete())}))})}}),o("gSl4p",function(e,r){t(e.exports,"defaultIfEmpty",function(){return s});var n=i("jSzwf"),o=i("iNetn");function s(e){return(0,n.operate)(function(t,r){var n=!1;t.subscribe((0,o.createOperatorSubscriber)(r,function(e){n=!0,r.next(e)},function(){n||r.next(e),r.complete()}))})}}),o("aRjCl",function(e,r){t(e.exports,"throwIfEmpty",function(){return a});var n=i("aXqMV"),o=i("jSzwf"),s=i("iNetn");function a(e){return void 0===e&&(e=l),(0,o.operate)(function(t,r){var n=!1;t.subscribe((0,s.createOperatorSubscriber)(r,function(e){n=!0,r.next(e)},function(){return n?r.complete():r.error(e())}))})}function l(){return new n.EmptyError}}),o("5gqvu",function(e,t){e.exports=i("9fdc7")}),o("9fdc7",function(e,r){t(e.exports,"Children",function(){return n},function(e){return n=e}),t(e.exports,"Component",function(){return i},function(e){return i=e}),t(e.exports,"Fragment",function(){return o},function(e){return o=e}),t(e.exports,"Profiler",function(){return s},function(e){return s=e}),t(e.exports,"PureComponent",function(){return a},function(e){return a=e}),t(e.exports,"StrictMode",function(){return l},function(e){return l=e}),t(e.exports,"Suspense",function(){return u},function(e){return u=e}),t(e.exports,"__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",function(){return c},function(e){return c=e}),t(e.exports,"act",function(){return h},function(e){return h=e}),t(e.exports,"cloneElement",function(){return d},function(e){return d=e}),t(e.exports,"createContext",function(){return p},function(e){return p=e}),t(e.exports,"createElement",function(){return f},function(e){return f=e}),t(e.exports,"createFactory",function(){return g},function(e){return g=e}),t(e.exports,"createRef",function(){return m},function(e){return m=e}),t(e.exports,"forwardRef",function(){return _},function(e){return _=e}),t(e.exports,"isValidElement",function(){return y},function(e){return y=e}),t(e.exports,"lazy",function(){return E},function(e){return E=e}),t(e.exports,"memo",function(){return v},function(e){return v=e}),t(e.exports,"startTransition",function(){return b},function(e){return b=e}),t(e.exports,"unstable_act",function(){return R},function(e){return R=e}),t(e.exports,"useCallback",function(){return T},function(e){return T=e}),t(e.exports,"useContext",function(){return I},function(e){return I=e}),t(e.exports,"useDebugValue",function(){return C},function(e){return C=e}),t(e.exports,"useDeferredValue",function(){return S},function(e){return S=e}),t(e.exports,"useEffect",function(){return x},function(e){return x=e}),t(e.exports,"useId",function(){return O},function(e){return O=e}),t(e.exports,"useImperativeHandle",function(){return A},function(e){return A=e}),t(e.exports,"useInsertionEffect",function(){return w},function(e){return w=e}),t(e.exports,"useLayoutEffect",function(){return N},function(e){return N=e}),t(e.exports,"useMemo",function(){return D},function(e){return D=e}),t(e.exports,"useReducer",function(){return L},function(e){return L=e}),t(e.exports,"useRef",function(){return M},function(e){return M=e}),t(e.exports,"useState",function(){return U},function(e){return U=e}),t(e.exports,"useSyncExternalStore",function(){return P},function(e){return P=e}),t(e.exports,"useTransition",function(){return k},function(e){return k=e}),t(e.exports,"version",function(){return F},function(e){return F=e});var n,i,o,s,a,l,u,c,h,d,p,f,g,m,_,y,E,v,b,R,T,I,C,S,x,O,A,w,N,D,L,M,U,P,k,F,j=Symbol.for("react.element"),B=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),G=Symbol.for("react.provider"),W=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),K=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),q=Symbol.iterator,J={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q=Object.assign,Z={};function ee(e,t,r){this.props=e,this.context=t,this.refs=Z,this.updater=r||J}function et(){}function er(e,t,r){this.props=e,this.context=t,this.refs=Z,this.updater=r||J}ee.prototype.isReactComponent={},ee.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},ee.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},et.prototype=ee.prototype;var en=er.prototype=new et;en.constructor=er,Q(en,ee.prototype),en.isPureReactComponent=!0;var ei=Array.isArray,eo=Object.prototype.hasOwnProperty,es={current:null},ea={key:!0,ref:!0,__self:!0,__source:!0};function el(e,t,r){var n,i={},o=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)eo.call(t,n)&&!ea.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(1===a)i.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===i[n]&&(i[n]=a[n]);return{$$typeof:j,type:e,key:o,ref:s,props:i,_owner:es.current}}function eu(e){return"object"==typeof e&&null!==e&&e.$$typeof===j}var ec=/\/+/g;function eh(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function ed(e,t,r){if(null==e)return e;var n=[],i=0;return function e(t,r,n,i,o){var s,a,l,u=typeof t;("undefined"===u||"boolean"===u)&&(t=null);var c=!1;if(null===t)c=!0;else switch(u){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case j:case B:c=!0}}if(c)return o=o(c=t),t=""===i?"."+eh(c,0):i,ei(o)?(n="",null!=t&&(n=t.replace(ec,"$&/")+"/"),e(o,r,n,"",function(e){return e})):null!=o&&(eu(o)&&(s=o,a=n+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(ec,"$&/")+"/")+t,o={$$typeof:j,type:s.type,key:a,ref:s.ref,props:s.props,_owner:s._owner}),r.push(o)),1;if(c=0,i=""===i?".":i+":",ei(t))for(var h=0;h<t.length;h++){var d=i+eh(u=t[h],h);c+=e(u,r,n,d,o)}else if("function"==typeof(d=null===(l=t)||"object"!=typeof l?null:"function"==typeof(l=q&&l[q]||l["@@iterator"])?l:null))for(t=d.call(t),h=0;!(u=t.next()).done;)d=i+eh(u=u.value,h++),c+=e(u,r,n,d,o);else if("object"===u)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(r=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return c}(e,n,"","",function(e){return t.call(r,e,i++)}),n}function ep(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var ef={current:null},eg={transition:null};function em(){throw Error("act(...) is not supported in production builds of React.")}n={map:ed,forEach:function(e,t,r){ed(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ed(e,function(){t++}),t},toArray:function(e){return ed(e,function(e){return e})||[]},only:function(e){if(!eu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},i=ee,o=H,s=$,a=er,l=V,u=Y,c={ReactCurrentDispatcher:ef,ReactCurrentBatchConfig:eg,ReactCurrentOwner:es},h=em,d=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Q({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=es.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)eo.call(t,l)&&!ea.hasOwnProperty(l)&&(n[l]=void 0===t[l]&&void 0!==a?a[l]:t[l])}var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:j,type:e.type,key:i,ref:o,props:n,_owner:s}},p=function(e){return(e={$$typeof:W,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:G,_context:e},e.Consumer=e},f=el,g=function(e){var t=el.bind(null,e);return t.type=e,t},m=function(){return{current:null}},_=function(e){return{$$typeof:z,render:e}},y=eu,E=function(e){return{$$typeof:X,_payload:{_status:-1,_result:e},_init:ep}},v=function(e,t){return{$$typeof:K,type:e,compare:void 0===t?null:t}},b=function(e){var t=eg.transition;eg.transition={};try{e()}finally{eg.transition=t}},R=em,T=function(e,t){return ef.current.useCallback(e,t)},I=function(e){return ef.current.useContext(e)},C=function(){},S=function(e){return ef.current.useDeferredValue(e)},x=function(e,t){return ef.current.useEffect(e,t)},O=function(){return ef.current.useId()},A=function(e,t,r){return ef.current.useImperativeHandle(e,t,r)},w=function(e,t){return ef.current.useInsertionEffect(e,t)},N=function(e,t){return ef.current.useLayoutEffect(e,t)},D=function(e,t){return ef.current.useMemo(e,t)},L=function(e,t,r){return ef.current.useReducer(e,t,r)},M=function(e){return ef.current.useRef(e)},U=function(e){return ef.current.useState(e)},P=function(e,t,r){return ef.current.useSyncExternalStore(e,t,r)},k=function(){return ef.current.useTransition()},F="18.3.1"}),o("8L69c",function(e,t){var r,n,i,o=e.exports={};function s(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u=[],c=!1,h=-1;function d(){c&&i&&(c=!1,i.length?u=i.concat(u):h=-1,u.length&&p())}function p(){if(!c){var e=l(d);c=!0;for(var t=u.length;t;){for(i=u,u=[];++h<t;)i&&i[h].run();h=-1,t=u.length}i=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||c||l(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}),o("kOUYr",function(e,t){var r=i("1XeGV");e.exports=r("bsj1K").then(()=>i("1UDbf"))}),o("1XeGV",function(e,t){e.exports=function(e){return import(i("6wcuN").resolve(e))}}),o("d2Syu",function(e,t){var r=i("1XeGV");e.exports=r("9KcLI").then(()=>i("3e0Iz"))}),o("3BKeR",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("9KcLI"),r("bsj1K"),r("cEaBk")]).then(()=>i("fL2Ug"))}),o("ihvjB",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("83zSG"),r("7XIVP")]).then(()=>i("ejawP"))}),o("56aTz",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("7XIVP"),r("83zSG"),r("R3kUb"),r("eR5nu"),r("9KcLI"),r("cEaBk"),r("bsj1K"),r("cGlq4")]).then(()=>i("4XALk"))}),o("gGrHp",function(e,t){var r=i("1XeGV");e.exports=r("83zSG").then(()=>i("86b1c"))}),o("9sshc",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("7XIVP"),r("83zSG"),r("R3kUb"),r("eR5nu"),r("cGlq4"),r("9KcLI"),r("cEaBk"),r("bsj1K"),r("fQ6Pz")]).then(()=>i("i5NZc"))}),o("RnZPS",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("83zSG"),r("7XIVP"),r("jtPqR")]).then(()=>i("bRzks"))}),o("8SSci",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("jtPqR"),r("7XIVP"),r("83zSG"),r("R3kUb"),r("eR5nu"),r("cGlq4"),r("9KcLI"),r("cEaBk"),r("bsj1K"),r("e9yja")]).then(()=>i("kRRWY"))}),o("5hnqv",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("jtPqR"),r("e9yja"),r("fQ6Pz"),r("7XIVP"),r("83zSG"),r("R3kUb"),r("eR5nu"),r("cGlq4"),r("9KcLI"),r("cEaBk"),r("bsj1K"),r("9LVLP")]).then(()=>i("7qSdr"))}),o("252tF",function(e,t){var r=i("1XeGV");e.exports=r("buFfU").then(()=>i("5DAFn"))}),o("9Ib86",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("9KcLI"),r("R3kUb")]).then(()=>i("7AR1b"))}),o("10b7f",function(e,t){var r=i("1XeGV");e.exports=Promise.all([r("83zSG"),r("R3kUb"),r("9KcLI"),r("cEaBk"),r("bsj1K"),r("eR5nu")]).then(()=>i("g6Cit"))}),o("6Xmii",function(e,t){var r=i("1XeGV");e.exports=r("dI0Yq").then(()=>i("fsU3r"))}),o("11ygn",function(e,t){var r=i("1XeGV");e.exports=r("cXU77").then(()=>i("lH5uj"))}),o("fut46",function(e,t){var r=i("1XeGV");e.exports=r("4p4lP").then(()=>i("bx8hK"))}),o("hNTKZ",function(e,t){var r=i("1XeGV");e.exports=r("kq2CJ").then(()=>i("lPND8"))}),o("7aGPl",function(e,t){var r=i("1XeGV");e.exports=r("igrod").then(()=>i("cJji3"))}),o("ihZKh",function(e,t){var r=i("1XeGV");e.exports=r("gwgTn").then(()=>i("4rp5R"))});var s=i("7yNYd");const a=Promise.resolve(i("7yNYd")).then(({Univer:e,LocaleType:t,Tools:r})=>({Univer:e,LocaleType:t,Tools:r})),l=i("kOUYr").then(({defaultTheme:e})=>({defaultTheme:e})),u=i("d2Syu").then(({UniverRenderEnginePlugin:e})=>e),c=i("3BKeR").then(({UniverUIPlugin:e})=>e),h=i("ihvjB").then(({UniverSheetsPlugin:e,SetRangeValuesMutation:t,SetFrozenCommand:r,SetSelectionsOperation:n})=>({UniverSheetsPlugin:e,SetRangeValuesMutation:t,SetFrozenCommand:r,SetSelectionsOperation:n})),d=i("56aTz").then(({UniverSheetsUIPlugin:e})=>e),p=i("gGrHp").then(({UniverFormulaEnginePlugin:e})=>e),f=i("9sshc").then(({UniverSheetsNumfmtPlugin:e})=>e),g=i("RnZPS").then(({UniverSheetsFormulaPlugin:e})=>e),m=i("8SSci").then(({UniverSheetsFormulaUIPlugin:e})=>e),_=i("5hnqv").then(({FUniver:e})=>({FUniver:e})),y=i("252tF"),E=i("9Ib86").then(({UniverDocsPlugin:e})=>e),v=i("10b7f").then(({UniverDocsUIPlugin:e})=>e),b=i("6Xmii"),R=i("11ygn"),T=i("fut46"),I=i("hNTKZ"),C=i("7aGPl"),S=i("ihZKh");async function x(e,t){let{cellData:r,rowCount:n,columnCount:i}=await O(e);return{id:"sqlpage",name:t.sheet_name,defaultColumnWidth:t.column_width,defaultRowHeight:t.row_height,showGridlines:+t.show_grid,freeze:{startRow:t.freeze_y,startColumn:t.freeze_x,xSplit:t.freeze_x,ySplit:t.freeze_y},rowCount:n,columnCount:i,cellData:r}}async function O(e){let t={},r=1e3,n=26,i=U(await y);for(let o of e){let[e,a,l,...u]=i.parse(o),c={v:l},h=u.length?function(e){let t={};for(let r=0;r<e.length;r++){let n=e[r];if(1===n)t.bl=1;else if(2===n)t.it=1;else if(3===n){let n=e[++r].toString(),i=N.getPropertyValue(`--tblr-${n}`)||n;t.bg={rgb:i}}else if(4===n)t.ht=s.HorizontalAlign.CENTER;else if(5===n)t.ht=s.HorizontalAlign.RIGHT;else if(6===n)t.ht=s.HorizontalAlign.JUSTIFIED;else if(7===n)t.ht=s.HorizontalAlign.DISTRIBUTED;else if(8===n){let n=e[++r].toString();t.n={pattern:n}}else if(9===n)t.id=e[++r].toString();else if(10===n)t.ff=e[++r].toString();else if(11===n)t.fs=Number(e[++r]);else if(12===n)t.ul={s:1};else if(13===n)t.st={s:1};else if(14===n){let n=e[++r].toString(),i=N.getPropertyValue(`--tblr-${n}`)||n;t.cl={rgb:i}}else 15===n?t.vt=s.VerticalAlign.TOP:16===n?t.vt=s.VerticalAlign.MIDDLE:17===n?t.vt=s.VerticalAlign.BOTTOM:18===n?t.tb=s.WrapStrategy.OVERFLOW:19===n?t.tb=s.WrapStrategy.CLIP:20===n?t.tb=s.WrapStrategy.WRAP:21===n&&(t.td=s.TextDirection.RIGHT_TO_LEFT)}return t}(u):null;c.s=h,h?.id&&(c.custom={id:h.id}),"number"==typeof l&&(c.t=2);let d=t[a];d?d[e]=c:t[a]={[e]:c},r=Math.max(r,a),n=Math.max(n,e)}return{cellData:t,rowCount:r,columnCount:n}}async function A(e){let{Univer:t,LocaleType:r,Tools:n}=await a,{defaultTheme:i}=await l,o=new t({theme:i,logLevel:3,locale:r.EN_US,locales:{[r.EN_US]:n.deepMerge(await b,await R,await T,await I,await C,await S)}});o.registerPlugin(await u);let s=await c;return e.className="sqlpage_spreadsheet",o.registerPlugin(s,{container:e}),o.registerPlugin((await h).UniverSheetsPlugin),o.registerPlugin(await d),o.registerPlugin(await E),o.registerPlugin(await v),o.registerPlugin(await p),o.registerPlugin(await f),o.registerPlugin(await g),o.registerPlugin(await m),o}async function w(e,t,r,n,i,o){if(!e)return;let s=new URL(e,window.location.href);s.searchParams.append("_sqlpage_embed","");let a=new URLSearchParams;a.append("x",t.toString()),a.append("y",r.toString()),null!=n&&a.append("value",n.toString()),"string"==typeof i.id&&a.append("id",i.id);let l=await fetch(s,{method:"POST",body:a}),u=await l.text();200===l.status||u||(u=l.statusText),u&&(o.resp_modal_body.innerHTML=u,new o.Modal(o.resp_modal).show())}const N=getComputedStyle(document.documentElement);async function D(e,t,r){let n=e.querySelector(".modal");if(!(n instanceof HTMLElement))throw Error("modal not found");let i=function(e){if(!e)throw Error("errorModal not found");let t=e.querySelector(".modal-body");if(!t)throw Error("errorModal not found");let r=window?.bootstrap?.Modal;if(!r)throw Error("bootstrap.Modal not found");return{resp_modal:e,resp_modal_body:t,Modal:r}}(n),o=await x(r,t),s=await A(e);s.createUnit(2,{sheetOrder:["sqlpage"],name:"sqlpage",appVersion:"0.2.14",sheets:{sqlpage:o}});let{FUniver:a}=await _,l=a.newAPI(s),{SetRangeValuesMutation:u}=await h,{update_link:c}=t;l.onCommandExecuted(({id:e,params:t})=>{c&&e===u.id&&function(e,t,r){let{cellValue:n}=e;if(n)for(let e in n){let i=n[e];for(let n in i){let o=i[n];o&&w(t,Number.parseInt(n),Number.parseInt(e),o.v,o.custom||{},r)}}}(t,c,i)})}const L=e=>e.object({update_link:e.string().optional(),sheet_name:e.string().default("SQLPage Data"),freeze_x:e.number().int().nonnegative().default(0),freeze_y:e.number().int().nonnegative().default(0),column_width:e.number().int().nonnegative().optional(),row_height:e.number().int().nonnegative().optional(),show_grid:e.boolean().default(!0)}),M=e=>e.union([e.string(),e.number()]),U=e=>e.tuple([e.number().int().nonnegative(),e.number().int().nonnegative(),e.union([e.string(),e.number(),e.null()])]).rest(M(e));async function P(e){try{let t=e.dataset;if(!t)throw Error("Props not found");let r=JSON.parse(t?.cells||"[]");if(!Array.isArray(r))throw Error(`Invalid cells${t?.cells}`);let n=L(await y).parse(JSON.parse(t?.props||"{}"));D(e,n,r)}catch(e){alert(`Invalid properties passed to the spreadsheet component: ${e}`)}}const k=document.getElementsByClassName("sqlpage_spreadsheet"),F=k[k.length-1];if(!(F instanceof HTMLElement))throw Error("No spreadsheet elements found");P(F);
//# sourceMappingURL=spreadsheet_component.3647f33b.js.map
